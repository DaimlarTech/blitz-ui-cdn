var eh=Object.defineProperty;var sh=(Pe,Ie,Oe)=>Ie in Pe?eh(Pe,Ie,{enumerable:!0,configurable:!0,writable:!0,value:Oe}):Pe[Ie]=Oe;var fe=(Pe,Ie,Oe)=>(sh(Pe,typeof Ie!="symbol"?Ie+"":Ie,Oe),Oe),Mn=(Pe,Ie,Oe)=>{if(!Ie.has(Pe))throw TypeError("Cannot "+Oe)};var t=(Pe,Ie,Oe)=>(Mn(Pe,Ie,"read from private field"),Oe?Oe.call(Pe):Ie.get(Pe)),l=(Pe,Ie,Oe)=>{if(Ie.has(Pe))throw TypeError("Cannot add the same private member more than once");Ie instanceof WeakSet?Ie.add(Pe):Ie.set(Pe,Oe)},I=(Pe,Ie,Oe,Ss)=>(Mn(Pe,Ie,"write to private field"),Ss?Ss.call(Pe,Oe):Ie.set(Pe,Oe),Oe);var fs=(Pe,Ie,Oe,Ss)=>({set _(vn){I(Pe,Ie,vn,Oe)},get _(){return t(Pe,Ie,Ss)}}),C=(Pe,Ie,Oe)=>(Mn(Pe,Ie,"access private method"),Oe);(async()=>{(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))u(e);new MutationObserver(e=>{for(const w of e)if(w.type==="childList")for(const f of w.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&u(f)}).observe(document,{childList:!0,subtree:!0});function m(e){const w={};return e.integrity&&(w.integrity=e.integrity),e.referrerPolicy&&(w.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?w.credentials="include":e.crossOrigin==="anonymous"?w.credentials="omit":w.credentials="same-origin",w}function u(e){if(e.ep)return;e.ep=!0;const w=m(e);fetch(e.href,w)}})();const Pe=document.querySelectorAll(".navigation-drawer"),Ie=document.querySelectorAll(".navigation-drawer__dialog"),Oe=document.querySelectorAll('[data-role="drawer"]');Oe.forEach(r=>r.addEventListener("click",Ss)),Pe.forEach(r=>r.addEventListener("click",Ss)),Ie.forEach(r=>r.addEventListener("click",m=>{m.stopPropagation()}));function Ss(){Pe.forEach(r=>r.classList.toggle("drawer_show")),Oe.forEach(r=>r.classList.toggle("toggler_show"))}const vn=document.querySelectorAll(".drawer"),so=document.querySelectorAll('[data-role="drawer-toggler"]');vn.forEach(r=>{r.addEventListener("click",()=>{r.classList.remove("drawer_is_open")});const m=r.querySelector(".drawer__content");m&&m.addEventListener("click",u=>{u.stopPropagation()})}),so.forEach(r=>{r.addEventListener("click",()=>{const m=document.querySelector(r.dataset.target);m&&m.classList.toggle("drawer_is_open")})}),document.addEventListener("DOMContentLoaded",function(){const r=document.getElementById("agreement-box"),m=document.getElementById("agreement-check"),u=document.getElementById("agree_chk_id");if(u&&r){let e=function(f,T){let W;return function(...k){const _=()=>{clearTimeout(W),f(...k)};clearTimeout(W),W=setTimeout(_,T)}},w=function(){Math.abs(r.scrollHeight-r.clientHeight-r.scrollTop)<=1&&u.disabled&&(u.disabled=!1,m.classList.remove("check-disabled"),m.classList.add("check-enabled"),u.classList.add("check-enabled"))};u.disabled=!0,r.addEventListener("scroll",e(w,100)),window.addEventListener("load",w)}}),document.addEventListener("DOMContentLoaded",function(){const r="noantisocial",m="edelivery",u=document.getElementById("confirmButton");if(u){let e=function(){const f=document.getElementById(r).checked,T=document.getElementById(m).checked;u.disabled=!(f&&T)},w=function(f,T,W,k,_,g,H){const S=document.getElementById(f),A=document.getElementById(T),F=document.getElementById(W),N=document.getElementById(k),X=document.getElementById(_),rt=document.getElementById(g),J=document.getElementById(H);N.disabled=!0,X.disabled=!0;function M(){let j=!(A.clientHeight<F.scrollHeight)||A.scrollHeight-A.scrollTop<=A.clientHeight+1;N.disabled=!j}S.addEventListener("shown.bs.modal",function(){M(),A.addEventListener("scroll",M)}),N.addEventListener("click",function(){this.disabled||(rt.style.display="none",X.disabled=!1,J.classList.remove("check-disabled"),J.classList.add("check-enabled"),X.classList.remove("check-disabled"),X.classList.add("check-enabled"))}),X.addEventListener("change",e)};u.disabled=!0,w("noantisocialModal","noantisocialBox","noantisocialItem","noantisocialButton",r,"noantisocialText","noantisocialLabel"),w("edeliveryModal","edeliveryBox","edeliveryItem","edeliveryButton",m,"edeliveryText","edeliveryLabel"),e()}}),document.querySelectorAll('[data-role="zengin-input"]').forEach(r=>{r.addEventListener("blur",io)});function io(r){let m=r.target.value;if(m){const u=no(m);r.target.value=u}}function no(r){const m=/[^0-9A-Zｱｲｳｴｵｶｷｸｹｺｻｼｽｾｿﾀﾁﾂﾃﾄﾅﾆﾇﾈﾉﾊﾋﾌﾍﾎﾏﾐﾑﾒﾓﾔﾕﾖﾗﾘﾙﾚﾛﾜﾝﾞﾟ\(\)｢｣\/\-\.\\ ]/g,u=["\uFF70","\uFF67","\uFF68","\uFF69","\uFF6A","\uFF6B","\uFF6F","\uFF6C","\uFF6D","\uFF6E","\uFF08","\uFF09"],e=["-","\uFF71","\uFF72","\uFF73","\uFF74","\uFF75","\uFF82","\uFF94","\uFF95","\uFF96","(",")"];let w;return w=r.toUpperCase(),w=ro(w,"khsa"),u.forEach((f,T)=>{w=w.replaceAll(f,e[T])}),w=w.replace(m,""),w}function ro(r,m){var u,e,w,f,T,W;if(u=["\uFF76\uFF9E","\uFF77\uFF9E","\uFF78\uFF9E","\uFF79\uFF9E","\uFF7A\uFF9E","\uFF7B\uFF9E","\uFF7C\uFF9E","\uFF7D\uFF9E","\uFF7E\uFF9E","\uFF7F\uFF9E","\uFF80\uFF9E","\uFF81\uFF9E","\uFF82\uFF9E","\uFF83\uFF9E","\uFF84\uFF9E","\uFF8A\uFF9E","\uFF8A\uFF9F","\uFF8B\uFF9E","\uFF8B\uFF9F","\uFF8C\uFF9E","\uFF8C\uFF9F","\uFF8D\uFF9E","\uFF8D\uFF9F","\uFF8E\uFF9E","\uFF8E\uFF9F","\uFF73\uFF9E","\uFF70","\uFF67","\uFF71","\uFF68","\uFF72","\uFF69","\uFF73","\uFF6A","\uFF74","\uFF6B","\uFF75","\uFF76","\uFF77","\uFF78","\uFF79","\uFF7A","\uFF7B","\uFF7C","\uFF7D","\uFF7E","\uFF7F","\uFF80","\uFF81","\uFF6F","\uFF82","\uFF83","\uFF84","\uFF85","\uFF86","\uFF87","\uFF88","\uFF89","\uFF8A","\uFF8B","\uFF8C","\uFF8D","\uFF8E","\uFF8F","\uFF90","\uFF91","\uFF92","\uFF93","\uFF6C","\uFF94","\uFF6D","\uFF95","\uFF6E","\uFF96","\uFF97","\uFF98","\uFF99","\uFF9A","\uFF9B","\uFF9C","\uFF66","\uFF9D","\uFF76","\uFF79","\uFF9C","\uFF72","\uFF74","\uFF9E","\uFF9F"],e=["\u30AC","\u30AE","\u30B0","\u30B2","\u30B4","\u30B6","\u30B8","\u30BA","\u30BC","\u30BE","\u30C0","\u30C2","\u30C5","\u30C7","\u30C9","\u30D0","\u30D1","\u30D3","\u30D4","\u30D6","\u30D7","\u30D9","\u30DA","\u30DC","\u30DD","\u30F4","\u30FC","\u30A1","\u30A2","\u30A3","\u30A4","\u30A5","\u30A6","\u30A7","\u30A8","\u30A9","\u30AA","\u30AB","\u30AD","\u30AF","\u30B1","\u30B3","\u30B5","\u30B7","\u30B9","\u30BB","\u30BD","\u30BF","\u30C1","\u30C3","\u30C4","\u30C6","\u30C8","\u30CA","\u30CB","\u30CC","\u30CD","\u30CE","\u30CF","\u30D2","\u30D5","\u30D8","\u30DB","\u30DE","\u30DF","\u30E0","\u30E1","\u30E2","\u30E3","\u30E4","\u30E5","\u30E6","\u30E7","\u30E8","\u30E9","\u30EA","\u30EB","\u30EC","\u30ED","\u30EF","\u30F2","\u30F3","\u30F5","\u30F6","\u30EE","\u30F0","\u30F1","\u309B","\u309C"],w=["\u304C","\u304E","\u3050","\u3052","\u3054","\u3056","\u3058","\u305A","\u305C","\u305E","\u3060","\u3062","\u3065","\u3067","\u3069","\u3070","\u3071","\u3073","\u3074","\u3076","\u3077","\u3079","\u307A","\u307C","\u307D","\u30F4","\u30FC","\u3041","\u3042","\u3043","\u3044","\u3045","\u3046","\u3047","\u3048","\u3049","\u304A","\u304B","\u304D","\u304F","\u3051","\u3053","\u3055","\u3057","\u3059","\u305B","\u305D","\u305F","\u3061","\u3063","\u3064","\u3066","\u3068","\u306A","\u306B","\u306C","\u306D","\u306E","\u306F","\u3072","\u3075","\u3078","\u307B","\u307E","\u307F","\u3080","\u3081","\u3082","\u3083","\u3084","\u3085","\u3086","\u3087","\u3088","\u3089","\u308A","\u308B","\u308C","\u308D","\u308F","\u3092","\u3093","\u304B","\u3051","\u308E","\u3090","\u3091","\u309B","\u309C"],f=u.length,m.match(/[ra]/)&&(r=r.replace(/[Ａ-ｚ]/g,function(k){return String.fromCharCode(parseInt(k.charCodeAt(0))-65248)})),m.match(/[RA]/)&&(r=r.replace(/[A-z]/g,function(k){return String.fromCharCode(parseInt(k.charCodeAt(0))+65248)})),m.match(/[na]/)&&(r=r.replace(/[０-９]/g,function(k){return String.fromCharCode(parseInt(k.charCodeAt(0))-65248)})),m.match(/[NA]/)&&(r=r.replace(/[0-9]/g,function(k){return String.fromCharCode(parseInt(k.charCodeAt(0))+65248)})),m.match(/s/)&&(r=r.replace(/　/g," ")),m.match(/S/)&&(r=r.replace(/ /g,"\u3000")),m.match(/k/))for(T=0;T<f;T++)W=new RegExp(e[T],"g"),r=r.replace(W,u[T]);if(m.match(/K/))for(m.match(/V/)||(r=r.replace(/ﾞ/g,"\u309B"),r=r.replace(/ﾟ/g,"\u309C")),T=0;T<f;T++)W=new RegExp(u[T],"g"),r=r.replace(W,e[T]);if(m.match(/h/))for(T=0;T<f;T++)W=new RegExp(w[T],"g"),r=r.replace(W,u[T]);if(m.match(/H/))for(m.match(/V/)||(r=r.replace(/ﾞ/g,"\u309B"),r=r.replace(/ﾟ/g,"\u309C")),T=0;T<f;T++)W=new RegExp(u[T],"g"),r=r.replace(W,w[T]);if(m.match(/c/))for(T=0;T<f;T++)W=new RegExp(e[T],"g"),r=r.replace(W,w[T]);if(m.match(/C/))for(T=0;T<f;T++)W=new RegExp(w[T],"g"),r=r.replace(W,e[T]);return r}document.querySelectorAll('[data-role="toggle-input--btn"]').forEach(r=>{r.addEventListener("click",m=>{const u=m.target.dataset.group;document.querySelectorAll(`[data-group="${u}"][data-role="toggle-input--value"], [data-group="${u}"][data-role="toggle-input--input"]`).forEach(e=>{e.classList.toggle("toggle-input_show")})})});const ao=document.querySelectorAll('[data-role="resize"]');window.addEventListener("load",()=>{ao.forEach(r=>{const m=r.dataset.field,u=document.querySelector(`[name="uploadFilesBlock${m}"]`),e=document.querySelector(`input[name='selectFiles${m}']`),w=document.createElement("div"),f=document.createElement("div"),T=document.createElement("div"),W=document.createElement("input"),k=document.createElement("p"),_=document.createElement("button");W.setAttribute("type","file"),W.style.display="none",W.addEventListener("change",g=>{const H=g.target.files[0];wr(H,e)}),f.appendChild(w),f.classList.add("coverDiv"),f.addEventListener("dragstart",g=>{g.dataTransfer.clearData(),bn(g)}),f.addEventListener("dragover",g=>{bn(g)}),f.addEventListener("dragleave",g=>{}),f.addEventListener("drop",g=>{bn(g);const H=g.target.files||g.dataTransfer.files;H.length>0&&wr(H[0],e)}),w.appendChild(T),w.classList.add("sp-flex-align-center","sp-flex-content-center","sp-flex","sp-from-file-default-drag-drop-area"),w.addEventListener("dragover",g=>{w.classList.remove("sp-from-file-ondragleave-drag-drop-area"),w.classList.remove("sp-from-file-ondrop-drag-drop-area"),w.classList.add("sp-from-file-ondraghover-drag-drop-area")}),w.addEventListener("dragleave",g=>{w.classList.add("sp-from-file-ondragleave-drag-drop-area"),w.classList.remove("sp-from-file-ondrop-drag-drop-area"),w.classList.remove("sp-from-file-ondraghover-drag-drop-area")}),w.addEventListener("drop",g=>{w.classList.remove("sp-from-file-ondragleave-drag-drop-area"),w.classList.add("sp-from-file-ondrop-drag-drop-area"),w.classList.remove("sp-from-file-ondraghover-drag-drop-area")}),T.appendChild(k),T.appendChild(_),T.appendChild(W),k.textContent="\u3053\u3053\u306B\u30D5\u30A1\u30A4\u30EB\u3092\u30C9\u30ED\u30C3\u30D7\u3057\u3066\u304F\u3060\u3055\u3044",k.classList.add("small"),_.type="button",_.textContent="\u30D5\u30A1\u30A4\u30EB\u53C2\u7167",_.classList.add("sp-form-file-button"),_.addEventListener("click",()=>W.click()),W.accept=".jpg,.png,.jpeg,.webp",u.style.position="relative",u.appendChild(f)})});const oo=/^(image\/jpg|image\/jpeg|image\/png|image\/webp)$/,ho=256;async function wr(r,m){if(!m)throw new Error("spiral input not found");const u=lo(r)?await co(r):r,e=new DataTransfer;e.items.add(u),m.files=e.files,m.dispatchEvent(new Event("change"))}function lo(r){return!(!r.type.match(oo)||r.name>ho)}function co(r){const m=r.name.split(".").slice(0,-1).join(".");let u=new FileReader;return new Promise((e,w)=>{u.onload=async()=>{const f=u.result,T=await uo(f),W=await(await fetch(T)).blob();e(new File([W],`${m}.jpeg`,{type:"image/jpeg"}))},u.readAsDataURL(r)})}async function uo(r){const m=await new Promise((f,T)=>{const W=new Image;W.onload=()=>{f(W)},W.onerror=()=>{T()},W.src=r}),u=document.createElement("canvas");let e=m.naturalWidth,w=m.naturalHeight;for(;e*w>5e5;)e/=10,w/=10;return u.width=e,u.height=w,u.getContext("2d").drawImage(m,0,0,e,w),u.toDataURL("image/jpeg")}function bn(r){r.stopPropagation(),r.preventDefault()}const Er=document.querySelector('[data-role="zip-search_input"]'),Ri=document.querySelector('[data-role="zip-search_btn"'),po=document.querySelector("#prefecture"),go=document.querySelector("#city"),mo=document.querySelector("#street"),fo=document.querySelector("#js-zip_error"),vo="https://api.zipaddress.net/";var An="",Pi="";Er&&Ri&&(Er.addEventListener("input",Ao),Ri.addEventListener("click",yo));async function bo(){const r=`${vo}?zipcode=${An}`;return fetch(r).then(m=>m.json()).then(m=>m.code!==200?{data:m.message,error:!0}:{data:m.data,error:!1})}function Ao(r){const m=r.target.value;Ri.disabled=!0,Pi="",m.length===7?(An=m,Ri.disabled=!1):m.length!=0&&(Pi="7\u6841\u306E\u6570\u5B57\u3092\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044\u3002"),xr()}async function yo(){var r;if(An.length===7){const m=await bo();if(m.error){Pi=m.data,xr();return}po.value=yn[r=m.data.pref]??(yn[r]=""),go.value=m.data.city,mo.value=m.data.town}}function xr(){fo.textContent=Pi}const yn={\u5317\u6D77\u9053:1,\u9752\u68EE\u770C:2,\u5CA9\u624B\u770C:3,\u5BAE\u57CE\u770C:4,\u79CB\u7530\u770C:5,\u5C71\u5F62\u770C:6,\u798F\u5CF6\u770C:7,\u8328\u57CE\u770C:8,\u6803\u6728\u770C:9,\u7FA4\u99AC\u770C:10,\u57FC\u7389\u770C:11,\u5343\u8449\u770C:12,\u6771\u4EAC\u90FD:13,\u795E\u5948\u5DDD\u770C:14,\u65B0\u6F5F\u770C:15,\u5BCC\u5C71\u770C:16,\u77F3\u5DDD\u770C:17,\u798F\u4E95\u770C:18,\u5C71\u68A8\u770C:19,\u9577\u91CE\u770C:20,\u5C90\u961C\u770C:21,\u9759\u5CA1\u770C:22,\u611B\u77E5\u770C:23,\u4E09\u91CD\u770C:24,\u6ECB\u8CC0\u770C:25,\u4EAC\u90FD\u5E9C:26,\u5927\u962A\u5E9C:27,\u5175\u5EAB\u770C:28,\u5948\u826F\u770C:29,\u548C\u6B4C\u5C71\u770C:30,\u9CE5\u53D6\u770C:31,\u5CF6\u6839\u770C:32,\u5CA1\u5C71\u770C:33,\u5E83\u5CF6\u770C:34,\u5C71\u53E3\u770C:35,\u5FB3\u5CF6\u770C:36,\u9999\u5DDD\u770C:37,\u611B\u5A9B\u770C:38,\u9AD8\u77E5\u770C:39,\u798F\u5CA1\u770C:40,\u4F50\u8CC0\u770C:41,\u9577\u5D0E\u770C:42,\u718A\u672C\u770C:43,\u5927\u5206\u770C:44,\u5BAE\u5D0E\u770C:45,\u9E7F\u5150\u5CF6\u770C:46,\u6C96\u7E04\u770C:47};document.querySelectorAll(".searh-dropdown").forEach(r=>{const m=r.querySelector("button"),u=r.querySelector(".search-dropdown__list"),e=r.querySelector(".search-dropdown__input"),w=r.querySelector(".search-dropdown__items"),f=r.querySelectorAll(".search-dropdown__items>li"),T=r.querySelector(".search-dropdown__back"),W=Array.from(f).map(g=>g);m.addEventListener("click",()=>{const{bottom:g,left:H}=r.getBoundingClientRect();u.style.left=`${H}px`,u.style.top=`${g+4}px`,k()}),T.addEventListener("click",()=>{k()}),u.addEventListener("click",g=>{g.stopPropagation()}),e.addEventListener("input",g=>{let H=W;if(w.replaceChildren(),g.target.value.length>0&&(H=H.filter(S=>new RegExp(g.target.value).test(S.textContent)).map(S=>S)),H.length===0){const S=document.createElement("li");S.textContent="items not found",w.appendChild(S)}H.forEach(S=>{const A=document.createElement("li");A.innerHTML=S.innerHTML,A.addEventListener("click",_),w.appendChild(A)})}),f.forEach(g=>g.addEventListener("click",_));function k(){u.classList.toggle("search-dropdown__list_show"),m.classList.toggle("searh-dropdown__btn_active")}function _(g){m.textContent=g.target.textContent,k()}});const _o=document.querySelectorAll('[data-role="open-menus"]'),Sr=document.querySelectorAll('[data-role="menus"]');_o.forEach(r=>{r.addEventListener("mouseenter",()=>{Sr.forEach(m=>{m.classList.add("is-visible")})}),r.addEventListener("mouseleave",()=>{Sr.forEach(m=>{m.classList.remove("is-visible")})})});const wo=document.getElementById("js-dialog-area"),Eo=document.querySelectorAll('[data-role="dialog-dismiss"]'),xo=document.querySelectorAll('[data-role="dialog-toggler"]'),Cr=document.querySelectorAll(".dialog"),So=document.querySelectorAll(".dialog__container"),si="dialog_is_open",Mr="dialog_close_hard";Lo(),Cr.forEach(r=>{document.getElementById("js-dialog-area").appendChild(r),r.classList.contains(Mr)||r.addEventListener("click",Lr)}),xo.forEach(r=>{r.addEventListener("click",Co)}),Eo.forEach(r=>{r.addEventListener("click",Lr)}),So.forEach(r=>r.addEventListener("click",Mo)),window.addEventListener("keydown",r=>{r.key==="Escape"&&document.querySelectorAll(`.${si}:not(.${Mr})`).forEach(m=>m.classList.remove(si))});function Co(){document.querySelector(this.dataset.target).classList.toggle(si)}function Lr(){document.querySelectorAll(`.${si}`).forEach(r=>r.classList.remove(si))}function Mo(r){r.stopPropagation()}function Lo(){if(!wo&&Cr.length>0){const r=document.createElement("div");r.setAttribute("id","js-dialog-area"),r.style.zIndex="100",r.style.position="relative",document.body.appendChild(r)}}const To=document.querySelectorAll(".format_num"),ko=document.querySelectorAll(".format_date"),Ro=document.querySelectorAll(".format_datetime"),Po=document.querySelectorAll(".format_datetime_second"),Io=document.querySelectorAll(".format_month_date"),Fo=document.querySelectorAll(".format_post_code"),Do="format_area",No="format_rate",$e="--";To.forEach(r=>{if(r.textContent&&r.textContent!==$e){let m;(r.classList.contains(Do)||r.classList.contains(No))&&(m={minimumFractionDigits:2});const u=Number(r.textContent).toLocaleString(void 0,m);r.innerHTML=isNaN(parseFloat(r.textContent))?r.textContent:u}}),ko.forEach(r=>{if(r.textContent&&r.textContent!==$e){let m=r.textContent.replaceAll(`
`,"").replaceAll(" ","").split("/");r.innerHTML=`<span class="format format_unit" data-format="\u5E74">${m[0]??(m[0]=$e)}</span> `,r.innerHTML+=`<span class="format format_unit" data-format="\u6708">${m[1]??(m[1]=$e)}</span> `,r.innerHTML+=`<span class="format format_unit" data-format="\u65E5">${m[2]??(m[2]=$e)}</span>`}}),Ro.forEach(r=>{if(r.textContent&&r.textContent!==$e){let m=new Date(r.textContent);m!="Invalid Date"?(r.innerHTML=`<span class="format format_unit" data-format="\u5E74">${m.getFullYear()}</span> `,r.innerHTML+=`<span class="format format_unit" data-format="\u6708">${m.getMonth()+1}</span> `,r.innerHTML+=`<span class="format format_unit" data-format="\u65E5">${m.getDate()}</span> `,r.innerHTML+=` ${m.getHours()}:${m.getMinutes()<10?"0":""}${m.getMinutes()}`):(r.innerHTML=`<span class="format format_unit" data-format="\u5E74">${$e}</span> `,r.innerHTML+=`<span class="format format_unit" data-format="\u6708">${$e}</span> `,r.innerHTML+=`<span class="format format_unit" data-format="\u65E5">${$e}</span>`,r.innerHTML+=`${$e}`)}}),Po.forEach(r=>{if(r.textContent&&r.textContent!==$e){let[m,u]=r.textContent.replaceAll(`
`,"").split(" ");m=m.split("/"),r.innerHTML=`<span class="format format_unit" data-format="\u5E74">${m[0]??(m[0]=$e)}</span> `,r.innerHTML+=`<span class="format format_unit" data-format="\u6708">${m[1]??(m[1]=$e)}</span> `,r.innerHTML+=`<span class="format format_unit" data-format="\u65E5">${m[2]??(m[2]=$e)}</span>`,u=u.split(":"),r.innerHTML+=` <span class="format format_unit" data-format="\u6642">${u[0]??(u[0]=$e)}</span> `,r.innerHTML+=`<span class="format format_unit" data-format="\u5206">${u[1]??(u[1]=$e)}</span>`}}),Io.forEach(r=>{if(r.textContent&&r.textContent!==$e){let m=r.textContent.replaceAll(`
`,"").replaceAll(" ","").split("/");r.innerHTML=`<span class="format format_unit" data-format="\u6708">${m[0]??(m[0]=$e)}</span> `,r.innerHTML+=`<span class="format format_unit" data-format="\u65E5">${m[1]??(m[1]=$e)}</span>`}}),Fo.forEach(r=>{if(r.textContent&&r.textContent.length===7){let m=r.textContent.replaceAll(`
`,"").replaceAll(" ","");r.textContent=`\u3012 ${m.substring(0,4)}-${m.substring(4)}`}}),document.querySelectorAll(".password__toggler").forEach(r=>r.addEventListener("click",Oo));function Oo(){const r=document.querySelector(this.dataset.target);r.type=r.type==="password"?"text":"password"}document.querySelectorAll('[data-role="dropdown"]').forEach(r=>{const m=r.querySelector("button"),u=r.querySelector(".dropdown__content"),e=r.querySelector(".dropdown__list-wrapper"),w=r.querySelector(".dropdown__list"),f=r.querySelector(".dropdown__input"),T=r.querySelectorAll(".dropdown__list-item"),W=Array.from(T).map(A=>A),k=r.classList.contains("dropdown_type_right");u.addEventListener("click",g);const _=()=>{const{bottom:A,left:F,right:N}=m.getBoundingClientRect();k?e.style.left=`${N-e.offsetWidth}px`:e.style.left=`${F}px`,e.style.top=`${A+4}px`};m.addEventListener("click",()=>{_(),H()}),e.addEventListener("click",A=>{A.stopPropagation()}),f&&r.classList.contains("dropdown_search")&&(m.dataset.value,f.addEventListener("input",A=>{let F=W;if(w.replaceChildren(),A.target.value.length>0&&(F=F.filter(N=>new RegExp(A.target.value).test(N.textContent)).map(N=>N)),F.length===0){const N=document.createElement("li");N.classList.add("dropdown__list-item","dropdown__list-item_no-item"),N.textContent="items not found",w.appendChild(N)}F.forEach(N=>{const X=document.createElement("li");X.innerHTML=N.innerHTML,X.classList.add("dropdown__list-item"),X.addEventListener("click",S),w.appendChild(X)})}),T.forEach(A=>A.addEventListener("click",S)));function g(){r.classList.remove("dropdown_is_open"),m.classList.remove("dropdown__btn_is_active"),_&&window.removeEventListener("scroll",_)}function H(){r.classList.toggle("dropdown_is_open"),m.classList.toggle("dropdown__btn_is_active"),m.classList.contains("dropdown__btn_is_active")?window.addEventListener("scroll",_):window.removeEventListener("scroll",_)}function S(A){m.textContent=A.target.textContent,m.dataset.value=A.target.textContent,H()}});const _n="toggle-section__button_is_active",wn="toggle-section__item_is_show";document.querySelectorAll('[data-role="toggle-section"]').forEach(r=>{r.querySelectorAll("button").forEach(m=>m.addEventListener("click",()=>{document.querySelector(`button.${_n}`).classList.remove(_n),m.classList.add(_n);const u=document.querySelector(m.dataset.target),e=document.querySelector(`.${wn}`);u&&e&&(e.classList.remove(wn),u.classList.add(wn))}))});var Os=function(){return Os=Object.assign||function(r){for(var m,u=1,e=arguments.length;u<e;u++)for(var w in m=arguments[u])Object.prototype.hasOwnProperty.call(m,w)&&(r[w]=m[w]);return r},Os.apply(this,arguments)};function Tr(r,m,u){if(u||arguments.length===2)for(var e,w=0,f=m.length;w<f;w++)!e&&w in m||(e||(e=Array.prototype.slice.call(m,0,w)),e[w]=m[w]);return r.concat(e||Array.prototype.slice.call(m))}function kr(r){return Array.prototype.slice.call(r)}function Rr(r,m){var u=Math.floor(r);return u===m||u+1===m?r:m}function Pr(){return Date.now()}function En(r,m,u){if(m="data-keen-slider-"+m,u===null)return r.removeAttribute(m);r.setAttribute(m,u||"")}function Ii(r,m){return m=m||document,typeof r=="function"&&(r=r(m)),Array.isArray(r)?r:typeof r=="string"?kr(m.querySelectorAll(r)):r instanceof HTMLElement?[r]:r instanceof NodeList?kr(r):[]}function ii(r){r.raw&&(r=r.raw),r.cancelable&&!r.defaultPrevented&&r.preventDefault()}function ni(r){r.raw&&(r=r.raw),r.stopPropagation&&r.stopPropagation()}function Ir(){var r=[];return{add:function(m,u,e,w){m.addListener?m.addListener(e):m.addEventListener(u,e,w),r.push([m,u,e,w])},input:function(m,u,e,w){this.add(m,u,function(f){return function(T){T.nativeEvent&&(T=T.nativeEvent);var W=T.changedTouches||[],k=T.targetTouches||[],_=T.detail&&T.detail.x?T.detail:null;return f({id:_?_.identifier?_.identifier:"i":k[0]?k[0]?k[0].identifier:"e":"d",idChanged:_?_.identifier?_.identifier:"i":W[0]?W[0]?W[0].identifier:"e":"d",raw:T,x:_&&_.x?_.x:k[0]?k[0].screenX:_?_.x:T.pageX,y:_&&_.y?_.y:k[0]?k[0].screenY:_?_.y:T.pageY})}}(e),w)},purge:function(){r.forEach(function(m){m[0].removeListener?m[0].removeListener(m[2]):m[0].removeEventListener(m[1],m[2],m[3])}),r=[]}}}function xn(r,m,u){return Math.min(Math.max(r,m),u)}function ss(r){return(r>0?1:0)-(r<0?1:0)||+r}function Fr(r){var m=r.getBoundingClientRect();return{height:Rr(m.height,r.offsetHeight),width:Rr(m.width,r.offsetWidth)}}function We(r,m,u,e){var w=r&&r[m];return w==null?u:e&&typeof w=="function"?w():w}function es(r){return Math.round(1e6*r)/1e6}function Ho(r){var m,u,e,w,f,T;function W(S){T||(T=S),k(!0);var A=S-T;A>e&&(A=e);var F=w[u];if(F[3]<A)return u++,W(S);var N=F[2],X=F[4],rt=F[0],J=F[1]*(0,F[5])(X===0?1:(A-N)/X);if(J&&r.track.to(rt+J),A<e)return g();T=null,k(!1),_(null),r.emit("animationEnded")}function k(S){m.active=S}function _(S){m.targetIdx=S}function g(){var S;S=W,f=window.requestAnimationFrame(S)}function H(){var S;S=f,window.cancelAnimationFrame(S),k(!1),_(null),T&&r.emit("animationStopped"),T=null}return m={active:!1,start:function(S){if(H(),r.track.details){var A=0,F=r.track.details.position;u=0,e=0,w=S.map(function(N){var X,rt=Number(F),J=(X=N.earlyExit)!==null&&X!==void 0?X:N.duration,M=N.easing,j=N.distance*M(J/N.duration)||0;F+=j;var $=e;return e+=J,A+=j,[rt,N.distance,$,e,N.duration,M]}),_(r.track.distToIdx(A)),g(),r.emit("animationStarted")}},stop:H,targetIdx:null}}function Bo(r){var m,u,e,w,f,T,W,k,_,g,H,S,A,F,N=1/0,X=[],rt=null,J=0;function M(Lt){Ot(J+Lt)}function j(Lt){var kt=$(J+Lt).abs;return tt(kt)?kt:null}function $(Lt){var kt=Math.floor(Math.abs(es(Lt/u))),Et=es((Lt%u+u)%u);Et===u&&(Et=0);var Z=ss(Lt),gt=W.indexOf(Tr([],W,!0).reduce(function(Pt,qt){return Math.abs(qt-Et)<Math.abs(Pt-Et)?qt:Pt})),Rt=gt;return Z<0&&kt++,gt===T&&(Rt=0,kt+=Z>0?1:-1),{abs:Rt+kt*T*Z,origin:gt,rel:Rt}}function O(Lt,kt,Et){var Z;if(kt||!Ft())return q(Lt,Et);if(!tt(Lt))return null;var gt=$(Et??J),Rt=gt.abs,Pt=Lt-gt.rel,qt=Rt+Pt;Z=q(qt);var Kt=q(qt-T*ss(Pt));return(Kt!==null&&Math.abs(Kt)<Math.abs(Z)||Z===null)&&(Z=Kt),es(Z)}function q(Lt,kt){if(kt==null&&(kt=es(J)),!tt(Lt)||Lt===null)return null;Lt=Math.round(Lt);var Et=$(kt),Z=Et.abs,gt=Et.rel,Rt=Et.origin,Pt=Ct(Lt),qt=(kt%u+u)%u,Kt=W[Rt],ie=Math.floor((Lt-(Z-gt))/T)*u;return es(Kt-qt-Kt+W[Pt]+ie+(Rt===T?u:0))}function tt(Lt){return vt(Lt)===Lt}function vt(Lt){return xn(Lt,_,g)}function Ft(){return w.loop}function Ct(Lt){return(Lt%T+T)%T}function Ot(Lt){var kt;kt=Lt-J,X.push({distance:kt,timestamp:Pr()}),X.length>6&&(X=X.slice(-6)),J=es(Lt);var Et=_t().abs;if(Et!==rt){var Z=rt!==null;rt=Et,Z&&r.emit("slideChanged")}}function _t(Lt){var kt=Lt?null:function(){if(T){var Et=Ft(),Z=Et?(J%u+u)%u:J,gt=(Et?J%u:J)-f[0][2],Rt=0-(gt<0&&Et?u-Math.abs(gt):gt),Pt=0,qt=$(J),Kt=qt.abs,ie=qt.rel,Se=f[ie][2],de=f.map(function(le,ve){var jt=Rt+Pt;(jt<0-le[0]||jt>1)&&(jt+=(Math.abs(jt)>u-1&&Et?u:0)*ss(-jt));var ae=ve-ie,Ce=ss(ae),ee=ae+Kt;Et&&(Ce===-1&&jt>Se&&(ee+=T),Ce===1&&jt<Se&&(ee-=T),H!==null&&ee<H&&(jt+=u),S!==null&&ee>S&&(jt-=u));var Ee=jt+le[0]+le[1],ne=Math.max(jt>=0&&Ee<=1?1:Ee<0||jt>1?0:jt<0?Math.min(1,(le[0]+jt)/le[0]):(1-jt)/le[0],0);return Pt+=le[0]+le[1],{abs:ee,distance:w.rtl?-1*jt+1-le[0]:jt,portion:ne,size:le[0]}});return Kt=vt(Kt),ie=Ct(Kt),{abs:vt(Kt),length:e,max:F,maxIdx:g,min:A,minIdx:_,position:J,progress:Et?Z/u:J/e,rel:ie,slides:de,slidesLength:u}}}();return m.details=kt,r.emit("detailsChanged"),kt}return m={absToRel:Ct,add:M,details:null,distToIdx:j,idxToDist:O,init:function(Lt){if(function(){if(w=r.options,f=(w.trackConfig||[]).map(function(gt){return[We(gt,"size",1),We(gt,"spacing",0),We(gt,"origin",0)]}),T=f.length){u=es(f.reduce(function(gt,Rt){return gt+Rt[0]+Rt[1]},0));var Et,Z=T-1;e=es(u+f[0][2]-f[Z][0]-f[Z][2]-f[Z][1]),W=f.reduce(function(gt,Rt){if(!gt)return[0];var Pt=f[gt.length-1],qt=gt[gt.length-1]+(Pt[0]+Pt[2])+Pt[1];return qt-=Rt[2],gt[gt.length-1]>qt&&(qt=gt[gt.length-1]),qt=es(qt),gt.push(qt),(!Et||Et<qt)&&(k=gt.length-1),Et=qt,gt},null),e===0&&(k=0),W.push(es(u))}}(),!T)return _t(!0);var kt;(function(){var Et=r.options.range,Z=r.options.loop;H=_=Z?We(Z,"min",-1/0):0,S=g=Z?We(Z,"max",N):k;var gt=We(Et,"min",null),Rt=We(Et,"max",null);gt!==null&&(_=gt),Rt!==null&&(g=Rt),A=_===-1/0?_:r.track.idxToDist(_||0,!0,0),F=g===N?g:O(g,!0,0),Rt===null&&(S=g),We(Et,"align",!1)&&g!==N&&f[Ct(g)][2]===0&&(F-=1-f[Ct(g)][0],g=j(F-J)),A=es(A),F=es(F)})(),kt=Lt,Number(kt)===kt?M(q(vt(Lt))):_t()},to:Ot,velocity:function(){var Lt=Pr(),kt=X.reduce(function(Et,Z){var gt=Z.distance,Rt=Z.timestamp;return Lt-Rt>200||(ss(gt)!==ss(Et.distance)&&Et.distance&&(Et={distance:0,lastTimestamp:0,time:0}),Et.time&&(Et.distance+=gt),Et.lastTimestamp&&(Et.time+=Rt-Et.lastTimestamp),Et.lastTimestamp=Rt),Et},{distance:0,lastTimestamp:0,time:0});return kt.distance/kt.time||0}}}function Uo(r){var m,u,e,w,f,T,W,k;function _(rt){return 2*rt}function g(rt){return xn(rt,W,k)}function H(rt){return 1-Math.pow(1-rt,3)}function S(){return e?r.track.velocity():0}function A(){X();var rt=r.options.mode==="free-snap",J=r.track,M=S();w=ss(M);var j=r.track.details,$=[];if(M||!rt){var O=F(M),q=O.dist,tt=O.dur;if(tt=_(tt),q*=w,rt){var vt=J.idxToDist(J.distToIdx(q),!0);vt&&(q=vt)}$.push({distance:q,duration:tt,easing:H});var Ft=j.position,Ct=Ft+q;if(Ct<f||Ct>T){var Ot=Ct<f?f-Ft:T-Ft,_t=0,Lt=M;if(ss(Ot)===w){var kt=Math.min(Math.abs(Ot)/Math.abs(q),1),Et=function(Rt){return 1-Math.pow(1-Rt,1/3)}(kt)*tt;$[0].earlyExit=Et,Lt=M*(1-kt)}else $[0].earlyExit=0,_t+=Ot;var Z=F(Lt,100),gt=Z.dist*w;r.options.rubberband&&($.push({distance:gt,duration:_(Z.dur),easing:H}),$.push({distance:-gt+_t,duration:500,easing:H}))}r.animator.start($)}else r.moveToIdx(g(j.abs),!0,{duration:500,easing:function(Rt){return 1+--Rt*Rt*Rt*Rt*Rt}})}function F(rt,J){J===void 0&&(J=1e3);var M=147e-9+(rt=Math.abs(rt))/J;return{dist:Math.pow(rt,2)/M,dur:rt/M}}function N(){var rt=r.track.details;rt&&(f=rt.min,T=rt.max,W=rt.minIdx,k=rt.maxIdx)}function X(){r.animator.stop()}r.on("updated",N),r.on("optionsChanged",N),r.on("created",N),r.on("dragStarted",function(){e=!1,X(),m=u=r.track.details.abs}),r.on("dragChecked",function(){e=!0}),r.on("dragEnded",function(){var rt=r.options.mode;rt==="snap"&&function(){var J=r.track,M=r.track.details,j=M.position,$=ss(S());(j>T||j<f)&&($=0);var O=m+$;M.slides[J.absToRel(O)].portion===0&&(O-=$),m!==u&&(O=u),ss(J.idxToDist(O,!0))!==$&&(O+=$),O=g(O);var q=J.idxToDist(O,!0);r.animator.start([{distance:q,duration:500,easing:function(tt){return 1+--tt*tt*tt*tt*tt}}])}(),rt!=="free"&&rt!=="free-snap"||A()}),r.on("dragged",function(){u=r.track.details.abs})}function $o(r){var m,u,e,w,f,T,W,k,_,g,H,S,A,F,N,X,rt,J,M=Ir();function j(_t){if(T&&k===_t.id){var Lt=tt(_t);if(_){if(!q(_t))return O(_t);g=Lt,_=!1,r.emit("dragChecked")}if(X)return g=Lt;ii(_t);var kt=function(Z){if(rt===-1/0&&J===1/0)return Z;var gt=r.track.details,Rt=gt.length,Pt=gt.position,qt=xn(Z,rt-Pt,J-Pt);if(Rt===0)return 0;if(!r.options.rubberband)return qt;if(Pt<=J&&Pt>=rt||Pt<rt&&u>0||Pt>J&&u<0)return Z;var Kt=(Pt<rt?Pt-rt:Pt-J)/Rt,ie=w*Rt,Se=Math.abs(Kt*ie),de=Math.max(0,1-Se/f*2);return de*de*Z}(W(g-Lt)/w*e);u=ss(kt);var Et=r.track.details.position;(Et>rt&&Et<J||Et===rt&&u>0||Et===J&&u<0)&&ni(_t),H+=kt,!S&&Math.abs(H*w)>5&&(S=!0),r.track.add(kt),g=Lt,r.emit("dragged")}}function $(_t){!T&&r.track.details&&r.track.details.length&&(H=0,T=!0,S=!1,_=!0,k=_t.id,q(_t),g=tt(_t),r.emit("dragStarted"))}function O(_t){T&&k===_t.idChanged&&(T=!1,r.emit("dragEnded"))}function q(_t){var Lt=vt(),kt=Lt?_t.y:_t.x,Et=Lt?_t.x:_t.y,Z=A!==void 0&&F!==void 0&&Math.abs(F-Et)<=Math.abs(A-kt);return A=kt,F=Et,Z}function tt(_t){return vt()?_t.y:_t.x}function vt(){return r.options.vertical}function Ft(){w=r.size,f=vt()?window.innerHeight:window.innerWidth;var _t=r.track.details;_t&&(rt=_t.min,J=_t.max)}function Ct(_t){S&&(ni(_t),ii(_t))}function Ot(){if(M.purge(),r.options.drag&&!r.options.disabled){var _t;_t=r.options.dragSpeed||1,W=typeof _t=="function"?_t:function(kt){return kt*_t},e=r.options.rtl?-1:1,Ft(),m=r.container,function(){var kt="data-keen-slider-clickable";Ii("[".concat(kt,"]:not([").concat(kt,"=false])"),m).map(function(Et){M.add(Et,"dragstart",ni),M.add(Et,"mousedown",ni),M.add(Et,"touchstart",ni)})}(),M.add(m,"dragstart",function(kt){ii(kt)}),M.add(m,"click",Ct,{capture:!0}),M.input(m,"ksDragStart",$),M.input(m,"ksDrag",j),M.input(m,"ksDragEnd",O),M.input(m,"mousedown",$),M.input(m,"mousemove",j),M.input(m,"mouseleave",O),M.input(m,"mouseup",O),M.input(m,"touchstart",$,{passive:!0}),M.input(m,"touchmove",j,{passive:!1}),M.input(m,"touchend",O),M.input(m,"touchcancel",O),M.add(window,"wheel",function(kt){T&&ii(kt)});var Lt="data-keen-slider-scrollable";Ii("[".concat(Lt,"]:not([").concat(Lt,"=false])"),r.container).map(function(kt){return function(Et){var Z;M.input(Et,"touchstart",function(gt){Z=tt(gt),X=!0,N=!0},{passive:!0}),M.input(Et,"touchmove",function(gt){var Rt=vt(),Pt=Rt?Et.scrollHeight-Et.clientHeight:Et.scrollWidth-Et.clientWidth,qt=Z-tt(gt),Kt=Rt?Et.scrollTop:Et.scrollLeft,ie=Rt&&Et.style.overflowY==="scroll"||!Rt&&Et.style.overflowX==="scroll";if(Z=tt(gt),(qt<0&&Kt>0||qt>0&&Kt<Pt)&&N&&ie)return X=!0;N=!1,ii(gt),X=!1}),M.input(Et,"touchend",function(){X=!1})}(kt)})}}r.on("updated",Ft),r.on("optionsChanged",Ot),r.on("created",Ot),r.on("destroyed",M.purge)}function jo(r){var m,u,e=null;function w(A,F,N){r.animator.active?T(A,F,N):requestAnimationFrame(function(){return T(A,F,N)})}function f(){w(!1,!1,u)}function T(A,F,N){var X=0,rt=r.size,J=r.track.details;if(J&&m){var M=J.slides;m.forEach(function(j,$){if(A)!e&&F&&k(j,null,N),_(j,null,N);else{if(!M[$])return;var O=M[$].size*rt;!e&&F&&k(j,O,N),_(j,M[$].distance*rt-X,N),X+=O}})}}function W(A){return r.options.renderMode==="performance"?Math.round(A):A}function k(A,F,N){var X=N?"height":"width";F!==null&&(F=W(F)+"px"),A.style["min-"+X]=F,A.style["max-"+X]=F}function _(A,F,N){if(F!==null){F=W(F);var X=N?F:0;F="translate3d(".concat(N?0:F,"px, ").concat(X,"px, 0)")}A.style.transform=F,A.style["-webkit-transform"]=F}function g(){m&&(T(!0,!0,u),m=null),r.on("detailsChanged",f,!0)}function H(){w(!1,!0,u)}function S(){g(),u=r.options.vertical,r.options.disabled||r.options.renderMode==="custom"||(e=We(r.options.slides,"perView",null)==="auto",r.on("detailsChanged",f),(m=r.slides).length&&H())}r.on("created",S),r.on("optionsChanged",S),r.on("beforeOptionsChanged",function(){g()}),r.on("updated",H),r.on("destroyed",g)}function Vo(r,m){return function(u){var e,w,f,T,W,k=Ir();function _(q){var tt;En(u.container,"reverse",(tt=u.container,window.getComputedStyle(tt,null).getPropertyValue("direction")!=="rtl"||q?null:"")),En(u.container,"v",u.options.vertical&&!q?"":null),En(u.container,"disabled",u.options.disabled&&!q?"":null)}function g(){H()&&X()}function H(){var q=null;if(T.forEach(function(vt){vt.matches&&(q=vt.__media)}),q===e)return!1;e||u.emit("beforeOptionsChanged"),e=q;var tt=q?f.breakpoints[q]:f;return u.options=Os(Os({},f),tt),_(),$(),O(),J(),!0}function S(q){var tt=Fr(q);return(u.options.vertical?tt.height:tt.width)/u.size||1}function A(){return u.options.trackConfig.length}function F(q){for(var tt in e=!1,f=Os(Os({},m),q),k.purge(),w=u.size,T=[],f.breakpoints||[]){var vt=window.matchMedia(tt);vt.__media=tt,T.push(vt),k.add(vt,"change",g)}k.add(window,"orientationchange",j),k.add(window,"resize",M),H()}function N(q){u.animator.stop();var tt=u.track.details;u.track.init(q??(tt?tt.abs:0))}function X(q){N(q),u.emit("optionsChanged")}function rt(q,tt){if(q)return F(q),void X(tt);$(),O();var vt=A();J(),A()!==vt?X(tt):N(tt),u.emit("updated")}function J(){var q=u.options.slides;if(typeof q=="function")return u.options.trackConfig=q(u.size,u.slides);for(var tt=u.slides,vt=tt.length,Ft=typeof q=="number"?q:We(q,"number",vt,!0),Ct=[],Ot=We(q,"perView",1,!0),_t=We(q,"spacing",0,!0)/u.size||0,Lt=Ot==="auto"?_t:_t/Ot,kt=We(q,"origin","auto"),Et=0,Z=0;Z<Ft;Z++){var gt=Ot==="auto"?S(tt[Z]):1/Ot-_t+Lt,Rt=kt==="center"?.5-gt/2:kt==="auto"?0:kt;Ct.push({origin:Rt,size:gt,spacing:_t}),Et+=gt}if(Et+=_t*(Ft-1),kt==="auto"&&!u.options.loop&&Ot!==1){var Pt=0;Ct.map(function(qt){var Kt=Et-Pt;return Pt+=qt.size+_t,Kt>=1||(qt.origin=1-Kt-(Et>1?0:1-Et)),qt})}u.options.trackConfig=Ct}function M(){$();var q=u.size;u.options.disabled||q===w||(w=q,rt())}function j(){M(),setTimeout(M,500),setTimeout(M,2e3)}function $(){var q=Fr(u.container);u.size=(u.options.vertical?q.height:q.width)||1}function O(){u.slides=Ii(u.options.selector,u.container)}u.container=(W=Ii(r,document)).length?W[0]:null,u.destroy=function(){k.purge(),u.emit("destroyed"),_(!0)},u.prev=function(){u.moveToIdx(u.track.details.abs-1,!0)},u.next=function(){u.moveToIdx(u.track.details.abs+1,!0)},u.update=rt,F(u.options)}}var Dr=function(r,m,u){try{return function(e,w){var f,T={};return f={emit:function(W){T[W]&&T[W].forEach(function(_){_(f)});var k=f.options&&f.options[W];k&&k(f)},moveToIdx:function(W,k,_){var g=f.track.idxToDist(W,k);if(g){var H=f.options.defaultAnimation;f.animator.start([{distance:g,duration:We(_||H,"duration",500),easing:We(_||H,"easing",function(S){return 1+--S*S*S*S*S})}])}},on:function(W,k,_){_===void 0&&(_=!1),T[W]||(T[W]=[]);var g=T[W].indexOf(k);g>-1?_&&delete T[W][g]:_||T[W].push(k)},options:e},function(){if(f.track=Bo(f),f.animator=Ho(f),w)for(var W=0,k=w;W<k.length;W++)(0,k[W])(f);f.track.init(f.options.initial||0),f.emit("created")}(),f}(m,Tr([Vo(r,{drag:!0,mode:"snap",renderMode:"precision",rubberband:!0,selector:".keen-slider__slide"}),jo,$o,Uo],u||[],!0))}catch(e){console.error(e)}};function Go(r){let m,u,e,w;function f(H){_(H),k(H)}function T(H){H.parentNode.removeChild(H)}function W(H){var S=document.createElement("div"),A=H.split(" ");return A.forEach(F=>S.classList.add(F)),S}function k(H){if(H){T(e),T(w),T(u);return}u=W("arrow-wrapper"),e=W("arrow arrow__left"),e.addEventListener("click",()=>r.prev()),w=W("arrow arrow__right"),w.addEventListener("click",()=>r.next()),m.appendChild(u),u.appendChild(e),u.appendChild(w)}function _(H){if(H){for(var S=m.parentNode;m.firstChild;)S.insertBefore(m.firstChild,m);T(m);return}m=W("navigation-wrapper"),r.container.parentNode.appendChild(m),m.appendChild(r.container)}function g(){var H=r.track.details.rel;H===0?e.classList.add("arrow_disabled"):e.classList.remove("arrow_disabled"),H===r.track.details.slides.length-1?w.classList.add("arrow_disabled"):w.classList.remove("arrow_disabled")}r.on("created",()=>{f(),g()}),r.on("optionsChanged",()=>{f(!0),f(),g()}),r.on("slideChanged",()=>{g()}),r.on("destroyed",()=>{f(!0)})}function qo(r){return m=>{function u(){r.forEach(e=>{e.addEventListener("click",()=>{m.moveToIdx(Number(e.dataset.target)),r.forEach(w=>{w.dataset.target!=e.dataset.target?w.classList.remove("slider-thumbnail__img_active"):w.classList.add("slider-thumbnail__img_active")})})})}m.on("created",()=>{u()}),m.on("animationEnded",()=>{const e=m.track.details.rel;r.forEach(w=>{w.dataset.target==e?w.classList.add("slider-thumbnail__img_active"):w.classList.remove("slider-thumbnail__img_active")})})}}document.querySelectorAll('[data-role="slider"]').forEach(r=>{const m=r.querySelector(".slider"),u=r.querySelectorAll('[data-role="slider-thumbnail"]');new Dr(m,{slides:{perView:1},defaultAnimation:{duration:0}},[qo(u)])});const Fi=document.querySelector("#top-slider"),Hs={bs:16,sm:16},Nr=341;Fi&&new Dr(Fi,{slides:{origin:"auto",perView:()=>(Fi.offsetWidth+Hs.bs)/(Nr+Hs.bs),spacing:Hs.bs},breakpoints:{"(max-width: 576px)":{slides:{origin:"center",perView:()=>(Fi.offsetWidth+Hs.sm)/(Nr+Hs.sm),spacing:Hs.sm}}}},[Go]),document.querySelectorAll(".schedule__status").forEach(r=>{if(r.dataset){const m=new Date,u=new Date(r.dataset.start),e=new Date(r.dataset.end);u!=="Invalid Date"&&e!=="Invalid Date"?m>e?(r.classList.remove("schedule__status_yet"),r.classList.add("schedule__status_complete")):u<=m&&m<=e&&(r.classList.remove("schedule__status_yet"),r.classList.add("schedule__status_current")):console.log("invalid date!",`
 start: ${u}`,`
end: ${e}`)}else console.log(r.dataset)}),document.querySelectorAll('[data-role="#####"]').forEach(r=>{const m=["\u62BD\u9078\u4E88\u5B9A\u65E5","\u30AD\u30E3\u30F3\u30BB\u30EB\u5F85\u3061\u62BD\u9078\u4E88\u5B9A\u65E5","\u632F\u8FBC\u671F\u9650\u65E5\u6642","\u904B\u7528\u958B\u59CB\u4E88\u5B9A\u65E5","\u904B\u7528\u7D42\u4E86\u4E88\u5B9A\u65E5","\u511F\u9084\u4E88\u5B9A\u65E5"],u=["\u632F\u8FBC\u671F\u9650\u65E5\u6642"],e=r.dataset.value.split(",");e.length===4&&m.splice(0,2);let w={},f="--",T;e.forEach((k,_)=>{const g=new Date(k),H=isNaN(g);H||(f=String(g.getFullYear()),T=Math.round((new Date().getTime()-g.getTime())/(24*36e5))),Object.keys(w).indexOf(f)===-1&&(w[f]=[]);const S={year:H?"--":g.getFullYear(),month:H?"--":g.getMonth()+1,date:H?"--":g.getDate(),hour:H?"--":("00"+g.getHours()).slice(-2),minute:H?"--":("00"+g.getMinutes()).slice(-2),status:T>1?"complete":T!==1?"yet":"current",lastRaw:_===m.length-1,hasTime:u.includes(m[_]),label:m[_]};w[f].push(S)});let W="";for(let[k,_]of Object.entries(w))W+=`            <div class="fund-shcedule-short__row">                 <div class="fund-schedule-short__year">                     ${k}                 </div>             <div class="fund-schedule-short__items">         `,_.forEach(g=>{W+=g.lastRaw?'<div class="fund-schedule-short__content fund-schedule-short__content_last">':'<div class="fund-schedule-short__content">',W+=`<span class="fund-schedule-short__values">                         <span class="fund-schedule-short__value format format_unit" data-format="\u6708">${g.month}</span>                        <span class="fund-schedule-short__value format format_unit" data-format="\u65E5">${g.date}</span>                    `,g.hasTime&&(W+=`<div class="fund-schedule-short__time">${g.hour}:${g.minute}</div>`),W+=`   </span>                     <div class="schedule__status schedule__status_${g.status}"></div>                     <span class="fund-schedule-short__label">${g.label}</span>                     </div>                     `}),W+="</div></div>";r.innerHTML=W}),document.querySelectorAll('[data-role="short-schedule"]').forEach(r=>{const m=["\u62BD\u9078\u4E88\u5B9A\u65E5","\u30AD\u30E3\u30F3\u30BB\u30EB\u5F85\u3061\u62BD\u9078\u4E88\u5B9A\u65E5","\u632F\u8FBC\u671F\u9650\u65E5\u6642","\u904B\u7528\u958B\u59CB\u4E88\u5B9A\u65E5","\u904B\u7528\u7D42\u4E86\u4E88\u5B9A\u65E5","\u511F\u9084\u4E88\u5B9A\u65E5"],u=["\u632F\u8FBC\u671F\u9650\u65E5\u6642"],e=r.dataset.value.split(",");e.length===4&&m.splice(0,2);let w=[],f="";const T=new Date,W=new Date;W.setHours(0,0,0,0),e.forEach((g,H)=>{const S=new Date(g),A=isNaN(S),F=u.includes(m[H]);if(A?f="null":String(S.getFullYear()),!A&&f!=="yet"){const X=T.getTime()-S.getTime(),rt=W.getTime()-S.getTime(),J=F?X:rt;f=J<0?"yet":J>24*36e5?"complete":"current"}const N={year:A?"--":S.getFullYear(),month:A?"--":S.getMonth()+1,date:A?"--":S.getDate(),hour:A?"--":("00"+S.getHours()).slice(-2),minute:A?"--":("00"+S.getMinutes()).slice(-2),status:f,lastRaw:H===m.length-1,hasTime:u.includes(m[H]),label:m[H]};w.push(N)});let k="",_="";w.forEach((g,H,S)=>{const A=_!==g.year;H!==0&&A&&(k+="</div></div>"),A&&(_=g.year,k+=`                <div class="fund-shcedule-short__row">                     <div class="fund-schedule-short__year">                         ${_}                     </div>                 <div class="fund-schedule-short__items">             `),k+=g.lastRaw?'<div class="fund-schedule-short__content fund-schedule-short__content_last">':'<div class="fund-schedule-short__content">',k+=`<span class="fund-schedule-short__values">                     <span class="fund-schedule-short__value format format_unit" data-format="\u6708">${g.month}</span>                    <span class="fund-schedule-short__value format format_unit" data-format="\u65E5">${g.date}</span>                `,g.hasTime&&(k+=`<div class="fund-schedule-short__time">${g.hour}:${g.minute}</div>`),k+=`   </span>                 <div class="schedule__status schedule__status_${g.status}"></div>                 <span class="fund-schedule-short__label">${g.label}</span>                 </div>                 `,H===S.length-1&&(k+="</div></div>")}),r.innerHTML=k});const zo="modulepreload",Wo=function(r){return"/"+r},Or={},vs=function(r,m,u){let e=Promise.resolve();if(m&&m.length>0){const w=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),T=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));e=Promise.all(m.map(W=>{if(W=Wo(W),W in Or)return;Or[W]=!0;const k=W.endsWith(".css"),_=k?'[rel="stylesheet"]':"";if(u)for(let H=w.length-1;H>=0;H--){const S=w[H];if(S.href===W&&(!k||S.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${W}"]${_}`))return;const g=document.createElement("link");if(g.rel=k?"stylesheet":zo,k||(g.as="script",g.crossOrigin=""),g.href=W,T&&g.setAttribute("nonce",T),document.head.appendChild(g),k)return new Promise((H,S)=>{g.addEventListener("load",H),g.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${W}`)))})}))}return e.then(()=>r()).catch(w=>{const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=w,window.dispatchEvent(f),!f.defaultPrevented)throw w})};var Xo={976:(r,m,u)=>{var le,jt,Fs,Ce,Gr,Ee,qr,et,i,n,c,p,o,y,b,E,d,a,h,R,V,G,at,ot,yt,zr,ut,Xi,P,Ln,nt,Tn,v,z,K,lt,mt,Mt,Dt,kn,re,he,Me,_e,Wr,me,Rn;u.d(m,{AnnotationLayer:()=>de,FreeTextAnnotationElement:()=>Ct,InkAnnotationElement:()=>gt,StampAnnotationElement:()=>ie});var e=u(292),w=u(419),f=u(792);function T(se){return Math.floor(Math.max(0,Math.min(1,se))*255).toString(16).padStart(2,"0")}function W(se){return Math.max(0,Math.min(255,255*se))}class k{static CMYK_G([D,x,Q,it]){return["G",1-Math.min(1,.3*D+.59*Q+.11*x+it)]}static G_CMYK([D]){return["CMYK",0,0,0,1-D]}static G_RGB([D]){return["RGB",D,D,D]}static G_rgb([D]){return D=W(D),[D,D,D]}static G_HTML([D]){const x=T(D);return`#${x}${x}${x}`}static RGB_G([D,x,Q]){return["G",.3*D+.59*x+.11*Q]}static RGB_rgb(D){return D.map(W)}static RGB_HTML(D){return`#${D.map(T).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([D,x,Q,it]){return["RGB",1-Math.min(1,D+it),1-Math.min(1,Q+it),1-Math.min(1,x+it)]}static CMYK_rgb([D,x,Q,it]){return[W(1-Math.min(1,D+it)),W(1-Math.min(1,Q+it)),W(1-Math.min(1,x+it))]}static CMYK_HTML(D){const x=this.CMYK_RGB(D).slice(1);return this.RGB_HTML(x)}static RGB_CMYK([D,x,Q]){const it=1-D,ct=1-x,wt=1-Q,bt=Math.min(it,ct,wt);return["CMYK",it,ct,wt,bt]}}var _=u(284);const g=1e3,H=9,S=new WeakSet;function A(se){return{width:se[2]-se[0],height:se[3]-se[1]}}class F{static create(D){switch(D.data.annotationType){case e.AnnotationType.LINK:return new X(D);case e.AnnotationType.TEXT:return new rt(D);case e.AnnotationType.WIDGET:switch(D.data.fieldType){case"Tx":return new M(D);case"Btn":return D.data.radioButton?new O(D):D.data.checkBox?new $(D):new q(D);case"Ch":return new tt(D);case"Sig":return new j(D)}return new J(D);case e.AnnotationType.POPUP:return new vt(D);case e.AnnotationType.FREETEXT:return new Ct(D);case e.AnnotationType.LINE:return new Ot(D);case e.AnnotationType.SQUARE:return new _t(D);case e.AnnotationType.CIRCLE:return new Lt(D);case e.AnnotationType.POLYLINE:return new kt(D);case e.AnnotationType.CARET:return new Z(D);case e.AnnotationType.INK:return new gt(D);case e.AnnotationType.POLYGON:return new Et(D);case e.AnnotationType.HIGHLIGHT:return new Rt(D);case e.AnnotationType.UNDERLINE:return new Pt(D);case e.AnnotationType.SQUIGGLY:return new qt(D);case e.AnnotationType.STRIKEOUT:return new Kt(D);case e.AnnotationType.STAMP:return new ie(D);case e.AnnotationType.FILEATTACHMENT:return new Se(D);default:return new N(D)}}}const ve=class ve{constructor(D,{isRenderable:x=!1,ignoreBorder:Q=!1,createQuadrilaterals:it=!1}={}){l(this,le,!1);this.isRenderable=x,this.data=D.data,this.layer=D.layer,this.linkService=D.linkService,this.downloadManager=D.downloadManager,this.imageResourcesPath=D.imageResourcesPath,this.renderForms=D.renderForms,this.svgFactory=D.svgFactory,this.annotationStorage=D.annotationStorage,this.enableScripting=D.enableScripting,this.hasJSActions=D.hasJSActions,this._fieldObjects=D.fieldObjects,this.parent=D.parent,x&&(this.container=this._createContainer(Q)),it&&this._createQuadrilaterals()}static _hasPopupData({titleObj:D,contentsObj:x,richText:Q}){return!!(D!=null&&D.str||x!=null&&x.str||Q!=null&&Q.str)}get hasPopupData(){return ve._hasPopupData(this.data)}_createContainer(D){const{data:x,parent:{page:Q,viewport:it}}=this,ct=document.createElement("section");ct.setAttribute("data-annotation-id",x.id),this instanceof J||(ct.tabIndex=g),ct.style.zIndex=this.parent.zIndex++,x.popupRef&&ct.setAttribute("aria-haspopup","dialog"),x.alternativeText&&(ct.title=x.alternativeText),x.noRotate&&ct.classList.add("norotate");const{pageWidth:wt,pageHeight:bt,pageX:zt,pageY:Vt}=it.rawDims;if(!x.rect||this instanceof vt){const{rotation:Bt}=x;return!x.hasOwnCanvas&&Bt!==0&&this.setRotation(Bt,ct),ct}const{width:Nt,height:Yt}=A(x.rect),$t=e.Util.normalizeRect([x.rect[0],Q.view[3]-x.rect[1]+Q.view[1],x.rect[2],Q.view[3]-x.rect[3]+Q.view[1]]);if(!D&&x.borderStyle.width>0){ct.style.borderWidth=`${x.borderStyle.width}px`;const Bt=x.borderStyle.horizontalCornerRadius,Qt=x.borderStyle.verticalCornerRadius;if(Bt>0||Qt>0){const ce=`calc(${Bt}px * var(--scale-factor)) / calc(${Qt}px * var(--scale-factor))`;ct.style.borderRadius=ce}else if(this instanceof O){const ce=`calc(${Nt}px * var(--scale-factor)) / calc(${Yt}px * var(--scale-factor))`;ct.style.borderRadius=ce}switch(x.borderStyle.style){case e.AnnotationBorderStyleType.SOLID:ct.style.borderStyle="solid";break;case e.AnnotationBorderStyleType.DASHED:ct.style.borderStyle="dashed";break;case e.AnnotationBorderStyleType.BEVELED:(0,e.warn)("Unimplemented border style: beveled");break;case e.AnnotationBorderStyleType.INSET:(0,e.warn)("Unimplemented border style: inset");break;case e.AnnotationBorderStyleType.UNDERLINE:ct.style.borderBottomStyle="solid";break}const ue=x.borderColor||null;ue?(I(this,le,!0),ct.style.borderColor=e.Util.makeHexColor(ue[0]|0,ue[1]|0,ue[2]|0)):ct.style.borderWidth=0}ct.style.left=`${100*($t[0]-zt)/wt}%`,ct.style.top=`${100*($t[1]-Vt)/bt}%`;const{rotation:St}=x;return x.hasOwnCanvas||St===0?(ct.style.width=`${100*Nt/wt}%`,ct.style.height=`${100*Yt/bt}%`):this.setRotation(St,ct),ct}setRotation(D,x=this.container){if(!this.data.rect)return;const{pageWidth:Q,pageHeight:it}=this.parent.viewport.rawDims,{width:ct,height:wt}=A(this.data.rect);let bt,zt;D%180===0?(bt=100*ct/Q,zt=100*wt/it):(bt=100*wt/Q,zt=100*ct/it),x.style.width=`${bt}%`,x.style.height=`${zt}%`,x.setAttribute("data-main-rotation",(360-D)%360)}get _commonActions(){const D=(x,Q,it)=>{const ct=it.detail[x],wt=ct[0],bt=ct.slice(1);it.target.style[Q]=k[`${wt}_HTML`](bt),this.annotationStorage.setValue(this.data.id,{[Q]:k[`${wt}_rgb`](bt)})};return(0,e.shadow)(this,"_commonActions",{display:x=>{const{display:Q}=x.detail,it=Q%2===1;this.container.style.visibility=it?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:it,noPrint:Q===1||Q===2})},print:x=>{this.annotationStorage.setValue(this.data.id,{noPrint:!x.detail.print})},hidden:x=>{const{hidden:Q}=x.detail;this.container.style.visibility=Q?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:Q,noView:Q})},focus:x=>{setTimeout(()=>x.target.focus({preventScroll:!1}),0)},userName:x=>{x.target.title=x.detail.userName},readonly:x=>{x.target.disabled=x.detail.readonly},required:x=>{this._setRequired(x.target,x.detail.required)},bgColor:x=>{D("bgColor","backgroundColor",x)},fillColor:x=>{D("fillColor","backgroundColor",x)},fgColor:x=>{D("fgColor","color",x)},textColor:x=>{D("textColor","color",x)},borderColor:x=>{D("borderColor","borderColor",x)},strokeColor:x=>{D("strokeColor","borderColor",x)},rotation:x=>{const Q=x.detail.rotation;this.setRotation(Q),this.annotationStorage.setValue(this.data.id,{rotation:Q})}})}_dispatchEventFromSandbox(D,x){var it;const Q=this._commonActions;for(const ct of Object.keys(x.detail))(it=D[ct]||Q[ct])==null||it(x)}_setDefaultPropertiesFromJS(D){if(!this.enableScripting)return;const x=this.annotationStorage.getRawValue(this.data.id);if(!x)return;const Q=this._commonActions;for(const[it,ct]of Object.entries(x)){const wt=Q[it];if(wt){const bt={detail:{[it]:ct},target:D};wt(bt),delete x[it]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:D}=this.data;if(!D)return;const[x,Q,it,ct]=this.data.rect;if(D.length===1){const[,{x:Qt,y:ue},{x:ce,y:we}]=D[0];if(it===Qt&&ct===ue&&x===ce&&Q===we)return}const{style:wt}=this.container;let bt;if(t(this,le)){const{borderColor:Qt,borderWidth:ue}=wt;wt.borderWidth=0,bt=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Qt}" stroke-width="${ue}">`],this.container.classList.add("hasBorder")}const zt=it-x,Vt=ct-Q,{svgFactory:Nt}=this,Yt=Nt.createElement("svg");Yt.classList.add("quadrilateralsContainer"),Yt.setAttribute("width",0),Yt.setAttribute("height",0);const $t=Nt.createElement("defs");Yt.append($t);const St=Nt.createElement("clipPath"),Bt=`clippath_${this.data.id}`;St.setAttribute("id",Bt),St.setAttribute("clipPathUnits","objectBoundingBox"),$t.append(St);for(const[,{x:Qt,y:ue},{x:ce,y:we}]of D){const Le=Nt.createElement("rect"),Ze=(ce-x)/zt,Xe=(ct-ue)/Vt,Ke=(Qt-ce)/zt,is=(ue-we)/Vt;Le.setAttribute("x",Ze),Le.setAttribute("y",Xe),Le.setAttribute("width",Ke),Le.setAttribute("height",is),St.append(Le),bt==null||bt.push(`<rect vector-effect="non-scaling-stroke" x="${Ze}" y="${Xe}" width="${Ke}" height="${is}"/>`)}t(this,le)&&(bt.push("</g></svg>')"),wt.backgroundImage=bt.join("")),this.container.append(Yt),this.container.style.clipPath=`url(#${Bt})`}_createPopup(){const{container:D,data:x}=this;D.setAttribute("aria-haspopup","dialog");const Q=new vt({data:{color:x.color,titleObj:x.titleObj,modificationDate:x.modificationDate,contentsObj:x.contentsObj,richText:x.richText,parentRect:x.rect,borderStyle:0,id:`popup_${x.id}`,rotation:x.rotation},parent:this.parent,elements:[this]});this.parent.div.append(Q.render())}render(){(0,e.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(D,x=null){const Q=[];if(this._fieldObjects){const it=this._fieldObjects[D];if(it)for(const{page:ct,id:wt,exportValues:bt}of it){if(ct===-1||wt===x)continue;const zt=typeof bt=="string"?bt:null,Vt=document.querySelector(`[data-element-id="${wt}"]`);if(Vt&&!S.has(Vt)){(0,e.warn)(`_getElementsByName - element not allowed: ${wt}`);continue}Q.push({id:wt,exportValue:zt,domElement:Vt})}return Q}for(const it of document.getElementsByName(D)){const{exportValue:ct}=it,wt=it.getAttribute("data-element-id");wt!==x&&S.has(it)&&Q.push({id:wt,exportValue:ct,domElement:it})}return Q}show(){var D;this.container&&(this.container.hidden=!1),(D=this.popup)==null||D.maybeShow()}hide(){var D;this.container&&(this.container.hidden=!0),(D=this.popup)==null||D.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const D=this.getElementsToTriggerPopup();if(Array.isArray(D))for(const x of D)x.classList.add("highlightArea");else D.classList.add("highlightArea")}get _isEditable(){return!1}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:D,data:{id:x}}=this;this.container.addEventListener("dblclick",()=>{var Q;(Q=this.linkService.eventBus)==null||Q.dispatch("switchannotationeditormode",{source:this,mode:D,editId:x})})}};le=new WeakMap;let N=ve;class X extends N{constructor(x,Q=null){super(x,{isRenderable:!0,ignoreBorder:!!(Q!=null&&Q.ignoreBorder),createQuadrilaterals:!0});l(this,jt);l(this,Ce);l(this,Ee);this.isTooltipOnly=x.data.isTooltipOnly}render(){const{data:x,linkService:Q}=this,it=document.createElement("a");it.setAttribute("data-element-id",x.id);let ct=!1;return x.url?(Q.addLinkAttributes(it,x.url,x.newWindow),ct=!0):x.action?(this._bindNamedAction(it,x.action),ct=!0):x.attachment?(C(this,Ce,Gr).call(this,it,x.attachment,x.attachmentDest),ct=!0):x.setOCGState?(C(this,Ee,qr).call(this,it,x.setOCGState),ct=!0):x.dest?(this._bindLink(it,x.dest),ct=!0):(x.actions&&(x.actions.Action||x.actions["Mouse Up"]||x.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(it,x),ct=!0),x.resetForm?(this._bindResetFormAction(it,x.resetForm),ct=!0):this.isTooltipOnly&&!ct&&(this._bindLink(it,""),ct=!0)),this.container.classList.add("linkAnnotation"),ct&&this.container.append(it),this.container}_bindLink(x,Q){x.href=this.linkService.getDestinationHash(Q),x.onclick=()=>(Q&&this.linkService.goToDestination(Q),!1),(Q||Q==="")&&C(this,jt,Fs).call(this)}_bindNamedAction(x,Q){x.href=this.linkService.getAnchorUrl(""),x.onclick=()=>(this.linkService.executeNamedAction(Q),!1),C(this,jt,Fs).call(this)}_bindJSAction(x,Q){x.href=this.linkService.getAnchorUrl("");const it=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const ct of Object.keys(Q.actions)){const wt=it.get(ct);wt&&(x[wt]=()=>{var bt;return(bt=this.linkService.eventBus)==null||bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Q.id,name:ct}}),!1})}x.onclick||(x.onclick=()=>!1),C(this,jt,Fs).call(this)}_bindResetFormAction(x,Q){const it=x.onclick;if(it||(x.href=this.linkService.getAnchorUrl("")),C(this,jt,Fs).call(this),!this._fieldObjects){(0,e.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),it||(x.onclick=()=>!1);return}x.onclick=()=>{var Yt;it==null||it();const{fields:ct,refs:wt,include:bt}=Q,zt=[];if(ct.length!==0||wt.length!==0){const $t=new Set(wt);for(const St of ct){const Bt=this._fieldObjects[St]||[];for(const{id:Qt}of Bt)$t.add(Qt)}for(const St of Object.values(this._fieldObjects))for(const Bt of St)$t.has(Bt.id)===bt&&zt.push(Bt)}else for(const $t of Object.values(this._fieldObjects))zt.push(...$t);const Vt=this.annotationStorage,Nt=[];for(const $t of zt){const{id:St}=$t;switch(Nt.push(St),$t.type){case"text":{const Qt=$t.defaultValue||"";Vt.setValue(St,{value:Qt});break}case"checkbox":case"radiobutton":{const Qt=$t.defaultValue===$t.exportValues;Vt.setValue(St,{value:Qt});break}case"combobox":case"listbox":{const Qt=$t.defaultValue||"";Vt.setValue(St,{value:Qt});break}default:continue}const Bt=document.querySelector(`[data-element-id="${St}"]`);if(Bt){if(!S.has(Bt)){(0,e.warn)(`_bindResetFormAction - element not allowed: ${St}`);continue}}else continue;Bt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Yt=this.linkService.eventBus)==null||Yt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Nt,name:"ResetForm"}})),!1}}}jt=new WeakSet,Fs=function(){this.container.setAttribute("data-internal-link","")},Ce=new WeakSet,Gr=function(x,Q,it=null){x.href=this.linkService.getAnchorUrl(""),x.onclick=()=>{var ct;return(ct=this.downloadManager)==null||ct.openOrDownloadData(Q.content,Q.filename,it),!1},C(this,jt,Fs).call(this)},Ee=new WeakSet,qr=function(x,Q){x.href=this.linkService.getAnchorUrl(""),x.onclick=()=>(this.linkService.executeSetOCGState(Q),!1),C(this,jt,Fs).call(this)};class rt extends N{constructor(D){super(D,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const D=document.createElement("img");return D.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",D.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),D.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(D),this.container}}class J extends N{render(){return this.container}showElementAndHideCanvas(D){var x;this.data.hasOwnCanvas&&(((x=D.previousSibling)==null?void 0:x.nodeName)==="CANVAS"&&(D.previousSibling.hidden=!0),D.hidden=!1)}_getKeyModifier(D){return e.FeatureTest.platform.isMac?D.metaKey:D.ctrlKey}_setEventListener(D,x,Q,it,ct){Q.includes("mouse")?D.addEventListener(Q,wt=>{var bt;(bt=this.linkService.eventBus)==null||bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:it,value:ct(wt),shift:wt.shiftKey,modifier:this._getKeyModifier(wt)}})}):D.addEventListener(Q,wt=>{var bt;if(Q==="blur"){if(!x.focused||!wt.relatedTarget)return;x.focused=!1}else if(Q==="focus"){if(x.focused)return;x.focused=!0}ct&&((bt=this.linkService.eventBus)==null||bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:it,value:ct(wt)}}))})}_setEventListeners(D,x,Q,it){var ct,wt,bt;for(const[zt,Vt]of Q)(Vt==="Action"||(ct=this.data.actions)!=null&&ct[Vt])&&((Vt==="Focus"||Vt==="Blur")&&(x||(x={focused:!1})),this._setEventListener(D,x,zt,Vt,it),Vt==="Focus"&&!((wt=this.data.actions)!=null&&wt.Blur)?this._setEventListener(D,x,"blur","Blur",null):Vt==="Blur"&&!((bt=this.data.actions)!=null&&bt.Focus)&&this._setEventListener(D,x,"focus","Focus",null))}_setBackgroundColor(D){const x=this.data.backgroundColor||null;D.style.backgroundColor=x===null?"transparent":e.Util.makeHexColor(x[0],x[1],x[2])}_setTextStyle(D){const x=["left","center","right"],{fontColor:Q}=this.data.defaultAppearanceData,it=this.data.defaultAppearanceData.fontSize||H,ct=D.style;let wt;const bt=2,zt=Vt=>Math.round(10*Vt)/10;if(this.data.multiLine){const Vt=Math.abs(this.data.rect[3]-this.data.rect[1]-bt),Nt=Math.round(Vt/(e.LINE_FACTOR*it))||1,Yt=Vt/Nt;wt=Math.min(it,zt(Yt/e.LINE_FACTOR))}else{const Vt=Math.abs(this.data.rect[3]-this.data.rect[1]-bt);wt=Math.min(it,zt(Vt/e.LINE_FACTOR))}ct.fontSize=`calc(${wt}px * var(--scale-factor))`,ct.color=e.Util.makeHexColor(Q[0],Q[1],Q[2]),this.data.textAlignment!==null&&(ct.textAlign=x[this.data.textAlignment])}_setRequired(D,x){x?D.setAttribute("required",!0):D.removeAttribute("required"),D.setAttribute("aria-required",x)}}class M extends J{constructor(D){const x=D.renderForms||D.data.hasOwnCanvas||!D.data.hasAppearance&&!!D.data.fieldValue;super(D,{isRenderable:x})}setPropertyOnSiblings(D,x,Q,it){const ct=this.annotationStorage;for(const wt of this._getElementsByName(D.name,D.id))wt.domElement&&(wt.domElement[x]=Q),ct.setValue(wt.id,{[it]:Q})}render(){var it,ct;const D=this.annotationStorage,x=this.data.id;this.container.classList.add("textWidgetAnnotation");let Q=null;if(this.renderForms){const wt=D.getValue(x,{value:this.data.fieldValue});let bt=wt.value||"";const zt=D.getValue(x,{charLimit:this.data.maxLen}).charLimit;zt&&bt.length>zt&&(bt=bt.slice(0,zt));let Vt=wt.formattedValue||((it=this.data.textContent)==null?void 0:it.join(`
`))||null;Vt&&this.data.comb&&(Vt=Vt.replaceAll(/\s+/g,""));const Nt={userValue:bt,formattedValue:Vt,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(Q=document.createElement("textarea"),Q.textContent=Vt??bt,this.data.doNotScroll&&(Q.style.overflowY="hidden")):(Q=document.createElement("input"),Q.type="text",Q.setAttribute("value",Vt??bt),this.data.doNotScroll&&(Q.style.overflowX="hidden")),this.data.hasOwnCanvas&&(Q.hidden=!0),S.add(Q),Q.setAttribute("data-element-id",x),Q.disabled=this.data.readOnly,Q.name=this.data.fieldName,Q.tabIndex=g,this._setRequired(Q,this.data.required),zt&&(Q.maxLength=zt),Q.addEventListener("input",$t=>{D.setValue(x,{value:$t.target.value}),this.setPropertyOnSiblings(Q,"value",$t.target.value,"value"),Nt.formattedValue=null}),Q.addEventListener("resetform",$t=>{const St=this.data.defaultFieldValue??"";Q.value=Nt.userValue=St,Nt.formattedValue=null});let Yt=$t=>{const{formattedValue:St}=Nt;St!=null&&($t.target.value=St),$t.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){Q.addEventListener("focus",St=>{var Qt;if(Nt.focused)return;const{target:Bt}=St;Nt.userValue&&(Bt.value=Nt.userValue),Nt.lastCommittedValue=Bt.value,Nt.commitKey=1,(Qt=this.data.actions)!=null&&Qt.Focus||(Nt.focused=!0)}),Q.addEventListener("updatefromsandbox",St=>{this.showElementAndHideCanvas(St.target);const Bt={value(Qt){Nt.userValue=Qt.detail.value??"",D.setValue(x,{value:Nt.userValue.toString()}),Qt.target.value=Nt.userValue},formattedValue(Qt){const{formattedValue:ue}=Qt.detail;Nt.formattedValue=ue,ue!=null&&Qt.target!==document.activeElement&&(Qt.target.value=ue),D.setValue(x,{formattedValue:ue})},selRange(Qt){Qt.target.setSelectionRange(...Qt.detail.selRange)},charLimit:Qt=>{var Le;const{charLimit:ue}=Qt.detail,{target:ce}=Qt;if(ue===0){ce.removeAttribute("maxLength");return}ce.setAttribute("maxLength",ue);let we=Nt.userValue;!we||we.length<=ue||(we=we.slice(0,ue),ce.value=Nt.userValue=we,D.setValue(x,{value:we}),(Le=this.linkService.eventBus)==null||Le.dispatch("dispatcheventinsandbox",{source:this,detail:{id:x,name:"Keystroke",value:we,willCommit:!0,commitKey:1,selStart:ce.selectionStart,selEnd:ce.selectionEnd}}))}};this._dispatchEventFromSandbox(Bt,St)}),Q.addEventListener("keydown",St=>{var ue;Nt.commitKey=1;let Bt=-1;if(St.key==="Escape"?Bt=0:St.key==="Enter"&&!this.data.multiLine?Bt=2:St.key==="Tab"&&(Nt.commitKey=3),Bt===-1)return;const{value:Qt}=St.target;Nt.lastCommittedValue!==Qt&&(Nt.lastCommittedValue=Qt,Nt.userValue=Qt,(ue=this.linkService.eventBus)==null||ue.dispatch("dispatcheventinsandbox",{source:this,detail:{id:x,name:"Keystroke",value:Qt,willCommit:!0,commitKey:Bt,selStart:St.target.selectionStart,selEnd:St.target.selectionEnd}}))});const $t=Yt;Yt=null,Q.addEventListener("blur",St=>{var Qt,ue;if(!Nt.focused||!St.relatedTarget)return;(Qt=this.data.actions)!=null&&Qt.Blur||(Nt.focused=!1);const{value:Bt}=St.target;Nt.userValue=Bt,Nt.lastCommittedValue!==Bt&&((ue=this.linkService.eventBus)==null||ue.dispatch("dispatcheventinsandbox",{source:this,detail:{id:x,name:"Keystroke",value:Bt,willCommit:!0,commitKey:Nt.commitKey,selStart:St.target.selectionStart,selEnd:St.target.selectionEnd}})),$t(St)}),(ct=this.data.actions)!=null&&ct.Keystroke&&Q.addEventListener("beforeinput",St=>{var Xe;Nt.lastCommittedValue=null;const{data:Bt,target:Qt}=St,{value:ue,selectionStart:ce,selectionEnd:we}=Qt;let Le=ce,Ze=we;switch(St.inputType){case"deleteWordBackward":{const Ke=ue.substring(0,ce).match(/\w*[^\w]*$/);Ke&&(Le-=Ke[0].length);break}case"deleteWordForward":{const Ke=ue.substring(ce).match(/^[^\w]*\w*/);Ke&&(Ze+=Ke[0].length);break}case"deleteContentBackward":ce===we&&(Le-=1);break;case"deleteContentForward":ce===we&&(Ze+=1);break}St.preventDefault(),(Xe=this.linkService.eventBus)==null||Xe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:x,name:"Keystroke",value:ue,change:Bt||"",willCommit:!1,selStart:Le,selEnd:Ze}})}),this._setEventListeners(Q,Nt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],St=>St.target.value)}if(Yt&&Q.addEventListener("blur",Yt),this.data.comb){const $t=(this.data.rect[2]-this.data.rect[0])/zt;Q.classList.add("comb"),Q.style.letterSpacing=`calc(${$t}px * var(--scale-factor) - 1ch)`}}else Q=document.createElement("div"),Q.textContent=this.data.fieldValue,Q.style.verticalAlign="middle",Q.style.display="table-cell",this.data.hasOwnCanvas&&(Q.hidden=!0);return this._setTextStyle(Q),this._setBackgroundColor(Q),this._setDefaultPropertiesFromJS(Q),this.container.append(Q),this.container}}class j extends J{constructor(D){super(D,{isRenderable:!!D.data.hasOwnCanvas})}}class $ extends J{constructor(D){super(D,{isRenderable:D.renderForms})}render(){const D=this.annotationStorage,x=this.data,Q=x.id;let it=D.getValue(Q,{value:x.exportValue===x.fieldValue}).value;typeof it=="string"&&(it=it!=="Off",D.setValue(Q,{value:it})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const ct=document.createElement("input");return S.add(ct),ct.setAttribute("data-element-id",Q),ct.disabled=x.readOnly,this._setRequired(ct,this.data.required),ct.type="checkbox",ct.name=x.fieldName,it&&ct.setAttribute("checked",!0),ct.setAttribute("exportValue",x.exportValue),ct.tabIndex=g,ct.addEventListener("change",wt=>{const{name:bt,checked:zt}=wt.target;for(const Vt of this._getElementsByName(bt,Q)){const Nt=zt&&Vt.exportValue===x.exportValue;Vt.domElement&&(Vt.domElement.checked=Nt),D.setValue(Vt.id,{value:Nt})}D.setValue(Q,{value:zt})}),ct.addEventListener("resetform",wt=>{const bt=x.defaultFieldValue||"Off";wt.target.checked=bt===x.exportValue}),this.enableScripting&&this.hasJSActions&&(ct.addEventListener("updatefromsandbox",wt=>{const bt={value(zt){zt.target.checked=zt.detail.value!=="Off",D.setValue(Q,{value:zt.target.checked})}};this._dispatchEventFromSandbox(bt,wt)}),this._setEventListeners(ct,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],wt=>wt.target.checked)),this._setBackgroundColor(ct),this._setDefaultPropertiesFromJS(ct),this.container.append(ct),this.container}}class O extends J{constructor(D){super(D,{isRenderable:D.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const D=this.annotationStorage,x=this.data,Q=x.id;let it=D.getValue(Q,{value:x.fieldValue===x.buttonValue}).value;if(typeof it=="string"&&(it=it!==x.buttonValue,D.setValue(Q,{value:it})),it)for(const wt of this._getElementsByName(x.fieldName,Q))D.setValue(wt.id,{value:!1});const ct=document.createElement("input");if(S.add(ct),ct.setAttribute("data-element-id",Q),ct.disabled=x.readOnly,this._setRequired(ct,this.data.required),ct.type="radio",ct.name=x.fieldName,it&&ct.setAttribute("checked",!0),ct.tabIndex=g,ct.addEventListener("change",wt=>{const{name:bt,checked:zt}=wt.target;for(const Vt of this._getElementsByName(bt,Q))D.setValue(Vt.id,{value:!1});D.setValue(Q,{value:zt})}),ct.addEventListener("resetform",wt=>{const bt=x.defaultFieldValue;wt.target.checked=bt!=null&&bt===x.buttonValue}),this.enableScripting&&this.hasJSActions){const wt=x.buttonValue;ct.addEventListener("updatefromsandbox",bt=>{const zt={value:Vt=>{const Nt=wt===Vt.detail.value;for(const Yt of this._getElementsByName(Vt.target.name)){const $t=Nt&&Yt.id===Q;Yt.domElement&&(Yt.domElement.checked=$t),D.setValue(Yt.id,{value:$t})}}};this._dispatchEventFromSandbox(zt,bt)}),this._setEventListeners(ct,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],bt=>bt.target.checked)}return this._setBackgroundColor(ct),this._setDefaultPropertiesFromJS(ct),this.container.append(ct),this.container}}class q extends X{constructor(D){super(D,{ignoreBorder:D.data.hasAppearance})}render(){const D=super.render();D.classList.add("buttonWidgetAnnotation","pushButton");const x=D.lastChild;return this.enableScripting&&this.hasJSActions&&x&&(this._setDefaultPropertiesFromJS(x),x.addEventListener("updatefromsandbox",Q=>{this._dispatchEventFromSandbox({},Q)})),D}}class tt extends J{constructor(D){super(D,{isRenderable:D.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const D=this.annotationStorage,x=this.data.id,Q=D.getValue(x,{value:this.data.fieldValue}),it=document.createElement("select");S.add(it),it.setAttribute("data-element-id",x),it.disabled=this.data.readOnly,this._setRequired(it,this.data.required),it.name=this.data.fieldName,it.tabIndex=g;let ct=this.data.combo&&this.data.options.length>0;this.data.combo||(it.size=this.data.options.length,this.data.multiSelect&&(it.multiple=!0)),it.addEventListener("resetform",Nt=>{const Yt=this.data.defaultFieldValue;for(const $t of it.options)$t.selected=$t.value===Yt});for(const Nt of this.data.options){const Yt=document.createElement("option");Yt.textContent=Nt.displayValue,Yt.value=Nt.exportValue,Q.value.includes(Nt.exportValue)&&(Yt.setAttribute("selected",!0),ct=!1),it.append(Yt)}let wt=null;if(ct){const Nt=document.createElement("option");Nt.value=" ",Nt.setAttribute("hidden",!0),Nt.setAttribute("selected",!0),it.prepend(Nt),wt=()=>{Nt.remove(),it.removeEventListener("input",wt),wt=null},it.addEventListener("input",wt)}const bt=Nt=>{const Yt=Nt?"value":"textContent",{options:$t,multiple:St}=it;return St?Array.prototype.filter.call($t,Bt=>Bt.selected).map(Bt=>Bt[Yt]):$t.selectedIndex===-1?null:$t[$t.selectedIndex][Yt]};let zt=bt(!1);const Vt=Nt=>{const Yt=Nt.target.options;return Array.prototype.map.call(Yt,$t=>({displayValue:$t.textContent,exportValue:$t.value}))};return this.enableScripting&&this.hasJSActions?(it.addEventListener("updatefromsandbox",Nt=>{const Yt={value($t){wt==null||wt();const St=$t.detail.value,Bt=new Set(Array.isArray(St)?St:[St]);for(const Qt of it.options)Qt.selected=Bt.has(Qt.value);D.setValue(x,{value:bt(!0)}),zt=bt(!1)},multipleSelection($t){it.multiple=!0},remove($t){const St=it.options,Bt=$t.detail.remove;St[Bt].selected=!1,it.remove(Bt),St.length>0&&Array.prototype.findIndex.call(St,Qt=>Qt.selected)===-1&&(St[0].selected=!0),D.setValue(x,{value:bt(!0),items:Vt($t)}),zt=bt(!1)},clear($t){for(;it.length!==0;)it.remove(0);D.setValue(x,{value:null,items:[]}),zt=bt(!1)},insert($t){const{index:St,displayValue:Bt,exportValue:Qt}=$t.detail.insert,ue=it.children[St],ce=document.createElement("option");ce.textContent=Bt,ce.value=Qt,ue?ue.before(ce):it.append(ce),D.setValue(x,{value:bt(!0),items:Vt($t)}),zt=bt(!1)},items($t){const{items:St}=$t.detail;for(;it.length!==0;)it.remove(0);for(const Bt of St){const{displayValue:Qt,exportValue:ue}=Bt,ce=document.createElement("option");ce.textContent=Qt,ce.value=ue,it.append(ce)}it.options.length>0&&(it.options[0].selected=!0),D.setValue(x,{value:bt(!0),items:Vt($t)}),zt=bt(!1)},indices($t){const St=new Set($t.detail.indices);for(const Bt of $t.target.options)Bt.selected=St.has(Bt.index);D.setValue(x,{value:bt(!0)}),zt=bt(!1)},editable($t){$t.target.disabled=!$t.detail.editable}};this._dispatchEventFromSandbox(Yt,Nt)}),it.addEventListener("input",Nt=>{var $t;const Yt=bt(!0);D.setValue(x,{value:Yt}),Nt.preventDefault(),($t=this.linkService.eventBus)==null||$t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:x,name:"Keystroke",value:zt,changeEx:Yt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(it,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Nt=>Nt.target.value)):it.addEventListener("input",function(Nt){D.setValue(x,{value:bt(!0)})}),this.data.combo&&this._setTextStyle(it),this._setBackgroundColor(it),this._setDefaultPropertiesFromJS(it),this.container.append(it),this.container}}class vt extends N{constructor(D){const{data:x,elements:Q}=D;super(D,{isRenderable:N._hasPopupData(x)}),this.elements=Q}render(){this.container.classList.add("popupAnnotation");const D=new Ft({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),x=[];for(const Q of this.elements)Q.popup=D,x.push(Q.data.id),Q.addHighlightArea();return this.container.setAttribute("aria-controls",x.map(Q=>`${e.AnnotationPrefix}${Q}`).join(",")),this.container}}class Ft{constructor({container:D,color:x,elements:Q,titleObj:it,modificationDate:ct,contentsObj:wt,richText:bt,parent:zt,rect:Vt,parentRect:Nt,open:Yt}){l(this,yt);l(this,ut);l(this,P);l(this,nt);l(this,et,C(this,yt,zr).bind(this));l(this,i,C(this,nt,Tn).bind(this));l(this,n,C(this,P,Ln).bind(this));l(this,c,C(this,ut,Xi).bind(this));l(this,p,null);l(this,o,null);l(this,y,null);l(this,b,null);l(this,E,null);l(this,d,null);l(this,a,null);l(this,h,!1);l(this,R,null);l(this,V,null);l(this,G,null);l(this,at,null);l(this,ot,!1);var $t;I(this,o,D),I(this,at,it),I(this,y,wt),I(this,G,bt),I(this,d,zt),I(this,p,x),I(this,V,Vt),I(this,a,Nt),I(this,E,Q),I(this,b,w.PDFDateString.toDateObject(ct)),this.trigger=Q.flatMap(St=>St.getElementsToTriggerPopup());for(const St of this.trigger)St.addEventListener("click",t(this,c)),St.addEventListener("mouseenter",t(this,n)),St.addEventListener("mouseleave",t(this,i)),St.classList.add("popupTriggerArea");for(const St of Q)($t=St.container)==null||$t.addEventListener("keydown",t(this,et));t(this,o).hidden=!0,Yt&&C(this,ut,Xi).call(this)}render(){if(t(this,R))return;const{page:{view:D},viewport:{rawDims:{pageWidth:x,pageHeight:Q,pageX:it,pageY:ct}}}=t(this,d),wt=I(this,R,document.createElement("div"));if(wt.className="popup",t(this,p)){const we=wt.style.outlineColor=e.Util.makeHexColor(...t(this,p));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?wt.style.backgroundColor=`color-mix(in srgb, ${we} 30%, white)`:wt.style.backgroundColor=e.Util.makeHexColor(...t(this,p).map(Le=>Math.floor(.7*(255-Le)+Le)))}const bt=document.createElement("span");bt.className="header";const zt=document.createElement("h1");if(bt.append(zt),{dir:zt.dir,str:zt.textContent}=t(this,at),wt.append(bt),t(this,b)){const we=document.createElement("span");we.classList.add("popupDate"),we.setAttribute("data-l10n-id","pdfjs-annotation-date-string"),we.setAttribute("data-l10n-args",JSON.stringify({date:t(this,b).toLocaleDateString(),time:t(this,b).toLocaleTimeString()})),bt.append(we)}const Vt=t(this,y),Nt=t(this,G);if(Nt!=null&&Nt.str&&(!(Vt!=null&&Vt.str)||Vt.str===Nt.str))_.XfaLayer.render({xfaHtml:Nt.html,intent:"richText",div:wt}),wt.lastChild.classList.add("richText","popupContent");else{const we=this._formatContents(Vt);wt.append(we)}let Yt=!!t(this,a),$t=Yt?t(this,a):t(this,V);for(const we of t(this,E))if(!$t||e.Util.intersect(we.data.rect,$t)!==null){$t=we.data.rect,Yt=!0;break}const St=e.Util.normalizeRect([$t[0],D[3]-$t[1]+D[1],$t[2],D[3]-$t[3]+D[1]]),Bt=Yt?$t[2]-$t[0]+5:0,Qt=St[0]+Bt,ue=St[1],{style:ce}=t(this,o);ce.left=`${100*(Qt-it)/x}%`,ce.top=`${100*(ue-ct)/Q}%`,t(this,o).append(wt)}_formatContents({str:D,dir:x}){const Q=document.createElement("p");Q.classList.add("popupContent"),Q.dir=x;const it=D.split(/(?:\r\n?|\n)/);for(let ct=0,wt=it.length;ct<wt;++ct){const bt=it[ct];Q.append(document.createTextNode(bt)),ct<wt-1&&Q.append(document.createElement("br"))}return Q}forceHide(){I(this,ot,this.isVisible),t(this,ot)&&(t(this,o).hidden=!0)}maybeShow(){t(this,ot)&&(I(this,ot,!1),t(this,o).hidden=!1)}get isVisible(){return t(this,o).hidden===!1}}et=new WeakMap,i=new WeakMap,n=new WeakMap,c=new WeakMap,p=new WeakMap,o=new WeakMap,y=new WeakMap,b=new WeakMap,E=new WeakMap,d=new WeakMap,a=new WeakMap,h=new WeakMap,R=new WeakMap,V=new WeakMap,G=new WeakMap,at=new WeakMap,ot=new WeakMap,yt=new WeakSet,zr=function(D){D.altKey||D.shiftKey||D.ctrlKey||D.metaKey||(D.key==="Enter"||D.key==="Escape"&&t(this,h))&&C(this,ut,Xi).call(this)},ut=new WeakSet,Xi=function(){I(this,h,!t(this,h)),t(this,h)?(C(this,P,Ln).call(this),t(this,o).addEventListener("click",t(this,c)),t(this,o).addEventListener("keydown",t(this,et))):(C(this,nt,Tn).call(this),t(this,o).removeEventListener("click",t(this,c)),t(this,o).removeEventListener("keydown",t(this,et)))},P=new WeakSet,Ln=function(){t(this,R)||this.render(),this.isVisible?t(this,h)&&t(this,o).classList.add("focused"):(t(this,o).hidden=!1,t(this,o).style.zIndex=parseInt(t(this,o).style.zIndex)+1e3)},nt=new WeakSet,Tn=function(){t(this,o).classList.remove("focused"),!(t(this,h)||!this.isVisible)&&(t(this,o).hidden=!0,t(this,o).style.zIndex=parseInt(t(this,o).style.zIndex)-1e3)};class Ct extends N{constructor(D){super(D,{isRenderable:!0,ignoreBorder:!0}),this.textContent=D.data.textContent,this.textPosition=D.data.textPosition,this.annotationEditorType=e.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const D=document.createElement("div");D.classList.add("annotationTextContent"),D.setAttribute("role","comment");for(const x of this.textContent){const Q=document.createElement("span");Q.textContent=x,D.append(Q)}this.container.append(D)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}get _isEditable(){return this.data.hasOwnCanvas}}class Ot extends N{constructor(x){super(x,{isRenderable:!0,ignoreBorder:!0});l(this,v,null)}render(){this.container.classList.add("lineAnnotation");const x=this.data,{width:Q,height:it}=A(x.rect),ct=this.svgFactory.create(Q,it,!0),wt=I(this,v,this.svgFactory.createElement("svg:line"));return wt.setAttribute("x1",x.rect[2]-x.lineCoordinates[0]),wt.setAttribute("y1",x.rect[3]-x.lineCoordinates[1]),wt.setAttribute("x2",x.rect[2]-x.lineCoordinates[2]),wt.setAttribute("y2",x.rect[3]-x.lineCoordinates[3]),wt.setAttribute("stroke-width",x.borderStyle.width||1),wt.setAttribute("stroke","transparent"),wt.setAttribute("fill","transparent"),ct.append(wt),this.container.append(ct),!x.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,v)}addHighlightArea(){this.container.classList.add("highlightArea")}}v=new WeakMap;class _t extends N{constructor(x){super(x,{isRenderable:!0,ignoreBorder:!0});l(this,z,null)}render(){this.container.classList.add("squareAnnotation");const x=this.data,{width:Q,height:it}=A(x.rect),ct=this.svgFactory.create(Q,it,!0),wt=x.borderStyle.width,bt=I(this,z,this.svgFactory.createElement("svg:rect"));return bt.setAttribute("x",wt/2),bt.setAttribute("y",wt/2),bt.setAttribute("width",Q-wt),bt.setAttribute("height",it-wt),bt.setAttribute("stroke-width",wt||1),bt.setAttribute("stroke","transparent"),bt.setAttribute("fill","transparent"),ct.append(bt),this.container.append(ct),!x.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,z)}addHighlightArea(){this.container.classList.add("highlightArea")}}z=new WeakMap;class Lt extends N{constructor(x){super(x,{isRenderable:!0,ignoreBorder:!0});l(this,K,null)}render(){this.container.classList.add("circleAnnotation");const x=this.data,{width:Q,height:it}=A(x.rect),ct=this.svgFactory.create(Q,it,!0),wt=x.borderStyle.width,bt=I(this,K,this.svgFactory.createElement("svg:ellipse"));return bt.setAttribute("cx",Q/2),bt.setAttribute("cy",it/2),bt.setAttribute("rx",Q/2-wt/2),bt.setAttribute("ry",it/2-wt/2),bt.setAttribute("stroke-width",wt||1),bt.setAttribute("stroke","transparent"),bt.setAttribute("fill","transparent"),ct.append(bt),this.container.append(ct),!x.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,K)}addHighlightArea(){this.container.classList.add("highlightArea")}}K=new WeakMap;class kt extends N{constructor(x){super(x,{isRenderable:!0,ignoreBorder:!0});l(this,lt,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const x=this.data,{width:Q,height:it}=A(x.rect),ct=this.svgFactory.create(Q,it,!0);let wt=[];for(const zt of x.vertices){const Vt=zt.x-x.rect[0],Nt=x.rect[3]-zt.y;wt.push(Vt+","+Nt)}wt=wt.join(" ");const bt=I(this,lt,this.svgFactory.createElement(this.svgElementName));return bt.setAttribute("points",wt),bt.setAttribute("stroke-width",x.borderStyle.width||1),bt.setAttribute("stroke","transparent"),bt.setAttribute("fill","transparent"),ct.append(bt),this.container.append(ct),!x.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,lt)}addHighlightArea(){this.container.classList.add("highlightArea")}}lt=new WeakMap;class Et extends kt{constructor(D){super(D),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Z extends N{constructor(D){super(D,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class gt extends N{constructor(x){super(x,{isRenderable:!0,ignoreBorder:!0});l(this,mt,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=e.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const x=this.data,{width:Q,height:it}=A(x.rect),ct=this.svgFactory.create(Q,it,!0);for(const wt of x.inkLists){let bt=[];for(const Vt of wt){const Nt=Vt.x-x.rect[0],Yt=x.rect[3]-Vt.y;bt.push(`${Nt},${Yt}`)}bt=bt.join(" ");const zt=this.svgFactory.createElement(this.svgElementName);t(this,mt).push(zt),zt.setAttribute("points",bt),zt.setAttribute("stroke-width",x.borderStyle.width||1),zt.setAttribute("stroke","transparent"),zt.setAttribute("fill","transparent"),!x.popupRef&&this.hasPopupData&&this._createPopup(),ct.append(zt)}return this.container.append(ct),this.container}getElementsToTriggerPopup(){return t(this,mt)}addHighlightArea(){this.container.classList.add("highlightArea")}}mt=new WeakMap;class Rt extends N{constructor(D){super(D,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class Pt extends N{constructor(D){super(D,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class qt extends N{constructor(D){super(D,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Kt extends N{constructor(D){super(D,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class ie extends N{constructor(D){super(D,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Se extends N{constructor(x){var ct;super(x,{isRenderable:!0});l(this,Dt);l(this,Mt,null);const{filename:Q,content:it}=this.data.file;this.filename=(0,w.getFilenameFromUrl)(Q,!0),this.content=it,(ct=this.linkService.eventBus)==null||ct.dispatch("fileattachmentannotation",{source:this,filename:Q,content:it})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:x,data:Q}=this;let it;Q.hasAppearance||Q.fillAlpha===0?it=document.createElement("div"):(it=document.createElement("img"),it.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(Q.name)?"paperclip":"pushpin"}.svg`,Q.fillAlpha&&Q.fillAlpha<1&&(it.style=`filter: opacity(${Math.round(Q.fillAlpha*100)}%);`)),it.addEventListener("dblclick",C(this,Dt,kn).bind(this)),I(this,Mt,it);const{isMac:ct}=e.FeatureTest.platform;return x.addEventListener("keydown",wt=>{wt.key==="Enter"&&(ct?wt.metaKey:wt.ctrlKey)&&C(this,Dt,kn).call(this)}),!Q.popupRef&&this.hasPopupData?this._createPopup():it.classList.add("popupTriggerArea"),x.append(it),x}getElementsToTriggerPopup(){return t(this,Mt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Mt=new WeakMap,Dt=new WeakSet,kn=function(){var x;(x=this.downloadManager)==null||x.openOrDownloadData(this.content,this.filename)};class de{constructor({div:D,accessibilityManager:x,annotationCanvasMap:Q,page:it,viewport:ct}){l(this,_e);l(this,me);l(this,re,null);l(this,he,null);l(this,Me,new Map);this.div=D,I(this,re,x),I(this,he,Q),this.page=it,this.viewport=ct,this.zIndex=0}async render(D){const{annotations:x}=D,Q=this.div;(0,w.setLayerDimensions)(Q,this.viewport);const it=new Map,ct={data:null,layer:Q,linkService:D.linkService,downloadManager:D.downloadManager,imageResourcesPath:D.imageResourcesPath||"",renderForms:D.renderForms!==!1,svgFactory:new w.DOMSVGFactory,annotationStorage:D.annotationStorage||new f.AnnotationStorage,enableScripting:D.enableScripting===!0,hasJSActions:D.hasJSActions,fieldObjects:D.fieldObjects,parent:this,elements:null};for(const wt of x){if(wt.noHTML)continue;const bt=wt.annotationType===e.AnnotationType.POPUP;if(bt){const Nt=it.get(wt.id);if(!Nt)continue;ct.elements=Nt}else{const{width:Nt,height:Yt}=A(wt.rect);if(Nt<=0||Yt<=0)continue}ct.data=wt;const zt=F.create(ct);if(!zt.isRenderable)continue;if(!bt&&wt.popupRef){const Nt=it.get(wt.popupRef);Nt?Nt.push(zt):it.set(wt.popupRef,[zt])}zt.annotationEditorType>0&&t(this,Me).set(zt.data.id,zt);const Vt=zt.render();wt.hidden&&(Vt.style.visibility="hidden"),C(this,_e,Wr).call(this,Vt,wt.id)}C(this,me,Rn).call(this)}update({viewport:D}){const x=this.div;this.viewport=D,(0,w.setLayerDimensions)(x,{rotation:D.rotation}),C(this,me,Rn).call(this),x.hidden=!1}getEditableAnnotations(){return Array.from(t(this,Me).values())}getEditableAnnotation(D){return t(this,Me).get(D)}}re=new WeakMap,he=new WeakMap,Me=new WeakMap,_e=new WeakSet,Wr=function(D,x){var it;const Q=D.firstChild||D;Q.id=`${e.AnnotationPrefix}${x}`,this.div.append(D),(it=t(this,re))==null||it.moveElementInDOM(this.div,D,Q,!1)},me=new WeakSet,Rn=function(){if(!t(this,he))return;const D=this.div;for(const[x,Q]of t(this,he)){const it=D.querySelector(`[data-annotation-id="${x}"]`);if(!it)continue;const{firstChild:ct}=it;ct?ct.nodeName==="CANVAS"?ct.replaceWith(Q):ct.before(Q):it.append(Q)}t(this,he).clear()}},792:(r,m,u)=>{var _,g,H,Xr,A;u.d(m,{AnnotationStorage:()=>W,PrintAnnotationStorage:()=>k,SerializableEmpty:()=>T});var e=u(292),w=u(310),f=u(651);const T=Object.freeze({map:null,hash:"",transfer:void 0});class W{constructor(){l(this,H);l(this,_,!1);l(this,g,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(N,X){const rt=t(this,g).get(N);return rt===void 0?X:Object.assign(X,rt)}getRawValue(N){return t(this,g).get(N)}remove(N){if(t(this,g).delete(N),t(this,g).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const X of t(this,g).values())if(X instanceof w.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(N,X){const rt=t(this,g).get(N);let J=!1;if(rt!==void 0)for(const[M,j]of Object.entries(X))rt[M]!==j&&(J=!0,rt[M]=j);else J=!0,t(this,g).set(N,X);J&&C(this,H,Xr).call(this),X instanceof w.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(X.constructor._type)}has(N){return t(this,g).has(N)}getAll(){return t(this,g).size>0?(0,e.objectFromMap)(t(this,g)):null}setAll(N){for(const[X,rt]of Object.entries(N))this.setValue(X,rt)}get size(){return t(this,g).size}resetModified(){t(this,_)&&(I(this,_,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new k(this)}get serializable(){if(t(this,g).size===0)return T;const N=new Map,X=new f.MurmurHash3_64,rt=[],J=Object.create(null);let M=!1;for(const[j,$]of t(this,g)){const O=$ instanceof w.AnnotationEditor?$.serialize(!1,J):$;O&&(N.set(j,O),X.update(`${j}:${JSON.stringify(O)}`),M||(M=!!O.bitmap))}if(M)for(const j of N.values())j.bitmap&&rt.push(j.bitmap);return N.size>0?{map:N,hash:X.hexdigest(),transfer:rt}:T}get editorStats(){let N=null;const X=new Map;for(const rt of t(this,g).values()){if(!(rt instanceof w.AnnotationEditor))continue;const J=rt.telemetryFinalData;if(!J)continue;const{type:M}=J;X.has(M)||X.set(M,Object.getPrototypeOf(rt).constructor),N||(N=Object.create(null));const j=N[M]||(N[M]=new Map);for(const[$,O]of Object.entries(J)){if($==="type")continue;let q=j.get($);q||(q=new Map,j.set($,q));const tt=q.get(O)??0;q.set(O,tt+1)}}for(const[rt,J]of X)N[rt]=J.computeTelemetryFinalData(N[rt]);return N}}_=new WeakMap,g=new WeakMap,H=new WeakSet,Xr=function(){t(this,_)||(I(this,_,!0),typeof this.onSetModified=="function"&&this.onSetModified())};class k extends W{constructor(X){super();l(this,A,void 0);const{map:rt,hash:J,transfer:M}=X.serializable,j=structuredClone(rt,M?{transfer:M}:null);I(this,A,{map:j,hash:J,transfer:M})}get print(){(0,e.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,A)}}A=new WeakMap},831:(r,m,u)=>{u.a(r,async(e,w)=>{var O,q,tt,vt,Ys,Ct,Ki,_t,Lt,kt,Et,Z,Yi,Rt,Pt,qt,Kt,ie,Ai,de,le,Pn,jt,ae;try{let Ce=function(U){if(typeof U=="string"||U instanceof URL?U={url:U}:(U instanceof ArrayBuffer||ArrayBuffer.isView(U))&&(U={data:U}),typeof U!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!U.url&&!U.data&&!U.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const v=new b,{docId:z}=v,K=U.url?ee(U.url):null,lt=U.data?Ee(U.data):null,mt=U.httpHeaders||null,Mt=U.withCredentials===!0,Dt=U.password??null,te=U.range instanceof E?U.range:null,re=Number.isInteger(U.rangeChunkSize)&&U.rangeChunkSize>0?U.rangeChunkSize:ne;let he=U.worker instanceof V?U.worker:null;const Me=U.verbosity,_e=typeof U.docBaseUrl=="string"&&!(0,W.isDataScheme)(U.docBaseUrl)?U.docBaseUrl:null,Fe=typeof U.cMapUrl=="string"?U.cMapUrl:null,me=U.cMapPacked!==!1,ke=U.CMapReaderFactory||c,se=typeof U.standardFontDataUrl=="string"?U.standardFontDataUrl:null,D=U.StandardFontDataFactory||o,x=U.stopAtErrors!==!0,Q=Number.isInteger(U.maxImageSize)&&U.maxImageSize>-1?U.maxImageSize:-1,it=U.isEvalSupported!==!1,ct=typeof U.isOffscreenCanvasSupported=="boolean"?U.isOffscreenCanvasSupported:!f.isNodeJS,wt=Number.isInteger(U.canvasMaxAreaInBytes)?U.canvasMaxAreaInBytes:-1,bt=typeof U.disableFontFace=="boolean"?U.disableFontFace:f.isNodeJS,zt=U.fontExtraProperties===!0,Vt=U.enableXfa===!0,Nt=U.ownerDocument||globalThis.document,Yt=U.disableRange===!0,$t=U.disableStream===!0,St=U.disableAutoFetch===!0,Bt=U.pdfBug===!0,Qt=te?te.length:U.length??NaN,ue=typeof U.useSystemFonts=="boolean"?U.useSystemFonts:!f.isNodeJS&&!bt,ce=typeof U.useWorkerFetch=="boolean"?U.useWorkerFetch:ke===W.DOMCMapReaderFactory&&D===W.DOMStandardFontDataFactory&&Fe&&se&&(0,W.isValidFetchUrl)(Fe,document.baseURI)&&(0,W.isValidFetchUrl)(se,document.baseURI),we=U.canvasFactory||new n({ownerDocument:Nt}),Le=U.filterFactory||new p({docId:z,ownerDocument:Nt}),Ze=null;(0,f.setVerbosityLevel)(Me);const Xe={canvasFactory:we,filterFactory:Le};if(ce||(Xe.cMapReaderFactory=new ke({baseUrl:Fe,isCompressed:me}),Xe.standardFontDataFactory=new D({baseUrl:se})),!he){const Ve={verbosity:Me,port:S.GlobalWorkerOptions.workerPort};he=Ve.port?V.fromPort(Ve):new V(Ve),v._worker=he}const Ke={docId:z,apiVersion:"4.1.392",data:lt,password:Dt,disableAutoFetch:St,rangeChunkSize:re,length:Qt,docBaseUrl:_e,enableXfa:Vt,evaluatorOptions:{maxImageSize:Q,disableFontFace:bt,ignoreErrors:x,isEvalSupported:it,isOffscreenCanvasSupported:ct,canvasMaxAreaInBytes:wt,fontExtraProperties:zt,useSystemFonts:ue,cMapUrl:ce?Fe:null,standardFontDataUrl:ce?se:null}},is={ignoreErrors:x,isEvalSupported:it,disableFontFace:bt,fontExtraProperties:zt,enableXfa:Vt,ownerDocument:Nt,disableAutoFetch:St,pdfBug:Bt,styleElement:Ze};return he.promise.then(function(){if(v.destroyed)throw new Error("Loading aborted");const Ve=y(he,Ke),B=new Promise(function(dt){let Ht;te?Ht=new X.PDFDataTransportStream(te,{disableRange:Yt,disableStream:$t}):lt||(Ht=(Ut=>f.isNodeJS?function(){return typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype}()&&(0,W.isValidFetchUrl)(Ut.url)?new rt.PDFFetchStream(Ut):new M.PDFNodeStream(Ut):(0,W.isValidFetchUrl)(Ut.url)?new rt.PDFFetchStream(Ut):new J.PDFNetworkStream(Ut))({url:K,length:Qt,httpHeaders:mt,withCredentials:Mt,rangeChunkSize:re,disableRange:Yt,disableStream:$t})),dt(Ht)});return Promise.all([Ve,B]).then(function([dt,Ht]){if(v.destroyed)throw new Error("Loading aborted");const Ut=new A.MessageHandler(z,dt,he.port),Jt=new G(Ut,v,Ht,is,Xe);v._transport=Jt,Ut.send("Ready",null)})}).catch(v._capability.reject),v},ee=function(U){if(U instanceof URL)return U.href;try{return new URL(U,window.location).href}catch{if(f.isNodeJS&&typeof U=="string")return U}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")},Ee=function(U){if(f.isNodeJS&&typeof Buffer<"u"&&U instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(U instanceof Uint8Array&&U.byteLength===U.buffer.byteLength)return U;if(typeof U=="string")return(0,f.stringToBytes)(U);if(U instanceof ArrayBuffer||ArrayBuffer.isView(U)||typeof U=="object"&&!isNaN(U==null?void 0:U.length))return new Uint8Array(U);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")};u.d(m,{PDFDataRangeTransport:()=>E,PDFWorker:()=>V,build:()=>xt,getDocument:()=>Ce,version:()=>ut});var f=u(292),T=u(792),W=u(419),k=u(10),_=u(573),g=u(923),H=u(814),S=u(164),A=u(178),F=u(62),N=u(626),X=u(585),rt=u(94),J=u(457),M=u(786),j=u(50),$=e([_,M]);[_,M]=$.then?(await $)():$;const ne=65536,et=100,i=5e3,n=f.isNodeJS?_.NodeCanvasFactory:W.DOMCanvasFactory,c=f.isNodeJS?_.NodeCMapReaderFactory:W.DOMCMapReaderFactory,p=f.isNodeJS?_.NodeFilterFactory:W.DOMFilterFactory,o=f.isNodeJS?_.NodeStandardFontDataFactory:W.DOMStandardFontDataFactory;async function y(U,v){if(U.destroyed)throw new Error("Worker was destroyed");const z=await U.messageHandler.sendWithPromise("GetDocRequest",v,v.data?[v.data.buffer]:null);if(U.destroyed)throw new Error("Worker was destroyed");return z}const P=class P{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${fs(P,O)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var v,z,K;this.destroyed=!0;try{(v=this._worker)!=null&&v.port&&(this._worker._pendingDestroy=!0),await((z=this._transport)==null?void 0:z.destroy())}catch(lt){throw(K=this._worker)!=null&&K.port&&delete this._worker._pendingDestroy,lt}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};O=new WeakMap,l(P,O,0);let b=P;class E{constructor(v,z,K=!1,lt=null){this.length=v,this.initialData=z,this.progressiveDone=K,this.contentDispositionFilename=lt,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(v){this._rangeListeners.push(v)}addProgressListener(v){this._progressListeners.push(v)}addProgressiveReadListener(v){this._progressiveReadListeners.push(v)}addProgressiveDoneListener(v){this._progressiveDoneListeners.push(v)}onDataRange(v,z){for(const K of this._rangeListeners)K(v,z)}onDataProgress(v,z){this._readyCapability.promise.then(()=>{for(const K of this._progressListeners)K(v,z)})}onDataProgressiveRead(v){this._readyCapability.promise.then(()=>{for(const z of this._progressiveReadListeners)z(v)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const v of this._progressiveDoneListeners)v()})}transportReady(){this._readyCapability.resolve()}requestDataRange(v,z){(0,f.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class d{constructor(v,z){this._pdfInfo=v,this._transport=z}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,f.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(v){return this._transport.getPage(v)}getPageIndex(v){return this._transport.getPageIndex(v)}getDestinations(){return this._transport.getDestinations()}getDestination(v){return this._transport.getDestination(v)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:v="display"}={}){const{renderingIntent:z}=this._transport.getRenderingIntent(v);return this._transport.getOptionalContentConfig(z)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(v=!1){return this._transport.startCleanup(v||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class a{constructor(v,z,K,lt=!1){l(this,vt);l(this,Ct);l(this,q,null);l(this,tt,!1);this._pageIndex=v,this._pageInfo=z,this._transport=K,this._stats=lt?new W.StatTimer:null,this._pdfBug=lt,this.commonObjs=K.commonObjs,this.objs=new ot,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:v,rotation:z=this.rotate,offsetX:K=0,offsetY:lt=0,dontFlip:mt=!1}={}){return new W.PageViewport({viewBox:this.view,scale:v,rotation:z,offsetX:K,offsetY:lt,dontFlip:mt})}getAnnotations({intent:v="display"}={}){const{renderingIntent:z}=this._transport.getRenderingIntent(v);return this._transport.getAnnotations(this._pageIndex,z)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,f.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var v;return((v=this._transport._htmlForXfa)==null?void 0:v.children[this._pageIndex])||null}render({canvasContext:v,viewport:z,intent:K="display",annotationMode:lt=f.AnnotationMode.ENABLE,transform:mt=null,background:Mt=null,optionalContentConfigPromise:Dt=null,annotationCanvasMap:te=null,pageColors:re=null,printAnnotationStorage:he=null}){var Q,it;(Q=this._stats)==null||Q.time("Overall");const Me=this._transport.getRenderingIntent(K,lt,he),{renderingIntent:_e,cacheKey:Fe}=Me;I(this,tt,!1),C(this,Ct,Ki).call(this),Dt||(Dt=this._transport.getOptionalContentConfig(_e));let me=this._intentStates.get(Fe);me||(me=Object.create(null),this._intentStates.set(Fe,me)),me.streamReaderCancelTimeout&&(clearTimeout(me.streamReaderCancelTimeout),me.streamReaderCancelTimeout=null);const ke=!!(_e&f.RenderingIntentFlag.PRINT);me.displayReadyCapability||(me.displayReadyCapability=Promise.withResolvers(),me.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(it=this._stats)==null||it.time("Page Request"),this._pumpOperatorList(Me));const se=ct=>{var wt,bt;me.renderTasks.delete(D),(this._maybeCleanupAfterRender||ke)&&I(this,tt,!0),C(this,vt,Ys).call(this,!ke),ct?(D.capability.reject(ct),this._abortOperatorList({intentState:me,reason:ct instanceof Error?ct:new Error(ct)})):D.capability.resolve(),(wt=this._stats)==null||wt.timeEnd("Rendering"),(bt=this._stats)==null||bt.timeEnd("Overall")},D=new At({callback:se,params:{canvasContext:v,viewport:z,transform:mt,background:Mt},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:te,operatorList:me.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!ke,pdfBug:this._pdfBug,pageColors:re});(me.renderTasks||(me.renderTasks=new Set)).add(D);const x=D.task;return Promise.all([me.displayReadyCapability.promise,Dt]).then(([ct,wt])=>{var bt;if(this.destroyed){se();return}if((bt=this._stats)==null||bt.time("Rendering"),!(wt.renderingIntent&_e))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");D.initializeGraphics({transparency:ct,optionalContentConfig:wt}),D.operatorListChanged()}).catch(se),x}getOperatorList({intent:v="display",annotationMode:z=f.AnnotationMode.ENABLE,printAnnotationStorage:K=null}={}){var te;function lt(){Mt.operatorList.lastChunk&&(Mt.opListReadCapability.resolve(Mt.operatorList),Mt.renderTasks.delete(Dt))}const mt=this._transport.getRenderingIntent(v,z,K,!0);let Mt=this._intentStates.get(mt.cacheKey);Mt||(Mt=Object.create(null),this._intentStates.set(mt.cacheKey,Mt));let Dt;return Mt.opListReadCapability||(Dt=Object.create(null),Dt.operatorListChanged=lt,Mt.opListReadCapability=Promise.withResolvers(),(Mt.renderTasks||(Mt.renderTasks=new Set)).add(Dt),Mt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(te=this._stats)==null||te.time("Page Request"),this._pumpOperatorList(mt)),Mt.opListReadCapability.promise}streamTextContent({includeMarkedContent:v=!1,disableNormalization:z=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:v===!0,disableNormalization:z===!0},{highWaterMark:100,size(K){return K.items.length}})}getTextContent(v={}){if(this._transport._htmlForXfa)return this.getXfa().then(K=>j.XfaText.textContent(K));const z=this.streamTextContent(v);return new Promise(function(K,lt){function mt(){Mt.read().then(function({value:te,done:re}){if(re){K(Dt);return}Object.assign(Dt.styles,te.styles),Dt.items.push(...te.items),mt()},lt)}const Mt=z.getReader(),Dt={items:[],styles:Object.create(null)};mt()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const v=[];for(const z of this._intentStates.values())if(this._abortOperatorList({intentState:z,reason:new Error("Page was destroyed."),force:!0}),!z.opListReadCapability)for(const K of z.renderTasks)v.push(K.completed),K.cancel();return this.objs.clear(),I(this,tt,!1),C(this,Ct,Ki).call(this),Promise.all(v)}cleanup(v=!1){I(this,tt,!0);const z=C(this,vt,Ys).call(this,!1);return v&&z&&this._stats&&(this._stats=new W.StatTimer),z}_startRenderPage(v,z){var lt,mt;const K=this._intentStates.get(z);K&&((lt=this._stats)==null||lt.timeEnd("Page Request"),(mt=K.displayReadyCapability)==null||mt.resolve(v))}_renderPageChunk(v,z){for(let K=0,lt=v.length;K<lt;K++)z.operatorList.fnArray.push(v.fnArray[K]),z.operatorList.argsArray.push(v.argsArray[K]);z.operatorList.lastChunk=v.lastChunk,z.operatorList.separateAnnots=v.separateAnnots;for(const K of z.renderTasks)K.operatorListChanged();v.lastChunk&&C(this,vt,Ys).call(this,!0)}_pumpOperatorList({renderingIntent:v,cacheKey:z,annotationStorageSerializable:K}){const{map:lt,transfer:mt}=K,Mt=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:v,cacheKey:z,annotationStorage:lt},mt).getReader(),Dt=this._intentStates.get(z);Dt.streamReader=Mt;const te=()=>{Mt.read().then(({value:re,done:he})=>{if(he){Dt.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(re,Dt),te())},re=>{if(Dt.streamReader=null,!this._transport.destroyed){if(Dt.operatorList){Dt.operatorList.lastChunk=!0;for(const he of Dt.renderTasks)he.operatorListChanged();C(this,vt,Ys).call(this,!0)}if(Dt.displayReadyCapability)Dt.displayReadyCapability.reject(re);else if(Dt.opListReadCapability)Dt.opListReadCapability.reject(re);else throw re}})};te()}_abortOperatorList({intentState:v,reason:z,force:K=!1}){if(v.streamReader){if(v.streamReaderCancelTimeout&&(clearTimeout(v.streamReaderCancelTimeout),v.streamReaderCancelTimeout=null),!K){if(v.renderTasks.size>0)return;if(z instanceof W.RenderingCancelledException){let lt=et;z.extraDelay>0&&z.extraDelay<1e3&&(lt+=z.extraDelay),v.streamReaderCancelTimeout=setTimeout(()=>{v.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:v,reason:z,force:!0})},lt);return}}if(v.streamReader.cancel(new f.AbortException(z.message)).catch(()=>{}),v.streamReader=null,!this._transport.destroyed){for(const[lt,mt]of this._intentStates)if(mt===v){this._intentStates.delete(lt);break}this.cleanup()}}}get stats(){return this._stats}}q=new WeakMap,tt=new WeakMap,vt=new WeakSet,Ys=function(v=!1){if(C(this,Ct,Ki).call(this),!t(this,tt)||this.destroyed)return!1;if(v)return I(this,q,setTimeout(()=>{I(this,q,null),C(this,vt,Ys).call(this,!1)},i)),!1;for(const{renderTasks:z,operatorList:K}of this._intentStates.values())if(z.size>0||!K.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),I(this,tt,!1),!0},Ct=new WeakSet,Ki=function(){t(this,q)&&(clearTimeout(t(this,q)),I(this,q,null))};class h{constructor(){l(this,_t,new Set);l(this,Lt,Promise.resolve())}postMessage(v,z){const K={data:structuredClone(v,z?{transfer:z}:null)};t(this,Lt).then(()=>{for(const lt of t(this,_t))lt.call(this,K)})}addEventListener(v,z){t(this,_t).add(z)}removeEventListener(v,z){t(this,_t).delete(z)}terminate(){t(this,_t).clear()}}_t=new WeakMap,Lt=new WeakMap;const R={isWorkerDisabled:!1,fakeWorkerId:0};f.isNodeJS&&(R.isWorkerDisabled=!0,(kt=S.GlobalWorkerOptions).workerSrc||(kt.workerSrc="./pdf.worker.mjs")),R.isSameOrigin=function(U,v){let z;try{if(z=new URL(U),!z.origin||z.origin==="null")return!1}catch{return!1}const K=new URL(v,z);return z.origin===K.origin},R.createCDNWrapper=function(U){const v=`await import("${U}");`;return URL.createObjectURL(new Blob([v],{type:"text/javascript"}))};const Y=class Y{constructor({name:v=null,port:z=null,verbosity:K=(0,f.getVerbosityLevel)()}={}){var lt;if(this.name=v,this.destroyed=!1,this.verbosity=K,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,z){if((lt=t(Y,Et))!=null&&lt.has(z))throw new Error("Cannot use more than one PDFWorker per port.");(t(Y,Et)||I(Y,Et,new WeakMap)).set(z,this),this._initializeFromPort(z);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(v){this._port=v,this._messageHandler=new A.MessageHandler("main","worker",v),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!R.isWorkerDisabled&&!t(Y,Z,Yi)){let{workerSrc:v}=Y;try{R.isSameOrigin(window.location.href,v)||(v=R.createCDNWrapper(new URL(v,window.location).href));const z=new Worker(v,{type:"module"}),K=new A.MessageHandler("main","worker",z),lt=()=>{z.removeEventListener("error",mt),K.destroy(),z.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},mt=()=>{this._webWorker||lt()};z.addEventListener("error",mt),K.on("test",Dt=>{if(z.removeEventListener("error",mt),this.destroyed){lt();return}Dt?(this._messageHandler=K,this._port=z,this._webWorker=z,this._readyCapability.resolve(),K.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),K.destroy(),z.terminate())}),K.on("ready",Dt=>{if(z.removeEventListener("error",mt),this.destroyed){lt();return}try{Mt()}catch{this._setupFakeWorker()}});const Mt=()=>{const Dt=new Uint8Array;K.send("test",Dt,[Dt.buffer])};Mt();return}catch{(0,f.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){R.isWorkerDisabled||((0,f.warn)("Setting up fake worker."),R.isWorkerDisabled=!0),Y._setupFakeWorkerGlobal.then(v=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const z=new h;this._port=z;const K=`fake${R.fakeWorkerId++}`,lt=new A.MessageHandler(K+"_worker",K,z);v.setup(lt,z);const mt=new A.MessageHandler(K,K+"_worker",z);this._messageHandler=mt,this._readyCapability.resolve(),mt.send("configure",{verbosity:this.verbosity})}).catch(v=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${v.message}".`))})}destroy(){var v;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(v=t(Y,Et))==null||v.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(v){var K;if(!(v!=null&&v.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const z=(K=t(this,Et))==null?void 0:K.get(v.port);if(z){if(z._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return z}return new Y(v)}static get workerSrc(){if(S.GlobalWorkerOptions.workerSrc)return S.GlobalWorkerOptions.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){const v=async()=>t(this,Z,Yi)?t(this,Z,Yi):(await vs(()=>import(this.workerSrc).then(async z=>(await z.__tla,z)),[])).WorkerMessageHandler;return(0,f.shadow)(this,"_setupFakeWorkerGlobal",v())}};Et=new WeakMap,Z=new WeakSet,Yi=function(){var v;try{return((v=globalThis.pdfjsWorker)==null?void 0:v.WorkerMessageHandler)||null}catch{return null}},l(Y,Z),l(Y,Et,void 0);let V=Y;class G{constructor(v,z,K,lt,mt){l(this,ie);l(this,Rt,new Map);l(this,Pt,new Map);l(this,qt,new Map);l(this,Kt,null);this.messageHandler=v,this.loadingTask=z,this.commonObjs=new ot,this.fontLoader=new k.FontLoader({ownerDocument:lt.ownerDocument,styleElement:lt.styleElement}),this._params=lt,this.canvasFactory=mt.canvasFactory,this.filterFactory=mt.filterFactory,this.cMapReaderFactory=mt.cMapReaderFactory,this.standardFontDataFactory=mt.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=K,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return(0,f.shadow)(this,"annotationStorage",new T.AnnotationStorage)}getRenderingIntent(v,z=f.AnnotationMode.ENABLE,K=null,lt=!1){let mt=f.RenderingIntentFlag.DISPLAY,Mt=T.SerializableEmpty;switch(v){case"any":mt=f.RenderingIntentFlag.ANY;break;case"display":break;case"print":mt=f.RenderingIntentFlag.PRINT;break;default:(0,f.warn)(`getRenderingIntent - invalid intent: ${v}`)}switch(z){case f.AnnotationMode.DISABLE:mt+=f.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case f.AnnotationMode.ENABLE:break;case f.AnnotationMode.ENABLE_FORMS:mt+=f.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case f.AnnotationMode.ENABLE_STORAGE:mt+=f.RenderingIntentFlag.ANNOTATIONS_STORAGE,Mt=(mt&f.RenderingIntentFlag.PRINT&&K instanceof T.PrintAnnotationStorage?K:this.annotationStorage).serializable;break;default:(0,f.warn)(`getRenderingIntent - invalid annotationMode: ${z}`)}return lt&&(mt+=f.RenderingIntentFlag.OPLIST),{renderingIntent:mt,cacheKey:`${mt}_${Mt.hash}`,annotationStorageSerializable:Mt}}destroy(){var K;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(K=t(this,Kt))==null||K.reject(new Error("Worker was destroyed during onPassword callback"));const v=[];for(const lt of t(this,Pt).values())v.push(lt._destroy());t(this,Pt).clear(),t(this,qt).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const z=this.messageHandler.sendWithPromise("Terminate",null);return v.push(z),Promise.all(v).then(()=>{var lt;this.commonObjs.clear(),this.fontLoader.clear(),t(this,Rt).clear(),this.filterFactory.destroy(),(0,H.cleanupTextLayer)(),(lt=this._networkStream)==null||lt.cancelAllRequests(new f.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:v,loadingTask:z}=this;v.on("GetReader",(K,lt)=>{(0,f.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=mt=>{this._lastProgress={loaded:mt.loaded,total:mt.total}},lt.onPull=()=>{this._fullReader.read().then(function({value:mt,done:Mt}){if(Mt){lt.close();return}(0,f.assert)(mt instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),lt.enqueue(new Uint8Array(mt),1,[mt])}).catch(mt=>{lt.error(mt)})},lt.onCancel=mt=>{this._fullReader.cancel(mt),lt.ready.catch(Mt=>{if(!this.destroyed)throw Mt})}}),v.on("ReaderHeadersReady",K=>{const lt=Promise.withResolvers(),mt=this._fullReader;return mt.headersReady.then(()=>{var Mt;(!mt.isStreamingSupported||!mt.isRangeSupported)&&(this._lastProgress&&((Mt=z.onProgress)==null||Mt.call(z,this._lastProgress)),mt.onProgress=Dt=>{var te;(te=z.onProgress)==null||te.call(z,{loaded:Dt.loaded,total:Dt.total})}),lt.resolve({isStreamingSupported:mt.isStreamingSupported,isRangeSupported:mt.isRangeSupported,contentLength:mt.contentLength})},lt.reject),lt.promise}),v.on("GetRangeReader",(K,lt)=>{(0,f.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const mt=this._networkStream.getRangeReader(K.begin,K.end);if(!mt){lt.close();return}lt.onPull=()=>{mt.read().then(function({value:Mt,done:Dt}){if(Dt){lt.close();return}(0,f.assert)(Mt instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),lt.enqueue(new Uint8Array(Mt),1,[Mt])}).catch(Mt=>{lt.error(Mt)})},lt.onCancel=Mt=>{mt.cancel(Mt),lt.ready.catch(Dt=>{if(!this.destroyed)throw Dt})}}),v.on("GetDoc",({pdfInfo:K})=>{this._numPages=K.numPages,this._htmlForXfa=K.htmlForXfa,delete K.htmlForXfa,z._capability.resolve(new d(K,this))}),v.on("DocException",function(K){let lt;switch(K.name){case"PasswordException":lt=new f.PasswordException(K.message,K.code);break;case"InvalidPDFException":lt=new f.InvalidPDFException(K.message);break;case"MissingPDFException":lt=new f.MissingPDFException(K.message);break;case"UnexpectedResponseException":lt=new f.UnexpectedResponseException(K.message,K.status);break;case"UnknownErrorException":lt=new f.UnknownErrorException(K.message,K.details);break;default:(0,f.unreachable)("DocException - expected a valid Error.")}z._capability.reject(lt)}),v.on("PasswordRequest",K=>{if(I(this,Kt,Promise.withResolvers()),z.onPassword){const lt=mt=>{mt instanceof Error?t(this,Kt).reject(mt):t(this,Kt).resolve({password:mt})};try{z.onPassword(lt,K.code)}catch(mt){t(this,Kt).reject(mt)}}else t(this,Kt).reject(new f.PasswordException(K.message,K.code));return t(this,Kt).promise}),v.on("DataLoaded",K=>{var lt;(lt=z.onProgress)==null||lt.call(z,{loaded:K.length,total:K.length}),this.downloadInfoCapability.resolve(K)}),v.on("StartRenderPage",K=>{this.destroyed||t(this,Pt).get(K.pageIndex)._startRenderPage(K.transparency,K.cacheKey)}),v.on("commonobj",([K,lt,mt])=>{var Mt;if(this.destroyed||this.commonObjs.has(K))return null;switch(lt){case"Font":const Dt=this._params;if("error"in mt){const Me=mt.error;(0,f.warn)(`Error during font loading: ${Me}`),this.commonObjs.resolve(K,Me);break}const te=Dt.pdfBug&&((Mt=globalThis.FontInspector)!=null&&Mt.enabled)?(Me,_e)=>globalThis.FontInspector.fontAdded(Me,_e):null,re=new k.FontFaceObject(mt,{isEvalSupported:Dt.isEvalSupported,disableFontFace:Dt.disableFontFace,ignoreErrors:Dt.ignoreErrors,inspectFont:te});this.fontLoader.bind(re).catch(()=>v.sendWithPromise("FontFallback",{id:K})).finally(()=>{!Dt.fontExtraProperties&&re.data&&(re.data=null),this.commonObjs.resolve(K,re)});break;case"CopyLocalImage":const{imageRef:he}=mt;(0,f.assert)(he,"The imageRef must be defined.");for(const Me of t(this,Pt).values())for(const[,_e]of Me.objs)if(_e.ref===he)return _e.dataLen?(this.commonObjs.resolve(K,structuredClone(_e)),_e.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(K,mt);break;default:throw new Error(`Got unknown common object type ${lt}`)}return null}),v.on("obj",([K,lt,mt,Mt])=>{var te;if(this.destroyed)return;const Dt=t(this,Pt).get(lt);if(!Dt.objs.has(K)){if(Dt._intentStates.size===0){(te=Mt==null?void 0:Mt.bitmap)==null||te.close();return}switch(mt){case"Image":Dt.objs.resolve(K,Mt),(Mt==null?void 0:Mt.dataLen)>f.MAX_IMAGE_SIZE_TO_CACHE&&(Dt._maybeCleanupAfterRender=!0);break;case"Pattern":Dt.objs.resolve(K,Mt);break;default:throw new Error(`Got unknown object type ${mt}`)}}}),v.on("DocProgress",K=>{var lt;this.destroyed||((lt=z.onProgress)==null||lt.call(z,{loaded:K.loaded,total:K.total}))}),v.on("FetchBuiltInCMap",K=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(K):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),v.on("FetchStandardFontData",K=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(K):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var K;this.annotationStorage.size<=0&&(0,f.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:v,transfer:z}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:v,filename:((K=this._fullReader)==null?void 0:K.filename)??null},z).finally(()=>{this.annotationStorage.resetModified()})}getPage(v){if(!Number.isInteger(v)||v<=0||v>this._numPages)return Promise.reject(new Error("Invalid page request."));const z=v-1,K=t(this,qt).get(z);if(K)return K;const lt=this.messageHandler.sendWithPromise("GetPage",{pageIndex:z}).then(mt=>{if(this.destroyed)throw new Error("Transport destroyed");const Mt=new a(z,mt,this,this._params.pdfBug);return t(this,Pt).set(z,Mt),Mt});return t(this,qt).set(z,lt),lt}getPageIndex(v){return typeof v!="object"||v===null||!Number.isInteger(v.num)||v.num<0||!Number.isInteger(v.gen)||v.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:v.num,gen:v.gen})}getAnnotations(v,z){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:v,intent:z})}getFieldObjects(){return C(this,ie,Ai).call(this,"GetFieldObjects")}hasJSActions(){return C(this,ie,Ai).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(v){return typeof v!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:v})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return C(this,ie,Ai).call(this,"GetDocJSActions")}getPageJSActions(v){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:v})}getStructTree(v){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:v})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(v){return C(this,ie,Ai).call(this,"GetOptionalContentConfig").then(z=>new N.OptionalContentConfig(z,v))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const v="GetMetadata",z=t(this,Rt).get(v);if(z)return z;const K=this.messageHandler.sendWithPromise(v,null).then(lt=>{var mt,Mt;return{info:lt[0],metadata:lt[1]?new F.Metadata(lt[1]):null,contentDispositionFilename:((mt=this._fullReader)==null?void 0:mt.filename)??null,contentLength:((Mt=this._fullReader)==null?void 0:Mt.contentLength)??null}});return t(this,Rt).set(v,K),K}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(v=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const z of t(this,Pt).values())if(!z.cleanup())throw new Error(`startCleanup: Page ${z.pageNumber} is currently rendering.`);this.commonObjs.clear(),v||this.fontLoader.clear(),t(this,Rt).clear(),this.filterFactory.destroy(!0),(0,H.cleanupTextLayer)()}}get loadingParams(){const{disableAutoFetch:v,enableXfa:z}=this._params;return(0,f.shadow)(this,"loadingParams",{disableAutoFetch:v,enableXfa:z})}}Rt=new WeakMap,Pt=new WeakMap,qt=new WeakMap,Kt=new WeakMap,ie=new WeakSet,Ai=function(v,z=null){const K=t(this,Rt).get(v);if(K)return K;const lt=this.messageHandler.sendWithPromise(v,z);return t(this,Rt).set(v,lt),lt};const at=Symbol("INITIAL_DATA");class ot{constructor(){l(this,le);l(this,de,Object.create(null))}get(v,z=null){if(z){const lt=C(this,le,Pn).call(this,v);return lt.promise.then(()=>z(lt.data)),null}const K=t(this,de)[v];if(!K||K.data===at)throw new Error(`Requesting object that isn't resolved yet ${v}.`);return K.data}has(v){const z=t(this,de)[v];return!!z&&z.data!==at}resolve(v,z=null){const K=C(this,le,Pn).call(this,v);K.data=z,K.resolve()}clear(){var v;for(const z in t(this,de)){const{data:K}=t(this,de)[z];(v=K==null?void 0:K.bitmap)==null||v.close()}I(this,de,Object.create(null))}*[Symbol.iterator](){for(const v in t(this,de)){const{data:z}=t(this,de)[v];z!==at&&(yield[v,z])}}}de=new WeakMap,le=new WeakSet,Pn=function(v){var z;return(z=t(this,de))[v]||(z[v]={...Promise.withResolvers(),data:at})};class yt{constructor(v){l(this,jt,null);I(this,jt,v),this.onContinue=null}get promise(){return t(this,jt).capability.promise}cancel(v=0){t(this,jt).cancel(null,v)}get separateAnnots(){const{separateAnnots:v}=t(this,jt).operatorList;if(!v)return!1;const{annotationCanvasMap:z}=t(this,jt);return v.form||v.canvas&&(z==null?void 0:z.size)>0}}jt=new WeakMap;const nt=class nt{constructor({callback:v,params:z,objs:K,commonObjs:lt,annotationCanvasMap:mt,operatorList:Mt,pageIndex:Dt,canvasFactory:te,filterFactory:re,useRequestAnimationFrame:he=!1,pdfBug:Me=!1,pageColors:_e=null}){this.callback=v,this.params=z,this.objs=K,this.commonObjs=lt,this.annotationCanvasMap=mt,this.operatorListIdx=null,this.operatorList=Mt,this._pageIndex=Dt,this.canvasFactory=te,this.filterFactory=re,this._pdfBug=Me,this.pageColors=_e,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=he===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new yt(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=z.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:v=!1,optionalContentConfig:z}){var Dt,te;if(this.cancelled)return;if(this._canvas){if(t(nt,ae).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(nt,ae).add(this._canvas)}this._pdfBug&&((Dt=globalThis.StepperManager)!=null&&Dt.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:K,viewport:lt,transform:mt,background:Mt}=this.params;this.gfx=new g.CanvasGraphics(K,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:z},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:mt,viewport:lt,transparency:v,background:Mt}),this.operatorListIdx=0,this.graphicsReady=!0,(te=this.graphicsReadyCallback)==null||te.call(this)}cancel(v=null,z=0){var K;this.running=!1,this.cancelled=!0,(K=this.gfx)==null||K.endDrawing(),t(nt,ae).delete(this._canvas),this.callback(v||new W.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,z))}operatorListChanged(){var v;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(v=this.stepper)==null||v.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(nt,ae).delete(this._canvas),this.callback())))}};ae=new WeakMap,l(nt,ae,new WeakSet);let At=nt;const ut="4.1.392",xt="fcb76a78d";w()}catch(Ce){w(Ce)}})},583:(r,m,u)=>{u.d(m,{BaseCMapReaderFactory:()=>T,BaseCanvasFactory:()=>f,BaseFilterFactory:()=>w,BaseSVGFactory:()=>k,BaseStandardFontDataFactory:()=>W});var e=u(292);class w{constructor(){this.constructor===w&&(0,e.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(g){return"none"}addHCMFilter(g,H){return"none"}addHighlightHCMFilter(g,H,S,A,F){return"none"}destroy(g=!1){}}class f{constructor(){this.constructor===f&&(0,e.unreachable)("Cannot initialize BaseCanvasFactory.")}create(g,H){if(g<=0||H<=0)throw new Error("Invalid canvas size");const S=this._createCanvas(g,H);return{canvas:S,context:S.getContext("2d")}}reset(g,H,S){if(!g.canvas)throw new Error("Canvas is not specified");if(H<=0||S<=0)throw new Error("Invalid canvas size");g.canvas.width=H,g.canvas.height=S}destroy(g){if(!g.canvas)throw new Error("Canvas is not specified");g.canvas.width=0,g.canvas.height=0,g.canvas=null,g.context=null}_createCanvas(g,H){(0,e.unreachable)("Abstract method `_createCanvas` called.")}}class T{constructor({baseUrl:g=null,isCompressed:H=!0}){this.constructor===T&&(0,e.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=g,this.isCompressed=H}async fetch({name:g}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!g)throw new Error("CMap name must be specified.");const H=this.baseUrl+g+(this.isCompressed?".bcmap":""),S=this.isCompressed?e.CMapCompressionType.BINARY:e.CMapCompressionType.NONE;return this._fetchData(H,S).catch(A=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${H}`)})}_fetchData(g,H){(0,e.unreachable)("Abstract method `_fetchData` called.")}}class W{constructor({baseUrl:g=null}){this.constructor===W&&(0,e.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=g}async fetch({filename:g}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!g)throw new Error("Font filename must be specified.");const H=`${this.baseUrl}${g}`;return this._fetchData(H).catch(S=>{throw new Error(`Unable to load font data at: ${H}`)})}_fetchData(g){(0,e.unreachable)("Abstract method `_fetchData` called.")}}class k{constructor(){this.constructor===k&&(0,e.unreachable)("Cannot initialize BaseSVGFactory.")}create(g,H,S=!1){if(g<=0||H<=0)throw new Error("Invalid SVG dimensions");const A=this._createSVG("svg:svg");return A.setAttribute("version","1.1"),S||(A.setAttribute("width",`${g}px`),A.setAttribute("height",`${H}px`)),A.setAttribute("preserveAspectRatio","none"),A.setAttribute("viewBox",`0 0 ${g} ${H}`),A}createElement(g){if(typeof g!="string")throw new Error("Invalid SVG element type");return this._createSVG(g)}_createSVG(g){(0,e.unreachable)("Abstract method `_createSVG` called.")}}},923:(r,m,u)=>{var ae,In,ee,Fn;u.d(m,{CanvasGraphics:()=>ve});var e=u(292),w=u(419);const f={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function T(et,i){if(!i)return;const n=i[2]-i[0],c=i[3]-i[1],p=new Path2D;p.rect(i[0],i[1],n,c),et.clip(p)}class W{constructor(){this.constructor===W&&(0,e.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,e.unreachable)("Abstract method `getPattern` called.")}}class k extends W{constructor(i){super(),this._type=i[1],this._bbox=i[2],this._colorStops=i[3],this._p0=i[4],this._p1=i[5],this._r0=i[6],this._r1=i[7],this.matrix=null}_createGradient(i){let n;this._type==="axial"?n=i.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(n=i.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const c of this._colorStops)n.addColorStop(c[0],c[1]);return n}getPattern(i,n,c,p){let o;if(p===f.STROKE||p===f.FILL){const y=n.current.getClippedPathBoundingBox(p,(0,w.getCurrentTransform)(i))||[0,0,0,0],b=Math.ceil(y[2]-y[0])||1,E=Math.ceil(y[3]-y[1])||1,d=n.cachedCanvases.getCanvas("pattern",b,E,!0),a=d.context;a.clearRect(0,0,a.canvas.width,a.canvas.height),a.beginPath(),a.rect(0,0,a.canvas.width,a.canvas.height),a.translate(-y[0],-y[1]),c=e.Util.transform(c,[1,0,0,1,y[0],y[1]]),a.transform(...n.baseTransform),this.matrix&&a.transform(...this.matrix),T(a,this._bbox),a.fillStyle=this._createGradient(a),a.fill(),o=i.createPattern(d.canvas,"no-repeat");const h=new DOMMatrix(c);o.setTransform(h)}else T(i,this._bbox),o=this._createGradient(i);return o}}function _(et,i,n,c,p,o,y,b){const E=i.coords,d=i.colors,a=et.data,h=et.width*4;let R;E[n+1]>E[c+1]&&(R=n,n=c,c=R,R=o,o=y,y=R),E[c+1]>E[p+1]&&(R=c,c=p,p=R,R=y,y=b,b=R),E[n+1]>E[c+1]&&(R=n,n=c,c=R,R=o,o=y,y=R);const V=(E[n]+i.offsetX)*i.scaleX,G=(E[n+1]+i.offsetY)*i.scaleY,at=(E[c]+i.offsetX)*i.scaleX,ot=(E[c+1]+i.offsetY)*i.scaleY,yt=(E[p]+i.offsetX)*i.scaleX,At=(E[p+1]+i.offsetY)*i.scaleY;if(G>=At)return;const ut=d[o],xt=d[o+1],P=d[o+2],Y=d[y],nt=d[y+1],U=d[y+2],v=d[b],z=d[b+1],K=d[b+2],lt=Math.round(G),mt=Math.round(At);let Mt,Dt,te,re,he,Me,_e,Fe;for(let me=lt;me<=mt;me++){if(me<ot){const Q=me<G?0:(G-me)/(G-ot);Mt=V-(V-at)*Q,Dt=ut-(ut-Y)*Q,te=xt-(xt-nt)*Q,re=P-(P-U)*Q}else{let Q;me>At?Q=1:ot===At?Q=0:Q=(ot-me)/(ot-At),Mt=at-(at-yt)*Q,Dt=Y-(Y-v)*Q,te=nt-(nt-z)*Q,re=U-(U-K)*Q}let ke;me<G?ke=0:me>At?ke=1:ke=(G-me)/(G-At),he=V-(V-yt)*ke,Me=ut-(ut-v)*ke,_e=xt-(xt-z)*ke,Fe=P-(P-K)*ke;const se=Math.round(Math.min(Mt,he)),D=Math.round(Math.max(Mt,he));let x=h*me+se*4;for(let Q=se;Q<=D;Q++)ke=(Mt-Q)/(Mt-he),ke<0?ke=0:ke>1&&(ke=1),a[x++]=Dt-(Dt-Me)*ke|0,a[x++]=te-(te-_e)*ke|0,a[x++]=re-(re-Fe)*ke|0,a[x++]=255}}function g(et,i,n){const c=i.coords,p=i.colors;let o,y;switch(i.type){case"lattice":const b=i.verticesPerRow,E=Math.floor(c.length/b)-1,d=b-1;for(o=0;o<E;o++){let a=o*b;for(let h=0;h<d;h++,a++)_(et,n,c[a],c[a+1],c[a+b],p[a],p[a+1],p[a+b]),_(et,n,c[a+b+1],c[a+1],c[a+b],p[a+b+1],p[a+1],p[a+b])}break;case"triangles":for(o=0,y=c.length;o<y;o+=3)_(et,n,c[o],c[o+1],c[o+2],p[o],p[o+1],p[o+2]);break;default:throw new Error("illegal figure")}}class H extends W{constructor(i){super(),this._coords=i[2],this._colors=i[3],this._figures=i[4],this._bounds=i[5],this._bbox=i[7],this._background=i[8],this.matrix=null}_createMeshCanvas(i,n,c){const p=Math.floor(this._bounds[0]),o=Math.floor(this._bounds[1]),y=Math.ceil(this._bounds[2])-p,b=Math.ceil(this._bounds[3])-o,E=Math.min(Math.ceil(Math.abs(y*i[0]*1.1)),3e3),d=Math.min(Math.ceil(Math.abs(b*i[1]*1.1)),3e3),a=y/E,h=b/d,R={coords:this._coords,colors:this._colors,offsetX:-p,offsetY:-o,scaleX:1/a,scaleY:1/h},V=E+2*2,G=d+2*2,at=c.getCanvas("mesh",V,G,!1),ot=at.context,yt=ot.createImageData(E,d);if(n){const At=yt.data;for(let ut=0,xt=At.length;ut<xt;ut+=4)At[ut]=n[0],At[ut+1]=n[1],At[ut+2]=n[2],At[ut+3]=255}for(const At of this._figures)g(yt,At,R);return ot.putImageData(yt,2,2),{canvas:at.canvas,offsetX:p-2*a,offsetY:o-2*h,scaleX:a,scaleY:h}}getPattern(i,n,c,p){T(i,this._bbox);let o;if(p===f.SHADING)o=e.Util.singularValueDecompose2dScale((0,w.getCurrentTransform)(i));else if(o=e.Util.singularValueDecompose2dScale(n.baseTransform),this.matrix){const b=e.Util.singularValueDecompose2dScale(this.matrix);o=[o[0]*b[0],o[1]*b[1]]}const y=this._createMeshCanvas(o,p===f.SHADING?null:this._background,n.cachedCanvases);return p!==f.SHADING&&(i.setTransform(...n.baseTransform),this.matrix&&i.transform(...this.matrix)),i.translate(y.offsetX,y.offsetY),i.scale(y.scaleX,y.scaleY),i.createPattern(y.canvas,"no-repeat")}}class S extends W{getPattern(){return"hotpink"}}function A(et){switch(et[0]){case"RadialAxial":return new k(et);case"Mesh":return new H(et);case"Dummy":return new S}throw new Error(`Unknown IR type: ${et[0]}`)}const F={COLORED:1,UNCOLORED:2},jt=class jt{constructor(i,n,c,p,o){this.operatorList=i[2],this.matrix=i[3]||[1,0,0,1,0,0],this.bbox=i[4],this.xstep=i[5],this.ystep=i[6],this.paintType=i[7],this.tilingType=i[8],this.color=n,this.ctx=c,this.canvasGraphicsFactory=p,this.baseTransform=o}createPatternCanvas(i){const n=this.operatorList,c=this.bbox,p=this.xstep,o=this.ystep,y=this.paintType,b=this.tilingType,E=this.color,d=this.canvasGraphicsFactory;(0,e.info)("TilingType: "+b);const a=c[0],h=c[1],R=c[2],V=c[3],G=e.Util.singularValueDecompose2dScale(this.matrix),at=e.Util.singularValueDecompose2dScale(this.baseTransform),ot=[G[0]*at[0],G[1]*at[1]],yt=this.getSizeAndScale(p,this.ctx.canvas.width,ot[0]),At=this.getSizeAndScale(o,this.ctx.canvas.height,ot[1]),ut=i.cachedCanvases.getCanvas("pattern",yt.size,At.size,!0),xt=ut.context,P=d.createCanvasGraphics(xt);P.groupLevel=i.groupLevel,this.setFillAndStrokeStyleToContext(P,y,E);let Y=a,nt=h,U=R,v=V;return a<0&&(Y=0,U+=Math.abs(a)),h<0&&(nt=0,v+=Math.abs(h)),xt.translate(-(yt.scale*Y),-(At.scale*nt)),P.transform(yt.scale,0,0,At.scale,0,0),xt.save(),this.clipBbox(P,Y,nt,U,v),P.baseTransform=(0,w.getCurrentTransform)(P.ctx),P.executeOperatorList(n),P.endDrawing(),{canvas:ut.canvas,scaleX:yt.scale,scaleY:At.scale,offsetX:Y,offsetY:nt}}getSizeAndScale(i,n,c){i=Math.abs(i);const p=Math.max(jt.MAX_PATTERN_SIZE,n);let o=Math.ceil(i*c);return o>=p?o=p:c=o/i,{scale:c,size:o}}clipBbox(i,n,c,p,o){const y=p-n,b=o-c;i.ctx.rect(n,c,y,b),i.current.updateRectMinMax((0,w.getCurrentTransform)(i.ctx),[n,c,p,o]),i.clip(),i.endPath()}setFillAndStrokeStyleToContext(i,n,c){const p=i.ctx,o=i.current;switch(n){case F.COLORED:const y=this.ctx;p.fillStyle=y.fillStyle,p.strokeStyle=y.strokeStyle,o.fillColor=y.fillStyle,o.strokeColor=y.strokeStyle;break;case F.UNCOLORED:const b=e.Util.makeHexColor(c[0],c[1],c[2]);p.fillStyle=b,p.strokeStyle=b,o.fillColor=b,o.strokeColor=b;break;default:throw new e.FormatError(`Unsupported paint type: ${n}`)}}getPattern(i,n,c,p){let o=c;p!==f.SHADING&&(o=e.Util.transform(o,n.baseTransform),this.matrix&&(o=e.Util.transform(o,this.matrix)));const y=this.createPatternCanvas(n);let b=new DOMMatrix(o);b=b.translate(y.offsetX,y.offsetY),b=b.scale(1/y.scaleX,1/y.scaleY);const E=i.createPattern(y.canvas,"repeat");return E.setTransform(b),E}};fe(jt,"MAX_PATTERN_SIZE",3e3);let N=jt;function X({src:et,srcPos:i=0,dest:n,width:c,height:p,nonBlackColor:o=4294967295,inverseDecode:y=!1}){const b=e.FeatureTest.isLittleEndian?4278190080:255,[E,d]=y?[o,b]:[b,o],a=c>>3,h=c&7,R=et.length;n=new Uint32Array(n.buffer);let V=0;for(let G=0;G<p;G++){for(const ot=i+a;i<ot;i++){const yt=i<R?et[i]:255;n[V++]=yt&128?d:E,n[V++]=yt&64?d:E,n[V++]=yt&32?d:E,n[V++]=yt&16?d:E,n[V++]=yt&8?d:E,n[V++]=yt&4?d:E,n[V++]=yt&2?d:E,n[V++]=yt&1?d:E}if(h===0)continue;const at=i<R?et[i++]:255;for(let ot=0;ot<h;ot++)n[V++]=at&1<<7-ot?d:E}return{srcPos:i,destPos:V}}const rt=16,J=100,M=4096,j=15,$=10,O=1e3,q=16;function tt(et,i){if(et._removeMirroring)throw new Error("Context is already forwarding operations.");et.__originalSave=et.save,et.__originalRestore=et.restore,et.__originalRotate=et.rotate,et.__originalScale=et.scale,et.__originalTranslate=et.translate,et.__originalTransform=et.transform,et.__originalSetTransform=et.setTransform,et.__originalResetTransform=et.resetTransform,et.__originalClip=et.clip,et.__originalMoveTo=et.moveTo,et.__originalLineTo=et.lineTo,et.__originalBezierCurveTo=et.bezierCurveTo,et.__originalRect=et.rect,et.__originalClosePath=et.closePath,et.__originalBeginPath=et.beginPath,et._removeMirroring=()=>{et.save=et.__originalSave,et.restore=et.__originalRestore,et.rotate=et.__originalRotate,et.scale=et.__originalScale,et.translate=et.__originalTranslate,et.transform=et.__originalTransform,et.setTransform=et.__originalSetTransform,et.resetTransform=et.__originalResetTransform,et.clip=et.__originalClip,et.moveTo=et.__originalMoveTo,et.lineTo=et.__originalLineTo,et.bezierCurveTo=et.__originalBezierCurveTo,et.rect=et.__originalRect,et.closePath=et.__originalClosePath,et.beginPath=et.__originalBeginPath,delete et._removeMirroring},et.save=function(){i.save(),this.__originalSave()},et.restore=function(){i.restore(),this.__originalRestore()},et.translate=function(n,c){i.translate(n,c),this.__originalTranslate(n,c)},et.scale=function(n,c){i.scale(n,c),this.__originalScale(n,c)},et.transform=function(n,c,p,o,y,b){i.transform(n,c,p,o,y,b),this.__originalTransform(n,c,p,o,y,b)},et.setTransform=function(n,c,p,o,y,b){i.setTransform(n,c,p,o,y,b),this.__originalSetTransform(n,c,p,o,y,b)},et.resetTransform=function(){i.resetTransform(),this.__originalResetTransform()},et.rotate=function(n){i.rotate(n),this.__originalRotate(n)},et.clip=function(n){i.clip(n),this.__originalClip(n)},et.moveTo=function(n,c){i.moveTo(n,c),this.__originalMoveTo(n,c)},et.lineTo=function(n,c){i.lineTo(n,c),this.__originalLineTo(n,c)},et.bezierCurveTo=function(n,c,p,o,y,b){i.bezierCurveTo(n,c,p,o,y,b),this.__originalBezierCurveTo(n,c,p,o,y,b)},et.rect=function(n,c,p,o){i.rect(n,c,p,o),this.__originalRect(n,c,p,o)},et.closePath=function(){i.closePath(),this.__originalClosePath()},et.beginPath=function(){i.beginPath(),this.__originalBeginPath()}}class vt{constructor(i){this.canvasFactory=i,this.cache=Object.create(null)}getCanvas(i,n,c){let p;return this.cache[i]!==void 0?(p=this.cache[i],this.canvasFactory.reset(p,n,c)):(p=this.canvasFactory.create(n,c),this.cache[i]=p),p}delete(i){delete this.cache[i]}clear(){for(const i in this.cache){const n=this.cache[i];this.canvasFactory.destroy(n),delete this.cache[i]}}}function Ft(et,i,n,c,p,o,y,b,E,d){const[a,h,R,V,G,at]=(0,w.getCurrentTransform)(et);if(h===0&&R===0){const At=y*a+G,ut=Math.round(At),xt=b*V+at,P=Math.round(xt),Y=(y+E)*a+G,nt=Math.abs(Math.round(Y)-ut)||1,U=(b+d)*V+at,v=Math.abs(Math.round(U)-P)||1;return et.setTransform(Math.sign(a),0,0,Math.sign(V),ut,P),et.drawImage(i,n,c,p,o,0,0,nt,v),et.setTransform(a,h,R,V,G,at),[nt,v]}if(a===0&&V===0){const At=b*R+G,ut=Math.round(At),xt=y*h+at,P=Math.round(xt),Y=(b+d)*R+G,nt=Math.abs(Math.round(Y)-ut)||1,U=(y+E)*h+at,v=Math.abs(Math.round(U)-P)||1;return et.setTransform(0,Math.sign(h),Math.sign(R),0,ut,P),et.drawImage(i,n,c,p,o,0,0,v,nt),et.setTransform(a,h,R,V,G,at),[v,nt]}et.drawImage(i,n,c,p,o,y,b,E,d);const ot=Math.hypot(a,h),yt=Math.hypot(R,V);return[ot*E,yt*d]}function Ct(et){const{width:i,height:n}=et;if(i>O||n>O)return null;const c=1e3,p=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),o=i+1;let y=new Uint8Array(o*(n+1)),b,E,d;const a=i+7&-8;let h=new Uint8Array(a*n),R=0;for(const ot of et.data){let yt=128;for(;yt>0;)h[R++]=ot&yt?0:255,yt>>=1}let V=0;for(R=0,h[R]!==0&&(y[0]=1,++V),E=1;E<i;E++)h[R]!==h[R+1]&&(y[E]=h[R]?2:1,++V),R++;for(h[R]!==0&&(y[E]=2,++V),b=1;b<n;b++){R=b*a,d=b*o,h[R-a]!==h[R]&&(y[d]=h[R]?1:8,++V);let ot=(h[R]?4:0)+(h[R-a]?8:0);for(E=1;E<i;E++)ot=(ot>>2)+(h[R+1]?4:0)+(h[R-a+1]?8:0),p[ot]&&(y[d+E]=p[ot],++V),R++;if(h[R-a]!==h[R]&&(y[d+E]=h[R]?2:4,++V),V>c)return null}for(R=a*(n-1),d=b*o,h[R]!==0&&(y[d]=8,++V),E=1;E<i;E++)h[R]!==h[R+1]&&(y[d+E]=h[R]?4:8,++V),R++;if(h[R]!==0&&(y[d+E]=4,++V),V>c)return null;const G=new Int32Array([0,o,-1,0,-o,0,0,0,1]),at=new Path2D;for(b=0;V&&b<=n;b++){let ot=b*o;const yt=ot+i;for(;ot<yt&&!y[ot];)ot++;if(ot===yt)continue;at.moveTo(ot%o,b);const At=ot;let ut=y[ot];do{const xt=G[ut];do ot+=xt;while(!y[ot]);const P=y[ot];P!==5&&P!==10?(ut=P,y[ot]=0):(ut=P&51*ut>>4,y[ot]&=ut>>2|ut<<2),at.lineTo(ot%o,ot/o|0),y[ot]||--V}while(At!==ot);--b}return h=null,y=null,function(ot){ot.save(),ot.scale(1/i,-1/n),ot.translate(0,-n),ot.fill(at),ot.beginPath(),ot.restore()}}class Ot{constructor(i,n){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=e.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=e.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=e.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,i,n])}clone(){const i=Object.create(this);return i.clipBox=this.clipBox.slice(),i}setCurrentPoint(i,n){this.x=i,this.y=n}updatePathMinMax(i,n,c){[n,c]=e.Util.applyTransform([n,c],i),this.minX=Math.min(this.minX,n),this.minY=Math.min(this.minY,c),this.maxX=Math.max(this.maxX,n),this.maxY=Math.max(this.maxY,c)}updateRectMinMax(i,n){const c=e.Util.applyTransform(n,i),p=e.Util.applyTransform(n.slice(2),i),o=e.Util.applyTransform([n[0],n[3]],i),y=e.Util.applyTransform([n[2],n[1]],i);this.minX=Math.min(this.minX,c[0],p[0],o[0],y[0]),this.minY=Math.min(this.minY,c[1],p[1],o[1],y[1]),this.maxX=Math.max(this.maxX,c[0],p[0],o[0],y[0]),this.maxY=Math.max(this.maxY,c[1],p[1],o[1],y[1])}updateScalingPathMinMax(i,n){e.Util.scaleMinMax(i,n),this.minX=Math.min(this.minX,n[0]),this.minY=Math.min(this.minY,n[1]),this.maxX=Math.max(this.maxX,n[2]),this.maxY=Math.max(this.maxY,n[3])}updateCurvePathMinMax(i,n,c,p,o,y,b,E,d,a){const h=e.Util.bezierBoundingBox(n,c,p,o,y,b,E,d,a);a||this.updateRectMinMax(i,h)}getPathBoundingBox(i=f.FILL,n=null){const c=[this.minX,this.minY,this.maxX,this.maxY];if(i===f.STROKE){n||(0,e.unreachable)("Stroke bounding box must include transform.");const p=e.Util.singularValueDecompose2dScale(n),o=p[0]*this.lineWidth/2,y=p[1]*this.lineWidth/2;c[0]-=o,c[1]-=y,c[2]+=o,c[3]+=y}return c}updateClipFromPath(){const i=e.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(i||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(i){this.clipBox=i,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(i=f.FILL,n=null){return e.Util.intersect(this.clipBox,this.getPathBoundingBox(i,n))}}function _t(et,i){if(typeof ImageData<"u"&&i instanceof ImageData){et.putImageData(i,0,0);return}const n=i.height,c=i.width,p=n%q,o=(n-p)/q,y=p===0?o:o+1,b=et.createImageData(c,q);let E=0,d;const a=i.data,h=b.data;let R,V,G,at;if(i.kind===e.ImageKind.GRAYSCALE_1BPP){const ot=a.byteLength,yt=new Uint32Array(h.buffer,0,h.byteLength>>2),At=yt.length,ut=c+7>>3,xt=4294967295,P=e.FeatureTest.isLittleEndian?4278190080:255;for(R=0;R<y;R++){for(G=R<o?q:p,d=0,V=0;V<G;V++){const Y=ot-E;let nt=0;const U=Y>ut?c:Y*8-7,v=U&-8;let z=0,K=0;for(;nt<v;nt+=8)K=a[E++],yt[d++]=K&128?xt:P,yt[d++]=K&64?xt:P,yt[d++]=K&32?xt:P,yt[d++]=K&16?xt:P,yt[d++]=K&8?xt:P,yt[d++]=K&4?xt:P,yt[d++]=K&2?xt:P,yt[d++]=K&1?xt:P;for(;nt<U;nt++)z===0&&(K=a[E++],z=128),yt[d++]=K&z?xt:P,z>>=1}for(;d<At;)yt[d++]=0;et.putImageData(b,0,R*q)}}else if(i.kind===e.ImageKind.RGBA_32BPP){for(V=0,at=c*q*4,R=0;R<o;R++)h.set(a.subarray(E,E+at)),E+=at,et.putImageData(b,0,V),V+=q;R<y&&(at=c*p*4,h.set(a.subarray(E,E+at)),et.putImageData(b,0,V))}else if(i.kind===e.ImageKind.RGB_24BPP)for(G=q,at=c*G,R=0;R<y;R++){for(R>=o&&(G=p,at=c*G),d=0,V=at;V--;)h[d++]=a[E++],h[d++]=a[E++],h[d++]=a[E++],h[d++]=255;et.putImageData(b,0,R*q)}else throw new Error(`bad image kind: ${i.kind}`)}function Lt(et,i){if(i.bitmap){et.drawImage(i.bitmap,0,0);return}const n=i.height,c=i.width,p=n%q,o=(n-p)/q,y=p===0?o:o+1,b=et.createImageData(c,q);let E=0;const d=i.data,a=b.data;for(let h=0;h<y;h++){const R=h<o?q:p;({srcPos:E}=X({src:d,srcPos:E,dest:a,width:c,height:R,nonBlackColor:0})),et.putImageData(b,0,h*q)}}function kt(et,i){const n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const c of n)et[c]!==void 0&&(i[c]=et[c]);et.setLineDash!==void 0&&(i.setLineDash(et.getLineDash()),i.lineDashOffset=et.lineDashOffset)}function Et(et){if(et.strokeStyle=et.fillStyle="#000000",et.fillRule="nonzero",et.globalAlpha=1,et.lineWidth=1,et.lineCap="butt",et.lineJoin="miter",et.miterLimit=10,et.globalCompositeOperation="source-over",et.font="10px sans-serif",et.setLineDash!==void 0&&(et.setLineDash([]),et.lineDashOffset=0),!e.isNodeJS){const{filter:i}=et;i!=="none"&&i!==""&&(et.filter="none")}}function Z(et,i,n,c){const p=et.length;for(let o=3;o<p;o+=4){const y=et[o];if(y===0)et[o-3]=i,et[o-2]=n,et[o-1]=c;else if(y<255){const b=255-y;et[o-3]=et[o-3]*y+i*b>>8,et[o-2]=et[o-2]*y+n*b>>8,et[o-1]=et[o-1]*y+c*b>>8}}}function gt(et,i,n){const c=et.length,p=1/255;for(let o=3;o<c;o+=4){const y=n?n[et[o]]:et[o];i[o]=i[o]*y*p|0}}function Rt(et,i,n){const c=et.length;for(let p=3;p<c;p+=4){const o=et[p-3]*77+et[p-2]*152+et[p-1]*28;i[p]=n?i[p]*n[o>>8]>>8:i[p]*o>>16}}function Pt(et,i,n,c,p,o,y,b,E,d,a){const h=!!o,R=h?o[0]:0,V=h?o[1]:0,G=h?o[2]:0,at=p==="Luminosity"?Rt:gt,ot=Math.min(c,Math.ceil(1048576/n));for(let yt=0;yt<c;yt+=ot){const At=Math.min(ot,c-yt),ut=et.getImageData(b-d,yt+(E-a),n,At),xt=i.getImageData(b,yt+E,n,At);h&&Z(ut.data,R,V,G),at(ut.data,xt.data,y),i.putImageData(xt,b,yt+E)}}function qt(et,i,n,c){const p=c[0],o=c[1],y=c[2]-p,b=c[3]-o;y===0||b===0||(Pt(i.context,n,y,b,i.subtype,i.backdrop,i.transferMap,p,o,i.offsetX,i.offsetY),et.save(),et.globalAlpha=1,et.globalCompositeOperation="source-over",et.setTransform(1,0,0,1,0,0),et.drawImage(n.canvas,0,0),et.restore())}function Kt(et,i){const n=e.Util.singularValueDecompose2dScale(et);n[0]=Math.fround(n[0]),n[1]=Math.fround(n[1]);const c=Math.fround((globalThis.devicePixelRatio||1)*w.PixelsPerInch.PDF_TO_CSS_UNITS);return i!==void 0?i:n[0]<=c||n[1]<=c}const ie=["butt","round","square"],Se=["miter","round","bevel"],de={},le={},ne=class ne{constructor(i,n,c,p,o,{optionalContentConfig:y,markedContentStack:b=null},E,d){l(this,ae);l(this,ee);this.ctx=i,this.current=new Ot(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=n,this.objs=c,this.canvasFactory=p,this.filterFactory=o,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=b||[],this.optionalContentConfig=y,this.cachedCanvases=new vt(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=E,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=d,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(i,n=null){return typeof i=="string"?i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i):n}beginDrawing({transform:i,viewport:n,transparency:c=!1,background:p=null}){const o=this.ctx.canvas.width,y=this.ctx.canvas.height,b=this.ctx.fillStyle;if(this.ctx.fillStyle=p||"#ffffff",this.ctx.fillRect(0,0,o,y),this.ctx.fillStyle=b,c){const E=this.cachedCanvases.getCanvas("transparent",o,y);this.compositeCtx=this.ctx,this.transparentCanvas=E.canvas,this.ctx=E.context,this.ctx.save(),this.ctx.transform(...(0,w.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),Et(this.ctx),i&&(this.ctx.transform(...i),this.outputScaleX=i[0],this.outputScaleY=i[0]),this.ctx.transform(...n.transform),this.viewportScale=n.scale,this.baseTransform=(0,w.getCurrentTransform)(this.ctx)}executeOperatorList(i,n,c,p){const o=i.argsArray,y=i.fnArray;let b=n||0;const E=o.length;if(E===b)return b;const d=E-b>$&&typeof c=="function",a=d?Date.now()+j:0;let h=0;const R=this.commonObjs,V=this.objs;let G;for(;;){if(p!==void 0&&b===p.nextBreakPoint)return p.breakIt(b,c),b;if(G=y[b],G!==e.OPS.dependency)this[G].apply(this,o[b]);else for(const at of o[b]){const ot=at.startsWith("g_")?R:V;if(!ot.has(at))return ot.get(at,c),b}if(b++,b===E)return b;if(d&&++h>$){if(Date.now()>a)return c(),b;h=0}}}endDrawing(){C(this,ae,In).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const i of this._cachedBitmapsMap.values()){for(const n of i.values())typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&(n.width=n.height=0);i.clear()}this._cachedBitmapsMap.clear(),C(this,ee,Fn).call(this)}_scaleImage(i,n){const c=i.width,p=i.height;let o=Math.max(Math.hypot(n[0],n[1]),1),y=Math.max(Math.hypot(n[2],n[3]),1),b=c,E=p,d="prescale1",a,h;for(;o>2&&b>1||y>2&&E>1;){let R=b,V=E;o>2&&b>1&&(R=b>=16384?Math.floor(b/2)-1||1:Math.ceil(b/2),o/=b/R),y>2&&E>1&&(V=E>=16384?Math.floor(E/2)-1||1:Math.ceil(E)/2,y/=E/V),a=this.cachedCanvases.getCanvas(d,R,V),h=a.context,h.clearRect(0,0,R,V),h.drawImage(i,0,0,b,E,0,0,R,V),i=a.canvas,b=R,E=V,d=d==="prescale1"?"prescale2":"prescale1"}return{img:i,paintWidth:b,paintHeight:E}}_createMaskCanvas(i){const n=this.ctx,{width:c,height:p}=i,o=this.current.fillColor,y=this.current.patternFill,b=(0,w.getCurrentTransform)(n);let E,d,a,h;if((i.bitmap||i.data)&&i.count>1){const U=i.bitmap||i.data.buffer;d=JSON.stringify(y?b:[b.slice(0,4),o]),E=this._cachedBitmapsMap.get(U),E||(E=new Map,this._cachedBitmapsMap.set(U,E));const v=E.get(d);if(v&&!y){const z=Math.round(Math.min(b[0],b[2])+b[4]),K=Math.round(Math.min(b[1],b[3])+b[5]);return{canvas:v,offsetX:z,offsetY:K}}a=v}a||(h=this.cachedCanvases.getCanvas("maskCanvas",c,p),Lt(h.context,i));let R=e.Util.transform(b,[1/c,0,0,-1/p,0,0]);R=e.Util.transform(R,[1,0,0,1,0,-p]);const[V,G,at,ot]=e.Util.getAxialAlignedBoundingBox([0,0,c,p],R),yt=Math.round(at-V)||1,At=Math.round(ot-G)||1,ut=this.cachedCanvases.getCanvas("fillCanvas",yt,At),xt=ut.context,P=V,Y=G;xt.translate(-P,-Y),xt.transform(...R),a||(a=this._scaleImage(h.canvas,(0,w.getCurrentTransformInverse)(xt)),a=a.img,E&&y&&E.set(d,a)),xt.imageSmoothingEnabled=Kt((0,w.getCurrentTransform)(xt),i.interpolate),Ft(xt,a,0,0,a.width,a.height,0,0,c,p),xt.globalCompositeOperation="source-in";const nt=e.Util.transform((0,w.getCurrentTransformInverse)(xt),[1,0,0,1,-P,-Y]);return xt.fillStyle=y?o.getPattern(n,this,nt,f.FILL):o,xt.fillRect(0,0,c,p),E&&!y&&(this.cachedCanvases.delete("fillCanvas"),E.set(d,ut.canvas)),{canvas:ut.canvas,offsetX:Math.round(P),offsetY:Math.round(Y)}}setLineWidth(i){i!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=i,this.ctx.lineWidth=i}setLineCap(i){this.ctx.lineCap=ie[i]}setLineJoin(i){this.ctx.lineJoin=Se[i]}setMiterLimit(i){this.ctx.miterLimit=i}setDash(i,n){const c=this.ctx;c.setLineDash!==void 0&&(c.setLineDash(i),c.lineDashOffset=n)}setRenderingIntent(i){}setFlatness(i){}setGState(i){for(const[n,c]of i)switch(n){case"LW":this.setLineWidth(c);break;case"LC":this.setLineCap(c);break;case"LJ":this.setLineJoin(c);break;case"ML":this.setMiterLimit(c);break;case"D":this.setDash(c[0],c[1]);break;case"RI":this.setRenderingIntent(c);break;case"FL":this.setFlatness(c);break;case"Font":this.setFont(c[0],c[1]);break;case"CA":this.current.strokeAlpha=c;break;case"ca":this.current.fillAlpha=c,this.ctx.globalAlpha=c;break;case"BM":this.ctx.globalCompositeOperation=c;break;case"SMask":this.current.activeSMask=c?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(c);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const i=this.inSMaskMode;this.current.activeSMask&&!i?this.beginSMaskMode():!this.current.activeSMask&&i&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const i=this.ctx.canvas.width,n=this.ctx.canvas.height,c="smaskGroupAt"+this.groupLevel,p=this.cachedCanvases.getCanvas(c,i,n);this.suspendedCtx=this.ctx,this.ctx=p.context;const o=this.ctx;o.setTransform(...(0,w.getCurrentTransform)(this.suspendedCtx)),kt(this.suspendedCtx,o),tt(o,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),kt(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(i){if(!this.current.activeSMask)return;i?(i[0]=Math.floor(i[0]),i[1]=Math.floor(i[1]),i[2]=Math.ceil(i[2]),i[3]=Math.ceil(i[3])):i=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const n=this.current.activeSMask,c=this.suspendedCtx;qt(c,n,this.ctx,i),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(kt(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const i=this.current;this.stateStack.push(i),this.current=i.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),kt(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(i,n,c,p,o,y){this.ctx.transform(i,n,c,p,o,y),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(i,n,c){const p=this.ctx,o=this.current;let y=o.x,b=o.y,E,d;const a=(0,w.getCurrentTransform)(p),h=a[0]===0&&a[3]===0||a[1]===0&&a[2]===0,R=h?c.slice(0):null;for(let V=0,G=0,at=i.length;V<at;V++)switch(i[V]|0){case e.OPS.rectangle:y=n[G++],b=n[G++];const ot=n[G++],yt=n[G++],At=y+ot,ut=b+yt;p.moveTo(y,b),ot===0||yt===0?p.lineTo(At,ut):(p.lineTo(At,b),p.lineTo(At,ut),p.lineTo(y,ut)),h||o.updateRectMinMax(a,[y,b,At,ut]),p.closePath();break;case e.OPS.moveTo:y=n[G++],b=n[G++],p.moveTo(y,b),h||o.updatePathMinMax(a,y,b);break;case e.OPS.lineTo:y=n[G++],b=n[G++],p.lineTo(y,b),h||o.updatePathMinMax(a,y,b);break;case e.OPS.curveTo:E=y,d=b,y=n[G+4],b=n[G+5],p.bezierCurveTo(n[G],n[G+1],n[G+2],n[G+3],y,b),o.updateCurvePathMinMax(a,E,d,n[G],n[G+1],n[G+2],n[G+3],y,b,R),G+=6;break;case e.OPS.curveTo2:E=y,d=b,p.bezierCurveTo(y,b,n[G],n[G+1],n[G+2],n[G+3]),o.updateCurvePathMinMax(a,E,d,y,b,n[G],n[G+1],n[G+2],n[G+3],R),y=n[G+2],b=n[G+3],G+=4;break;case e.OPS.curveTo3:E=y,d=b,y=n[G+2],b=n[G+3],p.bezierCurveTo(n[G],n[G+1],y,b,y,b),o.updateCurvePathMinMax(a,E,d,n[G],n[G+1],y,b,y,b,R),G+=4;break;case e.OPS.closePath:p.closePath();break}h&&o.updateScalingPathMinMax(a,R),o.setCurrentPoint(y,b)}closePath(){this.ctx.closePath()}stroke(i=!0){const n=this.ctx,c=this.current.strokeColor;n.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof c=="object"&&(c!=null&&c.getPattern)?(n.save(),n.strokeStyle=c.getPattern(n,this,(0,w.getCurrentTransformInverse)(n),f.STROKE),this.rescaleAndStroke(!1),n.restore()):this.rescaleAndStroke(!0)),i&&this.consumePath(this.current.getClippedPathBoundingBox()),n.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(i=!0){const n=this.ctx,c=this.current.fillColor,p=this.current.patternFill;let o=!1;p&&(n.save(),n.fillStyle=c.getPattern(n,this,(0,w.getCurrentTransformInverse)(n),f.FILL),o=!0);const y=this.current.getClippedPathBoundingBox();this.contentVisible&&y!==null&&(this.pendingEOFill?(n.fill("evenodd"),this.pendingEOFill=!1):n.fill()),o&&n.restore(),i&&this.consumePath(y)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=de}eoClip(){this.pendingClip=le}beginText(){this.current.textMatrix=e.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const i=this.pendingTextPaths,n=this.ctx;if(i===void 0){n.beginPath();return}n.save(),n.beginPath();for(const c of i)n.setTransform(...c.transform),n.translate(c.x,c.y),c.addToPath(n,c.fontSize);n.restore(),n.clip(),n.beginPath(),delete this.pendingTextPaths}setCharSpacing(i){this.current.charSpacing=i}setWordSpacing(i){this.current.wordSpacing=i}setHScale(i){this.current.textHScale=i/100}setLeading(i){this.current.leading=-i}setFont(i,n){var a;const c=this.commonObjs.get(i),p=this.current;if(!c)throw new Error(`Can't find font for ${i}`);if(p.fontMatrix=c.fontMatrix||e.FONT_IDENTITY_MATRIX,(p.fontMatrix[0]===0||p.fontMatrix[3]===0)&&(0,e.warn)("Invalid font matrix for font "+i),n<0?(n=-n,p.fontDirection=-1):p.fontDirection=1,this.current.font=c,this.current.fontSize=n,c.isType3Font)return;const o=c.loadedName||"sans-serif",y=((a=c.systemFontInfo)==null?void 0:a.css)||`"${o}", ${c.fallbackName}`;let b="normal";c.black?b="900":c.bold&&(b="bold");const E=c.italic?"italic":"normal";let d=n;n<rt?d=rt:n>J&&(d=J),this.current.fontSizeScale=n/d,this.ctx.font=`${E} ${b} ${d}px ${y}`}setTextRenderingMode(i){this.current.textRenderingMode=i}setTextRise(i){this.current.textRise=i}moveText(i,n){this.current.x=this.current.lineX+=i,this.current.y=this.current.lineY+=n}setLeadingMoveText(i,n){this.setLeading(-n),this.moveText(i,n)}setTextMatrix(i,n,c,p,o,y){this.current.textMatrix=[i,n,c,p,o,y],this.current.textMatrixScale=Math.hypot(i,n),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(i,n,c,p){const o=this.ctx,y=this.current,b=y.font,E=y.textRenderingMode,d=y.fontSize/y.fontSizeScale,a=E&e.TextRenderingMode.FILL_STROKE_MASK,h=!!(E&e.TextRenderingMode.ADD_TO_PATH_FLAG),R=y.patternFill&&!b.missingFile;let V;(b.disableFontFace||h||R)&&(V=b.getPathGenerator(this.commonObjs,i)),b.disableFontFace||R?(o.save(),o.translate(n,c),o.beginPath(),V(o,d),p&&o.setTransform(...p),(a===e.TextRenderingMode.FILL||a===e.TextRenderingMode.FILL_STROKE)&&o.fill(),(a===e.TextRenderingMode.STROKE||a===e.TextRenderingMode.FILL_STROKE)&&o.stroke(),o.restore()):((a===e.TextRenderingMode.FILL||a===e.TextRenderingMode.FILL_STROKE)&&o.fillText(i,n,c),(a===e.TextRenderingMode.STROKE||a===e.TextRenderingMode.FILL_STROKE)&&o.strokeText(i,n,c)),h&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,w.getCurrentTransform)(o),x:n,y:c,fontSize:d,addToPath:V})}get isFontSubpixelAAEnabled(){const{context:i}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);i.scale(1.5,1),i.fillText("I",0,10);const n=i.getImageData(0,0,10,10).data;let c=!1;for(let p=3;p<n.length;p+=4)if(n[p]>0&&n[p]<255){c=!0;break}return(0,e.shadow)(this,"isFontSubpixelAAEnabled",c)}showText(i){const n=this.current,c=n.font;if(c.isType3Font)return this.showType3Text(i);const p=n.fontSize;if(p===0)return;const o=this.ctx,y=n.fontSizeScale,b=n.charSpacing,E=n.wordSpacing,d=n.fontDirection,a=n.textHScale*d,h=i.length,R=c.vertical,V=R?1:-1,G=c.defaultVMetrics,at=p*n.fontMatrix[0],ot=n.textRenderingMode===e.TextRenderingMode.FILL&&!c.disableFontFace&&!n.patternFill;o.save(),o.transform(...n.textMatrix),o.translate(n.x,n.y+n.textRise),d>0?o.scale(a,-1):o.scale(a,1);let yt;if(n.patternFill){o.save();const Y=n.fillColor.getPattern(o,this,(0,w.getCurrentTransformInverse)(o),f.FILL);yt=(0,w.getCurrentTransform)(o),o.restore(),o.fillStyle=Y}let At=n.lineWidth;const ut=n.textMatrixScale;if(ut===0||At===0){const Y=n.textRenderingMode&e.TextRenderingMode.FILL_STROKE_MASK;(Y===e.TextRenderingMode.STROKE||Y===e.TextRenderingMode.FILL_STROKE)&&(At=this.getSinglePixelWidth())}else At/=ut;if(y!==1&&(o.scale(y,y),At/=y),o.lineWidth=At,c.isInvalidPDFjsFont){const Y=[];let nt=0;for(const U of i)Y.push(U.unicode),nt+=U.width;o.fillText(Y.join(""),0,0),n.x+=nt*at*a,o.restore(),this.compose();return}let xt=0,P;for(P=0;P<h;++P){const Y=i[P];if(typeof Y=="number"){xt+=V*Y*p/1e3;continue}let nt=!1;const U=(Y.isSpace?E:0)+b,v=Y.fontChar,z=Y.accent;let K,lt,mt=Y.width;if(R){const Dt=Y.vmetric||G,te=-(Y.vmetric?Dt[1]:mt*.5)*at,re=Dt[2]*at;mt=Dt?-Dt[0]:mt,K=te/y,lt=(xt+re)/y}else K=xt/y,lt=0;if(c.remeasure&&mt>0){const Dt=o.measureText(v).width*1e3/p*y;if(mt<Dt&&this.isFontSubpixelAAEnabled){const te=mt/Dt;nt=!0,o.save(),o.scale(te,1),K/=te}else mt!==Dt&&(K+=(mt-Dt)/2e3*p/y)}if(this.contentVisible&&(Y.isInFont||c.missingFile)){if(ot&&!z)o.fillText(v,K,lt);else if(this.paintChar(v,K,lt,yt),z){const Dt=K+p*z.offset.x/y,te=lt-p*z.offset.y/y;this.paintChar(z.fontChar,Dt,te,yt)}}const Mt=R?mt*at-U*d:mt*at+U*d;xt+=Mt,nt&&o.restore()}R?n.y-=xt:n.x+=xt*a,o.restore(),this.compose()}showType3Text(i){const n=this.ctx,c=this.current,p=c.font,o=c.fontSize,y=c.fontDirection,b=p.vertical?1:-1,E=c.charSpacing,d=c.wordSpacing,a=c.textHScale*y,h=c.fontMatrix||e.FONT_IDENTITY_MATRIX,R=i.length,V=c.textRenderingMode===e.TextRenderingMode.INVISIBLE;let G,at,ot,yt;if(!(V||o===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),n.transform(...c.textMatrix),n.translate(c.x,c.y),n.scale(a,y),G=0;G<R;++G){if(at=i[G],typeof at=="number"){yt=b*at*o/1e3,this.ctx.translate(yt,0),c.x+=yt*a;continue}const At=(at.isSpace?d:0)+E,ut=p.charProcOperatorList[at.operatorListId];if(!ut){(0,e.warn)(`Type3 character "${at.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=at,this.save(),n.scale(o,o),n.transform(...h),this.executeOperatorList(ut),this.restore()),ot=e.Util.applyTransform([at.width,0],h)[0]*o+At,n.translate(ot,0),c.x+=ot*a}n.restore(),this.processingType3=null}}setCharWidth(i,n){}setCharWidthAndBounds(i,n,c,p,o,y){this.ctx.rect(c,p,o-c,y-p),this.ctx.clip(),this.endPath()}getColorN_Pattern(i){let n;if(i[0]==="TilingPattern"){const c=i[1],p=this.baseTransform||(0,w.getCurrentTransform)(this.ctx),o={createCanvasGraphics:y=>new ne(y,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};n=new N(i,c,this.ctx,o,p)}else n=this._getPattern(i[1],i[2]);return n}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(i,n,c){const p=e.Util.makeHexColor(i,n,c);this.ctx.strokeStyle=p,this.current.strokeColor=p}setFillRGBColor(i,n,c){const p=e.Util.makeHexColor(i,n,c);this.ctx.fillStyle=p,this.current.fillColor=p,this.current.patternFill=!1}_getPattern(i,n=null){let c;return this.cachedPatterns.has(i)?c=this.cachedPatterns.get(i):(c=A(this.getObject(i)),this.cachedPatterns.set(i,c)),n&&(c.matrix=n),c}shadingFill(i){if(!this.contentVisible)return;const n=this.ctx;this.save();const c=this._getPattern(i);n.fillStyle=c.getPattern(n,this,(0,w.getCurrentTransformInverse)(n),f.SHADING);const p=(0,w.getCurrentTransformInverse)(n);if(p){const{width:o,height:y}=n.canvas,[b,E,d,a]=e.Util.getAxialAlignedBoundingBox([0,0,o,y],p);this.ctx.fillRect(b,E,d-b,a-E)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,e.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,e.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(i,n){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(i)&&i.length===6&&this.transform(...i),this.baseTransform=(0,w.getCurrentTransform)(this.ctx),n)){const c=n[2]-n[0],p=n[3]-n[1];this.ctx.rect(n[0],n[1],c,p),this.current.updateRectMinMax((0,w.getCurrentTransform)(this.ctx),n),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(i){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;i.isolated||(0,e.info)("TODO: Support non-isolated groups."),i.knockout&&(0,e.warn)("Knockout groups not supported.");const c=(0,w.getCurrentTransform)(n);if(i.matrix&&n.transform(...i.matrix),!i.bbox)throw new Error("Bounding box is required.");let p=e.Util.getAxialAlignedBoundingBox(i.bbox,(0,w.getCurrentTransform)(n));const o=[0,0,n.canvas.width,n.canvas.height];p=e.Util.intersect(p,o)||[0,0,0,0];const y=Math.floor(p[0]),b=Math.floor(p[1]);let E=Math.max(Math.ceil(p[2])-y,1),d=Math.max(Math.ceil(p[3])-b,1),a=1,h=1;E>M&&(a=E/M,E=M),d>M&&(h=d/M,d=M),this.current.startNewPathAndClipBox([0,0,E,d]);let R="groupAt"+this.groupLevel;i.smask&&(R+="_smask_"+this.smaskCounter++%2);const V=this.cachedCanvases.getCanvas(R,E,d),G=V.context;G.scale(1/a,1/h),G.translate(-y,-b),G.transform(...c),i.smask?this.smaskStack.push({canvas:V.canvas,context:G,offsetX:y,offsetY:b,scaleX:a,scaleY:h,subtype:i.smask.subtype,backdrop:i.smask.backdrop,transferMap:i.smask.transferMap||null,startTransformInverse:null}):(n.setTransform(1,0,0,1,0,0),n.translate(y,b),n.scale(a,h),n.save()),kt(n,G),this.ctx=G,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(i){if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,c=this.groupStack.pop();if(this.ctx=c,this.ctx.imageSmoothingEnabled=!1,i.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const p=(0,w.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...p);const o=e.Util.getAxialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],p);this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(i,n,c,p,o){if(C(this,ae,In).call(this),Et(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(n)&&n.length===4){const y=n[2]-n[0],b=n[3]-n[1];if(o&&this.annotationCanvasMap){c=c.slice(),c[4]-=n[0],c[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=y,n[3]=b;const[E,d]=e.Util.singularValueDecompose2dScale((0,w.getCurrentTransform)(this.ctx)),{viewportScale:a}=this,h=Math.ceil(y*this.outputScaleX*a),R=Math.ceil(b*this.outputScaleY*a);this.annotationCanvas=this.canvasFactory.create(h,R);const{canvas:V,context:G}=this.annotationCanvas;this.annotationCanvasMap.set(i,V),this.annotationCanvas.savedCtx=this.ctx,this.ctx=G,this.ctx.save(),this.ctx.setTransform(E,0,0,-d,0,b*d),Et(this.ctx)}else Et(this.ctx),this.ctx.rect(n[0],n[1],y,b),this.ctx.clip(),this.endPath()}this.current=new Ot(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...c),this.transform(...p)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),C(this,ee,Fn).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(i){if(!this.contentVisible)return;const n=i.count;i=this.getObject(i.data,i),i.count=n;const c=this.ctx,p=this.processingType3;if(p&&(p.compiled===void 0&&(p.compiled=Ct(i)),p.compiled)){p.compiled(c);return}const o=this._createMaskCanvas(i),y=o.canvas;c.save(),c.setTransform(1,0,0,1,0,0),c.drawImage(y,o.offsetX,o.offsetY),c.restore(),this.compose()}paintImageMaskXObjectRepeat(i,n,c=0,p=0,o,y){if(!this.contentVisible)return;i=this.getObject(i.data,i);const b=this.ctx;b.save();const E=(0,w.getCurrentTransform)(b);b.transform(n,c,p,o,0,0);const d=this._createMaskCanvas(i);b.setTransform(1,0,0,1,d.offsetX-E[4],d.offsetY-E[5]);for(let a=0,h=y.length;a<h;a+=2){const R=e.Util.transform(E,[n,c,p,o,y[a],y[a+1]]),[V,G]=e.Util.applyTransform([0,0],R);b.drawImage(d.canvas,V,G)}b.restore(),this.compose()}paintImageMaskXObjectGroup(i){if(!this.contentVisible)return;const n=this.ctx,c=this.current.fillColor,p=this.current.patternFill;for(const o of i){const{data:y,width:b,height:E,transform:d}=o,a=this.cachedCanvases.getCanvas("maskCanvas",b,E),h=a.context;h.save();const R=this.getObject(y,o);Lt(h,R),h.globalCompositeOperation="source-in",h.fillStyle=p?c.getPattern(h,this,(0,w.getCurrentTransformInverse)(n),f.FILL):c,h.fillRect(0,0,b,E),h.restore(),n.save(),n.transform(...d),n.scale(1,-1),Ft(n,a.canvas,0,0,b,E,0,-1,1,1),n.restore()}this.compose()}paintImageXObject(i){if(!this.contentVisible)return;const n=this.getObject(i);if(!n){(0,e.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(n)}paintImageXObjectRepeat(i,n,c,p){if(!this.contentVisible)return;const o=this.getObject(i);if(!o){(0,e.warn)("Dependent image isn't ready yet");return}const y=o.width,b=o.height,E=[];for(let d=0,a=p.length;d<a;d+=2)E.push({transform:[n,0,0,c,p[d],p[d+1]],x:0,y:0,w:y,h:b});this.paintInlineImageXObjectGroup(o,E)}applyTransferMapsToCanvas(i){return this.current.transferMaps!=="none"&&(i.filter=this.current.transferMaps,i.drawImage(i.canvas,0,0),i.filter="none"),i.canvas}applyTransferMapsToBitmap(i){if(this.current.transferMaps==="none")return i.bitmap;const{bitmap:n,width:c,height:p}=i,o=this.cachedCanvases.getCanvas("inlineImage",c,p),y=o.context;return y.filter=this.current.transferMaps,y.drawImage(n,0,0),y.filter="none",o.canvas}paintInlineImageXObject(i){if(!this.contentVisible)return;const n=i.width,c=i.height,p=this.ctx;if(this.save(),!e.isNodeJS){const{filter:b}=p;b!=="none"&&b!==""&&(p.filter="none")}p.scale(1/n,-1/c);let o;if(i.bitmap)o=this.applyTransferMapsToBitmap(i);else if(typeof HTMLElement=="function"&&i instanceof HTMLElement||!i.data)o=i;else{const b=this.cachedCanvases.getCanvas("inlineImage",n,c).context;_t(b,i),o=this.applyTransferMapsToCanvas(b)}const y=this._scaleImage(o,(0,w.getCurrentTransformInverse)(p));p.imageSmoothingEnabled=Kt((0,w.getCurrentTransform)(p),i.interpolate),Ft(p,y.img,0,0,y.paintWidth,y.paintHeight,0,-c,n,c),this.compose(),this.restore()}paintInlineImageXObjectGroup(i,n){if(!this.contentVisible)return;const c=this.ctx;let p;if(i.bitmap)p=i.bitmap;else{const o=i.width,y=i.height,b=this.cachedCanvases.getCanvas("inlineImage",o,y).context;_t(b,i),p=this.applyTransferMapsToCanvas(b)}for(const o of n)c.save(),c.transform(...o.transform),c.scale(1,-1),Ft(c,p,o.x,o.y,o.w,o.h,0,-1,1,1),c.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(i){}markPointProps(i,n){}beginMarkedContent(i){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(i,n){i==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(i){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const c=this.ctx;this.pendingClip&&(n||(this.pendingClip===le?c.clip("evenodd"):c.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),c.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const i=(0,w.getCurrentTransform)(this.ctx);if(i[1]===0&&i[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(i[0]),Math.abs(i[3]));else{const n=Math.abs(i[0]*i[3]-i[2]*i[1]),c=Math.hypot(i[0],i[2]),p=Math.hypot(i[1],i[3]);this._cachedGetSinglePixelWidth=Math.max(c,p)/n}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:i}=this.current,{a:n,b:c,c:p,d:o}=this.ctx.getTransform();let y,b;if(c===0&&p===0){const E=Math.abs(n),d=Math.abs(o);if(E===d)if(i===0)y=b=1/E;else{const a=E*i;y=b=a<1?1/a:1}else if(i===0)y=1/E,b=1/d;else{const a=E*i,h=d*i;y=a<1?1/a:1,b=h<1?1/h:1}}else{const E=Math.abs(n*o-c*p),d=Math.hypot(n,c),a=Math.hypot(p,o);if(i===0)y=a/E,b=d/E;else{const h=i*E;y=a>h?a/h:1,b=d>h?d/h:1}}this._cachedScaleForStroking[0]=y,this._cachedScaleForStroking[1]=b}return this._cachedScaleForStroking}rescaleAndStroke(i){const{ctx:n}=this,{lineWidth:c}=this.current,[p,o]=this.getScaleForStroking();if(n.lineWidth=c||1,p===1&&o===1){n.stroke();return}const y=n.getLineDash();if(i&&n.save(),n.scale(p,o),y.length>0){const b=Math.max(p,o);n.setLineDash(y.map(E=>E/b)),n.lineDashOffset/=b}n.stroke(),i&&n.restore()}isContentVisible(){for(let i=this.markedContentStack.length-1;i>=0;i--)if(!this.markedContentStack[i].visible)return!1;return!0}};ae=new WeakSet,In=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},ee=new WeakSet,Fn=function(){if(this.pageColors){const i=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(i!=="none"){const n=this.ctx.filter;this.ctx.filter=i,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=n}}};let ve=ne;for(const et in e.OPS)ve.prototype[et]!==void 0&&(ve.prototype[e.OPS[et]]=ve.prototype[et])},419:(r,m,u)=>{var kt,Et,Z,gt,Rt,Pt,qt,Js,ie,Qs,de,Zs,ve,Dn,ae,Ji,ee,Qi,ne,yi,i,_i;u.d(m,{DOMCMapReaderFactory:()=>g,DOMCanvasFactory:()=>k,DOMFilterFactory:()=>W,DOMSVGFactory:()=>S,DOMStandardFontDataFactory:()=>H,PDFDateString:()=>q,PageViewport:()=>A,PixelsPerInch:()=>T,RenderingCancelledException:()=>F,StatTimer:()=>M,fetchData:()=>_,getColorValues:()=>Ft,getCurrentTransform:()=>Ct,getCurrentTransformInverse:()=>Ot,getFilenameFromUrl:()=>rt,getPdfFilenameFromUrl:()=>J,getRGB:()=>vt,getXfaPageViewport:()=>tt,isDataScheme:()=>N,isPdfFile:()=>X,isValidFetchUrl:()=>j,noContextMenu:()=>$,setLayerDimensions:()=>_t});var e=u(583),w=u(292);const f="http://www.w3.org/2000/svg",Lt=class Lt{};fe(Lt,"CSS",96),fe(Lt,"PDF",72),fe(Lt,"PDF_TO_CSS_UNITS",Lt.CSS/Lt.PDF);let T=Lt;class W extends e.BaseFilterFactory{constructor({docId:o,ownerDocument:y=globalThis.document}={}){super();l(this,qt);l(this,ie);l(this,de);l(this,ve);l(this,ae);l(this,ee);l(this,ne);l(this,i);l(this,kt,void 0);l(this,Et,void 0);l(this,Z,void 0);l(this,gt,void 0);l(this,Rt,void 0);l(this,Pt,0);I(this,Z,o),I(this,gt,y)}addFilter(o){if(!o)return"none";let y=t(this,qt,Js).get(o);if(y)return y;let b,E,d,a;if(o.length===1){const G=o[0],at=new Array(256);for(let ot=0;ot<256;ot++)at[ot]=G[ot]/255;a=b=E=d=at.join(",")}else{const[G,at,ot]=o,yt=new Array(256),At=new Array(256),ut=new Array(256);for(let xt=0;xt<256;xt++)yt[xt]=G[xt]/255,At[xt]=at[xt]/255,ut[xt]=ot[xt]/255;b=yt.join(","),E=At.join(","),d=ut.join(","),a=`${b}${E}${d}`}if(y=t(this,qt,Js).get(a),y)return t(this,qt,Js).set(o,y),y;const h=`g_${t(this,Z)}_transfer_map_${fs(this,Pt)._++}`,R=`url(#${h})`;t(this,qt,Js).set(o,R),t(this,qt,Js).set(a,R);const V=C(this,ae,Ji).call(this,h);return C(this,ne,yi).call(this,b,E,d,V),R}addHCMFilter(o,y){var yt;const b=`${o}-${y}`,E="base";let d=t(this,ie,Qs).get(E);if((d==null?void 0:d.key)===b||(d?((yt=d.filter)==null||yt.remove(),d.key=b,d.url="none",d.filter=null):(d={key:b,url:"none",filter:null},t(this,ie,Qs).set(E,d)),!o||!y))return d.url;const a=C(this,i,_i).call(this,o);o=w.Util.makeHexColor(...a);const h=C(this,i,_i).call(this,y);if(y=w.Util.makeHexColor(...h),t(this,de,Zs).style.color="",o==="#000000"&&y==="#ffffff"||o===y)return d.url;const R=new Array(256);for(let At=0;At<=255;At++){const ut=At/255;R[At]=ut<=.03928?ut/12.92:((ut+.055)/1.055)**2.4}const V=R.join(","),G=`g_${t(this,Z)}_hcm_filter`,at=d.filter=C(this,ae,Ji).call(this,G);C(this,ne,yi).call(this,V,V,V,at),C(this,ve,Dn).call(this,at);const ot=(At,ut)=>{const xt=a[At]/255,P=h[At]/255,Y=new Array(ut+1);for(let nt=0;nt<=ut;nt++)Y[nt]=xt+nt/ut*(P-xt);return Y.join(",")};return C(this,ne,yi).call(this,ot(0,5),ot(1,5),ot(2,5),at),d.url=`url(#${G})`,d.url}addHighlightHCMFilter(o,y,b,E,d){var P;const a=`${y}-${b}-${E}-${d}`;let h=t(this,ie,Qs).get(o);if((h==null?void 0:h.key)===a||(h?((P=h.filter)==null||P.remove(),h.key=a,h.url="none",h.filter=null):(h={key:a,url:"none",filter:null},t(this,ie,Qs).set(o,h)),!y||!b))return h.url;const[R,V]=[y,b].map(C(this,i,_i).bind(this));let G=Math.round(.2126*R[0]+.7152*R[1]+.0722*R[2]),at=Math.round(.2126*V[0]+.7152*V[1]+.0722*V[2]),[ot,yt]=[E,d].map(C(this,i,_i).bind(this));at<G&&([G,at,ot,yt]=[at,G,yt,ot]),t(this,de,Zs).style.color="";const At=(Y,nt,U)=>{const v=new Array(256),z=(at-G)/U,K=Y/255,lt=(nt-Y)/(255*U);let mt=0;for(let Mt=0;Mt<=U;Mt++){const Dt=Math.round(G+Mt*z),te=K+Mt*lt;for(let re=mt;re<=Dt;re++)v[re]=te;mt=Dt+1}for(let Mt=mt;Mt<256;Mt++)v[Mt]=v[mt-1];return v.join(",")},ut=`g_${t(this,Z)}_hcm_${o}_filter`,xt=h.filter=C(this,ae,Ji).call(this,ut);return C(this,ve,Dn).call(this,xt),C(this,ne,yi).call(this,At(ot[0],yt[0],5),At(ot[1],yt[1],5),At(ot[2],yt[2],5),xt),h.url=`url(#${ut})`,h.url}destroy(o=!1){o&&t(this,ie,Qs).size!==0||(t(this,Et)&&(t(this,Et).parentNode.parentNode.remove(),I(this,Et,null)),t(this,kt)&&(t(this,kt).clear(),I(this,kt,null)),I(this,Pt,0))}}kt=new WeakMap,Et=new WeakMap,Z=new WeakMap,gt=new WeakMap,Rt=new WeakMap,Pt=new WeakMap,qt=new WeakSet,Js=function(){return t(this,kt)||I(this,kt,new Map)},ie=new WeakSet,Qs=function(){return t(this,Rt)||I(this,Rt,new Map)},de=new WeakSet,Zs=function(){if(!t(this,Et)){const o=t(this,gt).createElement("div"),{style:y}=o;y.visibility="hidden",y.contain="strict",y.width=y.height=0,y.position="absolute",y.top=y.left=0,y.zIndex=-1;const b=t(this,gt).createElementNS(f,"svg");b.setAttribute("width",0),b.setAttribute("height",0),I(this,Et,t(this,gt).createElementNS(f,"defs")),o.append(b),b.append(t(this,Et)),t(this,gt).body.append(o)}return t(this,Et)},ve=new WeakSet,Dn=function(o){const y=t(this,gt).createElementNS(f,"feColorMatrix");y.setAttribute("type","matrix"),y.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),o.append(y)},ae=new WeakSet,Ji=function(o){const y=t(this,gt).createElementNS(f,"filter");return y.setAttribute("color-interpolation-filters","sRGB"),y.setAttribute("id",o),t(this,de,Zs).append(y),y},ee=new WeakSet,Qi=function(o,y,b){const E=t(this,gt).createElementNS(f,y);E.setAttribute("type","discrete"),E.setAttribute("tableValues",b),o.append(E)},ne=new WeakSet,yi=function(o,y,b,E){const d=t(this,gt).createElementNS(f,"feComponentTransfer");E.append(d),C(this,ee,Qi).call(this,d,"feFuncR",o),C(this,ee,Qi).call(this,d,"feFuncG",y),C(this,ee,Qi).call(this,d,"feFuncB",b)},i=new WeakSet,_i=function(o){return t(this,de,Zs).style.color=o,vt(getComputedStyle(t(this,de,Zs)).getPropertyValue("color"))};class k extends e.BaseCanvasFactory{constructor({ownerDocument:p=globalThis.document}={}){super(),this._document=p}_createCanvas(p,o){const y=this._document.createElement("canvas");return y.width=p,y.height=o,y}}async function _(c,p="text"){if(j(c,document.baseURI)){const o=await fetch(c);if(!o.ok)throw new Error(o.statusText);switch(p){case"arraybuffer":return o.arrayBuffer();case"blob":return o.blob();case"json":return o.json()}return o.text()}return new Promise((o,y)=>{const b=new XMLHttpRequest;b.open("GET",c,!0),b.responseType=p,b.onreadystatechange=()=>{if(b.readyState===XMLHttpRequest.DONE){if(b.status===200||b.status===0){switch(p){case"arraybuffer":case"blob":case"json":o(b.response);return}o(b.responseText);return}y(new Error(b.statusText))}},b.send(null)})}class g extends e.BaseCMapReaderFactory{_fetchData(p,o){return _(p,this.isCompressed?"arraybuffer":"text").then(y=>({cMapData:y instanceof ArrayBuffer?new Uint8Array(y):(0,w.stringToBytes)(y),compressionType:o}))}}class H extends e.BaseStandardFontDataFactory{_fetchData(p){return _(p,"arraybuffer").then(o=>new Uint8Array(o))}}class S extends e.BaseSVGFactory{_createSVG(p){return document.createElementNS(f,p)}}class A{constructor({viewBox:p,scale:o,rotation:y,offsetX:b=0,offsetY:E=0,dontFlip:d=!1}){this.viewBox=p,this.scale=o,this.rotation=y,this.offsetX=b,this.offsetY=E;const a=(p[2]+p[0])/2,h=(p[3]+p[1])/2;let R,V,G,at;switch(y%=360,y<0&&(y+=360),y){case 180:R=-1,V=0,G=0,at=1;break;case 90:R=0,V=1,G=1,at=0;break;case 270:R=0,V=-1,G=-1,at=0;break;case 0:R=1,V=0,G=0,at=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}d&&(G=-G,at=-at);let ot,yt,At,ut;R===0?(ot=Math.abs(h-p[1])*o+b,yt=Math.abs(a-p[0])*o+E,At=(p[3]-p[1])*o,ut=(p[2]-p[0])*o):(ot=Math.abs(a-p[0])*o+b,yt=Math.abs(h-p[1])*o+E,At=(p[2]-p[0])*o,ut=(p[3]-p[1])*o),this.transform=[R*o,V*o,G*o,at*o,ot-R*o*a-G*o*h,yt-V*o*a-at*o*h],this.width=At,this.height=ut}get rawDims(){const{viewBox:p}=this;return(0,w.shadow)(this,"rawDims",{pageWidth:p[2]-p[0],pageHeight:p[3]-p[1],pageX:p[0],pageY:p[1]})}clone({scale:p=this.scale,rotation:o=this.rotation,offsetX:y=this.offsetX,offsetY:b=this.offsetY,dontFlip:E=!1}={}){return new A({viewBox:this.viewBox.slice(),scale:p,rotation:o,offsetX:y,offsetY:b,dontFlip:E})}convertToViewportPoint(p,o){return w.Util.applyTransform([p,o],this.transform)}convertToViewportRectangle(p){const o=w.Util.applyTransform([p[0],p[1]],this.transform),y=w.Util.applyTransform([p[2],p[3]],this.transform);return[o[0],o[1],y[0],y[1]]}convertToPdfPoint(p,o){return w.Util.applyInverseTransform([p,o],this.transform)}}class F extends w.BaseException{constructor(p,o=0){super(p,"RenderingCancelledException"),this.extraDelay=o}}function N(c){const p=c.length;let o=0;for(;o<p&&c[o].trim()==="";)o++;return c.substring(o,o+5).toLowerCase()==="data:"}function X(c){return typeof c=="string"&&/\.pdf$/i.test(c)}function rt(c,p=!1){return p||([c]=c.split(/[#?]/,1)),c.substring(c.lastIndexOf("/")+1)}function J(c,p="document.pdf"){if(typeof c!="string")return p;if(N(c))return(0,w.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),p;const o=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,y=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,b=o.exec(c);let E=y.exec(b[1])||y.exec(b[2])||y.exec(b[3]);if(E&&(E=E[0],E.includes("%")))try{E=y.exec(decodeURIComponent(E))[0]}catch{}return E||p}class M{constructor(){fe(this,"started",Object.create(null));fe(this,"times",[])}time(p){p in this.started&&(0,w.warn)(`Timer is already running for ${p}`),this.started[p]=Date.now()}timeEnd(p){p in this.started||(0,w.warn)(`Timer has not been started for ${p}`),this.times.push({name:p,start:this.started[p],end:Date.now()}),delete this.started[p]}toString(){const p=[];let o=0;for(const{name:y}of this.times)o=Math.max(y.length,o);for(const{name:y,start:b,end:E}of this.times)p.push(`${y.padEnd(o)} ${E-b}ms
`);return p.join("")}}function j(c,p){try{const{protocol:o}=p?new URL(c,p):new URL(c);return o==="http:"||o==="https:"}catch{return!1}}function $(c){c.preventDefault()}let O;class q{static toDateObject(p){if(!p||typeof p!="string")return null;O||(O=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const o=O.exec(p);if(!o)return null;const y=parseInt(o[1],10);let b=parseInt(o[2],10);b=b>=1&&b<=12?b-1:0;let E=parseInt(o[3],10);E=E>=1&&E<=31?E:1;let d=parseInt(o[4],10);d=d>=0&&d<=23?d:0;let a=parseInt(o[5],10);a=a>=0&&a<=59?a:0;let h=parseInt(o[6],10);h=h>=0&&h<=59?h:0;const R=o[7]||"Z";let V=parseInt(o[8],10);V=V>=0&&V<=23?V:0;let G=parseInt(o[9],10)||0;return G=G>=0&&G<=59?G:0,R==="-"?(d+=V,a+=G):R==="+"&&(d-=V,a-=G),new Date(Date.UTC(y,b,E,d,a,h))}}function tt(c,{scale:p=1,rotation:o=0}){const{width:y,height:b}=c.attributes.style,E=[0,0,parseInt(y),parseInt(b)];return new A({viewBox:E,scale:p,rotation:o})}function vt(c){if(c.startsWith("#")){const p=parseInt(c.slice(1),16);return[(p&16711680)>>16,(p&65280)>>8,p&255]}return c.startsWith("rgb(")?c.slice(4,-1).split(",").map(p=>parseInt(p)):c.startsWith("rgba(")?c.slice(5,-1).split(",").map(p=>parseInt(p)).slice(0,3):((0,w.warn)(`Not a valid color format: "${c}"`),[0,0,0])}function Ft(c){const p=document.createElement("span");p.style.visibility="hidden",document.body.append(p);for(const o of c.keys()){p.style.color=o;const y=window.getComputedStyle(p).color;c.set(o,vt(y))}p.remove()}function Ct(c){const{a:p,b:o,c:y,d:b,e:E,f:d}=c.getTransform();return[p,o,y,b,E,d]}function Ot(c){const{a:p,b:o,c:y,d:b,e:E,f:d}=c.getTransform().invertSelf();return[p,o,y,b,E,d]}function _t(c,p,o=!1,y=!0){if(p instanceof A){const{pageWidth:b,pageHeight:E}=p.rawDims,{style:d}=c,a=w.FeatureTest.isCSSRoundSupported,h=`var(--scale-factor) * ${b}px`,R=`var(--scale-factor) * ${E}px`,V=a?`round(${h}, 1px)`:`calc(${h})`,G=a?`round(${R}, 1px)`:`calc(${R})`;!o||p.rotation%180===0?(d.width=V,d.height=G):(d.width=G,d.height=V)}y&&c.setAttribute("data-main-rotation",p.rotation)}},47:(r,m,u)=>{var T,W,k,_,g,Nn,S,On,F,Kr;u.d(m,{DrawLayer:()=>f});var e=u(419),w=u(292);const X=class X{constructor({pageIndex:J}){l(this,S);l(this,F);l(this,T,null);l(this,W,0);l(this,k,new Map);l(this,_,new Map);this.pageIndex=J}setParent(J){if(!t(this,T)){I(this,T,J);return}if(t(this,T)!==J){if(t(this,k).size>0)for(const M of t(this,k).values())M.remove(),J.append(M);I(this,T,J)}}static get _svgFactory(){return(0,w.shadow)(this,"_svgFactory",new e.DOMSVGFactory)}highlight(J,M,j,$=!1){const O=fs(this,W)._++,q=C(this,S,On).call(this,J.box);q.classList.add("highlight"),J.free&&q.classList.add("free");const tt=X._svgFactory.createElement("defs");q.append(tt);const vt=X._svgFactory.createElement("path");tt.append(vt);const Ft=`path_p${this.pageIndex}_${O}`;vt.setAttribute("id",Ft),vt.setAttribute("d",J.toSVGPath()),$&&t(this,_).set(O,vt);const Ct=C(this,F,Kr).call(this,tt,Ft),Ot=X._svgFactory.createElement("use");return q.append(Ot),q.setAttribute("fill",M),q.setAttribute("fill-opacity",j),Ot.setAttribute("href",`#${Ft}`),t(this,k).set(O,q),{id:O,clipPathId:`url(#${Ct})`}}highlightOutline(J){const M=fs(this,W)._++,j=C(this,S,On).call(this,J.box);j.classList.add("highlightOutline");const $=X._svgFactory.createElement("defs");j.append($);const O=X._svgFactory.createElement("path");$.append(O);const q=`path_p${this.pageIndex}_${M}`;O.setAttribute("id",q),O.setAttribute("d",J.toSVGPath()),O.setAttribute("vector-effect","non-scaling-stroke");let tt;if(J.free){j.classList.add("free");const Ct=X._svgFactory.createElement("mask");$.append(Ct),tt=`mask_p${this.pageIndex}_${M}`,Ct.setAttribute("id",tt),Ct.setAttribute("maskUnits","objectBoundingBox");const Ot=X._svgFactory.createElement("rect");Ct.append(Ot),Ot.setAttribute("width","1"),Ot.setAttribute("height","1"),Ot.setAttribute("fill","white");const _t=X._svgFactory.createElement("use");Ct.append(_t),_t.setAttribute("href",`#${q}`),_t.setAttribute("stroke","none"),_t.setAttribute("fill","black"),_t.setAttribute("fill-rule","nonzero"),_t.classList.add("mask")}const vt=X._svgFactory.createElement("use");j.append(vt),vt.setAttribute("href",`#${q}`),tt&&vt.setAttribute("mask",`url(#${tt})`);const Ft=vt.cloneNode();return j.append(Ft),vt.classList.add("mainOutline"),Ft.classList.add("secondaryOutline"),t(this,k).set(M,j),M}finalizeLine(J,M){const j=t(this,_).get(J);t(this,_).delete(J),this.updateBox(J,M.box),j.setAttribute("d",M.toSVGPath())}updateLine(J,M){t(this,k).get(J).firstChild.firstChild.setAttribute("d",M.toSVGPath())}removeFreeHighlight(J){this.remove(J),t(this,_).delete(J)}updatePath(J,M){t(this,_).get(J).setAttribute("d",M.toSVGPath())}updateBox(J,M){var j;C(j=X,g,Nn).call(j,t(this,k).get(J),M)}show(J,M){t(this,k).get(J).classList.toggle("hidden",!M)}rotate(J,M){t(this,k).get(J).setAttribute("data-main-rotation",M)}changeColor(J,M){t(this,k).get(J).setAttribute("fill",M)}changeOpacity(J,M){t(this,k).get(J).setAttribute("fill-opacity",M)}addClass(J,M){t(this,k).get(J).classList.add(M)}removeClass(J,M){t(this,k).get(J).classList.remove(M)}remove(J){t(this,T)!==null&&(t(this,k).get(J).remove(),t(this,k).delete(J))}destroy(){I(this,T,null);for(const J of t(this,k).values())J.remove();t(this,k).clear()}};T=new WeakMap,W=new WeakMap,k=new WeakMap,_=new WeakMap,g=new WeakSet,Nn=function(J,{x:M=0,y:j=0,width:$=1,height:O=1}={}){const{style:q}=J;q.top=`${100*j}%`,q.left=`${100*M}%`,q.width=`${100*$}%`,q.height=`${100*O}%`},S=new WeakSet,On=function(J){var j;const M=X._svgFactory.create(1,1,!0);return t(this,T).append(M),M.setAttribute("aria-hidden",!0),C(j=X,g,Nn).call(j,M,J),M},F=new WeakSet,Kr=function(J,M){const j=X._svgFactory.createElement("clipPath");J.append(j);const $=`clip_${M}`;j.setAttribute("id",$),j.setAttribute("clipPathUnits","objectBoundingBox");const O=X._svgFactory.createElement("use");return j.append(O),O.setAttribute("href",`#${M}`),O.classList.add("clip"),$},l(X,g);let f=X},731:(r,m,u)=>{var X,rt,J,M,j,$,O,q,tt,vt,Ft,Yr,Ot,Jr,Lt,Qr,Et,Zi,gt,tn,Pt,en,Kt,Zr,Se,Hn,le,ta,ae,Ce,ee,Ee,ne,et,i,n,c,p,o,y,b,E,d,a,h,R,V,G,Bn,ot,Un,At,ea,xt,sa,Y,ia,U,$n,z,wi,lt,ti,Mt,na,te,sn,he,Ei,_e,ra,me,aa,se,oa,x,ha,ct,wt,bt,zt,Vt,Nt,Yt,$t,St,Bt,Qt,ue,ce,we,Le,Ze,la,Ke,ca,Ve,da,dt,ua,Ut,jn,Zt,pa,be,Vn,He,ga,ze,ma,Ms,fa,Di,va,Ni,ba,ds,Ds,ri,Gn,Bs,nn,Us,rn,bs,ei,ai,qn,$s,an,Oi,Aa,oi,zn,Hi,ya,Bi,_a,hi,Wn,js,on,Ls,xi,Ge,qe,As,us,ys,Vs,os,Ts,hs,ns,li,ks,Si,Rs,Ci,Gs,hn,ci,Xn,Ui,wa,$i,Ea,di,Kn,qs,ln,ji,xa,Ps,zs,ls,Is,ps,gs,ms,ts,_s,Ws,Xs,Je,pe,ws,Vi,Sa,pi,Yn,gi,Jn,mi,Qn,Ks,cn;u.d(m,{AnnotationEditorLayer:()=>N});var e=u(292),w=u(310),f=u(830),T=u(976);const W=/\r\n?|\n/g,jt=class jt extends w.AnnotationEditor{constructor(s){super({...s,name:"freeTextEditor"});l(this,Ft);l(this,Ot);l(this,Lt);l(this,Et);l(this,Pt);l(this,Kt);l(this,le);l(this,X,this.editorDivBlur.bind(this));l(this,rt,this.editorDivFocus.bind(this));l(this,J,this.editorDivInput.bind(this));l(this,M,this.editorDivKeydown.bind(this));l(this,j,this.editorDivPaste.bind(this));l(this,$,void 0);l(this,O,"");l(this,q,`${this.id}-editor`);l(this,tt,void 0);l(this,vt,null);I(this,$,s.color||jt._defaultColor||w.AnnotationEditor._defaultLineColor),I(this,tt,s.fontSize||jt._defaultFontSize)}static get _keyboardManager(){const s=jt.prototype,L=ft=>ft.isEmpty(),st=f.AnnotationEditorUIManager.TRANSLATE_SMALL,ht=f.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,e.shadow)(this,"_keyboardManager",new f.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],s.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],s.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],s._translateEmpty,{args:[-st,0],checker:L}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],s._translateEmpty,{args:[-ht,0],checker:L}],[["ArrowRight","mac+ArrowRight"],s._translateEmpty,{args:[st,0],checker:L}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],s._translateEmpty,{args:[ht,0],checker:L}],[["ArrowUp","mac+ArrowUp"],s._translateEmpty,{args:[0,-st],checker:L}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],s._translateEmpty,{args:[0,-ht],checker:L}],[["ArrowDown","mac+ArrowDown"],s._translateEmpty,{args:[0,st],checker:L}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],s._translateEmpty,{args:[0,ht],checker:L}]]))}static initialize(s,L){w.AnnotationEditor.initialize(s,L,{strings:["pdfjs-free-text-default-content"]});const st=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(st.getPropertyValue("--freetext-padding"))}static updateDefaultParams(s,L){switch(s){case e.AnnotationEditorParamsType.FREETEXT_SIZE:jt._defaultFontSize=L;break;case e.AnnotationEditorParamsType.FREETEXT_COLOR:jt._defaultColor=L;break}}updateParams(s,L){switch(s){case e.AnnotationEditorParamsType.FREETEXT_SIZE:C(this,Ft,Yr).call(this,L);break;case e.AnnotationEditorParamsType.FREETEXT_COLOR:C(this,Ot,Jr).call(this,L);break}}static get defaultPropertiesToUpdate(){return[[e.AnnotationEditorParamsType.FREETEXT_SIZE,jt._defaultFontSize],[e.AnnotationEditorParamsType.FREETEXT_COLOR,jt._defaultColor||w.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[e.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,tt)],[e.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,$)]]}_translateEmpty(s,L){this._uiManager.translateSelectedEditors(s,L,!0)}getInitialTranslation(){const s=this.parentScale;return[-jt._internalPadding*s,-(jt._internalPadding+t(this,tt))*s]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(e.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,M)),this.editorDiv.addEventListener("focus",t(this,rt)),this.editorDiv.addEventListener("blur",t(this,X)),this.editorDiv.addEventListener("input",t(this,J)),this.editorDiv.addEventListener("paste",t(this,j)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,q)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,M)),this.editorDiv.removeEventListener("focus",t(this,rt)),this.editorDiv.removeEventListener("blur",t(this,X)),this.editorDiv.removeEventListener("input",t(this,J)),this.editorDiv.removeEventListener("paste",t(this,j)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(s){this._focusEventsAllowed&&(super.focusin(s),s.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var s;this.width||(this.enableEditMode(),this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const s=t(this,O),L=I(this,O,C(this,Lt,Qr).call(this).trimEnd());if(s===L)return;const st=ht=>{if(I(this,O,ht),!ht){this.remove();return}C(this,Pt,en).call(this),this._uiManager.rebuild(this),C(this,Et,Zi).call(this)};this.addCommands({cmd:()=>{st(L)},undo:()=>{st(s)},mustExec:!1}),C(this,Et,Zi).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(s){this.enterInEditMode()}keydown(s){s.target===this.div&&s.key==="Enter"&&(this.enterInEditMode(),s.preventDefault())}editorDivKeydown(s){jt._keyboardManager.exec(this,s)}editorDivFocus(s){this.isEditing=!0}editorDivBlur(s){this.isEditing=!1}editorDivInput(s){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let s,L;this.width&&(s=this.x,L=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,q)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text"),this.enableEditing(),w.AnnotationEditor._l10nPromise.get("pdfjs-free-text-default-content").then(ht=>{var ft;return(ft=this.editorDiv)==null?void 0:ft.setAttribute("default-content",ht)}),this.editorDiv.contentEditable=!0;const{style:st}=this.editorDiv;if(st.fontSize=`calc(${t(this,tt)}px * var(--scale-factor))`,st.color=t(this,$),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,f.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[ht,ft]=this.parentDimensions;if(this.annotationElementId){const{position:It}=t(this,vt);let[Gt,Tt]=this.getInitialTranslation();[Gt,Tt]=this.pageTranslationToScreen(Gt,Tt);const[Xt,Wt]=this.pageDimensions,[Ae,ye]=this.pageTranslation;let xe,Te;switch(this.rotation){case 0:xe=s+(It[0]-Ae)/Xt,Te=L+this.height-(It[1]-ye)/Wt;break;case 90:xe=s+(It[0]-Ae)/Xt,Te=L-(It[1]-ye)/Wt,[Gt,Tt]=[Tt,-Gt];break;case 180:xe=s-this.width+(It[0]-Ae)/Xt,Te=L-(It[1]-ye)/Wt,[Gt,Tt]=[-Gt,-Tt];break;case 270:xe=s+(It[0]-Ae-this.height*Wt)/Xt,Te=L+(It[1]-ye-this.width*Xt)/Wt,[Gt,Tt]=[-Tt,Gt];break}this.setAt(xe*ht,Te*ft,Gt,Tt)}else this.setAt(s*ht,L*ft,this.width*ht,this.height*ft);C(this,Pt,en).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(s){var xe,Te,je;const L=s.clipboardData||window.clipboardData,{types:st}=L;if(st.length===1&&st[0]==="text/plain")return;s.preventDefault();const ht=C(xe=jt,Se,Hn).call(xe,L.getData("text")||"").replaceAll(W,`
`);if(!ht)return;const ft=window.getSelection();if(!ft.rangeCount)return;this.editorDiv.normalize(),ft.deleteFromDocument();const It=ft.getRangeAt(0);if(!ht.includes(`
`)){It.insertNode(document.createTextNode(ht)),this.editorDiv.normalize(),ft.collapseToStart();return}const{startContainer:Gt,startOffset:Tt}=It,Xt=[],Wt=[];if(Gt.nodeType===Node.TEXT_NODE){const De=Gt.parentElement;if(Wt.push(Gt.nodeValue.slice(Tt).replaceAll(W,"")),De!==this.editorDiv){let Ue=Xt;for(const Be of this.editorDiv.childNodes){if(Be===De){Ue=Wt;continue}Ue.push(C(Te=jt,gt,tn).call(Te,Be))}}Xt.push(Gt.nodeValue.slice(0,Tt).replaceAll(W,""))}else if(Gt===this.editorDiv){let De=Xt,Ue=0;for(const Be of this.editorDiv.childNodes)Ue++===Tt&&(De=Wt),De.push(C(je=jt,gt,tn).call(je,Be))}I(this,O,`${Xt.join(`
`)}${ht}${Wt.join(`
`)}`),C(this,Pt,en).call(this);const Ae=new Range;let ye=Xt.reduce((De,Ue)=>De+Ue.length,0);for(const{firstChild:De}of this.editorDiv.childNodes)if(De.nodeType===Node.TEXT_NODE){const Ue=De.nodeValue.length;if(ye<=Ue){Ae.setStart(De,ye),Ae.setEnd(De,ye);break}ye-=Ue}ft.removeAllRanges(),ft.addRange(Ae)}get contentDiv(){return this.editorDiv}static deserialize(s,L,st){var It;let ht=null;if(s instanceof T.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:Gt,fontColor:Tt},rect:Xt,rotation:Wt,id:Ae},textContent:ye,textPosition:xe,parent:{page:{pageNumber:Te}}}=s;if(!ye||ye.length===0)return null;ht=s={annotationType:e.AnnotationEditorType.FREETEXT,color:Array.from(Tt),fontSize:Gt,value:ye.join(`
`),position:xe,pageIndex:Te-1,rect:Xt,rotation:Wt,id:Ae,deleted:!1}}const ft=super.deserialize(s,L,st);return I(ft,tt,s.fontSize),I(ft,$,e.Util.makeHexColor(...s.color)),I(ft,O,C(It=jt,Se,Hn).call(It,s.value)),ft.annotationElementId=s.id||null,I(ft,vt,ht),ft}serialize(s=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const L=jt._internalPadding*this.parentScale,st=this.getRect(L,L),ht=w.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,$)),ft={annotationType:e.AnnotationEditorType.FREETEXT,color:ht,fontSize:t(this,tt),value:C(this,Kt,Zr).call(this),pageIndex:this.pageIndex,rect:st,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return s?ft:this.annotationElementId&&!C(this,le,ta).call(this,ft)?null:(ft.id=this.annotationElementId,ft)}};X=new WeakMap,rt=new WeakMap,J=new WeakMap,M=new WeakMap,j=new WeakMap,$=new WeakMap,O=new WeakMap,q=new WeakMap,tt=new WeakMap,vt=new WeakMap,Ft=new WeakSet,Yr=function(s){const L=ht=>{this.editorDiv.style.fontSize=`calc(${ht}px * var(--scale-factor))`,this.translate(0,-(ht-t(this,tt))*this.parentScale),I(this,tt,ht),C(this,Et,Zi).call(this)},st=t(this,tt);this.addCommands({cmd:L.bind(this,s),undo:L.bind(this,st),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Ot=new WeakSet,Jr=function(s){const L=ht=>{I(this,$,this.editorDiv.style.color=ht)},st=t(this,$);this.addCommands({cmd:L.bind(this,s),undo:L.bind(this,st),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Lt=new WeakSet,Qr=function(){var L;const s=[];this.editorDiv.normalize();for(const st of this.editorDiv.childNodes)s.push(C(L=jt,gt,tn).call(L,st));return s.join(`
`)},Et=new WeakSet,Zi=function(){const[s,L]=this.parentDimensions;let st;if(this.isAttachedToDOM)st=this.div.getBoundingClientRect();else{const{currentLayer:ht,div:ft}=this,It=ft.style.display;ft.style.display="hidden",ht.div.append(this.div),st=ft.getBoundingClientRect(),ft.remove(),ft.style.display=It}this.rotation%180===this.parentRotation%180?(this.width=st.width/s,this.height=st.height/L):(this.width=st.height/s,this.height=st.width/L),this.fixAndSetPosition()},gt=new WeakSet,tn=function(s){return(s.nodeType===Node.TEXT_NODE?s.nodeValue:s.innerText).replaceAll(W,"")},Pt=new WeakSet,en=function(){if(this.editorDiv.replaceChildren(),!!t(this,O))for(const s of t(this,O).split(`
`)){const L=document.createElement("div");L.append(s?document.createTextNode(s):document.createElement("br")),this.editorDiv.append(L)}},Kt=new WeakSet,Zr=function(){return t(this,O).replaceAll("\xA0"," ")},Se=new WeakSet,Hn=function(s){return s.replaceAll(" ","\xA0")},le=new WeakSet,ta=function(s){const{value:L,fontSize:st,color:ht,pageIndex:ft}=t(this,vt);return this._hasBeenMoved||s.value!==L||s.fontSize!==st||s.color.some((It,Gt)=>It!==ht[Gt])||s.pageIndex!==ft},l(jt,gt),l(jt,Se),fe(jt,"_freeTextDefaultContent",""),fe(jt,"_internalPadding",0),fe(jt,"_defaultColor",null),fe(jt,"_defaultFontSize",10),fe(jt,"_type","freetext"),fe(jt,"_editorType",e.AnnotationEditorType.FREETEXT);let k=jt;var _=u(61),g=u(259),H=u(419);const it=class it extends w.AnnotationEditor{constructor(s){super({...s,name:"highlightEditor"});l(this,G);l(this,ot);l(this,At);l(this,xt);l(this,Y);l(this,U);l(this,z);l(this,Mt);l(this,te);l(this,he);l(this,_e);l(this,me);l(this,ae,null);l(this,Ce,0);l(this,ee,void 0);l(this,Ee,null);l(this,ne,null);l(this,et,null);l(this,i,null);l(this,n,0);l(this,c,null);l(this,p,null);l(this,o,null);l(this,y,!1);l(this,b,C(this,Mt,na).bind(this));l(this,E,null);l(this,d,void 0);l(this,a,null);l(this,h,"");l(this,R,void 0);l(this,V,"");this.color=s.color||it._defaultColor,I(this,R,s.thickness||it._defaultThickness),I(this,d,s.opacity||it._defaultOpacity),I(this,ee,s.boxes||null),I(this,V,s.methodOfCreation||""),I(this,h,s.text||""),this._isDraggable=!1,s.highlightId>-1?(I(this,y,!0),C(this,ot,Un).call(this,s),C(this,z,wi).call(this)):(I(this,ae,s.anchorNode),I(this,Ce,s.anchorOffset),I(this,i,s.focusNode),I(this,n,s.focusOffset),C(this,G,Bn).call(this),C(this,z,wi).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const s=it.prototype;return(0,e.shadow)(this,"_keyboardManager",new f.KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],s._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],s._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],s._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],s._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:t(this,y)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:t(this,R),methodOfCreation:t(this,V)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(s){return{numberOfColors:s.get("color").size}}static initialize(s,L){var st;w.AnnotationEditor.initialize(s,L),it._defaultColor||(it._defaultColor=((st=L.highlightColors)==null?void 0:st.values().next().value)||"#fff066")}static updateDefaultParams(s,L){switch(s){case e.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:it._defaultColor=L;break;case e.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:it._defaultThickness=L;break}}translateInPage(s,L){}get toolbarPosition(){return t(this,E)}updateParams(s,L){switch(s){case e.AnnotationEditorParamsType.HIGHLIGHT_COLOR:C(this,At,ea).call(this,L);break;case e.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:C(this,xt,sa).call(this,L);break}}static get defaultPropertiesToUpdate(){return[[e.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR,it._defaultColor],[e.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS,it._defaultThickness]]}get propertiesToUpdate(){return[[e.AnnotationEditorParamsType.HIGHLIGHT_COLOR,this.color||it._defaultColor],[e.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS,t(this,R)||it._defaultThickness],[e.AnnotationEditorParamsType.HIGHLIGHT_FREE,t(this,y)]]}async addEditToolbar(){const s=await super.addEditToolbar();return s?(this._uiManager.highlightColors&&(I(this,ne,new g.ColorPicker({editor:this})),s.addColorPicker(t(this,ne))),s):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(C(this,he,Ei).call(this))}getBaseTranslation(){return[0,0]}getRect(s,L){return super.getRect(s,L,C(this,he,Ei).call(this))}onceAdded(){this.parent.addUndoableEditor(this),this.div.focus()}remove(){C(this,U,$n).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(C(this,z,wi).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(s){var st;let L=!1;this.parent&&!s?C(this,U,$n).call(this):s&&(C(this,z,wi).call(this,s),L=!this.parent&&((st=this.div)==null?void 0:st.classList.contains("selectedEditor"))),super.setParent(s),this.show(this._isVisible),L&&this.select()}rotate(s){var ht,ft,It;const{drawLayer:L}=this.parent;let st;t(this,y)?(s=(s-this.rotation+360)%360,st=C(ht=it,lt,ti).call(ht,t(this,p).box,s)):st=C(ft=it,lt,ti).call(ft,this,s),L.rotate(t(this,o),s),L.rotate(t(this,a),s),L.updateBox(t(this,o),st),L.updateBox(t(this,a),C(It=it,lt,ti).call(It,t(this,et).box,s))}render(){if(this.div)return this.div;const s=super.render();t(this,h)&&(s.setAttribute("aria-label",t(this,h)),s.setAttribute("role","mark")),t(this,y)?s.classList.add("free"):this.div.addEventListener("keydown",t(this,b));const L=I(this,c,document.createElement("div"));s.append(L),L.setAttribute("aria-hidden","true"),L.className="internal",L.style.clipPath=t(this,Ee);const[st,ht]=this.parentDimensions;return this.setDims(this.width*st,this.height*ht),(0,f.bindEvents)(this,t(this,c),["pointerover","pointerleave"]),this.enableEditing(),s}pointerover(){this.parent.drawLayer.addClass(t(this,a),"hovered")}pointerleave(){this.parent.drawLayer.removeClass(t(this,a),"hovered")}_moveCaret(s){switch(this.parent.unselect(this),s){case 0:case 2:C(this,te,sn).call(this,!0);break;case 1:case 3:C(this,te,sn).call(this,!1);break}}select(){var s,L;super.select(),t(this,a)&&((s=this.parent)==null||s.drawLayer.removeClass(t(this,a),"hovered"),(L=this.parent)==null||L.drawLayer.addClass(t(this,a),"selected"))}unselect(){var s;super.unselect(),t(this,a)&&((s=this.parent)==null||s.drawLayer.removeClass(t(this,a),"selected"),t(this,y)||C(this,te,sn).call(this,!1))}get _mustFixPosition(){return!t(this,y)}show(s=this._isVisible){super.show(s),this.parent&&(this.parent.drawLayer.show(t(this,o),s),this.parent.drawLayer.show(t(this,a),s))}static startHighlighting(s,L,{target:st,x:ht,y:ft}){const{x:It,y:Gt,width:Tt,height:Xt}=st.getBoundingClientRect(),Wt=Te=>{C(this,se,oa).call(this,s,Te)},Ae={capture:!0,passive:!1},ye=Te=>{Te.preventDefault(),Te.stopPropagation()},xe=Te=>{st.removeEventListener("pointermove",Wt),window.removeEventListener("blur",xe),window.removeEventListener("pointerup",xe),window.removeEventListener("pointerdown",ye,Ae),window.removeEventListener("contextmenu",H.noContextMenu),C(this,x,ha).call(this,s,Te)};window.addEventListener("blur",xe),window.addEventListener("pointerup",xe),window.addEventListener("pointerdown",ye,Ae),window.addEventListener("contextmenu",H.noContextMenu),st.addEventListener("pointermove",Wt),this._freeHighlight=new _.FreeOutliner({x:ht,y:ft},[It,Gt,Tt,Xt],s.scale,this._defaultThickness/2,L,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=s.drawLayer.highlight(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static deserialize(s,L,st){var Te;const ht=super.deserialize(s,L,st),{rect:[ft,It,Gt,Tt],color:Xt,quadPoints:Wt}=s;ht.color=e.Util.makeHexColor(...Xt),I(ht,d,s.opacity);const[Ae,ye]=ht.pageDimensions;ht.width=(Gt-ft)/Ae,ht.height=(Tt-It)/ye;const xe=I(ht,ee,[]);for(let je=0;je<Wt.length;je+=8)xe.push({x:(Wt[4]-Gt)/Ae,y:(Tt-(1-Wt[je+5]))/ye,width:(Wt[je+2]-Wt[je])/Ae,height:(Wt[je+5]-Wt[je+1])/ye});return C(Te=ht,G,Bn).call(Te),ht}serialize(s=!1){if(this.isEmpty()||s)return null;const L=this.getRect(0,0),st=w.AnnotationEditor._colorManager.convert(this.color);return{annotationType:e.AnnotationEditorType.HIGHLIGHT,color:st,opacity:t(this,d),thickness:t(this,R),quadPoints:C(this,_e,ra).call(this),outlines:C(this,me,aa).call(this,L),pageIndex:this.pageIndex,rect:L,rotation:C(this,he,Ei).call(this),structTreeParentId:this._structTreeParentId}}static canCreateNewEmptyEditor(){return!1}};ae=new WeakMap,Ce=new WeakMap,ee=new WeakMap,Ee=new WeakMap,ne=new WeakMap,et=new WeakMap,i=new WeakMap,n=new WeakMap,c=new WeakMap,p=new WeakMap,o=new WeakMap,y=new WeakMap,b=new WeakMap,E=new WeakMap,d=new WeakMap,a=new WeakMap,h=new WeakMap,R=new WeakMap,V=new WeakMap,G=new WeakSet,Bn=function(){const s=new _.Outliner(t(this,ee),.001);I(this,p,s.getOutlines()),{x:this.x,y:this.y,width:this.width,height:this.height}=t(this,p).box;const L=new _.Outliner(t(this,ee),.0025,.001,this._uiManager.direction==="ltr");I(this,et,L.getOutlines());const{lastPoint:st}=t(this,et).box;I(this,E,[(st[0]-this.x)/this.width,(st[1]-this.y)/this.height])},ot=new WeakSet,Un=function({highlightOutlines:s,highlightId:L,clipPathId:st}){var Wt,Ae;if(I(this,p,s),I(this,et,s.getNewOutline(t(this,R)/2+1.5,.0025)),L>=0)I(this,o,L),I(this,Ee,st),this.parent.drawLayer.finalizeLine(L,s),I(this,a,this.parent.drawLayer.highlightOutline(t(this,et)));else if(this.parent){const ye=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(t(this,o),s),this.parent.drawLayer.updateBox(t(this,o),C(Wt=it,lt,ti).call(Wt,t(this,p).box,(ye-this.rotation+360)%360)),this.parent.drawLayer.updateLine(t(this,a),t(this,et)),this.parent.drawLayer.updateBox(t(this,a),C(Ae=it,lt,ti).call(Ae,t(this,et).box,ye))}const{x:ft,y:It,width:Gt,height:Tt}=s.box;switch(this.rotation){case 0:this.x=ft,this.y=It,this.width=Gt,this.height=Tt;break;case 90:{const[ye,xe]=this.parentDimensions;this.x=It,this.y=1-ft,this.width=Gt*xe/ye,this.height=Tt*ye/xe;break}case 180:this.x=1-ft,this.y=1-It,this.width=Gt,this.height=Tt;break;case 270:{const[ye,xe]=this.parentDimensions;this.x=1-It,this.y=ft,this.width=Gt*xe/ye,this.height=Tt*ye/xe;break}}const{lastPoint:Xt}=t(this,et).box;I(this,E,[(Xt[0]-ft)/Gt,(Xt[1]-It)/Tt])},At=new WeakSet,ea=function(s){const L=ht=>{var ft,It;this.color=ht,(ft=this.parent)==null||ft.drawLayer.changeColor(t(this,o),ht),(It=t(this,ne))==null||It.updateColor(ht)},st=this.color;this.addCommands({cmd:L.bind(this,s),undo:L.bind(this,st),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e.AnnotationEditorParamsType.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(s)},!0)},xt=new WeakSet,sa=function(s){const L=t(this,R),st=ht=>{I(this,R,ht),C(this,Y,ia).call(this,ht)};this.addCommands({cmd:st.bind(this,s),undo:st.bind(this,L),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:s},!0)},Y=new WeakSet,ia=function(s){if(!t(this,y))return;C(this,ot,Un).call(this,{highlightOutlines:t(this,p).getNewOutline(s/2)}),this.fixAndSetPosition();const[L,st]=this.parentDimensions;this.setDims(this.width*L,this.height*st)},U=new WeakSet,$n=function(){t(this,o)===null||!this.parent||(this.parent.drawLayer.remove(t(this,o)),I(this,o,null),this.parent.drawLayer.remove(t(this,a)),I(this,a,null))},z=new WeakSet,wi=function(s=this.parent){t(this,o)===null&&({id:fs(this,o)._,clipPathId:fs(this,Ee)._}=s.drawLayer.highlight(t(this,p),this.color,t(this,d)),I(this,a,s.drawLayer.highlightOutline(t(this,et))),t(this,c)&&(t(this,c).style.clipPath=t(this,Ee)))},lt=new WeakSet,ti=function({x:s,y:L,width:st,height:ht},ft){switch(ft){case 90:return{x:1-L-ht,y:s,width:ht,height:st};case 180:return{x:1-s-st,y:1-L-ht,width:st,height:ht};case 270:return{x:L,y:1-s-st,width:ht,height:st}}return{x:s,y:L,width:st,height:ht}},Mt=new WeakSet,na=function(s){it._keyboardManager.exec(this,s)},te=new WeakSet,sn=function(s){if(!t(this,ae))return;const L=window.getSelection();s?L.setPosition(t(this,ae),t(this,Ce)):L.setPosition(t(this,i),t(this,n))},he=new WeakSet,Ei=function(){return t(this,y)?this.rotation:0},_e=new WeakSet,ra=function(){if(t(this,y))return null;const[s,L]=this.pageDimensions,st=t(this,ee),ht=new Array(st.length*8);let ft=0;for(const{x:It,y:Gt,width:Tt,height:Xt}of st){const Wt=It*s,Ae=(1-Gt-Xt)*L;ht[ft]=ht[ft+4]=Wt,ht[ft+1]=ht[ft+3]=Ae,ht[ft+2]=ht[ft+6]=Wt+Tt*s,ht[ft+5]=ht[ft+7]=Ae+Xt*L,ft+=8}return ht},me=new WeakSet,aa=function(s){return t(this,p).serialize(s,C(this,he,Ei).call(this))},se=new WeakSet,oa=function(s,L){this._freeHighlight.add(L)&&s.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)},x=new WeakSet,ha=function(s,L){this._freeHighlight.isEmpty()?s.drawLayer.removeFreeHighlight(this._freeHighlightId):s.createAndAddNewEditor(L,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},l(it,lt),l(it,se),l(it,x),fe(it,"_defaultColor",null),fe(it,"_defaultOpacity",1),fe(it,"_defaultThickness",12),fe(it,"_l10nPromise"),fe(it,"_type","highlight"),fe(it,"_editorType",e.AnnotationEditorType.HIGHLIGHT),fe(it,"_freeHighlightId",-1),fe(it,"_freeHighlight",null),fe(it,"_freeHighlightClipId","");let S=it;const Ne=class Ne extends w.AnnotationEditor{constructor(s){super({...s,name:"inkEditor"});l(this,Ze);l(this,Ke);l(this,Ve);l(this,dt);l(this,Ut);l(this,Zt);l(this,be);l(this,He);l(this,ze);l(this,Ms);l(this,Di);l(this,Ni);l(this,ds);l(this,ri);l(this,Bs);l(this,Us);l(this,bs);l(this,ai);l(this,$s);l(this,Bi);l(this,hi);l(this,js);l(this,Ls);l(this,ct,0);l(this,wt,0);l(this,bt,this.canvasPointermove.bind(this));l(this,zt,this.canvasPointerleave.bind(this));l(this,Vt,this.canvasPointerup.bind(this));l(this,Nt,this.canvasPointerdown.bind(this));l(this,Yt,null);l(this,$t,new Path2D);l(this,St,!1);l(this,Bt,!1);l(this,Qt,!1);l(this,ue,null);l(this,ce,0);l(this,we,0);l(this,Le,null);this.color=s.color||null,this.thickness=s.thickness||null,this.opacity=s.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(s,L){w.AnnotationEditor.initialize(s,L)}static updateDefaultParams(s,L){switch(s){case e.AnnotationEditorParamsType.INK_THICKNESS:Ne._defaultThickness=L;break;case e.AnnotationEditorParamsType.INK_COLOR:Ne._defaultColor=L;break;case e.AnnotationEditorParamsType.INK_OPACITY:Ne._defaultOpacity=L/100;break}}updateParams(s,L){switch(s){case e.AnnotationEditorParamsType.INK_THICKNESS:C(this,Ze,la).call(this,L);break;case e.AnnotationEditorParamsType.INK_COLOR:C(this,Ke,ca).call(this,L);break;case e.AnnotationEditorParamsType.INK_OPACITY:C(this,Ve,da).call(this,L);break}}static get defaultPropertiesToUpdate(){return[[e.AnnotationEditorParamsType.INK_THICKNESS,Ne._defaultThickness],[e.AnnotationEditorParamsType.INK_COLOR,Ne._defaultColor||w.AnnotationEditor._defaultLineColor],[e.AnnotationEditorParamsType.INK_OPACITY,Math.round(Ne._defaultOpacity*100)]]}get propertiesToUpdate(){return[[e.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Ne._defaultThickness],[e.AnnotationEditorParamsType.INK_COLOR,this.color||Ne._defaultColor||w.AnnotationEditor._defaultLineColor],[e.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Ne._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(C(this,Bs,nn).call(this),C(this,Us,rn).call(this)),this.isAttachedToDOM||(this.parent.add(this),C(this,bs,ei).call(this)),C(this,Ls,xi).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,Yt)&&(clearTimeout(t(this,Yt)),I(this,Yt,null)),t(this,ue).disconnect(),I(this,ue,null),super.remove())}setParent(s){!this.parent&&s?this._uiManager.removeShouldRescale(this):this.parent&&s===null&&this._uiManager.addShouldRescale(this),super.setParent(s)}onScaleChanging(){const[s,L]=this.parentDimensions,st=this.width*s,ht=this.height*L;this.setDimensions(st,ht)}enableEditMode(){t(this,St)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,Nt)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,Nt)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,St)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),I(this,St,!0),this.div.classList.add("disabled"),C(this,Ls,xi).call(this,!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(s){this._focusEventsAllowed&&(super.focusin(s),this.enableEditMode())}canvasPointerdown(s){s.button!==0||!this.isInEditMode()||t(this,St)||(this.setInForeground(),s.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),C(this,Zt,pa).call(this,s.offsetX,s.offsetY))}canvasPointermove(s){s.preventDefault(),C(this,be,Vn).call(this,s.offsetX,s.offsetY)}canvasPointerup(s){s.preventDefault(),C(this,ri,Gn).call(this,s)}canvasPointerleave(s){C(this,ri,Gn).call(this,s)}get isResizable(){return!this.isEmpty()&&t(this,St)}render(){if(this.div)return this.div;let s,L;this.width&&(s=this.x,L=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[st,ht,ft,It]=C(this,dt,ua).call(this);if(this.setAt(st,ht,0,0),this.setDims(ft,It),C(this,Bs,nn).call(this),this.width){const[Gt,Tt]=this.parentDimensions;this.setAspectRatio(this.width*Gt,this.height*Tt),this.setAt(s*Gt,L*Tt,this.width*Gt,this.height*Tt),I(this,Qt,!0),C(this,bs,ei).call(this),this.setDims(this.width*Gt,this.height*Tt),C(this,ds,Ds).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return C(this,Us,rn).call(this),this.div}setDimensions(s,L){const st=Math.round(s),ht=Math.round(L);if(t(this,ce)===st&&t(this,we)===ht)return;I(this,ce,st),I(this,we,ht),this.canvas.style.visibility="hidden";const[ft,It]=this.parentDimensions;this.width=s/ft,this.height=L/It,this.fixAndSetPosition(),t(this,St)&&C(this,ai,qn).call(this,s,L),C(this,bs,ei).call(this),C(this,ds,Ds).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(s,L,st){var je,De,Ue;if(s instanceof T.InkAnnotationElement)return null;const ht=super.deserialize(s,L,st);ht.thickness=s.thickness,ht.color=e.Util.makeHexColor(...s.color),ht.opacity=s.opacity;const[ft,It]=ht.pageDimensions,Gt=ht.width*ft,Tt=ht.height*It,Xt=ht.parentScale,Wt=s.thickness/2;I(ht,St,!0),I(ht,ce,Math.round(Gt)),I(ht,we,Math.round(Tt));const{paths:Ae,rect:ye,rotation:xe}=s;for(let{bezier:Be}of Ae){Be=C(je=Ne,Hi,ya).call(je,Be,ye,xe);const cs=[];ht.paths.push(cs);let fi=Xt*(Be[0]-Wt),vi=Xt*(Be[1]-Wt);for(let as=2,Sn=Be.length;as<Sn;as+=6){const Cn=Xt*(Be[as]-Wt),qi=Xt*(Be[as+1]-Wt),zi=Xt*(Be[as+2]-Wt),Wi=Xt*(Be[as+3]-Wt),bi=Xt*(Be[as+4]-Wt),Vr=Xt*(Be[as+5]-Wt);cs.push([[fi,vi],[Cn,qi],[zi,Wi],[bi,Vr]]),fi=bi,vi=Vr}const Gi=C(this,Oi,Aa).call(this,cs);ht.bezierPath2D.push(Gi)}const Te=C(De=ht,hi,Wn).call(De);return I(ht,wt,Math.max(w.AnnotationEditor.MIN_SIZE,Te[2]-Te[0])),I(ht,ct,Math.max(w.AnnotationEditor.MIN_SIZE,Te[3]-Te[1])),C(Ue=ht,ai,qn).call(Ue,Gt,Tt),ht}serialize(){if(this.isEmpty())return null;const s=this.getRect(0,0),L=w.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:e.AnnotationEditorType.INK,color:L,thickness:this.thickness,opacity:this.opacity,paths:C(this,Bi,_a).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,s),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};ct=new WeakMap,wt=new WeakMap,bt=new WeakMap,zt=new WeakMap,Vt=new WeakMap,Nt=new WeakMap,Yt=new WeakMap,$t=new WeakMap,St=new WeakMap,Bt=new WeakMap,Qt=new WeakMap,ue=new WeakMap,ce=new WeakMap,we=new WeakMap,Le=new WeakMap,Ze=new WeakSet,la=function(s){const L=ht=>{this.thickness=ht,C(this,Ls,xi).call(this)},st=this.thickness;this.addCommands({cmd:L.bind(this,s),undo:L.bind(this,st),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Ke=new WeakSet,ca=function(s){const L=ht=>{this.color=ht,C(this,ds,Ds).call(this)},st=this.color;this.addCommands({cmd:L.bind(this,s),undo:L.bind(this,st),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Ve=new WeakSet,da=function(s){const L=ht=>{this.opacity=ht,C(this,ds,Ds).call(this)};s/=100;const st=this.opacity;this.addCommands({cmd:L.bind(this,s),undo:L.bind(this,st),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},dt=new WeakSet,ua=function(){const{parentRotation:s,parentDimensions:[L,st]}=this;switch(s){case 90:return[0,st,st,L];case 180:return[L,st,L,st];case 270:return[L,0,st,L];default:return[0,0,L,st]}},Ut=new WeakSet,jn=function(){const{ctx:s,color:L,opacity:st,thickness:ht,parentScale:ft,scaleFactor:It}=this;s.lineWidth=ht*ft/It,s.lineCap="round",s.lineJoin="round",s.miterLimit=10,s.strokeStyle=`${L}${(0,f.opacityToHex)(st)}`},Zt=new WeakSet,pa=function(s,L){this.canvas.addEventListener("contextmenu",H.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,zt)),this.canvas.addEventListener("pointermove",t(this,bt)),this.canvas.addEventListener("pointerup",t(this,Vt)),this.canvas.removeEventListener("pointerdown",t(this,Nt)),this.isEditing=!0,t(this,Qt)||(I(this,Qt,!0),C(this,bs,ei).call(this),this.thickness||(this.thickness=Ne._defaultThickness),this.color||(this.color=Ne._defaultColor||w.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Ne._defaultOpacity)),this.currentPath.push([s,L]),I(this,Bt,!1),C(this,Ut,jn).call(this),I(this,Le,()=>{C(this,Ms,fa).call(this),t(this,Le)&&window.requestAnimationFrame(t(this,Le))}),window.requestAnimationFrame(t(this,Le))},be=new WeakSet,Vn=function(s,L){const[st,ht]=this.currentPath.at(-1);if(this.currentPath.length>1&&s===st&&L===ht)return;const ft=this.currentPath;let It=t(this,$t);if(ft.push([s,L]),I(this,Bt,!0),ft.length<=2){It.moveTo(...ft[0]),It.lineTo(s,L);return}ft.length===3&&(I(this,$t,It=new Path2D),It.moveTo(...ft[0])),C(this,Di,va).call(this,It,...ft.at(-3),...ft.at(-2),s,L)},He=new WeakSet,ga=function(){if(this.currentPath.length===0)return;const s=this.currentPath.at(-1);t(this,$t).lineTo(...s)},ze=new WeakSet,ma=function(s,L){I(this,Le,null),s=Math.min(Math.max(s,0),this.canvas.width),L=Math.min(Math.max(L,0),this.canvas.height),C(this,be,Vn).call(this,s,L),C(this,He,ga).call(this);let st;if(this.currentPath.length!==1)st=C(this,Ni,ba).call(this);else{const Tt=[s,L];st=[[Tt,Tt.slice(),Tt.slice(),Tt]]}const ht=t(this,$t),ft=this.currentPath;this.currentPath=[],I(this,$t,new Path2D);const It=()=>{this.allRawPaths.push(ft),this.paths.push(st),this.bezierPath2D.push(ht),this._uiManager.rebuild(this)},Gt=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(C(this,Bs,nn).call(this),C(this,Us,rn).call(this)),C(this,Ls,xi).call(this))};this.addCommands({cmd:It,undo:Gt,mustExec:!0})},Ms=new WeakSet,fa=function(){if(!t(this,Bt))return;I(this,Bt,!1);const s=Math.ceil(this.thickness*this.parentScale),L=this.currentPath.slice(-3),st=L.map(It=>It[0]),ht=L.map(It=>It[1]);Math.min(...st)-s,Math.max(...st)+s,Math.min(...ht)-s,Math.max(...ht)+s;const{ctx:ft}=this;ft.save(),ft.clearRect(0,0,this.canvas.width,this.canvas.height);for(const It of this.bezierPath2D)ft.stroke(It);ft.stroke(t(this,$t)),ft.restore()},Di=new WeakSet,va=function(s,L,st,ht,ft,It,Gt){const Tt=(L+ht)/2,Xt=(st+ft)/2,Wt=(ht+It)/2,Ae=(ft+Gt)/2;s.bezierCurveTo(Tt+2*(ht-Tt)/3,Xt+2*(ft-Xt)/3,Wt+2*(ht-Wt)/3,Ae+2*(ft-Ae)/3,Wt,Ae)},Ni=new WeakSet,ba=function(){const s=this.currentPath;if(s.length<=2)return[[s[0],s[0],s.at(-1),s.at(-1)]];const L=[];let st,[ht,ft]=s[0];for(st=1;st<s.length-2;st++){const[ye,xe]=s[st],[Te,je]=s[st+1],De=(ye+Te)/2,Ue=(xe+je)/2,Be=[ht+2*(ye-ht)/3,ft+2*(xe-ft)/3],cs=[De+2*(ye-De)/3,Ue+2*(xe-Ue)/3];L.push([[ht,ft],Be,cs,[De,Ue]]),[ht,ft]=[De,Ue]}const[It,Gt]=s[st],[Tt,Xt]=s[st+1],Wt=[ht+2*(It-ht)/3,ft+2*(Gt-ft)/3],Ae=[Tt+2*(It-Tt)/3,Xt+2*(Gt-Xt)/3];return L.push([[ht,ft],Wt,Ae,[Tt,Xt]]),L},ds=new WeakSet,Ds=function(){if(this.isEmpty()){C(this,$s,an).call(this);return}C(this,Ut,jn).call(this);const{canvas:s,ctx:L}=this;L.setTransform(1,0,0,1,0,0),L.clearRect(0,0,s.width,s.height),C(this,$s,an).call(this);for(const st of this.bezierPath2D)L.stroke(st)},ri=new WeakSet,Gn=function(s){this.canvas.removeEventListener("pointerleave",t(this,zt)),this.canvas.removeEventListener("pointermove",t(this,bt)),this.canvas.removeEventListener("pointerup",t(this,Vt)),this.canvas.addEventListener("pointerdown",t(this,Nt)),t(this,Yt)&&clearTimeout(t(this,Yt)),I(this,Yt,setTimeout(()=>{I(this,Yt,null),this.canvas.removeEventListener("contextmenu",H.noContextMenu)},10)),C(this,ze,ma).call(this,s.offsetX,s.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Bs=new WeakSet,nn=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Us=new WeakSet,rn=function(){I(this,ue,new ResizeObserver(s=>{const L=s[0].contentRect;L.width&&L.height&&this.setDimensions(L.width,L.height)})),t(this,ue).observe(this.div)},bs=new WeakSet,ei=function(){if(!t(this,Qt))return;const[s,L]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*s),this.canvas.height=Math.ceil(this.height*L),C(this,$s,an).call(this)},ai=new WeakSet,qn=function(s,L){const st=C(this,js,on).call(this),ht=(s-st)/t(this,wt),ft=(L-st)/t(this,ct);this.scaleFactor=Math.min(ht,ft)},$s=new WeakSet,an=function(){const s=C(this,js,on).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+s,this.translationY*this.scaleFactor+s)},Oi=new WeakSet,Aa=function(s){const L=new Path2D;for(let st=0,ht=s.length;st<ht;st++){const[ft,It,Gt,Tt]=s[st];st===0&&L.moveTo(...ft),L.bezierCurveTo(It[0],It[1],Gt[0],Gt[1],Tt[0],Tt[1])}return L},oi=new WeakSet,zn=function(s,L,st){const[ht,ft,It,Gt]=L;switch(st){case 0:for(let Tt=0,Xt=s.length;Tt<Xt;Tt+=2)s[Tt]+=ht,s[Tt+1]=Gt-s[Tt+1];break;case 90:for(let Tt=0,Xt=s.length;Tt<Xt;Tt+=2){const Wt=s[Tt];s[Tt]=s[Tt+1]+ht,s[Tt+1]=Wt+ft}break;case 180:for(let Tt=0,Xt=s.length;Tt<Xt;Tt+=2)s[Tt]=It-s[Tt],s[Tt+1]+=ft;break;case 270:for(let Tt=0,Xt=s.length;Tt<Xt;Tt+=2){const Wt=s[Tt];s[Tt]=It-s[Tt+1],s[Tt+1]=Gt-Wt}break;default:throw new Error("Invalid rotation")}return s},Hi=new WeakSet,ya=function(s,L,st){const[ht,ft,It,Gt]=L;switch(st){case 0:for(let Tt=0,Xt=s.length;Tt<Xt;Tt+=2)s[Tt]-=ht,s[Tt+1]=Gt-s[Tt+1];break;case 90:for(let Tt=0,Xt=s.length;Tt<Xt;Tt+=2){const Wt=s[Tt];s[Tt]=s[Tt+1]-ft,s[Tt+1]=Wt-ht}break;case 180:for(let Tt=0,Xt=s.length;Tt<Xt;Tt+=2)s[Tt]=It-s[Tt],s[Tt+1]-=ft;break;case 270:for(let Tt=0,Xt=s.length;Tt<Xt;Tt+=2){const Wt=s[Tt];s[Tt]=Gt-s[Tt+1],s[Tt+1]=It-Wt}break;default:throw new Error("Invalid rotation")}return s},Bi=new WeakSet,_a=function(s,L,st,ht){var Xt,Wt;const ft=[],It=this.thickness/2,Gt=s*L+It,Tt=s*st+It;for(const Ae of this.paths){const ye=[],xe=[];for(let Te=0,je=Ae.length;Te<je;Te++){const[De,Ue,Be,cs]=Ae[Te];if(De[0]===cs[0]&&De[1]===cs[1]&&je===1){const Wi=s*De[0]+Gt,bi=s*De[1]+Tt;ye.push(Wi,bi),xe.push(Wi,bi);break}const fi=s*De[0]+Gt,vi=s*De[1]+Tt,Gi=s*Ue[0]+Gt,as=s*Ue[1]+Tt,Sn=s*Be[0]+Gt,Cn=s*Be[1]+Tt,qi=s*cs[0]+Gt,zi=s*cs[1]+Tt;Te===0&&(ye.push(fi,vi),xe.push(fi,vi)),ye.push(Gi,as,Sn,Cn,qi,zi),xe.push(Gi,as),Te===je-1&&xe.push(qi,zi)}ft.push({bezier:C(Xt=Ne,oi,zn).call(Xt,ye,ht,this.rotation),points:C(Wt=Ne,oi,zn).call(Wt,xe,ht,this.rotation)})}return ft},hi=new WeakSet,Wn=function(){let s=1/0,L=-1/0,st=1/0,ht=-1/0;for(const ft of this.paths)for(const[It,Gt,Tt,Xt]of ft){const Wt=e.Util.bezierBoundingBox(...It,...Gt,...Tt,...Xt);s=Math.min(s,Wt[0]),st=Math.min(st,Wt[1]),L=Math.max(L,Wt[2]),ht=Math.max(ht,Wt[3])}return[s,st,L,ht]},js=new WeakSet,on=function(){return t(this,St)?Math.ceil(this.thickness*this.parentScale):0},Ls=new WeakSet,xi=function(s=!1){if(this.isEmpty())return;if(!t(this,St)){C(this,ds,Ds).call(this);return}const L=C(this,hi,Wn).call(this),st=C(this,js,on).call(this);I(this,wt,Math.max(w.AnnotationEditor.MIN_SIZE,L[2]-L[0])),I(this,ct,Math.max(w.AnnotationEditor.MIN_SIZE,L[3]-L[1]));const ht=Math.ceil(st+t(this,wt)*this.scaleFactor),ft=Math.ceil(st+t(this,ct)*this.scaleFactor),[It,Gt]=this.parentDimensions;this.width=ht/It,this.height=ft/Gt,this.setAspectRatio(ht,ft);const Tt=this.translationX,Xt=this.translationY;this.translationX=-L[0],this.translationY=-L[1],C(this,bs,ei).call(this),C(this,ds,Ds).call(this),I(this,ce,ht),I(this,we,ft),this.setDims(ht,ft);const Wt=s?st/this.scaleFactor/2:0;this.translate(Tt-this.translationX-Wt,Xt-this.translationY-Wt)},l(Ne,Oi),l(Ne,oi),l(Ne,Hi),fe(Ne,"_defaultColor",null),fe(Ne,"_defaultOpacity",1),fe(Ne,"_defaultThickness",1),fe(Ne,"_type","ink"),fe(Ne,"_editorType",e.AnnotationEditorType.INK);let A=Ne;const ui=class ui extends w.AnnotationEditor{constructor(s){super({...s,name:"stampEditor"});l(this,ks);l(this,Rs);l(this,Gs);l(this,ci);l(this,Ui);l(this,$i);l(this,di);l(this,qs);l(this,ji);l(this,Ge,null);l(this,qe,null);l(this,As,null);l(this,us,null);l(this,ys,null);l(this,Vs,"");l(this,os,null);l(this,Ts,null);l(this,hs,null);l(this,ns,!1);l(this,li,!1);I(this,us,s.bitmapUrl),I(this,ys,s.bitmapFile)}static initialize(s,L){w.AnnotationEditor.initialize(s,L)}static get supportedTypes(){const s=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,e.shadow)(this,"supportedTypes",s.map(L=>`image/${L}`))}static get supportedTypesStr(){return(0,e.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(s){return this.supportedTypes.includes(s)}static paste(s,L){L.pasteEditor(e.AnnotationEditorType.STAMP,{bitmapFile:s.getAsFile()})}remove(){var s,L;t(this,qe)&&(I(this,Ge,null),this._uiManager.imageManager.deleteId(t(this,qe)),(s=t(this,os))==null||s.remove(),I(this,os,null),(L=t(this,Ts))==null||L.disconnect(),I(this,Ts,null),t(this,hs)&&(clearTimeout(t(this,hs)),I(this,hs,null))),super.remove()}rebuild(){if(!this.parent){t(this,qe)&&C(this,Gs,hn).call(this);return}super.rebuild(),this.div!==null&&(t(this,qe)&&t(this,os)===null&&C(this,Gs,hn).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,As)||t(this,Ge)||t(this,us)||t(this,ys)||t(this,qe))}get isResizable(){return!0}render(){if(this.div)return this.div;let s,L;if(this.width&&(s=this.x,L=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),t(this,Ge)?C(this,ci,Xn).call(this):C(this,Gs,hn).call(this),this.width){const[st,ht]=this.parentDimensions;this.setAt(s*st,L*ht,this.width*st,this.height*ht)}return this.div}getImageForAltText(){return t(this,os)}static deserialize(s,L,st){if(s instanceof T.StampAnnotationElement)return null;const ht=super.deserialize(s,L,st),{rect:ft,bitmapUrl:It,bitmapId:Gt,isSvg:Tt,accessibilityData:Xt}=s;Gt&&st.imageManager.isValidId(Gt)?I(ht,qe,Gt):I(ht,us,It),I(ht,ns,Tt);const[Wt,Ae]=ht.pageDimensions;return ht.width=(ft[2]-ft[0])/Wt,ht.height=(ft[3]-ft[1])/Ae,Xt&&(ht.altTextData=Xt),ht}serialize(s=!1,L=null){if(this.isEmpty())return null;const st={annotationType:e.AnnotationEditorType.STAMP,bitmapId:t(this,qe),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,ns),structTreeParentId:this._structTreeParentId};if(s)return st.bitmapUrl=C(this,qs,ln).call(this,!0),st.accessibilityData=this.altTextData,st;const{decorative:ht,altText:ft}=this.altTextData;if(!ht&&ft&&(st.accessibilityData={type:"Figure",alt:ft}),L===null)return st;L.stamps||(L.stamps=new Map);const It=t(this,ns)?(st.rect[2]-st.rect[0])*(st.rect[3]-st.rect[1]):null;if(!L.stamps.has(t(this,qe)))L.stamps.set(t(this,qe),{area:It,serialized:st}),st.bitmap=C(this,qs,ln).call(this,!1);else if(t(this,ns)){const Gt=L.stamps.get(t(this,qe));It>Gt.area&&(Gt.area=It,Gt.serialized.bitmap.close(),Gt.serialized.bitmap=C(this,qs,ln).call(this,!1))}return st}};Ge=new WeakMap,qe=new WeakMap,As=new WeakMap,us=new WeakMap,ys=new WeakMap,Vs=new WeakMap,os=new WeakMap,Ts=new WeakMap,hs=new WeakMap,ns=new WeakMap,li=new WeakMap,ks=new WeakSet,Si=function(s,L=!1){if(!s){this.remove();return}I(this,Ge,s.bitmap),L||(I(this,qe,s.id),I(this,ns,s.isSvg)),s.file&&I(this,Vs,s.file.name),C(this,ci,Xn).call(this)},Rs=new WeakSet,Ci=function(){I(this,As,null),this._uiManager.enableWaiting(!1),t(this,os)&&this.div.focus()},Gs=new WeakSet,hn=function(){if(t(this,qe)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,qe)).then(L=>C(this,ks,Si).call(this,L,!0)).finally(()=>C(this,Rs,Ci).call(this));return}if(t(this,us)){const L=t(this,us);I(this,us,null),this._uiManager.enableWaiting(!0),I(this,As,this._uiManager.imageManager.getFromUrl(L).then(st=>C(this,ks,Si).call(this,st)).finally(()=>C(this,Rs,Ci).call(this)));return}if(t(this,ys)){const L=t(this,ys);I(this,ys,null),this._uiManager.enableWaiting(!0),I(this,As,this._uiManager.imageManager.getFromFile(L).then(st=>C(this,ks,Si).call(this,st)).finally(()=>C(this,Rs,Ci).call(this)));return}const s=document.createElement("input");s.type="file",s.accept=ui.supportedTypesStr,I(this,As,new Promise(L=>{s.addEventListener("change",async()=>{if(!s.files||s.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const st=await this._uiManager.imageManager.getFromFile(s.files[0]);C(this,ks,Si).call(this,st)}L()}),s.addEventListener("cancel",()=>{this.remove(),L()})}).finally(()=>C(this,Rs,Ci).call(this))),s.click()},ci=new WeakSet,Xn=function(){const{div:s}=this;let{width:L,height:st}=t(this,Ge);const[ht,ft]=this.pageDimensions,It=.75;if(this.width)L=this.width*ht,st=this.height*ft;else if(L>It*ht||st>It*ft){const Wt=Math.min(It*ht/L,It*ft/st);L*=Wt,st*=Wt}const[Gt,Tt]=this.parentDimensions;this.setDims(L*Gt/ht,st*Tt/ft),this._uiManager.enableWaiting(!1);const Xt=I(this,os,document.createElement("canvas"));s.append(Xt),s.hidden=!1,C(this,di,Kn).call(this,L,st),C(this,ji,xa).call(this),t(this,li)||(this.parent.addUndoableEditor(this),I(this,li,!0)),this._reportTelemetry({action:"inserted_image"}),t(this,Vs)&&Xt.setAttribute("aria-label",t(this,Vs))},Ui=new WeakSet,wa=function(s,L){var It;const[st,ht]=this.parentDimensions;this.width=s/st,this.height=L/ht,this.setDims(s,L),(It=this._initialOptions)!=null&&It.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,hs)!==null&&clearTimeout(t(this,hs)),I(this,hs,setTimeout(()=>{I(this,hs,null),C(this,di,Kn).call(this,s,L)},200))},$i=new WeakSet,Ea=function(s,L){const{width:st,height:ht}=t(this,Ge);let ft=st,It=ht,Gt=t(this,Ge);for(;ft>2*s||It>2*L;){const Tt=ft,Xt=It;ft>2*s&&(ft=ft>=16384?Math.floor(ft/2)-1:Math.ceil(ft/2)),It>2*L&&(It=It>=16384?Math.floor(It/2)-1:Math.ceil(It/2));const Wt=new OffscreenCanvas(ft,It);Wt.getContext("2d").drawImage(Gt,0,0,Tt,Xt,0,0,ft,It),Gt=Wt.transferToImageBitmap()}return Gt},di=new WeakSet,Kn=function(s,L){s=Math.ceil(s),L=Math.ceil(L);const st=t(this,os);if(!st||st.width===s&&st.height===L)return;st.width=s,st.height=L;const ht=t(this,ns)?t(this,Ge):C(this,$i,Ea).call(this,s,L);if(this._uiManager.hasMLManager&&!this.hasAltText()){const It=new OffscreenCanvas(s,L);It.getContext("2d").drawImage(ht,0,0,ht.width,ht.height,0,0,s,L),It.convertToBlob().then(Gt=>{const Tt=new FileReader;Tt.onload=()=>{const Xt=Tt.result;this._uiManager.mlGuess({service:"image-to-text",request:{imageData:Xt}}).then(Wt=>{const Ae=(Wt==null?void 0:Wt.output)||"";this.parent&&Ae&&!this.hasAltText()&&(this.altTextData={altText:Ae,decorative:!1})})},Tt.readAsDataURL(Gt)})}const ft=st.getContext("2d");ft.filter=this._uiManager.hcmFilter,ft.drawImage(ht,0,0,ht.width,ht.height,0,0,s,L)},qs=new WeakSet,ln=function(s){if(s){if(t(this,ns)){const st=this._uiManager.imageManager.getSvgUrl(t(this,qe));if(st)return st}const L=document.createElement("canvas");return{width:L.width,height:L.height}=t(this,Ge),L.getContext("2d").drawImage(t(this,Ge),0,0),L.toDataURL()}if(t(this,ns)){const[L,st]=this.pageDimensions,ht=Math.round(this.width*L*H.PixelsPerInch.PDF_TO_CSS_UNITS),ft=Math.round(this.height*st*H.PixelsPerInch.PDF_TO_CSS_UNITS),It=new OffscreenCanvas(ht,ft);return It.getContext("2d").drawImage(t(this,Ge),0,0,t(this,Ge).width,t(this,Ge).height,0,0,ht,ft),It.transferToImageBitmap()}return structuredClone(t(this,Ge))},ji=new WeakSet,xa=function(){I(this,Ts,new ResizeObserver(s=>{const L=s[0].contentRect;L.width&&L.height&&C(this,Ui,wa).call(this,L.width,L.height)})),t(this,Ts).observe(this.div)},fe(ui,"_type","stamp"),fe(ui,"_editorType",e.AnnotationEditorType.STAMP);let F=ui;const rs=class rs{constructor({uiManager:pt,pageIndex:s,div:L,accessibilityManager:st,annotationLayer:ht,drawLayer:ft,textLayer:It,viewport:Gt,l10n:Tt}){l(this,Vi);l(this,pi);l(this,gi);l(this,mi);l(this,Ks);l(this,Ps,void 0);l(this,zs,!1);l(this,ls,null);l(this,Is,null);l(this,ps,null);l(this,gs,null);l(this,ms,null);l(this,ts,new Map);l(this,_s,!1);l(this,Ws,!1);l(this,Xs,!1);l(this,Je,null);l(this,pe,void 0);const Xt=[...t(rs,ws).values()];if(!rs._initialized){rs._initialized=!0;for(const Wt of Xt)Wt.initialize(Tt,pt)}pt.registerEditorTypes(Xt),I(this,pe,pt),this.pageIndex=s,this.div=L,I(this,Ps,st),I(this,ls,ht),this.viewport=Gt,I(this,Je,It),this.drawLayer=ft,t(this,pe).addLayer(this)}get isEmpty(){return t(this,ts).size===0}get isInvisible(){return this.isEmpty&&t(this,pe).getMode()===e.AnnotationEditorType.NONE}updateToolbar(pt){t(this,pe).updateToolbar(pt)}updateMode(pt=t(this,pe).getMode()){switch(C(this,Ks,cn).call(this),pt){case e.AnnotationEditorType.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case e.AnnotationEditorType.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case e.AnnotationEditorType.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:s}=this.div;for(const L of t(rs,ws).values())s.toggle(`${L._type}Editing`,pt===L._editorType);this.div.hidden=!1}hasTextLayer(pt){var s;return pt===((s=t(this,Je))==null?void 0:s.div)}addInkEditorIfNeeded(pt){if(t(this,pe).getMode()===e.AnnotationEditorType.INK){if(!pt){for(const s of t(this,ts).values())if(s.isEmpty()){s.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}}setEditingState(pt){t(this,pe).setEditingState(pt)}addCommands(pt){t(this,pe).addCommands(pt)}togglePointerEvents(pt=!1){this.div.classList.toggle("disabled",!pt)}toggleAnnotationLayerPointerEvents(pt=!1){var s;(s=t(this,ls))==null||s.div.classList.toggle("disabled",!pt)}enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const pt=new Set;for(const L of t(this,ts).values())L.enableEditing(),L.annotationElementId&&pt.add(L.annotationElementId);if(!t(this,ls))return;const s=t(this,ls).getEditableAnnotations();for(const L of s){if(L.hide(),t(this,pe).isDeletedAnnotationElement(L.data.id)||pt.has(L.data.id))continue;const st=this.deserialize(L);st&&(this.addOrRebuild(st),st.enableEditing())}}disable(){var L;I(this,Xs,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const pt=new Set;for(const st of t(this,ts).values()){if(st.disableEditing(),!st.annotationElementId||st.serialize()!==null){pt.add(st.annotationElementId);continue}(L=this.getEditableAnnotation(st.annotationElementId))==null||L.show(),st.remove()}if(t(this,ls)){const st=t(this,ls).getEditableAnnotations();for(const ht of st){const{id:ft}=ht.data;pt.has(ft)||t(this,pe).isDeletedAnnotationElement(ft)||ht.show()}}C(this,Ks,cn).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const st of t(rs,ws).values())s.remove(`${st._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),I(this,Xs,!1)}getEditableAnnotation(pt){var s;return((s=t(this,ls))==null?void 0:s.getEditableAnnotation(pt))||null}setActiveEditor(pt){t(this,pe).getActive()!==pt&&t(this,pe).setActiveEditor(pt)}enableTextSelection(){var pt;this.div.tabIndex=-1,(pt=t(this,Je))!=null&&pt.div&&!t(this,gs)&&(I(this,gs,C(this,Vi,Sa).bind(this)),t(this,Je).div.addEventListener("pointerdown",t(this,gs)),t(this,Je).div.classList.add("highlighting"))}disableTextSelection(){var pt;this.div.tabIndex=0,(pt=t(this,Je))!=null&&pt.div&&t(this,gs)&&(t(this,Je).div.removeEventListener("pointerdown",t(this,gs)),I(this,gs,null),t(this,Je).div.classList.remove("highlighting"))}enableClick(){t(this,ps)||(I(this,ps,this.pointerdown.bind(this)),I(this,Is,this.pointerup.bind(this)),this.div.addEventListener("pointerdown",t(this,ps)),this.div.addEventListener("pointerup",t(this,Is)))}disableClick(){t(this,ps)&&(this.div.removeEventListener("pointerdown",t(this,ps)),this.div.removeEventListener("pointerup",t(this,Is)),I(this,ps,null),I(this,Is,null))}attach(pt){t(this,ts).set(pt.id,pt);const{annotationElementId:s}=pt;s&&t(this,pe).isDeletedAnnotationElement(s)&&t(this,pe).removeDeletedAnnotationElement(pt)}detach(pt){var s;t(this,ts).delete(pt.id),(s=t(this,Ps))==null||s.removePointerInTextLayer(pt.contentDiv),!t(this,Xs)&&pt.annotationElementId&&t(this,pe).addDeletedAnnotationElement(pt)}remove(pt){this.detach(pt),t(this,pe).removeEditor(pt),pt.div.remove(),pt.isAttachedToDOM=!1,t(this,Ws)||this.addInkEditorIfNeeded(!1)}changeParent(pt){var s;pt.parent!==this&&(pt.annotationElementId&&(t(this,pe).addDeletedAnnotationElement(pt.annotationElementId),w.AnnotationEditor.deleteAnnotationElement(pt),pt.annotationElementId=null),this.attach(pt),(s=pt.parent)==null||s.detach(pt),pt.setParent(this),pt.div&&pt.isAttachedToDOM&&(pt.div.remove(),this.div.append(pt.div)))}add(pt){if(!(pt.parent===this&&pt.isAttachedToDOM)){if(this.changeParent(pt),t(this,pe).addEditor(pt),this.attach(pt),!pt.isAttachedToDOM){const s=pt.render();this.div.append(s),pt.isAttachedToDOM=!0}pt.fixAndSetPosition(),pt.onceAdded(),t(this,pe).addToAnnotationStorage(pt),pt._reportTelemetry(pt.telemetryInitialData)}}moveEditorInDOM(pt){var L;if(!pt.isAttachedToDOM)return;const{activeElement:s}=document;pt.div.contains(s)&&!t(this,ms)&&(pt._focusEventsAllowed=!1,I(this,ms,setTimeout(()=>{I(this,ms,null),pt.div.contains(document.activeElement)?pt._focusEventsAllowed=!0:(pt.div.addEventListener("focusin",()=>{pt._focusEventsAllowed=!0},{once:!0}),s.focus())},0))),pt._structTreeParentId=(L=t(this,Ps))==null?void 0:L.moveElementInDOM(this.div,pt.div,pt.contentDiv,!0)}addOrRebuild(pt){pt.needsToBeRebuilt()?(pt.parent||(pt.parent=this),pt.rebuild(),pt.show()):this.add(pt)}addUndoableEditor(pt){const s=()=>pt._uiManager.rebuild(pt),L=()=>{pt.remove()};this.addCommands({cmd:s,undo:L,mustExec:!1})}getNextId(){return t(this,pe).getId()}canCreateNewEmptyEditor(){var pt;return(pt=t(this,pi,Yn))==null?void 0:pt.canCreateNewEmptyEditor()}pasteEditor(pt,s){t(this,pe).updateToolbar(pt),t(this,pe).updateMode(pt);const{offsetX:L,offsetY:st}=C(this,mi,Qn).call(this),ht=this.getNextId(),ft=C(this,gi,Jn).call(this,{parent:this,id:ht,x:L,y:st,uiManager:t(this,pe),isCentered:!0,...s});ft&&this.add(ft)}deserialize(pt){var s;return((s=t(rs,ws).get(pt.annotationType??pt.annotationEditorType))==null?void 0:s.deserialize(pt,this,t(this,pe)))||null}createAndAddNewEditor(pt,s,L={}){const st=this.getNextId(),ht=C(this,gi,Jn).call(this,{parent:this,id:st,x:pt.offsetX,y:pt.offsetY,uiManager:t(this,pe),isCentered:s,...L});return ht&&this.add(ht),ht}addNewEditor(){this.createAndAddNewEditor(C(this,mi,Qn).call(this),!0)}setSelected(pt){t(this,pe).setSelected(pt)}toggleSelected(pt){t(this,pe).toggleSelected(pt)}isSelected(pt){return t(this,pe).isSelected(pt)}unselect(pt){t(this,pe).unselect(pt)}pointerup(pt){const{isMac:s}=e.FeatureTest.platform;if(!(pt.button!==0||pt.ctrlKey&&s)&&pt.target===this.div&&t(this,_s)){if(I(this,_s,!1),!t(this,zs)){I(this,zs,!0);return}if(t(this,pe).getMode()===e.AnnotationEditorType.STAMP){t(this,pe).unselectAll();return}this.createAndAddNewEditor(pt,!1)}}pointerdown(pt){if(t(this,pe).getMode()===e.AnnotationEditorType.HIGHLIGHT&&this.enableTextSelection(),t(this,_s)){I(this,_s,!1);return}const{isMac:s}=e.FeatureTest.platform;if(pt.button!==0||pt.ctrlKey&&s||pt.target!==this.div)return;I(this,_s,!0);const L=t(this,pe).getActive();I(this,zs,!L||L.isEmpty())}findNewParent(pt,s,L){const st=t(this,pe).findParent(s,L);return st===null||st===this?!1:(st.changeParent(pt),!0)}destroy(){var pt,s;((pt=t(this,pe).getActive())==null?void 0:pt.parent)===this&&(t(this,pe).commitOrRemove(),t(this,pe).setActiveEditor(null)),t(this,ms)&&(clearTimeout(t(this,ms)),I(this,ms,null));for(const L of t(this,ts).values())(s=t(this,Ps))==null||s.removePointerInTextLayer(L.contentDiv),L.setParent(null),L.isAttachedToDOM=!1,L.div.remove();this.div=null,t(this,ts).clear(),t(this,pe).removeLayer(this)}render({viewport:pt}){this.viewport=pt,(0,H.setLayerDimensions)(this.div,pt);for(const s of t(this,pe).getEditors(this.pageIndex))this.add(s),s.rebuild();this.updateMode()}update({viewport:pt}){t(this,pe).commitOrRemove(),C(this,Ks,cn).call(this);const s=this.viewport.rotation,L=pt.rotation;if(this.viewport=pt,(0,H.setLayerDimensions)(this.div,{rotation:L}),s!==L)for(const st of t(this,ts).values())st.rotate(L);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:pt,pageHeight:s}=this.viewport.rawDims;return[pt,s]}get scale(){return t(this,pe).viewParameters.realScale}};Ps=new WeakMap,zs=new WeakMap,ls=new WeakMap,Is=new WeakMap,ps=new WeakMap,gs=new WeakMap,ms=new WeakMap,ts=new WeakMap,_s=new WeakMap,Ws=new WeakMap,Xs=new WeakMap,Je=new WeakMap,pe=new WeakMap,ws=new WeakMap,Vi=new WeakSet,Sa=function(pt){if(t(this,pe).unselectAll(),pt.target===t(this,Je).div){const{isMac:s}=e.FeatureTest.platform;if(pt.button!==0||pt.ctrlKey&&s)return;t(this,pe).showAllEditors("highlight",!0,!0),t(this,Je).div.classList.add("free"),S.startHighlighting(this,t(this,pe).direction==="ltr",pt),t(this,Je).div.addEventListener("pointerup",()=>{t(this,Je).div.classList.remove("free")},{once:!0}),pt.preventDefault()}},pi=new WeakSet,Yn=function(){return t(rs,ws).get(t(this,pe).getMode())},gi=new WeakSet,Jn=function(pt){const s=t(this,pi,Yn);return s?new s.prototype.constructor(pt):null},mi=new WeakSet,Qn=function(){const{x:pt,y:s,width:L,height:st}=this.div.getBoundingClientRect(),ht=Math.max(0,pt),ft=Math.max(0,s),It=Math.min(window.innerWidth,pt+L),Gt=Math.min(window.innerHeight,s+st),Tt=(ht+It)/2-pt,Xt=(ft+Gt)/2-s,[Wt,Ae]=this.viewport.rotation%180===0?[Tt,Xt]:[Xt,Tt];return{offsetX:Wt,offsetY:Ae}},Ks=new WeakSet,cn=function(){I(this,Ws,!0);for(const pt of t(this,ts).values())pt.isEmpty()&&pt.remove();I(this,Ws,!1)},fe(rs,"_initialized",!1),l(rs,ws,new Map([k,A,F,S].map(pt=>[pt._editorType,pt])));let N=rs},259:(r,m,u)=>{var W,k,_,g,H,S,A,F,N,X,rt,J,M,Zn,$,tr,q,Ca,vt,Ns,Ct,Ma,_t,Es;u.d(m,{ColorPicker:()=>T});var e=u(292),w=u(830),f=u(419);const kt=class kt{constructor({editor:Z=null,uiManager:gt=null}){l(this,M);l(this,$);l(this,q);l(this,vt);l(this,Ct);l(this,_t);l(this,W,C(this,q,Ca).bind(this));l(this,k,C(this,Ct,Ma).bind(this));l(this,_,null);l(this,g,null);l(this,H,void 0);l(this,S,null);l(this,A,!1);l(this,F,!1);l(this,N,null);l(this,X,void 0);l(this,rt,null);l(this,J,void 0);var Rt;Z?(I(this,F,!1),I(this,J,e.AnnotationEditorParamsType.HIGHLIGHT_COLOR),I(this,N,Z)):(I(this,F,!0),I(this,J,e.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR)),I(this,rt,(Z==null?void 0:Z._uiManager)||gt),I(this,X,t(this,rt)._eventBus),I(this,H,(Z==null?void 0:Z.color)||((Rt=t(this,rt))==null?void 0:Rt.highlightColors.values().next().value)||"#FFFF98")}static get _keyboardManager(){return(0,e.shadow)(this,"_keyboardManager",new w.KeyboardManager([[["Escape","mac+Escape"],kt.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],kt.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],kt.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],kt.prototype._moveToPrevious],[["Home","mac+Home"],kt.prototype._moveToBeginning],[["End","mac+End"],kt.prototype._moveToEnd]]))}renderButton(){const Z=I(this,_,document.createElement("button"));Z.className="colorPicker",Z.tabIndex="0",Z.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),Z.setAttribute("aria-haspopup",!0),Z.addEventListener("click",C(this,vt,Ns).bind(this)),Z.addEventListener("keydown",t(this,W));const gt=I(this,g,document.createElement("span"));return gt.className="swatch",gt.setAttribute("aria-hidden",!0),gt.style.backgroundColor=t(this,H),Z.append(gt),Z}renderMainDropdown(){const Z=I(this,S,C(this,M,Zn).call(this));return Z.setAttribute("aria-orientation","horizontal"),Z.setAttribute("aria-labelledby","highlightColorPickerLabel"),Z}_colorSelectFromKeyboard(Z){if(Z.target===t(this,_)){C(this,vt,Ns).call(this,Z);return}const gt=Z.target.getAttribute("data-color");gt&&C(this,$,tr).call(this,gt,Z)}_moveToNext(Z){var gt,Rt;if(!t(this,_t,Es)){C(this,vt,Ns).call(this,Z);return}if(Z.target===t(this,_)){(gt=t(this,S).firstChild)==null||gt.focus();return}(Rt=Z.target.nextSibling)==null||Rt.focus()}_moveToPrevious(Z){var gt,Rt;if(Z.target===((gt=t(this,S))==null?void 0:gt.firstChild)||Z.target===t(this,_)){t(this,_t,Es)&&this._hideDropdownFromKeyboard();return}t(this,_t,Es)||C(this,vt,Ns).call(this,Z),(Rt=Z.target.previousSibling)==null||Rt.focus()}_moveToBeginning(Z){var gt;if(!t(this,_t,Es)){C(this,vt,Ns).call(this,Z);return}(gt=t(this,S).firstChild)==null||gt.focus()}_moveToEnd(Z){var gt;if(!t(this,_t,Es)){C(this,vt,Ns).call(this,Z);return}(gt=t(this,S).lastChild)==null||gt.focus()}hideDropdown(){var Z;(Z=t(this,S))==null||Z.classList.add("hidden"),window.removeEventListener("pointerdown",t(this,k))}_hideDropdownFromKeyboard(){var Z;if(!t(this,F)){if(!t(this,_t,Es)){(Z=t(this,N))==null||Z.unselect();return}this.hideDropdown(),t(this,_).focus({preventScroll:!0,focusVisible:t(this,A)})}}updateColor(Z){if(t(this,g)&&(t(this,g).style.backgroundColor=Z),!t(this,S))return;const gt=t(this,rt).highlightColors.values();for(const Rt of t(this,S).children)Rt.setAttribute("aria-selected",gt.next().value===Z)}destroy(){var Z,gt;(Z=t(this,_))==null||Z.remove(),I(this,_,null),I(this,g,null),(gt=t(this,S))==null||gt.remove(),I(this,S,null)}};W=new WeakMap,k=new WeakMap,_=new WeakMap,g=new WeakMap,H=new WeakMap,S=new WeakMap,A=new WeakMap,F=new WeakMap,N=new WeakMap,X=new WeakMap,rt=new WeakMap,J=new WeakMap,M=new WeakSet,Zn=function(){const Z=document.createElement("div");Z.addEventListener("contextmenu",f.noContextMenu),Z.className="dropdown",Z.role="listbox",Z.setAttribute("aria-multiselectable",!1),Z.setAttribute("aria-orientation","vertical"),Z.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[gt,Rt]of t(this,rt).highlightColors){const Pt=document.createElement("button");Pt.tabIndex="0",Pt.role="option",Pt.setAttribute("data-color",Rt),Pt.title=gt,Pt.setAttribute("data-l10n-id",`pdfjs-editor-colorpicker-${gt}`);const qt=document.createElement("span");Pt.append(qt),qt.className="swatch",qt.style.backgroundColor=Rt,Pt.setAttribute("aria-selected",Rt===t(this,H)),Pt.addEventListener("click",C(this,$,tr).bind(this,Rt)),Z.append(Pt)}return Z.addEventListener("keydown",t(this,W)),Z},$=new WeakSet,tr=function(Z,gt){gt.stopPropagation(),t(this,X).dispatch("switchannotationeditorparams",{source:this,type:t(this,J),value:Z})},q=new WeakSet,Ca=function(Z){kt._keyboardManager.exec(this,Z)},vt=new WeakSet,Ns=function(Z){if(t(this,_t,Es)){this.hideDropdown();return}if(I(this,A,Z.detail===0),window.addEventListener("pointerdown",t(this,k)),t(this,S)){t(this,S).classList.remove("hidden");return}const gt=I(this,S,C(this,M,Zn).call(this));t(this,_).append(gt)},Ct=new WeakSet,Ma=function(Z){var gt;(gt=t(this,S))!=null&&gt.contains(Z.target)||this.hideDropdown()},_t=new WeakSet,Es=function(){return t(this,S)&&!t(this,S).classList.contains("hidden")};let T=kt},310:(r,m,u)=>{var g,H,S,A,F,N,X,rt,er,j,$,O,q,tt,vt,Ft,Ct,Ot,_t,Lt,kt,Et,Z,gt,Rt,Pt,qt,Kt,ie,Se,de,sr,ve,ir,ae,nr,ee,La,ne,Ta,i,rr,c,ar,o,or,b,ka,d,Ra,h,Pa,V,Ia,at,hr,yt,Mi;u.d(m,{AnnotationEditor:()=>k});var e=u(830),w=u(292),f=u(419);const M=class M{constructor(P){l(this,rt);l(this,g,"");l(this,H,!1);l(this,S,null);l(this,A,null);l(this,F,null);l(this,N,!1);l(this,X,null);I(this,X,P)}static initialize(P){M._l10nPromise||(M._l10nPromise=P)}async render(){const P=I(this,S,document.createElement("button"));P.className="altText";const Y=await M._l10nPromise.get("pdfjs-editor-alt-text-button-label");P.textContent=Y,P.setAttribute("aria-label",Y),P.tabIndex="0",P.addEventListener("contextmenu",f.noContextMenu),P.addEventListener("pointerdown",U=>U.stopPropagation());const nt=U=>{U.preventDefault(),t(this,X)._uiManager.editAltText(t(this,X))};return P.addEventListener("click",nt,{capture:!0}),P.addEventListener("keydown",U=>{U.target===P&&U.key==="Enter"&&(I(this,N,!0),nt(U))}),await C(this,rt,er).call(this),P}finish(){t(this,S)&&(t(this,S).focus({focusVisible:t(this,N)}),I(this,N,!1))}isEmpty(){return!t(this,g)&&!t(this,H)}get data(){return{altText:t(this,g),decorative:t(this,H)}}set data({altText:P,decorative:Y}){t(this,g)===P&&t(this,H)===Y||(I(this,g,P),I(this,H,Y),C(this,rt,er).call(this))}toggle(P=!1){t(this,S)&&(!P&&t(this,F)&&(clearTimeout(t(this,F)),I(this,F,null)),t(this,S).disabled=!P)}destroy(){var P;(P=t(this,S))==null||P.remove(),I(this,S,null),I(this,A,null)}};g=new WeakMap,H=new WeakMap,S=new WeakMap,A=new WeakMap,F=new WeakMap,N=new WeakMap,X=new WeakMap,rt=new WeakSet,er=async function(){var nt,U;const P=t(this,S);if(!P)return;if(!t(this,g)&&!t(this,H)){P.classList.remove("done"),(nt=t(this,A))==null||nt.remove();return}P.classList.add("done"),M._l10nPromise.get("pdfjs-editor-alt-text-edit-button-label").then(v=>{P.setAttribute("aria-label",v)});let Y=t(this,A);if(!Y){I(this,A,Y=document.createElement("span")),Y.className="tooltip",Y.setAttribute("role","tooltip");const v=Y.id=`alt-text-tooltip-${t(this,X).id}`;P.setAttribute("aria-describedby",v);const z=100;P.addEventListener("mouseenter",()=>{I(this,F,setTimeout(()=>{I(this,F,null),t(this,A).classList.add("show"),t(this,X)._reportTelemetry({action:"alt_text_tooltip"})},z))}),P.addEventListener("mouseleave",()=>{var K;t(this,F)&&(clearTimeout(t(this,F)),I(this,F,null)),(K=t(this,A))==null||K.classList.remove("show")})}Y.innerText=t(this,H)?await M._l10nPromise.get("pdfjs-editor-alt-text-decorative-tooltip"):t(this,g),Y.parentNode||P.append(Y),(U=t(this,X).getImageForAltText())==null||U.setAttribute("aria-describedby",Y.id)},fe(M,"_l10nPromise",null);let T=M;var W=u(362);const ut=class ut{constructor(P){l(this,de);l(this,ae);l(this,ee);l(this,ne);l(this,i);l(this,c);l(this,o);l(this,b);l(this,d);l(this,h);l(this,V);l(this,at);l(this,yt);l(this,j,null);l(this,$,null);l(this,O,!1);l(this,q,!1);l(this,tt,null);l(this,vt,null);l(this,Ft,this.focusin.bind(this));l(this,Ct,this.focusout.bind(this));l(this,Ot,null);l(this,_t,"");l(this,Lt,!1);l(this,kt,null);l(this,Et,!1);l(this,Z,!1);l(this,gt,!1);l(this,Rt,null);l(this,Pt,0);l(this,qt,0);l(this,Kt,null);fe(this,"_initialOptions",Object.create(null));fe(this,"_isVisible",!0);fe(this,"_uiManager",null);fe(this,"_focusEventsAllowed",!0);fe(this,"_l10nPromise",null);l(this,ie,!1);l(this,Se,ut._zIndex++);this.constructor===ut&&(0,w.unreachable)("Cannot initialize AnnotationEditor."),this.parent=P.parent,this.id=P.id,this.width=this.height=null,this.pageIndex=P.parent.pageIndex,this.name=P.name,this.div=null,this._uiManager=P.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=P.isCentered,this._structTreeParentId=null;const{rotation:Y,rawDims:{pageWidth:nt,pageHeight:U,pageX:v,pageY:z}}=this.parent.viewport;this.rotation=Y,this.pageRotation=(360+Y-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[nt,U],this.pageTranslation=[v,z];const[K,lt]=this.parentDimensions;this.x=P.x/K,this.y=P.y/lt,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const P=ut.prototype._resizeWithKeyboard,Y=e.AnnotationEditorUIManager.TRANSLATE_SMALL,nt=e.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,w.shadow)(this,"_resizerKeyboardManager",new e.KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],P,{args:[-Y,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],P,{args:[-nt,0]}],[["ArrowRight","mac+ArrowRight"],P,{args:[Y,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],P,{args:[nt,0]}],[["ArrowUp","mac+ArrowUp"],P,{args:[0,-Y]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],P,{args:[0,-nt]}],[["ArrowDown","mac+ArrowDown"],P,{args:[0,Y]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],P,{args:[0,nt]}],[["Escape","mac+Escape"],ut.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,w.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(P){const Y=new _({id:P.parent.getNextId(),parent:P.parent,uiManager:P._uiManager});Y.annotationElementId=P.annotationElementId,Y.deleted=!0,Y._uiManager.addToAnnotationStorage(Y)}static initialize(P,Y,nt){if(ut._l10nPromise||(ut._l10nPromise=new Map(["pdfjs-editor-alt-text-button-label","pdfjs-editor-alt-text-edit-button-label","pdfjs-editor-alt-text-decorative-tooltip","pdfjs-editor-resizer-label-topLeft","pdfjs-editor-resizer-label-topMiddle","pdfjs-editor-resizer-label-topRight","pdfjs-editor-resizer-label-middleRight","pdfjs-editor-resizer-label-bottomRight","pdfjs-editor-resizer-label-bottomMiddle","pdfjs-editor-resizer-label-bottomLeft","pdfjs-editor-resizer-label-middleLeft"].map(v=>[v,P.get(v.replaceAll(/([A-Z])/g,z=>`-${z.toLowerCase()}`))]))),nt==null?void 0:nt.strings)for(const v of nt.strings)ut._l10nPromise.set(v,P.get(v));if(ut._borderLineWidth!==-1)return;const U=getComputedStyle(document.documentElement);ut._borderLineWidth=parseFloat(U.getPropertyValue("--outline-width"))||0}static updateDefaultParams(P,Y){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(P){return!1}static paste(P,Y){(0,w.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,ie)}set _isDraggable(P){var Y;I(this,ie,P),(Y=this.div)==null||Y.classList.toggle("draggable",P)}get isEnterHandled(){return!0}center(){const[P,Y]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*Y/(P*2),this.y+=this.width*P/(Y*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*Y/(P*2),this.y-=this.width*P/(Y*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(P){this._uiManager.addCommands(P)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,Se)}setParent(P){P!==null?(this.pageIndex=P.pageIndex,this.pageDimensions=P.pageDimensions):C(this,yt,Mi).call(this),this.parent=P}focusin(P){this._focusEventsAllowed&&(t(this,Lt)?I(this,Lt,!1):this.parent.setSelected(this))}focusout(P){var Y,nt;!this._focusEventsAllowed||!this.isAttachedToDOM||(Y=P.relatedTarget)!=null&&Y.closest(`#${this.id}`)||(P.preventDefault(),(nt=this.parent)!=null&&nt.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(P,Y,nt,U){const[v,z]=this.parentDimensions;[nt,U]=this.screenToPageTranslation(nt,U),this.x=(P+nt)/v,this.y=(Y+U)/z,this.fixAndSetPosition()}translate(P,Y){C(this,de,sr).call(this,this.parentDimensions,P,Y)}translateInPage(P,Y){t(this,kt)||I(this,kt,[this.x,this.y]),C(this,de,sr).call(this,this.pageDimensions,P,Y),this.div.scrollIntoView({block:"nearest"})}drag(P,Y){t(this,kt)||I(this,kt,[this.x,this.y]);const[nt,U]=this.parentDimensions;if(this.x+=P/nt,this.y+=Y/U,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:mt,y:Mt}=this.div.getBoundingClientRect();this.parent.findNewParent(this,mt,Mt)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:v,y:z}=this;const[K,lt]=this.getBaseTranslation();v+=K,z+=lt,this.div.style.left=`${(100*v).toFixed(2)}%`,this.div.style.top=`${(100*z).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!t(this,kt)&&(t(this,kt)[0]!==this.x||t(this,kt)[1]!==this.y)}getBaseTranslation(){const[P,Y]=this.parentDimensions,{_borderLineWidth:nt}=ut,U=nt/P,v=nt/Y;switch(this.rotation){case 90:return[-U,v];case 180:return[U,v];case 270:return[U,-v];default:return[-U,-v]}}get _mustFixPosition(){return!0}fixAndSetPosition(P=this.rotation){const[Y,nt]=this.pageDimensions;let{x:U,y:v,width:z,height:K}=this;if(z*=Y,K*=nt,U*=Y,v*=nt,this._mustFixPosition)switch(P){case 0:U=Math.max(0,Math.min(Y-z,U)),v=Math.max(0,Math.min(nt-K,v));break;case 90:U=Math.max(0,Math.min(Y-K,U)),v=Math.min(nt,Math.max(z,v));break;case 180:U=Math.min(Y,Math.max(z,U)),v=Math.min(nt,Math.max(K,v));break;case 270:U=Math.min(Y,Math.max(K,U)),v=Math.max(0,Math.min(nt-z,v));break}this.x=U/=Y,this.y=v/=nt;const[lt,mt]=this.getBaseTranslation();U+=lt,v+=mt;const{style:Mt}=this.div;Mt.left=`${(100*U).toFixed(2)}%`,Mt.top=`${(100*v).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(P,Y){var nt;return C(nt=ut,ve,ir).call(nt,P,Y,this.parentRotation)}pageTranslationToScreen(P,Y){var nt;return C(nt=ut,ve,ir).call(nt,P,Y,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:P,pageDimensions:[Y,nt]}=this,U=Y*P,v=nt*P;return w.FeatureTest.isCSSRoundSupported?[Math.round(U),Math.round(v)]:[U,v]}setDims(P,Y){const[nt,U]=this.parentDimensions;this.div.style.width=`${(100*P/nt).toFixed(2)}%`,t(this,q)||(this.div.style.height=`${(100*Y/U).toFixed(2)}%`)}fixDims(){const{style:P}=this.div,{height:Y,width:nt}=P,U=nt.endsWith("%"),v=!t(this,q)&&Y.endsWith("%");if(U&&v)return;const[z,K]=this.parentDimensions;U||(P.width=`${(100*parseFloat(nt)/z).toFixed(2)}%`),!t(this,q)&&!v&&(P.height=`${(100*parseFloat(Y)/K).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}altTextFinish(){var P;(P=t(this,$))==null||P.finish()}async addEditToolbar(){return t(this,Ot)||t(this,Z)?t(this,Ot):(I(this,Ot,new W.EditorToolbar(this)),this.div.append(t(this,Ot).render()),t(this,$)&&t(this,Ot).addAltTextButton(await t(this,$).render()),t(this,Ot))}removeEditToolbar(){var P;t(this,Ot)&&(t(this,Ot).remove(),I(this,Ot,null),(P=t(this,$))==null||P.destroy())}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){t(this,$)||(T.initialize(ut._l10nPromise),I(this,$,new T(this)),await this.addEditToolbar())}get altTextData(){var P;return(P=t(this,$))==null?void 0:P.data}set altTextData(P){t(this,$)&&(t(this,$).data=P)}hasAltText(){var P;return!((P=t(this,$))!=null&&P.isEmpty())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=t(this,O)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.div.addEventListener("focusin",t(this,Ft)),this.div.addEventListener("focusout",t(this,Ct));const[P,Y]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*Y/P).toFixed(2)}%`,this.div.style.maxHeight=`${(100*P/Y).toFixed(2)}%`);const[nt,U]=this.getInitialTranslation();return this.translate(nt,U),(0,e.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(P){const{isMac:Y}=w.FeatureTest.platform;if(P.button!==0||P.ctrlKey&&Y){P.preventDefault();return}if(I(this,Lt,!0),this._isDraggable){C(this,b,ka).call(this,P);return}C(this,o,or).call(this,P)}moveInDOM(){t(this,Rt)&&clearTimeout(t(this,Rt)),I(this,Rt,setTimeout(()=>{var P;I(this,Rt,null),(P=this.parent)==null||P.moveEditorInDOM(this)},0))}_setParentAndPosition(P,Y,nt){P.changeParent(this),this.x=Y,this.y=nt,this.fixAndSetPosition()}getRect(P,Y,nt=this.rotation){const U=this.parentScale,[v,z]=this.pageDimensions,[K,lt]=this.pageTranslation,mt=P/U,Mt=Y/U,Dt=this.x*v,te=this.y*z,re=this.width*v,he=this.height*z;switch(nt){case 0:return[Dt+mt+K,z-te-Mt-he+lt,Dt+mt+re+K,z-te-Mt+lt];case 90:return[Dt+Mt+K,z-te+mt+lt,Dt+Mt+he+K,z-te+mt+re+lt];case 180:return[Dt-mt-re+K,z-te+Mt+lt,Dt-mt+K,z-te+Mt+he+lt];case 270:return[Dt-Mt-he+K,z-te-mt-re+lt,Dt-Mt+K,z-te-mt+lt];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(P,Y){const[nt,U,v,z]=P,K=v-nt,lt=z-U;switch(this.rotation){case 0:return[nt,Y-z,K,lt];case 90:return[nt,Y-U,lt,K];case 180:return[v,Y-U,K,lt];case 270:return[v,Y-z,lt,K];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){I(this,Z,!0)}disableEditMode(){I(this,Z,!1)}isInEditMode(){return t(this,Z)}shouldGetKeyboardEvents(){return t(this,gt)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var P,Y;(P=this.div)==null||P.addEventListener("focusin",t(this,Ft)),(Y=this.div)==null||Y.addEventListener("focusout",t(this,Ct))}rotate(P){}serialize(P=!1,Y=null){(0,w.unreachable)("An editor must be serializable")}static deserialize(P,Y,nt){const U=new this.prototype.constructor({parent:Y,id:Y.getNextId(),uiManager:nt});U.rotation=P.rotation;const[v,z]=U.pageDimensions,[K,lt,mt,Mt]=U.getRectInCurrentCoords(P.rect,z);return U.x=K/v,U.y=lt/z,U.width=mt/v,U.height=Mt/z,U}remove(){if(this.div.removeEventListener("focusin",t(this,Ft)),this.div.removeEventListener("focusout",t(this,Ct)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),t(this,Rt)&&(clearTimeout(t(this,Rt)),I(this,Rt,null)),C(this,yt,Mi).call(this),this.removeEditToolbar(),t(this,Kt)){for(const P of t(this,Kt).values())clearTimeout(P);I(this,Kt,null)}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(C(this,ee,La).call(this),t(this,tt).classList.remove("hidden"),(0,e.bindEvents)(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(P){if(!this.isResizable||P.target!==this.div||P.key!=="Enter")return;this._uiManager.setSelected(this),I(this,vt,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const Y=t(this,tt).children;if(!t(this,j)){I(this,j,Array.from(Y));const z=C(this,d,Ra).bind(this),K=C(this,h,Pa).bind(this);for(const lt of t(this,j)){const mt=lt.getAttribute("data-resizer-name");lt.setAttribute("role","spinbutton"),lt.addEventListener("keydown",z),lt.addEventListener("blur",K),lt.addEventListener("focus",C(this,V,Ia).bind(this,mt)),ut._l10nPromise.get(`pdfjs-editor-resizer-label-${mt}`).then(Mt=>lt.setAttribute("aria-label",Mt))}}const nt=t(this,j)[0];let U=0;for(const z of Y){if(z===nt)break;U++}const v=(360-this.rotation+this.parentRotation)%360/90*(t(this,j).length/4);if(v!==U){if(v<U)for(let K=0;K<U-v;K++)t(this,tt).append(t(this,tt).firstChild);else if(v>U)for(let K=0;K<v-U;K++)t(this,tt).firstChild.before(t(this,tt).lastChild);let z=0;for(const K of Y){const lt=t(this,j)[z++].getAttribute("data-resizer-name");ut._l10nPromise.get(`pdfjs-editor-resizer-label-${lt}`).then(mt=>K.setAttribute("aria-label",mt))}}C(this,at,hr).call(this,0),I(this,gt,!0),t(this,tt).firstChild.focus({focusVisible:!0}),P.preventDefault(),P.stopImmediatePropagation()}_resizeWithKeyboard(P,Y){t(this,gt)&&C(this,c,ar).call(this,t(this,_t),{movementX:P,movementY:Y})}_stopResizingWithKeyboard(){C(this,yt,Mi).call(this),this.div.focus()}select(){var P,Y;if(this.makeResizable(),(P=this.div)==null||P.classList.add("selectedEditor"),!t(this,Ot)){this.addEditToolbar().then(()=>{var nt,U;(nt=this.div)!=null&&nt.classList.contains("selectedEditor")&&((U=t(this,Ot))==null||U.show())});return}(Y=t(this,Ot))==null||Y.show()}unselect(){var P,Y,nt,U;(P=t(this,tt))==null||P.classList.add("hidden"),(Y=this.div)==null||Y.classList.remove("selectedEditor"),(nt=this.div)!=null&&nt.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(U=t(this,Ot))==null||U.hide()}updateParams(P,Y){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return t(this,Et)}set isEditing(P){I(this,Et,P),this.parent&&(P?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(P,Y){I(this,q,!0);const nt=P/Y,{style:U}=this.div;U.aspectRatio=nt,U.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(P,Y=!1){if(Y){t(this,Kt)||I(this,Kt,new Map);const{action:nt}=P;let U=t(this,Kt).get(nt);U&&clearTimeout(U),U=setTimeout(()=>{this._reportTelemetry(P),t(this,Kt).delete(nt),t(this,Kt).size===0&&I(this,Kt,null)},ut._telemetryTimeout),t(this,Kt).set(nt,U);return}P.type||(P.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:P}})}show(P=this._isVisible){this.div.classList.toggle("hidden",!P),this._isVisible=P}enable(){this.div&&(this.div.tabIndex=0),I(this,O,!1)}disable(){this.div&&(this.div.tabIndex=-1),I(this,O,!0)}};j=new WeakMap,$=new WeakMap,O=new WeakMap,q=new WeakMap,tt=new WeakMap,vt=new WeakMap,Ft=new WeakMap,Ct=new WeakMap,Ot=new WeakMap,_t=new WeakMap,Lt=new WeakMap,kt=new WeakMap,Et=new WeakMap,Z=new WeakMap,gt=new WeakMap,Rt=new WeakMap,Pt=new WeakMap,qt=new WeakMap,Kt=new WeakMap,ie=new WeakMap,Se=new WeakMap,de=new WeakSet,sr=function([P,Y],nt,U){[nt,U]=this.screenToPageTranslation(nt,U),this.x+=nt/P,this.y+=U/Y,this.fixAndSetPosition()},ve=new WeakSet,ir=function(P,Y,nt){switch(nt){case 90:return[Y,-P];case 180:return[-P,-Y];case 270:return[-Y,P];default:return[P,Y]}},ae=new WeakSet,nr=function(P){switch(P){case 90:{const[Y,nt]=this.pageDimensions;return[0,-Y/nt,nt/Y,0]}case 180:return[-1,0,0,-1];case 270:{const[Y,nt]=this.pageDimensions;return[0,Y/nt,-nt/Y,0]}default:return[1,0,0,1]}},ee=new WeakSet,La=function(){if(t(this,tt))return;I(this,tt,document.createElement("div")),t(this,tt).classList.add("resizers");const P=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"];for(const Y of P){const nt=document.createElement("div");t(this,tt).append(nt),nt.classList.add("resizer",Y),nt.setAttribute("data-resizer-name",Y),nt.addEventListener("pointerdown",C(this,ne,Ta).bind(this,Y)),nt.addEventListener("contextmenu",f.noContextMenu),nt.tabIndex=-1}this.div.prepend(t(this,tt))},ne=new WeakSet,Ta=function(P,Y){var he;Y.preventDefault();const{isMac:nt}=w.FeatureTest.platform;if(Y.button!==0||Y.ctrlKey&&nt)return;(he=t(this,$))==null||he.toggle(!1);const U=C(this,c,ar).bind(this,P),v=this._isDraggable;this._isDraggable=!1;const z={passive:!0,capture:!0};this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",U,z);const K=this.x,lt=this.y,mt=this.width,Mt=this.height,Dt=this.parent.div.style.cursor,te=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(Y.target).cursor;const re=()=>{var Me;this.parent.togglePointerEvents(!0),(Me=t(this,$))==null||Me.toggle(!0),this._isDraggable=v,window.removeEventListener("pointerup",re),window.removeEventListener("blur",re),window.removeEventListener("pointermove",U,z),this.parent.div.style.cursor=Dt,this.div.style.cursor=te,C(this,i,rr).call(this,K,lt,mt,Mt)};window.addEventListener("pointerup",re),window.addEventListener("blur",re)},i=new WeakSet,rr=function(P,Y,nt,U){const v=this.x,z=this.y,K=this.width,lt=this.height;v===P&&z===Y&&K===nt&&lt===U||this.addCommands({cmd:()=>{this.width=K,this.height=lt,this.x=v,this.y=z;const[mt,Mt]=this.parentDimensions;this.setDims(mt*K,Mt*lt),this.fixAndSetPosition()},undo:()=>{this.width=nt,this.height=U,this.x=P,this.y=Y;const[mt,Mt]=this.parentDimensions;this.setDims(mt*nt,Mt*U),this.fixAndSetPosition()},mustExec:!0})},c=new WeakSet,ar=function(P,Y){const[nt,U]=this.parentDimensions,v=this.x,z=this.y,K=this.width,lt=this.height,mt=ut.MIN_SIZE/nt,Mt=ut.MIN_SIZE/U,Dt=St=>Math.round(St*1e4)/1e4,te=C(this,ae,nr).call(this,this.rotation),re=(St,Bt)=>[te[0]*St+te[2]*Bt,te[1]*St+te[3]*Bt],he=C(this,ae,nr).call(this,360-this.rotation),Me=(St,Bt)=>[he[0]*St+he[2]*Bt,he[1]*St+he[3]*Bt];let _e,Fe,me=!1,ke=!1;switch(P){case"topLeft":me=!0,_e=(St,Bt)=>[0,0],Fe=(St,Bt)=>[St,Bt];break;case"topMiddle":_e=(St,Bt)=>[St/2,0],Fe=(St,Bt)=>[St/2,Bt];break;case"topRight":me=!0,_e=(St,Bt)=>[St,0],Fe=(St,Bt)=>[0,Bt];break;case"middleRight":ke=!0,_e=(St,Bt)=>[St,Bt/2],Fe=(St,Bt)=>[0,Bt/2];break;case"bottomRight":me=!0,_e=(St,Bt)=>[St,Bt],Fe=(St,Bt)=>[0,0];break;case"bottomMiddle":_e=(St,Bt)=>[St/2,Bt],Fe=(St,Bt)=>[St/2,0];break;case"bottomLeft":me=!0,_e=(St,Bt)=>[0,Bt],Fe=(St,Bt)=>[St,0];break;case"middleLeft":ke=!0,_e=(St,Bt)=>[0,Bt/2],Fe=(St,Bt)=>[St,Bt/2];break}const se=_e(K,lt),D=Fe(K,lt);let x=re(...D);const Q=Dt(v+x[0]),it=Dt(z+x[1]);let ct=1,wt=1,[bt,zt]=this.screenToPageTranslation(Y.movementX,Y.movementY);if([bt,zt]=Me(bt/nt,zt/U),me){const St=Math.hypot(K,lt);ct=wt=Math.max(Math.min(Math.hypot(D[0]-se[0]-bt,D[1]-se[1]-zt)/St,1/K,1/lt),mt/K,Mt/lt)}else ke?ct=Math.max(mt,Math.min(1,Math.abs(D[0]-se[0]-bt)))/K:wt=Math.max(Mt,Math.min(1,Math.abs(D[1]-se[1]-zt)))/lt;const Vt=Dt(K*ct),Nt=Dt(lt*wt);x=re(...Fe(Vt,Nt));const Yt=Q-x[0],$t=it-x[1];this.width=Vt,this.height=Nt,this.x=Yt,this.y=$t,this.setDims(nt*Vt,U*Nt),this.fixAndSetPosition()},o=new WeakSet,or=function(P){const{isMac:Y}=w.FeatureTest.platform;P.ctrlKey&&!Y||P.shiftKey||P.metaKey&&Y?this.parent.toggleSelected(this):this.parent.setSelected(this)},b=new WeakSet,ka=function(P){const Y=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let nt,U;Y&&(this.div.classList.add("moving"),nt={passive:!0,capture:!0},I(this,Pt,P.clientX),I(this,qt,P.clientY),U=z=>{const{clientX:K,clientY:lt}=z,[mt,Mt]=this.screenToPageTranslation(K-t(this,Pt),lt-t(this,qt));I(this,Pt,K),I(this,qt,lt),this._uiManager.dragSelectedEditors(mt,Mt)},window.addEventListener("pointermove",U,nt));const v=()=>{window.removeEventListener("pointerup",v),window.removeEventListener("blur",v),Y&&(this.div.classList.remove("moving"),window.removeEventListener("pointermove",U,nt)),I(this,Lt,!1),this._uiManager.endDragSession()||C(this,o,or).call(this,P)};window.addEventListener("pointerup",v),window.addEventListener("blur",v)},d=new WeakSet,Ra=function(P){ut._resizerKeyboardManager.exec(this,P)},h=new WeakSet,Pa=function(P){var Y;t(this,gt)&&((Y=P.relatedTarget)==null?void 0:Y.parentNode)!==t(this,tt)&&C(this,yt,Mi).call(this)},V=new WeakSet,Ia=function(P){I(this,_t,t(this,gt)?P:"")},at=new WeakSet,hr=function(P){if(t(this,j))for(const Y of t(this,j))Y.tabIndex=P},yt=new WeakSet,Mi=function(){if(I(this,gt,!1),C(this,at,hr).call(this,-1),t(this,vt)){const{savedX:P,savedY:Y,savedWidth:nt,savedHeight:U}=t(this,vt);C(this,i,rr).call(this,P,Y,nt,U),I(this,vt,null)}},l(ut,ve),fe(ut,"_borderLineWidth",-1),fe(ut,"_colorManager",new e.ColorManager),fe(ut,"_zIndex",1),fe(ut,"_telemetryTimeout",1e3);let k=ut;class _ extends k{constructor(P){super(P),this.annotationElementId=P.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},61:(r,m,u)=>{var _,g,H,S,Fa,F,dn,X,Da,J,Na,j,lr,O,q,tt,vt,Ft,Ct,Ot,_t,Lt,kt,Et,Z,gt,Rt,Pt,qt,Kt,ie,Se,cr,ve,jt,ae,Ce,ee,Ee,ne,et,Li,n,Ti,p,Oa;u.d(m,{FreeOutliner:()=>W,Outliner:()=>w});var e=u(292);class w{constructor(b,E=0,d=0,a=!0){l(this,S);l(this,F);l(this,X);l(this,J);l(this,j);l(this,_,void 0);l(this,g,[]);l(this,H,[]);let h=1/0,R=-1/0,V=1/0,G=-1/0;const at=10**-4;for(const{x:Y,y:nt,width:U,height:v}of b){const z=Math.floor((Y-E)/at)*at,K=Math.ceil((Y+U+E)/at)*at,lt=Math.floor((nt-E)/at)*at,mt=Math.ceil((nt+v+E)/at)*at,Mt=[z,lt,mt,!0],Dt=[K,lt,mt,!1];t(this,g).push(Mt,Dt),h=Math.min(h,z),R=Math.max(R,K),V=Math.min(V,lt),G=Math.max(G,mt)}const ot=R-h+2*d,yt=G-V+2*d,At=h-d,ut=V-d,xt=t(this,g).at(a?-1:-2),P=[xt[0],xt[2]];for(const Y of t(this,g)){const[nt,U,v]=Y;Y[0]=(nt-At)/ot,Y[1]=(U-ut)/yt,Y[2]=(v-ut)/yt}I(this,_,{x:At,y:ut,width:ot,height:yt,lastPoint:P})}getOutlines(){t(this,g).sort((E,d)=>E[0]-d[0]||E[1]-d[1]||E[2]-d[2]);const b=[];for(const E of t(this,g))E[3]?(b.push(...C(this,j,lr).call(this,E)),C(this,X,Da).call(this,E)):(C(this,J,Na).call(this,E),b.push(...C(this,j,lr).call(this,E)));return C(this,S,Fa).call(this,b)}}_=new WeakMap,g=new WeakMap,H=new WeakMap,S=new WeakSet,Fa=function(b){const E=[],d=new Set;for(const R of b){const[V,G,at]=R;E.push([V,G,R],[V,at,R])}E.sort((R,V)=>R[1]-V[1]||R[0]-V[0]);for(let R=0,V=E.length;R<V;R+=2){const G=E[R][2],at=E[R+1][2];G.push(at),at.push(G),d.add(G),d.add(at)}const a=[];let h;for(;d.size>0;){const R=d.values().next().value;let[V,G,at,ot,yt]=R;d.delete(R);let At=V,ut=G;for(h=[V,at],a.push(h);;){let xt;if(d.has(ot))xt=ot;else if(d.has(yt))xt=yt;else break;d.delete(xt),[V,G,at,ot,yt]=xt,At!==V&&(h.push(At,ut,V,ut===G?G:at),At=V),ut=ut===G?at:G}h.push(At,ut)}return new T(a,t(this,_))},F=new WeakSet,dn=function(b){const E=t(this,H);let d=0,a=E.length-1;for(;d<=a;){const h=d+a>>1,R=E[h][0];if(R===b)return h;R<b?d=h+1:a=h-1}return a+1},X=new WeakSet,Da=function([,b,E]){const d=C(this,F,dn).call(this,b);t(this,H).splice(d,0,[b,E])},J=new WeakSet,Na=function([,b,E]){const d=C(this,F,dn).call(this,b);for(let a=d;a<t(this,H).length;a++){const[h,R]=t(this,H)[a];if(h!==b)break;if(h===b&&R===E){t(this,H).splice(a,1);return}}for(let a=d-1;a>=0;a--){const[h,R]=t(this,H)[a];if(h!==b)break;if(h===b&&R===E){t(this,H).splice(a,1);return}}},j=new WeakSet,lr=function(b){const[E,d,a]=b,h=[[E,d,a]],R=C(this,F,dn).call(this,a);for(let V=0;V<R;V++){const[G,at]=t(this,H)[V];for(let ot=0,yt=h.length;ot<yt;ot++){const[,At,ut]=h[ot];if(!(at<=At||ut<=G)){if(At>=G){if(ut>at)h[ot][1]=at;else{if(yt===1)return[];h.splice(ot,1),ot--,yt--}continue}h[ot][2]=G,ut>at&&h.push([E,at,ut])}}}return h};class f{toSVGPath(){throw new Error("Abstract method `toSVGPath` must be implemented.")}get box(){throw new Error("Abstract getter `box` must be implemented.")}serialize(b,E){throw new Error("Abstract method `serialize` must be implemented.")}get free(){return this instanceof k}}class T extends f{constructor(E,d){super();l(this,O,void 0);l(this,q,void 0);I(this,q,E),I(this,O,d)}toSVGPath(){const E=[];for(const d of t(this,q)){let[a,h]=d;E.push(`M${a} ${h}`);for(let R=2;R<d.length;R+=2){const V=d[R],G=d[R+1];V===a?(E.push(`V${G}`),h=G):G===h&&(E.push(`H${V}`),a=V)}E.push("Z")}return E.join(" ")}serialize([E,d,a,h],R){const V=[],G=a-E,at=h-d;for(const ot of t(this,q)){const yt=new Array(ot.length);for(let At=0;At<ot.length;At+=2)yt[At]=E+ot[At]*G,yt[At+1]=h-ot[At+1]*at;V.push(yt)}return V}get box(){return t(this,O)}}O=new WeakMap,q=new WeakMap;const le=class le{constructor({x:b,y:E},d,a,h,R,V=0){l(this,Se);l(this,tt,void 0);l(this,vt,[]);l(this,Ft,void 0);l(this,Ct,void 0);l(this,Ot,[]);l(this,_t,new Float64Array(18));l(this,Lt,void 0);l(this,kt,void 0);l(this,Et,void 0);l(this,Z,void 0);l(this,gt,void 0);l(this,Rt,void 0);l(this,Pt,[]);I(this,tt,d),I(this,Rt,h*a),I(this,Ct,R),t(this,_t).set([NaN,NaN,NaN,NaN,b,E],6),I(this,Ft,V),I(this,Z,t(le,qt)*a),I(this,Et,t(le,ie)*a),I(this,gt,a),t(this,Pt).push(b,E)}get free(){return!0}isEmpty(){return isNaN(t(this,_t)[8])}add({x:b,y:E}){var Mt;I(this,Lt,b),I(this,kt,E);const[d,a,h,R]=t(this,tt);let[V,G,at,ot]=t(this,_t).subarray(8,12);const yt=b-at,At=E-ot,ut=Math.hypot(yt,At);if(ut<t(this,Et))return!1;const xt=ut-t(this,Z),P=xt/ut,Y=P*yt,nt=P*At;let U=V,v=G;V=at,G=ot,at+=Y,ot+=nt,(Mt=t(this,Pt))==null||Mt.push(b,E);const z=-nt/xt,K=Y/xt,lt=z*t(this,Rt),mt=K*t(this,Rt);return t(this,_t).set(t(this,_t).subarray(2,8),0),t(this,_t).set([at+lt,ot+mt],4),t(this,_t).set(t(this,_t).subarray(14,18),12),t(this,_t).set([at-lt,ot-mt],16),isNaN(t(this,_t)[6])?(t(this,Ot).length===0&&(t(this,_t).set([V+lt,G+mt],2),t(this,Ot).push(NaN,NaN,NaN,NaN,(V+lt-d)/h,(G+mt-a)/R),t(this,_t).set([V-lt,G-mt],14),t(this,vt).push(NaN,NaN,NaN,NaN,(V-lt-d)/h,(G-mt-a)/R)),t(this,_t).set([U,v,V,G,at,ot],6),!this.isEmpty()):(t(this,_t).set([U,v,V,G,at,ot],6),Math.abs(Math.atan2(v-G,U-V)-Math.atan2(nt,Y))<Math.PI/2?([V,G,at,ot]=t(this,_t).subarray(2,6),t(this,Ot).push(NaN,NaN,NaN,NaN,((V+at)/2-d)/h,((G+ot)/2-a)/R),[V,G,U,v]=t(this,_t).subarray(14,18),t(this,vt).push(NaN,NaN,NaN,NaN,((U+V)/2-d)/h,((v+G)/2-a)/R),!0):([U,v,V,G,at,ot]=t(this,_t).subarray(0,6),t(this,Ot).push(((U+5*V)/6-d)/h,((v+5*G)/6-a)/R,((5*V+at)/6-d)/h,((5*G+ot)/6-a)/R,((V+at)/2-d)/h,((G+ot)/2-a)/R),[at,ot,V,G,U,v]=t(this,_t).subarray(12,18),t(this,vt).push(((U+5*V)/6-d)/h,((v+5*G)/6-a)/R,((5*V+at)/6-d)/h,((5*G+ot)/6-a)/R,((V+at)/2-d)/h,((G+ot)/2-a)/R),!0))}toSVGPath(){if(this.isEmpty())return"";const b=t(this,Ot),E=t(this,vt),d=t(this,_t).subarray(4,6),a=t(this,_t).subarray(16,18),[h,R,V,G]=t(this,tt),[at,ot,yt,At]=C(this,Se,cr).call(this);if(isNaN(t(this,_t)[6])&&!this.isEmpty())return`M${(t(this,_t)[2]-h)/V} ${(t(this,_t)[3]-R)/G} L${(t(this,_t)[4]-h)/V} ${(t(this,_t)[5]-R)/G} L${at} ${ot} L${yt} ${At} L${(t(this,_t)[16]-h)/V} ${(t(this,_t)[17]-R)/G} L${(t(this,_t)[14]-h)/V} ${(t(this,_t)[15]-R)/G} Z`;const ut=[];ut.push(`M${b[4]} ${b[5]}`);for(let xt=6;xt<b.length;xt+=6)isNaN(b[xt])?ut.push(`L${b[xt+4]} ${b[xt+5]}`):ut.push(`C${b[xt]} ${b[xt+1]} ${b[xt+2]} ${b[xt+3]} ${b[xt+4]} ${b[xt+5]}`);ut.push(`L${(d[0]-h)/V} ${(d[1]-R)/G} L${at} ${ot} L${yt} ${At} L${(a[0]-h)/V} ${(a[1]-R)/G}`);for(let xt=E.length-6;xt>=6;xt-=6)isNaN(E[xt])?ut.push(`L${E[xt+4]} ${E[xt+5]}`):ut.push(`C${E[xt]} ${E[xt+1]} ${E[xt+2]} ${E[xt+3]} ${E[xt+4]} ${E[xt+5]}`);return ut.push(`L${E[4]} ${E[5]} Z`),ut.join(" ")}getOutlines(){var nt;const b=t(this,Ot),E=t(this,vt),d=t(this,_t),a=d.subarray(4,6),h=d.subarray(16,18),[R,V,G,at]=t(this,tt),ot=new Float64Array((((nt=t(this,Pt))==null?void 0:nt.length)??0)+2);for(let U=0,v=ot.length-2;U<v;U+=2)ot[U]=(t(this,Pt)[U]-R)/G,ot[U+1]=(t(this,Pt)[U+1]-V)/at;ot[ot.length-2]=(t(this,Lt)-R)/G,ot[ot.length-1]=(t(this,kt)-V)/at;const[yt,At,ut,xt]=C(this,Se,cr).call(this);if(isNaN(d[6])&&!this.isEmpty()){const U=new Float64Array(36);return U.set([NaN,NaN,NaN,NaN,(d[2]-R)/G,(d[3]-V)/at,NaN,NaN,NaN,NaN,(d[4]-R)/G,(d[5]-V)/at,NaN,NaN,NaN,NaN,yt,At,NaN,NaN,NaN,NaN,ut,xt,NaN,NaN,NaN,NaN,(d[16]-R)/G,(d[17]-V)/at,NaN,NaN,NaN,NaN,(d[14]-R)/G,(d[15]-V)/at],0),new k(U,ot,t(this,tt),t(this,gt),t(this,Ft),t(this,Ct))}const P=new Float64Array(t(this,Ot).length+24+t(this,vt).length);let Y=b.length;for(let U=0;U<Y;U+=2){if(isNaN(b[U])){P[U]=P[U+1]=NaN;continue}P[U]=b[U],P[U+1]=b[U+1]}P.set([NaN,NaN,NaN,NaN,(a[0]-R)/G,(a[1]-V)/at,NaN,NaN,NaN,NaN,yt,At,NaN,NaN,NaN,NaN,ut,xt,NaN,NaN,NaN,NaN,(h[0]-R)/G,(h[1]-V)/at],Y),Y+=24;for(let U=E.length-6;U>=6;U-=6)for(let v=0;v<6;v+=2){if(isNaN(E[U+v])){P[Y]=P[Y+1]=NaN,Y+=2;continue}P[Y]=E[U+v],P[Y+1]=E[U+v+1],Y+=2}return P.set([NaN,NaN,NaN,NaN,E[4],E[5]],Y),new k(P,ot,t(this,tt),t(this,gt),t(this,Ft),t(this,Ct))}};tt=new WeakMap,vt=new WeakMap,Ft=new WeakMap,Ct=new WeakMap,Ot=new WeakMap,_t=new WeakMap,Lt=new WeakMap,kt=new WeakMap,Et=new WeakMap,Z=new WeakMap,gt=new WeakMap,Rt=new WeakMap,Pt=new WeakMap,qt=new WeakMap,Kt=new WeakMap,ie=new WeakMap,Se=new WeakSet,cr=function(){const b=t(this,_t).subarray(4,6),E=t(this,_t).subarray(16,18),[d,a,h,R]=t(this,tt);return[(t(this,Lt)+(b[0]-E[0])/2-d)/h,(t(this,kt)+(b[1]-E[1])/2-a)/R,(t(this,Lt)+(E[0]-b[0])/2-d)/h,(t(this,kt)+(E[1]-b[1])/2-a)/R]},l(le,qt,8),l(le,Kt,2),l(le,ie,t(le,qt)+t(le,Kt));let W=le;class k extends f{constructor(E,d,a,h,R,V){super();l(this,et);l(this,n);l(this,p);l(this,ve,void 0);l(this,jt,null);l(this,ae,void 0);l(this,Ce,void 0);l(this,ee,void 0);l(this,Ee,void 0);l(this,ne,void 0);I(this,ne,E),I(this,ee,d),I(this,ve,a),I(this,Ee,h),I(this,ae,R),I(this,Ce,V),C(this,p,Oa).call(this,V);const{x:G,y:at,width:ot,height:yt}=t(this,jt);for(let At=0,ut=E.length;At<ut;At+=2)E[At]=(E[At]-G)/ot,E[At+1]=(E[At+1]-at)/yt;for(let At=0,ut=d.length;At<ut;At+=2)d[At]=(d[At]-G)/ot,d[At+1]=(d[At+1]-at)/yt}toSVGPath(){const E=[`M${t(this,ne)[4]} ${t(this,ne)[5]}`];for(let d=6,a=t(this,ne).length;d<a;d+=6){if(isNaN(t(this,ne)[d])){E.push(`L${t(this,ne)[d+4]} ${t(this,ne)[d+5]}`);continue}E.push(`C${t(this,ne)[d]} ${t(this,ne)[d+1]} ${t(this,ne)[d+2]} ${t(this,ne)[d+3]} ${t(this,ne)[d+4]} ${t(this,ne)[d+5]}`)}return E.push("Z"),E.join(" ")}serialize([E,d,a,h],R){const V=a-E,G=h-d;let at,ot;switch(R){case 0:at=C(this,et,Li).call(this,t(this,ne),E,h,V,-G),ot=C(this,et,Li).call(this,t(this,ee),E,h,V,-G);break;case 90:at=C(this,n,Ti).call(this,t(this,ne),E,d,V,G),ot=C(this,n,Ti).call(this,t(this,ee),E,d,V,G);break;case 180:at=C(this,et,Li).call(this,t(this,ne),a,d,-V,G),ot=C(this,et,Li).call(this,t(this,ee),a,d,-V,G);break;case 270:at=C(this,n,Ti).call(this,t(this,ne),a,h,-V,-G),ot=C(this,n,Ti).call(this,t(this,ee),a,h,-V,-G);break}return{outline:Array.from(at),points:[Array.from(ot)]}}get box(){return t(this,jt)}getNewOutline(E,d){const{x:a,y:h,width:R,height:V}=t(this,jt),[G,at,ot,yt]=t(this,ve),At=R*ot,ut=V*yt,xt=a*ot+G,P=h*yt+at,Y=new W({x:t(this,ee)[0]*At+xt,y:t(this,ee)[1]*ut+P},t(this,ve),t(this,Ee),E,t(this,Ce),d??t(this,ae));for(let nt=2;nt<t(this,ee).length;nt+=2)Y.add({x:t(this,ee)[nt]*At+xt,y:t(this,ee)[nt+1]*ut+P});return Y.getOutlines()}}ve=new WeakMap,jt=new WeakMap,ae=new WeakMap,Ce=new WeakMap,ee=new WeakMap,Ee=new WeakMap,ne=new WeakMap,et=new WeakSet,Li=function(E,d,a,h,R){const V=new Float64Array(E.length);for(let G=0,at=E.length;G<at;G+=2)V[G]=d+E[G]*h,V[G+1]=a+E[G+1]*R;return V},n=new WeakSet,Ti=function(E,d,a,h,R){const V=new Float64Array(E.length);for(let G=0,at=E.length;G<at;G+=2)V[G]=d+E[G+1]*h,V[G+1]=a+E[G]*R;return V},p=new WeakSet,Oa=function(E){const d=t(this,ne);let a=d[4],h=d[5],R=a,V=h,G=a,at=h,ot=a,yt=h;const At=E?Math.max:Math.min;for(let nt=6,U=d.length;nt<U;nt+=6){if(isNaN(d[nt]))R=Math.min(R,d[nt+4]),V=Math.min(V,d[nt+5]),G=Math.max(G,d[nt+4]),at=Math.max(at,d[nt+5]),yt<d[nt+5]?(ot=d[nt+4],yt=d[nt+5]):yt===d[nt+5]&&(ot=At(ot,d[nt+4]));else{const v=e.Util.bezierBoundingBox(a,h,...d.slice(nt,nt+6));R=Math.min(R,v[0]),V=Math.min(V,v[1]),G=Math.max(G,v[2]),at=Math.max(at,v[3]),yt<v[3]?(ot=v[2],yt=v[3]):yt===v[3]&&(ot=At(ot,v[2]))}a=d[nt+4],h=d[nt+5]}const ut=R-t(this,ae),xt=V-t(this,ae),P=G-R+2*t(this,ae),Y=at-V+2*t(this,ae);I(this,jt,{x:ut,y:xt,width:P,height:Y,lastPoint:[ot,yt]})}},362:(r,m,u)=>{var T,W,k,_,g,Ha,S,Ba,F,Ua,X,un,J,$a,j,dr,q,tt,vt,Ft,ja,Ot,Va,Lt,Ga;u.d(m,{EditorToolbar:()=>w,HighlightToolbar:()=>f});var e=u(419);const O=class O{constructor(Z){l(this,S);l(this,F);l(this,X);l(this,J);l(this,j);l(this,T,null);l(this,W,null);l(this,k,void 0);l(this,_,null);I(this,k,Z)}render(){const Z=I(this,T,document.createElement("div"));Z.className="editToolbar",Z.setAttribute("role","toolbar"),Z.addEventListener("contextmenu",e.noContextMenu),Z.addEventListener("pointerdown",C(O,g,Ha));const gt=I(this,_,document.createElement("div"));gt.className="buttons",Z.append(gt);const Rt=t(this,k).toolbarPosition;if(Rt){const{style:Pt}=Z,qt=t(this,k)._uiManager.direction==="ltr"?1-Rt[0]:Rt[0];Pt.insetInlineEnd=`${100*qt}%`,Pt.top=`calc(${100*Rt[1]}% + var(--editor-toolbar-vert-offset))`}return C(this,J,$a).call(this),Z}hide(){var Z;t(this,T).classList.add("hidden"),(Z=t(this,W))==null||Z.hideDropdown()}show(){t(this,T).classList.remove("hidden")}addAltTextButton(Z){C(this,X,un).call(this,Z),t(this,_).prepend(Z,t(this,j,dr))}addColorPicker(Z){I(this,W,Z);const gt=Z.renderButton();C(this,X,un).call(this,gt),t(this,_).prepend(gt,t(this,j,dr))}remove(){var Z;t(this,T).remove(),(Z=t(this,W))==null||Z.destroy(),I(this,W,null)}};T=new WeakMap,W=new WeakMap,k=new WeakMap,_=new WeakMap,g=new WeakSet,Ha=function(Z){Z.stopPropagation()},S=new WeakSet,Ba=function(Z){t(this,k)._focusEventsAllowed=!1,Z.preventDefault(),Z.stopPropagation()},F=new WeakSet,Ua=function(Z){t(this,k)._focusEventsAllowed=!0,Z.preventDefault(),Z.stopPropagation()},X=new WeakSet,un=function(Z){Z.addEventListener("focusin",C(this,S,Ba).bind(this),{capture:!0}),Z.addEventListener("focusout",C(this,F,Ua).bind(this),{capture:!0}),Z.addEventListener("contextmenu",e.noContextMenu)},J=new WeakSet,$a=function(){const Z=document.createElement("button");Z.className="delete",Z.tabIndex=0,Z.setAttribute("data-l10n-id",`pdfjs-editor-remove-${t(this,k).editorType}-button`),C(this,X,un).call(this,Z),Z.addEventListener("click",gt=>{t(this,k)._uiManager.delete()}),t(this,_).append(Z)},j=new WeakSet,dr=function(){const Z=document.createElement("div");return Z.className="divider",Z},l(O,g);let w=O;class f{constructor(Z){l(this,Ft);l(this,Ot);l(this,Lt);l(this,q,null);l(this,tt,null);l(this,vt,void 0);I(this,vt,Z)}show(Z,gt,Rt){const[Pt,qt]=C(this,Ot,Va).call(this,gt,Rt),{style:Kt}=t(this,tt)||I(this,tt,C(this,Ft,ja).call(this));Z.append(t(this,tt)),Kt.insetInlineEnd=`${100*Pt}%`,Kt.top=`calc(${100*qt}% + var(--editor-toolbar-vert-offset))`}hide(){t(this,tt).remove()}}q=new WeakMap,tt=new WeakMap,vt=new WeakMap,Ft=new WeakSet,ja=function(){const Z=I(this,tt,document.createElement("div"));Z.className="editToolbar",Z.setAttribute("role","toolbar"),Z.addEventListener("contextmenu",e.noContextMenu);const gt=I(this,q,document.createElement("div"));return gt.className="buttons",Z.append(gt),C(this,Lt,Ga).call(this),Z},Ot=new WeakSet,Va=function(Z,gt){let Rt=0,Pt=0;for(const qt of Z){const Kt=qt.y+qt.height;if(Kt<Rt)continue;const ie=qt.x+(gt?qt.width:0);if(Kt>Rt){Pt=ie,Rt=Kt;continue}gt?ie>Pt&&(Pt=ie):ie<Pt&&(Pt=ie)}return[gt?1-Pt:Pt,Rt]},Lt=new WeakSet,Ga=function(){const Z=document.createElement("button");Z.className="highlightButton",Z.tabIndex=0,Z.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const gt=document.createElement("span");Z.append(gt),gt.className="visuallyHidden",gt.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label"),Z.addEventListener("contextmenu",e.noContextMenu),Z.addEventListener("click",()=>{t(this,vt).highlightSelection("floating_button")}),t(this,q).append(Z)}},830:(r,m,u)=>{var F,N,X,rt,J,ur,$,O,q,tt,vt,qa,Ot,_t,Lt,kt,Et,Z,gt,Rt,Pt,qt,Kt,ie,Se,de,le,ve,jt,ae,Ce,ee,Ee,ne,et,i,n,c,p,o,y,b,E,d,a,h,R,V,G,at,ot,yt,At,ut,xt,P,Y,nt,pn,v,za,K,Wa,mt,gn,Dt,Xa,re,Ka,Me,Ya,Fe,pr,ke,gr,D,mr,Q,fr,ct,vr,bt,Qe,Vt,xs,Yt,Ja,St,Qa,Qt,br,ce,Za,Le,ki,Xe,Ar;u.d(m,{AnnotationEditorUIManager:()=>A,ColorManager:()=>S,KeyboardManager:()=>H,bindEvents:()=>T,opacityToHex:()=>W});var e=u(292),w=u(419),f=u(362);function T(Ve,B,dt){for(const Ht of dt)B.addEventListener(Ht,Ve[Ht].bind(Ve))}function W(Ve){return Math.round(Math.min(255,Math.max(1,255*Ve))).toString(16).padStart(2,"0")}class k{constructor(){l(this,F,0)}get id(){return`${e.AnnotationEditorPrefix}${fs(this,F)._++}`}}F=new WeakMap;const j=class j{constructor(){l(this,J);l(this,N,(0,e.getUuid)());l(this,X,0);l(this,rt,null)}static get _isSVGFittingCanvas(){const B='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',dt=new OffscreenCanvas(1,3).getContext("2d"),Ht=new Image;Ht.src=B;const Ut=Ht.decode().then(()=>(dt.drawImage(Ht,0,0,1,1,0,0,1,3),new Uint32Array(dt.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,e.shadow)(this,"_isSVGFittingCanvas",Ut)}async getFromFile(B){const{lastModified:dt,name:Ht,size:Ut,type:Jt}=B;return C(this,J,ur).call(this,`${dt}_${Ht}_${Ut}_${Jt}`,B)}async getFromUrl(B){return C(this,J,ur).call(this,B,B)}async getFromId(B){t(this,rt)||I(this,rt,new Map);const dt=t(this,rt).get(B);return dt?dt.bitmap?(dt.refCounter+=1,dt):dt.file?this.getFromFile(dt.file):this.getFromUrl(dt.url):null}getSvgUrl(B){const dt=t(this,rt).get(B);return dt!=null&&dt.isSvg?dt.svgUrl:null}deleteId(B){t(this,rt)||I(this,rt,new Map);const dt=t(this,rt).get(B);dt&&(dt.refCounter-=1,dt.refCounter===0&&(dt.bitmap=null))}isValidId(B){return B.startsWith(`image_${t(this,N)}_`)}};N=new WeakMap,X=new WeakMap,rt=new WeakMap,J=new WeakSet,ur=async function(B,dt){t(this,rt)||I(this,rt,new Map);let Ht=t(this,rt).get(B);if(Ht===null)return null;if(Ht!=null&&Ht.bitmap)return Ht.refCounter+=1,Ht;try{Ht||(Ht={bitmap:null,id:`image_${t(this,N)}_${fs(this,X)._++}`,refCounter:0,isSvg:!1});let Ut;if(typeof dt=="string"?(Ht.url=dt,Ut=await(0,w.fetchData)(dt,"blob")):Ut=Ht.file=dt,Ut.type==="image/svg+xml"){const Jt=j._isSVGFittingCanvas,Zt=new FileReader,oe=new Image,be=new Promise((Re,He)=>{oe.onload=()=>{Ht.bitmap=oe,Ht.isSvg=!0,Re()},Zt.onload=async()=>{const Ye=Ht.svgUrl=Zt.result;oe.src=await Jt?`${Ye}#svgView(preserveAspectRatio(none))`:Ye},oe.onerror=Zt.onerror=He});Zt.readAsDataURL(Ut),await be}else Ht.bitmap=await createImageBitmap(Ut);Ht.refCounter=1}catch(Ut){console.error(Ut),Ht=null}return t(this,rt).set(B,Ht),Ht&&t(this,rt).set(Ht.id,Ht),Ht};let _=j;class g{constructor(B=128){l(this,$,[]);l(this,O,!1);l(this,q,void 0);l(this,tt,-1);I(this,q,B)}add({cmd:B,undo:dt,post:Ht,mustExec:Ut,type:Jt=NaN,overwriteIfSameType:Zt=!1,keepUndo:oe=!1}){if(Ut&&B(),t(this,O))return;const be={cmd:B,undo:dt,post:Ht,type:Jt};if(t(this,tt)===-1){t(this,$).length>0&&(t(this,$).length=0),I(this,tt,0),t(this,$).push(be);return}if(Zt&&t(this,$)[t(this,tt)].type===Jt){oe&&(be.undo=t(this,$)[t(this,tt)].undo),t(this,$)[t(this,tt)]=be;return}const Re=t(this,tt)+1;Re===t(this,q)?t(this,$).splice(0,1):(I(this,tt,Re),Re<t(this,$).length&&t(this,$).splice(Re)),t(this,$).push(be)}undo(){if(t(this,tt)===-1)return;I(this,O,!0);const{undo:B,post:dt}=t(this,$)[t(this,tt)];B(),dt==null||dt(),I(this,O,!1),I(this,tt,t(this,tt)-1)}redo(){if(t(this,tt)<t(this,$).length-1){I(this,tt,t(this,tt)+1),I(this,O,!0);const{cmd:B,post:dt}=t(this,$)[t(this,tt)];B(),dt==null||dt(),I(this,O,!1)}}hasSomethingToUndo(){return t(this,tt)!==-1}hasSomethingToRedo(){return t(this,tt)<t(this,$).length-1}destroy(){I(this,$,null)}}$=new WeakMap,O=new WeakMap,q=new WeakMap,tt=new WeakMap;class H{constructor(B){l(this,vt);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:dt}=e.FeatureTest.platform;for(const[Ht,Ut,Jt={}]of B)for(const Zt of Ht){const oe=Zt.startsWith("mac+");dt&&oe?(this.callbacks.set(Zt.slice(4),{callback:Ut,options:Jt}),this.allKeys.add(Zt.split("+").at(-1))):!dt&&!oe&&(this.callbacks.set(Zt,{callback:Ut,options:Jt}),this.allKeys.add(Zt.split("+").at(-1)))}}exec(B,dt){if(!this.allKeys.has(dt.key))return;const Ht=this.callbacks.get(C(this,vt,qa).call(this,dt));if(!Ht)return;const{callback:Ut,options:{bubbles:Jt=!1,args:Zt=[],checker:oe=null}}=Ht;oe&&!oe(B,dt)||(Ut.bind(B,...Zt,dt)(),Jt||(dt.stopPropagation(),dt.preventDefault()))}}vt=new WeakSet,qa=function(B){B.altKey&&this.buffer.push("alt"),B.ctrlKey&&this.buffer.push("ctrl"),B.metaKey&&this.buffer.push("meta"),B.shiftKey&&this.buffer.push("shift"),this.buffer.push(B.key);const dt=this.buffer.join("+");return this.buffer.length=0,dt};const Ct=class Ct{get _colors(){const B=new Map([["CanvasText",null],["Canvas",null]]);return(0,w.getColorValues)(B),(0,e.shadow)(this,"_colors",B)}convert(B){const dt=(0,w.getRGB)(B);if(!window.matchMedia("(forced-colors: active)").matches)return dt;for(const[Ht,Ut]of this._colors)if(Ut.every((Jt,Zt)=>Jt===dt[Zt]))return Ct._colorsMapping.get(Ht);return dt}getHexCode(B){const dt=this._colors.get(B);return dt?e.Util.makeHexColor(...dt):B}};fe(Ct,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let S=Ct;const is=class is{constructor(B,dt,Ht,Ut,Jt,Zt,oe,be,Re){l(this,nt);l(this,v);l(this,K);l(this,mt);l(this,Dt);l(this,re);l(this,Me);l(this,Fe);l(this,ke);l(this,D);l(this,Q);l(this,ct);l(this,bt);l(this,Vt);l(this,Yt);l(this,St);l(this,Qt);l(this,ce);l(this,Le);l(this,Xe);l(this,Ot,null);l(this,_t,new Map);l(this,Lt,new Map);l(this,kt,null);l(this,Et,null);l(this,Z,new g);l(this,gt,0);l(this,Rt,new Set);l(this,Pt,null);l(this,qt,null);l(this,Kt,new Set);l(this,ie,!1);l(this,Se,null);l(this,de,null);l(this,le,null);l(this,ve,!1);l(this,jt,null);l(this,ae,new k);l(this,Ce,!1);l(this,ee,!1);l(this,Ee,null);l(this,ne,null);l(this,et,null);l(this,i,e.AnnotationEditorType.NONE);l(this,n,new Set);l(this,c,null);l(this,p,null);l(this,o,null);l(this,y,this.blur.bind(this));l(this,b,this.focus.bind(this));l(this,E,this.copy.bind(this));l(this,d,this.cut.bind(this));l(this,a,this.paste.bind(this));l(this,h,this.keydown.bind(this));l(this,R,this.keyup.bind(this));l(this,V,this.onEditingAction.bind(this));l(this,G,this.onPageChanging.bind(this));l(this,at,this.onScaleChanging.bind(this));l(this,ot,C(this,K,Wa).bind(this));l(this,yt,this.onRotationChanging.bind(this));l(this,At,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});l(this,ut,[0,0]);l(this,xt,null);l(this,P,null);l(this,Y,null);I(this,P,B),I(this,Y,dt),I(this,kt,Ht),this._eventBus=Ut,this._eventBus._on("editingaction",t(this,V)),this._eventBus._on("pagechanging",t(this,G)),this._eventBus._on("scalechanging",t(this,at)),this._eventBus._on("rotationchanging",t(this,yt)),C(this,Dt,Xa).call(this),C(this,ke,gr).call(this),I(this,Et,Jt.annotationStorage),I(this,Se,Jt.filterFactory),I(this,p,Zt),I(this,le,oe||null),I(this,ie,be),I(this,et,Re||null),this.viewParameters={realScale:w.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}static get _keyboardManager(){const B=is.prototype,dt=Zt=>t(Zt,P).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&Zt.hasSomethingToControl(),Ht=(Zt,{target:oe})=>{if(oe instanceof HTMLInputElement){const{type:be}=oe;return be!=="text"&&be!=="number"}return!0},Ut=this.TRANSLATE_SMALL,Jt=this.TRANSLATE_BIG;return(0,e.shadow)(this,"_keyboardManager",new H([[["ctrl+a","mac+meta+a"],B.selectAll,{checker:Ht}],[["ctrl+z","mac+meta+z"],B.undo,{checker:Ht}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],B.redo,{checker:Ht}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],B.delete,{checker:Ht}],[["Enter","mac+Enter"],B.addNewEditorFromKeyboard,{checker:(Zt,{target:oe})=>!(oe instanceof HTMLButtonElement)&&t(Zt,P).contains(oe)&&!Zt.isEnterHandled}],[[" ","mac+ "],B.addNewEditorFromKeyboard,{checker:(Zt,{target:oe})=>!(oe instanceof HTMLButtonElement)&&t(Zt,P).contains(document.activeElement)}],[["Escape","mac+Escape"],B.unselectAll],[["ArrowLeft","mac+ArrowLeft"],B.translateSelectedEditors,{args:[-Ut,0],checker:dt}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],B.translateSelectedEditors,{args:[-Jt,0],checker:dt}],[["ArrowRight","mac+ArrowRight"],B.translateSelectedEditors,{args:[Ut,0],checker:dt}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],B.translateSelectedEditors,{args:[Jt,0],checker:dt}],[["ArrowUp","mac+ArrowUp"],B.translateSelectedEditors,{args:[0,-Ut],checker:dt}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],B.translateSelectedEditors,{args:[0,-Jt],checker:dt}],[["ArrowDown","mac+ArrowDown"],B.translateSelectedEditors,{args:[0,Ut],checker:dt}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],B.translateSelectedEditors,{args:[0,Jt],checker:dt}]]))}destroy(){var B,dt;C(this,D,mr).call(this),C(this,Fe,pr).call(this),this._eventBus._off("editingaction",t(this,V)),this._eventBus._off("pagechanging",t(this,G)),this._eventBus._off("scalechanging",t(this,at)),this._eventBus._off("rotationchanging",t(this,yt));for(const Ht of t(this,Lt).values())Ht.destroy();t(this,Lt).clear(),t(this,_t).clear(),t(this,Kt).clear(),I(this,Ot,null),t(this,n).clear(),t(this,Z).destroy(),(B=t(this,kt))==null||B.destroy(),(dt=t(this,jt))==null||dt.hide(),I(this,jt,null),t(this,de)&&(clearTimeout(t(this,de)),I(this,de,null)),t(this,xt)&&(clearTimeout(t(this,xt)),I(this,xt,null)),C(this,re,Ka).call(this)}async mlGuess(B){var dt;return((dt=t(this,et))==null?void 0:dt.guess(B))||null}get hasMLManager(){return!!t(this,et)}get hcmFilter(){return(0,e.shadow)(this,"hcmFilter",t(this,p)?t(this,Se).addHCMFilter(t(this,p).foreground,t(this,p).background):"none")}get direction(){return(0,e.shadow)(this,"direction",getComputedStyle(t(this,P)).direction)}get highlightColors(){return(0,e.shadow)(this,"highlightColors",t(this,le)?new Map(t(this,le).split(",").map(B=>B.split("=").map(dt=>dt.trim()))):null)}get highlightColorNames(){return(0,e.shadow)(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,B=>B.reverse())):null)}setMainHighlightColorPicker(B){I(this,ne,B)}editAltText(B){var dt;(dt=t(this,kt))==null||dt.editAltText(this,B)}onPageChanging({pageNumber:B}){I(this,gt,B-1)}focusMainContainer(){t(this,P).focus()}findParent(B,dt){for(const Ht of t(this,Lt).values()){const{x:Ut,y:Jt,width:Zt,height:oe}=Ht.div.getBoundingClientRect();if(B>=Ut&&B<=Ut+Zt&&dt>=Jt&&dt<=Jt+oe)return Ht}return null}disableUserSelect(B=!1){t(this,Y).classList.toggle("noUserSelect",B)}addShouldRescale(B){t(this,Kt).add(B)}removeShouldRescale(B){t(this,Kt).delete(B)}onScaleChanging({scale:B}){this.commitOrRemove(),this.viewParameters.realScale=B*w.PixelsPerInch.PDF_TO_CSS_UNITS;for(const dt of t(this,Kt))dt.onScaleChanging()}onRotationChanging({pagesRotation:B}){this.commitOrRemove(),this.viewParameters.rotation=B}highlightSelection(B=""){const dt=document.getSelection();if(!dt||dt.isCollapsed)return;const{anchorNode:Ht,anchorOffset:Ut,focusNode:Jt,focusOffset:Zt}=dt,oe=dt.toString(),be=C(this,nt,pn).call(this,dt).closest(".textLayer"),Re=this.getSelectionBoxes(be);if(Re){dt.empty(),t(this,i)===e.AnnotationEditorType.NONE&&(this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e.AnnotationEditorType.HIGHLIGHT}),this.showAllEditors("highlight",!0,!0));for(const He of t(this,Lt).values())if(He.hasTextLayer(be)){He.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:B,boxes:Re,anchorNode:Ht,anchorOffset:Ut,focusNode:Jt,focusOffset:Zt,text:oe});break}}}addToAnnotationStorage(B){!B.isEmpty()&&t(this,Et)&&!t(this,Et).has(B.id)&&t(this,Et).setValue(B.id,B)}blur(){if(this.isShiftKeyDown=!1,t(this,ve)&&(I(this,ve,!1),C(this,mt,gn).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:B}=document;for(const dt of t(this,n))if(dt.div.contains(B)){I(this,Ee,[dt,B]),dt._focusEventsAllowed=!1;break}}focus(){if(!t(this,Ee))return;const[B,dt]=t(this,Ee);I(this,Ee,null),dt.addEventListener("focusin",()=>{B._focusEventsAllowed=!0},{once:!0}),dt.focus()}addEditListeners(){C(this,ke,gr).call(this),C(this,Q,fr).call(this)}removeEditListeners(){C(this,D,mr).call(this),C(this,ct,vr).call(this)}copy(B){var Ht;if(B.preventDefault(),(Ht=t(this,Ot))==null||Ht.commitOrRemove(),!this.hasSelection)return;const dt=[];for(const Ut of t(this,n)){const Jt=Ut.serialize(!0);Jt&&dt.push(Jt)}dt.length!==0&&B.clipboardData.setData("application/pdfjs",JSON.stringify(dt))}cut(B){this.copy(B),this.delete()}paste(B){B.preventDefault();const{clipboardData:dt}=B;for(const Jt of dt.items)for(const Zt of t(this,qt))if(Zt.isHandlingMimeForPasting(Jt.type)){Zt.paste(Jt,this.currentLayer);return}let Ht=dt.getData("application/pdfjs");if(!Ht)return;try{Ht=JSON.parse(Ht)}catch(Jt){(0,e.warn)(`paste: "${Jt.message}".`);return}if(!Array.isArray(Ht))return;this.unselectAll();const Ut=this.currentLayer;try{const Jt=[];for(const be of Ht){const Re=Ut.deserialize(be);if(!Re)return;Jt.push(Re)}const Zt=()=>{for(const be of Jt)C(this,Qt,br).call(this,be);C(this,Xe,Ar).call(this,Jt)},oe=()=>{for(const be of Jt)be.remove()};this.addCommands({cmd:Zt,undo:oe,mustExec:!0})}catch(Jt){(0,e.warn)(`paste: "${Jt.message}".`)}}keydown(B){!this.isShiftKeyDown&&B.key==="Shift"&&(this.isShiftKeyDown=!0),t(this,i)!==e.AnnotationEditorType.NONE&&!this.isEditorHandlingKeyboard&&is._keyboardManager.exec(this,B)}keyup(B){this.isShiftKeyDown&&B.key==="Shift"&&(this.isShiftKeyDown=!1,t(this,ve)&&(I(this,ve,!1),C(this,mt,gn).call(this,"main_toolbar")))}onEditingAction({name:B}){switch(B){case"undo":case"redo":case"delete":case"selectAll":this[B]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(B){B?(C(this,Me,Ya).call(this),C(this,Q,fr).call(this),C(this,bt,Qe).call(this,{isEditing:t(this,i)!==e.AnnotationEditorType.NONE,isEmpty:C(this,Le,ki).call(this),hasSomethingToUndo:t(this,Z).hasSomethingToUndo(),hasSomethingToRedo:t(this,Z).hasSomethingToRedo(),hasSelectedEditor:!1})):(C(this,Fe,pr).call(this),C(this,ct,vr).call(this),C(this,bt,Qe).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(B){if(!t(this,qt)){I(this,qt,B);for(const dt of t(this,qt))C(this,Vt,xs).call(this,dt.defaultPropertiesToUpdate)}}getId(){return t(this,ae).id}get currentLayer(){return t(this,Lt).get(t(this,gt))}getLayer(B){return t(this,Lt).get(B)}get currentPageIndex(){return t(this,gt)}addLayer(B){t(this,Lt).set(B.pageIndex,B),t(this,Ce)?B.enable():B.disable()}removeLayer(B){t(this,Lt).delete(B.pageIndex)}updateMode(B,dt=null,Ht=!1){if(t(this,i)!==B){if(I(this,i,B),B===e.AnnotationEditorType.NONE){this.setEditingState(!1),C(this,St,Qa).call(this);return}this.setEditingState(!0),C(this,Yt,Ja).call(this),this.unselectAll();for(const Ut of t(this,Lt).values())Ut.updateMode(B);if(!dt&&Ht){this.addNewEditorFromKeyboard();return}if(dt){for(const Ut of t(this,_t).values())if(Ut.annotationElementId===dt){this.setSelected(Ut),Ut.enterInEditMode();break}}}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(B){B!==t(this,i)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:B})}updateParams(B,dt){var Ht;if(t(this,qt)){switch(B){case e.AnnotationEditorParamsType.CREATE:this.currentLayer.addNewEditor();return;case e.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:(Ht=t(this,ne))==null||Ht.updateColor(dt);break;case e.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(t(this,o)||I(this,o,new Map)).set(B,dt),this.showAllEditors("highlight",dt);break}for(const Ut of t(this,n))Ut.updateParams(B,dt);for(const Ut of t(this,qt))Ut.updateDefaultParams(B,dt)}}showAllEditors(B,dt,Ht=!1){var Ut;for(const Jt of t(this,_t).values())Jt.editorType===B&&Jt.show(dt);(((Ut=t(this,o))==null?void 0:Ut.get(e.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL))??!0)!==dt&&C(this,Vt,xs).call(this,[[e.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL,dt]])}enableWaiting(B=!1){if(t(this,ee)!==B){I(this,ee,B);for(const dt of t(this,Lt).values())B?dt.disableClick():dt.enableClick(),dt.div.classList.toggle("waiting",B)}}getEditors(B){const dt=[];for(const Ht of t(this,_t).values())Ht.pageIndex===B&&dt.push(Ht);return dt}getEditor(B){return t(this,_t).get(B)}addEditor(B){t(this,_t).set(B.id,B)}removeEditor(B){var dt;B.div.contains(document.activeElement)&&(t(this,de)&&clearTimeout(t(this,de)),I(this,de,setTimeout(()=>{this.focusMainContainer(),I(this,de,null)},0))),t(this,_t).delete(B.id),this.unselect(B),(!B.annotationElementId||!t(this,Rt).has(B.annotationElementId))&&((dt=t(this,Et))==null||dt.remove(B.id))}addDeletedAnnotationElement(B){t(this,Rt).add(B.annotationElementId),B.deleted=!0}isDeletedAnnotationElement(B){return t(this,Rt).has(B)}removeDeletedAnnotationElement(B){t(this,Rt).delete(B.annotationElementId),B.deleted=!1}setActiveEditor(B){t(this,Ot)!==B&&(I(this,Ot,B),B&&C(this,Vt,xs).call(this,B.propertiesToUpdate))}updateUI(B){t(this,ce,Za)===B&&C(this,Vt,xs).call(this,B.propertiesToUpdate)}toggleSelected(B){if(t(this,n).has(B)){t(this,n).delete(B),B.unselect(),C(this,bt,Qe).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,n).add(B),B.select(),C(this,Vt,xs).call(this,B.propertiesToUpdate),C(this,bt,Qe).call(this,{hasSelectedEditor:!0})}setSelected(B){for(const dt of t(this,n))dt!==B&&dt.unselect();t(this,n).clear(),t(this,n).add(B),B.select(),C(this,Vt,xs).call(this,B.propertiesToUpdate),C(this,bt,Qe).call(this,{hasSelectedEditor:!0})}isSelected(B){return t(this,n).has(B)}get firstSelectedEditor(){return t(this,n).values().next().value}unselect(B){B.unselect(),t(this,n).delete(B),C(this,bt,Qe).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,n).size!==0}get isEnterHandled(){return t(this,n).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){t(this,Z).undo(),C(this,bt,Qe).call(this,{hasSomethingToUndo:t(this,Z).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:C(this,Le,ki).call(this)})}redo(){t(this,Z).redo(),C(this,bt,Qe).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,Z).hasSomethingToRedo(),isEmpty:C(this,Le,ki).call(this)})}addCommands(B){t(this,Z).add(B),C(this,bt,Qe).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:C(this,Le,ki).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const B=[...t(this,n)],dt=()=>{for(const Ut of B)Ut.remove()},Ht=()=>{for(const Ut of B)C(this,Qt,br).call(this,Ut)};this.addCommands({cmd:dt,undo:Ht,mustExec:!0})}commitOrRemove(){var B;(B=t(this,Ot))==null||B.commitOrRemove()}hasSomethingToControl(){return t(this,Ot)||this.hasSelection}selectAll(){for(const B of t(this,n))B.commit();C(this,Xe,Ar).call(this,t(this,_t).values())}unselectAll(){if(!(t(this,Ot)&&(t(this,Ot).commitOrRemove(),t(this,i)!==e.AnnotationEditorType.NONE))&&this.hasSelection){for(const B of t(this,n))B.unselect();t(this,n).clear(),C(this,bt,Qe).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(B,dt,Ht=!1){if(Ht||this.commitOrRemove(),!this.hasSelection)return;t(this,ut)[0]+=B,t(this,ut)[1]+=dt;const[Ut,Jt]=t(this,ut),Zt=[...t(this,n)];t(this,xt)&&clearTimeout(t(this,xt)),I(this,xt,setTimeout(()=>{I(this,xt,null),t(this,ut)[0]=t(this,ut)[1]=0,this.addCommands({cmd:()=>{for(const be of Zt)t(this,_t).has(be.id)&&be.translateInPage(Ut,Jt)},undo:()=>{for(const be of Zt)t(this,_t).has(be.id)&&be.translateInPage(-Ut,-Jt)},mustExec:!1})},1e3));for(const be of Zt)be.translateInPage(B,dt)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),I(this,Pt,new Map);for(const B of t(this,n))t(this,Pt).set(B,{savedX:B.x,savedY:B.y,savedPageIndex:B.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,Pt))return!1;this.disableUserSelect(!1);const B=t(this,Pt);I(this,Pt,null);let dt=!1;for(const[{x:Ut,y:Jt,pageIndex:Zt},oe]of B)oe.newX=Ut,oe.newY=Jt,oe.newPageIndex=Zt,dt||(dt=Ut!==oe.savedX||Jt!==oe.savedY||Zt!==oe.savedPageIndex);if(!dt)return!1;const Ht=(Ut,Jt,Zt,oe)=>{if(t(this,_t).has(Ut.id)){const be=t(this,Lt).get(oe);be?Ut._setParentAndPosition(be,Jt,Zt):(Ut.pageIndex=oe,Ut.x=Jt,Ut.y=Zt)}};return this.addCommands({cmd:()=>{for(const[Ut,{newX:Jt,newY:Zt,newPageIndex:oe}]of B)Ht(Ut,Jt,Zt,oe)},undo:()=>{for(const[Ut,{savedX:Jt,savedY:Zt,savedPageIndex:oe}]of B)Ht(Ut,Jt,Zt,oe)},mustExec:!0}),!0}dragSelectedEditors(B,dt){if(t(this,Pt))for(const Ht of t(this,Pt).keys())Ht.drag(B,dt)}rebuild(B){if(B.parent===null){const dt=this.getLayer(B.pageIndex);dt?(dt.changeParent(B),dt.addOrRebuild(B)):(this.addEditor(B),this.addToAnnotationStorage(B),B.rebuild())}else B.parent.addOrRebuild(B)}get isEditorHandlingKeyboard(){var B;return((B=this.getActive())==null?void 0:B.shouldGetKeyboardEvents())||t(this,n).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(B){return t(this,Ot)===B}getActive(){return t(this,Ot)}getMode(){return t(this,i)}get imageManager(){return(0,e.shadow)(this,"imageManager",new _)}getSelectionBoxes(B){if(!B)return null;const dt=document.getSelection();for(let Re=0,He=dt.rangeCount;Re<He;Re++)if(!B.contains(dt.getRangeAt(Re).commonAncestorContainer))return null;const{x:Ht,y:Ut,width:Jt,height:Zt}=B.getBoundingClientRect();let oe;switch(B.getAttribute("data-main-rotation")){case"90":oe=(Re,He,Ye,ze)=>({x:(He-Ut)/Zt,y:1-(Re+Ye-Ht)/Jt,width:ze/Zt,height:Ye/Jt});break;case"180":oe=(Re,He,Ye,ze)=>({x:1-(Re+Ye-Ht)/Jt,y:1-(He+ze-Ut)/Zt,width:Ye/Jt,height:ze/Zt});break;case"270":oe=(Re,He,Ye,ze)=>({x:1-(He+ze-Ut)/Zt,y:(Re-Ht)/Jt,width:ze/Zt,height:Ye/Jt});break;default:oe=(Re,He,Ye,ze)=>({x:(Re-Ht)/Jt,y:(He-Ut)/Zt,width:Ye/Jt,height:ze/Zt});break}const be=[];for(let Re=0,He=dt.rangeCount;Re<He;Re++){const Ye=dt.getRangeAt(Re);if(!Ye.collapsed)for(const{x:ze,y:th,width:Ms,height:jr}of Ye.getClientRects())Ms===0||jr===0||be.push(oe(ze,th,Ms,jr))}return be.length===0?null:be}};Ot=new WeakMap,_t=new WeakMap,Lt=new WeakMap,kt=new WeakMap,Et=new WeakMap,Z=new WeakMap,gt=new WeakMap,Rt=new WeakMap,Pt=new WeakMap,qt=new WeakMap,Kt=new WeakMap,ie=new WeakMap,Se=new WeakMap,de=new WeakMap,le=new WeakMap,ve=new WeakMap,jt=new WeakMap,ae=new WeakMap,Ce=new WeakMap,ee=new WeakMap,Ee=new WeakMap,ne=new WeakMap,et=new WeakMap,i=new WeakMap,n=new WeakMap,c=new WeakMap,p=new WeakMap,o=new WeakMap,y=new WeakMap,b=new WeakMap,E=new WeakMap,d=new WeakMap,a=new WeakMap,h=new WeakMap,R=new WeakMap,V=new WeakMap,G=new WeakMap,at=new WeakMap,ot=new WeakMap,yt=new WeakMap,At=new WeakMap,ut=new WeakMap,xt=new WeakMap,P=new WeakMap,Y=new WeakMap,nt=new WeakSet,pn=function({anchorNode:B}){return B.nodeType===Node.TEXT_NODE?B.parentElement:B},v=new WeakSet,za=function(){const B=document.getSelection();if(!B||B.isCollapsed)return;const dt=C(this,nt,pn).call(this,B).closest(".textLayer"),Ht=this.getSelectionBoxes(dt);Ht&&(t(this,jt)||I(this,jt,new f.HighlightToolbar(this)),t(this,jt).show(dt,Ht,this.direction==="ltr"))},K=new WeakSet,Wa=function(){var Ht,Ut,Jt;const B=document.getSelection();if(!B||B.isCollapsed){t(this,c)&&((Ht=t(this,jt))==null||Ht.hide(),I(this,c,null),C(this,bt,Qe).call(this,{hasSelectedText:!1}));return}const{anchorNode:dt}=B;if(dt!==t(this,c)){if(!C(this,nt,pn).call(this,B).closest(".textLayer")){t(this,c)&&((Ut=t(this,jt))==null||Ut.hide(),I(this,c,null),C(this,bt,Qe).call(this,{hasSelectedText:!1}));return}if((Jt=t(this,jt))==null||Jt.hide(),I(this,c,dt),C(this,bt,Qe).call(this,{hasSelectedText:!0}),!(t(this,i)!==e.AnnotationEditorType.HIGHLIGHT&&t(this,i)!==e.AnnotationEditorType.NONE)&&(t(this,i)===e.AnnotationEditorType.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),I(this,ve,this.isShiftKeyDown),!this.isShiftKeyDown)){const Zt=oe=>{oe.type==="pointerup"&&oe.button!==0||(window.removeEventListener("pointerup",Zt),window.removeEventListener("blur",Zt),oe.type==="pointerup"&&C(this,mt,gn).call(this,"main_toolbar"))};window.addEventListener("pointerup",Zt),window.addEventListener("blur",Zt)}}},mt=new WeakSet,gn=function(B=""){t(this,i)===e.AnnotationEditorType.HIGHLIGHT?this.highlightSelection(B):t(this,ie)&&C(this,v,za).call(this)},Dt=new WeakSet,Xa=function(){document.addEventListener("selectionchange",t(this,ot))},re=new WeakSet,Ka=function(){document.removeEventListener("selectionchange",t(this,ot))},Me=new WeakSet,Ya=function(){window.addEventListener("focus",t(this,b)),window.addEventListener("blur",t(this,y))},Fe=new WeakSet,pr=function(){window.removeEventListener("focus",t(this,b)),window.removeEventListener("blur",t(this,y))},ke=new WeakSet,gr=function(){window.addEventListener("keydown",t(this,h)),window.addEventListener("keyup",t(this,R))},D=new WeakSet,mr=function(){window.removeEventListener("keydown",t(this,h)),window.removeEventListener("keyup",t(this,R))},Q=new WeakSet,fr=function(){document.addEventListener("copy",t(this,E)),document.addEventListener("cut",t(this,d)),document.addEventListener("paste",t(this,a))},ct=new WeakSet,vr=function(){document.removeEventListener("copy",t(this,E)),document.removeEventListener("cut",t(this,d)),document.removeEventListener("paste",t(this,a))},bt=new WeakSet,Qe=function(B){Object.entries(B).some(([dt,Ht])=>t(this,At)[dt]!==Ht)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,At),B)}),t(this,i)===e.AnnotationEditorType.HIGHLIGHT&&B.hasSelectedEditor===!1&&C(this,Vt,xs).call(this,[[e.AnnotationEditorParamsType.HIGHLIGHT_FREE,!0]]))},Vt=new WeakSet,xs=function(B){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:B})},Yt=new WeakSet,Ja=function(){if(!t(this,Ce)){I(this,Ce,!0);for(const B of t(this,Lt).values())B.enable();for(const B of t(this,_t).values())B.enable()}},St=new WeakSet,Qa=function(){if(this.unselectAll(),t(this,Ce)){I(this,Ce,!1);for(const B of t(this,Lt).values())B.disable();for(const B of t(this,_t).values())B.disable()}},Qt=new WeakSet,br=function(B){const dt=t(this,Lt).get(B.pageIndex);dt?dt.addOrRebuild(B):(this.addEditor(B),this.addToAnnotationStorage(B))},ce=new WeakSet,Za=function(){let B=null;for(B of t(this,n));return B},Le=new WeakSet,ki=function(){if(t(this,_t).size===0)return!0;if(t(this,_t).size===1)for(const B of t(this,_t).values())return B.isEmpty();return!1},Xe=new WeakSet,Ar=function(B){for(const dt of t(this,n))dt.unselect();t(this,n).clear();for(const dt of B)dt.isEmpty()||(t(this,n).add(dt),dt.select());C(this,bt,Qe).call(this,{hasSelectedEditor:this.hasSelection})},fe(is,"TRANSLATE_SMALL",1),fe(is,"TRANSLATE_BIG",10);let A=is},94:(r,m,u)=>{u.d(m,{PDFFetchStream:()=>k});var e=u(292),w=u(490);function f(H,S,A){return{method:"GET",headers:H,signal:A.signal,mode:"cors",credentials:S?"include":"same-origin",redirect:"follow"}}function T(H){const S=new Headers;for(const A in H){const F=H[A];F!==void 0&&S.append(A,F)}return S}function W(H){return H instanceof Uint8Array?H.buffer:H instanceof ArrayBuffer?H:((0,e.warn)(`getArrayBuffer - unexpected data format: ${H}`),new Uint8Array(H).buffer)}class k{constructor(S){this.source=S,this.isHttp=/^https?:/i.test(S.url),this.httpHeaders=this.isHttp&&S.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var S;return((S=this._fullRequestReader)==null?void 0:S._loaded)??0}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new _(this),this._fullRequestReader}getRangeReader(S,A){if(A<=this._progressiveDataLength)return null;const F=new g(this,S,A);return this._rangeRequestReaders.push(F),F}cancelAllRequests(S){var A;(A=this._fullRequestReader)==null||A.cancel(S);for(const F of this._rangeRequestReaders.slice(0))F.cancel(S)}}class _{constructor(S){this._stream=S,this._reader=null,this._loaded=0,this._filename=null;const A=S.source;this._withCredentials=A.withCredentials||!1,this._contentLength=A.length,this._headersCapability=Promise.withResolvers(),this._disableRange=A.disableRange||!1,this._rangeChunkSize=A.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!A.disableStream,this._isRangeSupported=!A.disableRange,this._headers=T(this._stream.httpHeaders);const F=A.url;fetch(F,f(this._headers,this._withCredentials,this._abortController)).then(N=>{if(!(0,w.validateResponseStatus)(N.status))throw(0,w.createResponseStatusError)(N.status,F);this._reader=N.body.getReader(),this._headersCapability.resolve();const X=M=>N.headers.get(M),{allowRangeRequests:rt,suggestedLength:J}=(0,w.validateRangeRequestCapabilities)({getResponseHeader:X,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=rt,this._contentLength=J||this._contentLength,this._filename=(0,w.extractFilenameFromHeader)(X),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new e.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var F;await this._headersCapability.promise;const{value:S,done:A}=await this._reader.read();return A?{value:S,done:A}:(this._loaded+=S.byteLength,(F=this.onProgress)==null||F.call(this,{loaded:this._loaded,total:this._contentLength}),{value:W(S),done:!1})}cancel(S){var A;(A=this._reader)==null||A.cancel(S),this._abortController.abort()}}class g{constructor(S,A,F){this._stream=S,this._reader=null,this._loaded=0;const N=S.source;this._withCredentials=N.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!N.disableStream,this._abortController=new AbortController,this._headers=T(this._stream.httpHeaders),this._headers.append("Range",`bytes=${A}-${F-1}`);const X=N.url;fetch(X,f(this._headers,this._withCredentials,this._abortController)).then(rt=>{if(!(0,w.validateResponseStatus)(rt.status))throw(0,w.createResponseStatusError)(rt.status,X);this._readCapability.resolve(),this._reader=rt.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var F;await this._readCapability.promise;const{value:S,done:A}=await this._reader.read();return A?{value:S,done:A}:(this._loaded+=S.byteLength,(F=this.onProgress)==null||F.call(this,{loaded:this._loaded}),{value:W(S),done:!1})}cancel(S){var A;(A=this._reader)==null||A.cancel(S),this._abortController.abort()}}},10:(r,m,u)=>{var T;u.d(m,{FontFaceObject:()=>f,FontLoader:()=>w});var e=u(292);class w{constructor({ownerDocument:k=globalThis.document,styleElement:_=null}){l(this,T,new Set);this._document=k,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(k){this.nativeFontFaces.add(k),this._document.fonts.add(k)}removeNativeFontFace(k){this.nativeFontFaces.delete(k),this._document.fonts.delete(k)}insertRule(k){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const _=this.styleElement.sheet;_.insertRule(k,_.cssRules.length)}clear(){for(const k of this.nativeFontFaces)this._document.fonts.delete(k);this.nativeFontFaces.clear(),t(this,T).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:k,_inspectFont:_}){if(!(!k||t(this,T).has(k.loadedName))){if((0,e.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:g,src:H,style:S}=k,A=new FontFace(g,H,S);this.addNativeFontFace(A);try{await A.load(),t(this,T).add(g),_==null||_(k)}catch{(0,e.warn)(`Cannot load system font: ${k.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(A)}return}(0,e.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(k){if(k.attached||k.missingFile&&!k.systemFontInfo)return;if(k.attached=!0,k.systemFontInfo){await this.loadSystemFont(k);return}if(this.isFontLoadingAPISupported){const g=k.createNativeFontFace();if(g){this.addNativeFontFace(g);try{await g.loaded}catch(H){throw(0,e.warn)(`Failed to load font '${g.family}': '${H}'.`),k.disableFontFace=!0,H}}return}const _=k.createFontFaceRule();if(_){if(this.insertRule(_),this.isSyncFontLoadingSupported)return;await new Promise(g=>{const H=this._queueLoadingCallback(g);this._prepareFontLoadEvent(k,H)})}}get isFontLoadingAPISupported(){var _;const k=!!((_=this._document)!=null&&_.fonts);return(0,e.shadow)(this,"isFontLoadingAPISupported",k)}get isSyncFontLoadingSupported(){let k=!1;return(e.isNodeJS||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(k=!0),(0,e.shadow)(this,"isSyncFontLoadingSupported",k)}_queueLoadingCallback(k){function _(){for((0,e.assert)(!H.done,"completeRequest() cannot be called twice."),H.done=!0;g.length>0&&g[0].done;){const S=g.shift();setTimeout(S.callback,0)}}const{loadingRequests:g}=this,H={done:!1,complete:_,callback:k};return g.push(H),H}get _loadTestFont(){const k=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,e.shadow)(this,"_loadTestFont",k)}_prepareFontLoadEvent(k,_){function g(Ft,Ct){return Ft.charCodeAt(Ct)<<24|Ft.charCodeAt(Ct+1)<<16|Ft.charCodeAt(Ct+2)<<8|Ft.charCodeAt(Ct+3)&255}function H(Ft,Ct,Ot,_t){const Lt=Ft.substring(0,Ct),kt=Ft.substring(Ct+Ot);return Lt+_t+kt}let S,A;const F=this._document.createElement("canvas");F.width=1,F.height=1;const N=F.getContext("2d");let X=0;function rt(Ft,Ct){if(++X>30){(0,e.warn)("Load test font never loaded."),Ct();return}if(N.font="30px "+Ft,N.fillText(".",0,20),N.getImageData(0,0,1,1).data[3]>0){Ct();return}setTimeout(rt.bind(null,Ft,Ct))}const J=`lt${Date.now()}${this.loadTestFontId++}`;let M=this._loadTestFont;M=H(M,976,J.length,J);const j=16,$=1482184792;let O=g(M,j);for(S=0,A=J.length-3;S<A;S+=4)O=O-$+g(J,S)|0;S<J.length&&(O=O-$+g(J+"XXX",S)|0),M=H(M,j,4,(0,e.string32)(O));const q=`url(data:font/opentype;base64,${btoa(M)});`,tt=`@font-face {font-family:"${J}";src:${q}}`;this.insertRule(tt);const vt=this._document.createElement("div");vt.style.visibility="hidden",vt.style.width=vt.style.height="10px",vt.style.position="absolute",vt.style.top=vt.style.left="0px";for(const Ft of[k.loadedName,J]){const Ct=this._document.createElement("span");Ct.textContent="Hi",Ct.style.fontFamily=Ft,vt.append(Ct)}this._document.body.append(vt),rt(J,()=>{vt.remove(),_.complete()})}}T=new WeakMap;class f{constructor(k,{isEvalSupported:_=!0,disableFontFace:g=!1,ignoreErrors:H=!1,inspectFont:S=null}){this.compiledGlyphs=Object.create(null);for(const A in k)this[A]=k[A];this.isEvalSupported=_!==!1,this.disableFontFace=g===!0,this.ignoreErrors=H===!0,this._inspectFont=S}createNativeFontFace(){var _;if(!this.data||this.disableFontFace)return null;let k;if(!this.cssFontInfo)k=new FontFace(this.loadedName,this.data,{});else{const g={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(g.style=`oblique ${this.cssFontInfo.italicAngle}deg`),k=new FontFace(this.cssFontInfo.fontFamily,this.data,g)}return(_=this._inspectFont)==null||_.call(this,this),k}createFontFaceRule(){var H;if(!this.data||this.disableFontFace)return null;const k=(0,e.bytesToString)(this.data),_=`url(data:${this.mimetype};base64,${btoa(k)});`;let g;if(!this.cssFontInfo)g=`@font-face {font-family:"${this.loadedName}";src:${_}}`;else{let S=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(S+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),g=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${S}src:${_}}`}return(H=this._inspectFont)==null||H.call(this,this,_),g}getPathGenerator(k,_){if(this.compiledGlyphs[_]!==void 0)return this.compiledGlyphs[_];let g;try{g=k.get(this.loadedName+"_path_"+_)}catch(H){if(!this.ignoreErrors)throw H;return(0,e.warn)(`getPathGenerator - ignoring character: "${H}".`),this.compiledGlyphs[_]=function(S,A){}}if(this.isEvalSupported&&e.FeatureTest.isEvalSupported){const H=[];for(const S of g){const A=S.args!==void 0?S.args.join(","):"";H.push("c.",S.cmd,"(",A,`);
`)}return this.compiledGlyphs[_]=new Function("c","size",H.join(""))}return this.compiledGlyphs[_]=function(H,S){for(const A of g)A.cmd==="scale"&&(A.args=[S,-S]),H[A.cmd].apply(H,A.args)}}}},62:(r,m,u)=>{var f,T;u.d(m,{Metadata:()=>w});var e=u(292);class w{constructor({parsedData:k,rawData:_}){l(this,f,void 0);l(this,T,void 0);I(this,f,k),I(this,T,_)}getRaw(){return t(this,T)}get(k){return t(this,f).get(k)??null}getAll(){return(0,e.objectFromMap)(t(this,f))}has(k){return t(this,f).has(k)}}f=new WeakMap,T=new WeakMap},457:(r,m,u)=>{u.d(m,{PDFNetworkStream:()=>_});var e=u(292),w=u(490);const f=200,T=206;function W(S){const A=S.response;return typeof A!="string"?A:(0,e.stringToBytes)(A).buffer}class k{constructor(A,F={}){this.url=A,this.isHttp=/^https?:/i.test(A),this.httpHeaders=this.isHttp&&F.httpHeaders||Object.create(null),this.withCredentials=F.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(A,F,N){const X={begin:A,end:F};for(const rt in N)X[rt]=N[rt];return this.request(X)}requestFull(A){return this.request(A)}request(A){const F=new XMLHttpRequest,N=this.currXhrId++,X=this.pendingRequests[N]={xhr:F};F.open("GET",this.url),F.withCredentials=this.withCredentials;for(const rt in this.httpHeaders){const J=this.httpHeaders[rt];J!==void 0&&F.setRequestHeader(rt,J)}return this.isHttp&&"begin"in A&&"end"in A?(F.setRequestHeader("Range",`bytes=${A.begin}-${A.end-1}`),X.expectedStatus=T):X.expectedStatus=f,F.responseType="arraybuffer",A.onError&&(F.onerror=function(rt){A.onError(F.status)}),F.onreadystatechange=this.onStateChange.bind(this,N),F.onprogress=this.onProgress.bind(this,N),X.onHeadersReceived=A.onHeadersReceived,X.onDone=A.onDone,X.onError=A.onError,X.onProgress=A.onProgress,F.send(null),N}onProgress(A,F){var X;const N=this.pendingRequests[A];N&&((X=N.onProgress)==null||X.call(N,F))}onStateChange(A,F){var M,j,$;const N=this.pendingRequests[A];if(!N)return;const X=N.xhr;if(X.readyState>=2&&N.onHeadersReceived&&(N.onHeadersReceived(),delete N.onHeadersReceived),X.readyState!==4||!(A in this.pendingRequests))return;if(delete this.pendingRequests[A],X.status===0&&this.isHttp){(M=N.onError)==null||M.call(N,X.status);return}const rt=X.status||f;if(!(rt===f&&N.expectedStatus===T)&&rt!==N.expectedStatus){(j=N.onError)==null||j.call(N,X.status);return}const J=W(X);if(rt===T){const O=X.getResponseHeader("Content-Range"),q=/bytes (\d+)-(\d+)\/(\d+)/.exec(O);N.onDone({begin:parseInt(q[1],10),chunk:J})}else J?N.onDone({begin:0,chunk:J}):($=N.onError)==null||$.call(N,X.status)}getRequestXhr(A){return this.pendingRequests[A].xhr}isPendingRequest(A){return A in this.pendingRequests}abortRequest(A){const F=this.pendingRequests[A].xhr;delete this.pendingRequests[A],F.abort()}}class _{constructor(A){this._source=A,this._manager=new k(A.url,{httpHeaders:A.httpHeaders,withCredentials:A.withCredentials}),this._rangeChunkSize=A.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(A){const F=this._rangeRequestReaders.indexOf(A);F>=0&&this._rangeRequestReaders.splice(F,1)}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new g(this._manager,this._source),this._fullRequestReader}getRangeReader(A,F){const N=new H(this._manager,A,F);return N.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(N),N}cancelAllRequests(A){var F;(F=this._fullRequestReader)==null||F.cancel(A);for(const N of this._rangeRequestReaders.slice(0))N.cancel(A)}}class g{constructor(A,F){this._manager=A;const N={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=F.url,this._fullRequestId=A.requestFull(N),this._headersReceivedCapability=Promise.withResolvers(),this._disableRange=F.disableRange||!1,this._contentLength=F.length,this._rangeChunkSize=F.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const A=this._fullRequestId,F=this._manager.getRequestXhr(A),N=J=>F.getResponseHeader(J),{allowRangeRequests:X,suggestedLength:rt}=(0,w.validateRangeRequestCapabilities)({getResponseHeader:N,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});X&&(this._isRangeSupported=!0),this._contentLength=rt||this._contentLength,this._filename=(0,w.extractFilenameFromHeader)(N),this._isRangeSupported&&this._manager.abortRequest(A),this._headersReceivedCapability.resolve()}_onDone(A){if(A&&(this._requests.length>0?this._requests.shift().resolve({value:A.chunk,done:!1}):this._cachedChunks.push(A.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const F of this._requests)F.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(A){this._storedError=(0,w.createResponseStatusError)(A,this._url),this._headersReceivedCapability.reject(this._storedError);for(const F of this._requests)F.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(A){var F;(F=this.onProgress)==null||F.call(this,{loaded:A.loaded,total:A.lengthComputable?A.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const A=Promise.withResolvers();return this._requests.push(A),A.promise}cancel(A){this._done=!0,this._headersReceivedCapability.reject(A);for(const F of this._requests)F.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class H{constructor(A,F,N){this._manager=A;const X={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=A.url,this._requestId=A.requestRange(F,N,X),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var A;(A=this.onClosed)==null||A.call(this,this)}_onDone(A){const F=A.chunk;this._requests.length>0?this._requests.shift().resolve({value:F,done:!1}):this._queuedChunk=F,this._done=!0;for(const N of this._requests)N.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(A){this._storedError=(0,w.createResponseStatusError)(A,this._url);for(const F of this._requests)F.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(A){var F;this.isStreamingSupported||((F=this.onProgress)==null||F.call(this,{loaded:A.loaded}))}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const F=this._queuedChunk;return this._queuedChunk=null,{value:F,done:!1}}if(this._done)return{value:void 0,done:!0};const A=Promise.withResolvers();return this._requests.push(A),A.promise}cancel(A){this._done=!0;for(const F of this._requests)F.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},490:(r,m,u)=>{u.d(m,{createResponseStatusError:()=>k,extractFilenameFromHeader:()=>W,validateRangeRequestCapabilities:()=>T,validateResponseStatus:()=>_});var e=u(292);function w(g){let H=!0,S=A("filename\\*","i").exec(g);if(S){S=S[1];let j=rt(S);return j=unescape(j),j=J(j),j=M(j),N(j)}if(S=X(g),S){const j=M(S);return N(j)}if(S=A("filename","i").exec(g),S){S=S[1];let j=rt(S);return j=M(j),N(j)}function A(j,$){return new RegExp("(?:^|;)\\s*"+j+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',$)}function F(j,$){if(j){if(!/^[\x00-\xFF]+$/.test($))return $;try{const O=new TextDecoder(j,{fatal:!0}),q=(0,e.stringToBytes)($);$=O.decode(q),H=!1}catch{}}return $}function N(j){return H&&/[\x80-\xff]/.test(j)&&(j=F("utf-8",j),H&&(j=F("iso-8859-1",j))),j}function X(j){const $=[];let O;const q=A("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(O=q.exec(j))!==null;){let[,vt,Ft,Ct]=O;if(vt=parseInt(vt,10),vt in $){if(vt===0)break;continue}$[vt]=[Ft,Ct]}const tt=[];for(let vt=0;vt<$.length&&vt in $;++vt){let[Ft,Ct]=$[vt];Ct=rt(Ct),Ft&&(Ct=unescape(Ct),vt===0&&(Ct=J(Ct))),tt.push(Ct)}return tt.join("")}function rt(j){if(j.startsWith('"')){const $=j.slice(1).split('\\"');for(let O=0;O<$.length;++O){const q=$[O].indexOf('"');q!==-1&&($[O]=$[O].slice(0,q),$.length=O+1),$[O]=$[O].replaceAll(/\\(.)/g,"$1")}j=$.join('"')}return j}function J(j){const $=j.indexOf("'");if($===-1)return j;const O=j.slice(0,$),q=j.slice($+1).replace(/^[^']*'/,"");return F(O,q)}function M(j){return!j.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(j)?j:j.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function($,O,q,tt){if(q==="q"||q==="Q")return tt=tt.replaceAll("_"," "),tt=tt.replaceAll(/=([0-9a-fA-F]{2})/g,function(vt,Ft){return String.fromCharCode(parseInt(Ft,16))}),F(O,tt);try{tt=atob(tt)}catch{}return F(O,tt)})}return""}var f=u(419);function T({getResponseHeader:g,isHttp:H,rangeChunkSize:S,disableRange:A}){const F={allowRangeRequests:!1,suggestedLength:void 0},N=parseInt(g("Content-Length"),10);return!Number.isInteger(N)||(F.suggestedLength=N,N<=2*S)||A||!H||g("Accept-Ranges")!=="bytes"||(g("Content-Encoding")||"identity")!=="identity"||(F.allowRangeRequests=!0),F}function W(g){const H=g("Content-Disposition");if(H){let S=w(H);if(S.includes("%"))try{S=decodeURIComponent(S)}catch{}if((0,f.isPdfFile)(S))return S}return null}function k(g,H){return g===404||g===0&&H.startsWith("file:")?new e.MissingPDFException('Missing PDF "'+H+'".'):new e.UnexpectedResponseException(`Unexpected server response (${g}) while retrieving PDF "${H}".`,g)}function _(g){return g===200||g===206}},786:(r,m,u)=>{u.a(r,async(e,w)=>{try{let W=function($){const O=S.parse($);return O.protocol==="file:"||O.host?O:/^[a-z]:[/\\]/i.test($)?S.parse(`file:///${$}`):(O.host||(O.protocol="file:"),O)},k=function($,O){return{protocol:$.protocol,auth:$.auth,host:$.hostname,port:$.port,path:$.path,method:"GET",headers:O}};u.d(m,{PDFNodeStream:()=>F});var f=u(292),T=u(490);let _,g,H,S;f.isNodeJS&&(_=await vs(()=>import("./chunk.js"),[]),g=await vs(()=>import("./chunk.js"),[]),H=await vs(()=>import("./chunk.js"),[]),S=await vs(()=>import("./chunk.js"),[]));const A=/^file:\/\/\/[a-zA-Z]:\//;class F{constructor(O){this.source=O,this.url=W(O.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&O.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var O;return((O=this._fullRequestReader)==null?void 0:O._loaded)??0}getFullReader(){return(0,f.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new M(this):new rt(this),this._fullRequestReader}getRangeReader(O,q){if(q<=this._progressiveDataLength)return null;const tt=this.isFsUrl?new j(this,O,q):new J(this,O,q);return this._rangeRequestReaders.push(tt),tt}cancelAllRequests(O){var q;(q=this._fullRequestReader)==null||q.cancel(O);for(const tt of this._rangeRequestReaders.slice(0))tt.cancel(O)}}class N{constructor(O){this._url=O.url,this._done=!1,this._storedError=null,this.onProgress=null;const q=O.source;this._contentLength=q.length,this._loaded=0,this._filename=null,this._disableRange=q.disableRange||!1,this._rangeChunkSize=q.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!q.disableStream,this._isRangeSupported=!q.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var q;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const O=this._readableStream.read();return O===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=O.length,(q=this.onProgress)==null||q.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(O).buffer,done:!1})}cancel(O){if(!this._readableStream){this._error(O);return}this._readableStream.destroy(O)}_error(O){this._storedError=O,this._readCapability.resolve()}_setReadableStream(O){this._readableStream=O,O.on("readable",()=>{this._readCapability.resolve()}),O.on("end",()=>{O.destroy(),this._done=!0,this._readCapability.resolve()}),O.on("error",q=>{this._error(q)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new f.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class X{constructor(O){this._url=O.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const q=O.source;this._isStreamingSupported=!q.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var q;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const O=this._readableStream.read();return O===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=O.length,(q=this.onProgress)==null||q.call(this,{loaded:this._loaded}),{value:new Uint8Array(O).buffer,done:!1})}cancel(O){if(!this._readableStream){this._error(O);return}this._readableStream.destroy(O)}_error(O){this._storedError=O,this._readCapability.resolve()}_setReadableStream(O){this._readableStream=O,O.on("readable",()=>{this._readCapability.resolve()}),O.on("end",()=>{O.destroy(),this._done=!0,this._readCapability.resolve()}),O.on("error",q=>{this._error(q)}),this._storedError&&this._readableStream.destroy(this._storedError)}}class rt extends N{constructor(O){super(O);const q=tt=>{if(tt.statusCode===404){const Ot=new f.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Ot,this._headersCapability.reject(Ot);return}this._headersCapability.resolve(),this._setReadableStream(tt);const vt=Ot=>this._readableStream.headers[Ot.toLowerCase()],{allowRangeRequests:Ft,suggestedLength:Ct}=(0,T.validateRangeRequestCapabilities)({getResponseHeader:vt,isHttp:O.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=Ft,this._contentLength=Ct||this._contentLength,this._filename=(0,T.extractFilenameFromHeader)(vt)};this._request=null,this._url.protocol==="http:"?this._request=g.request(k(this._url,O.httpHeaders),q):this._request=H.request(k(this._url,O.httpHeaders),q),this._request.on("error",tt=>{this._storedError=tt,this._headersCapability.reject(tt)}),this._request.end()}}class J extends X{constructor(O,q,tt){super(O),this._httpHeaders={};for(const Ft in O.httpHeaders){const Ct=O.httpHeaders[Ft];Ct!==void 0&&(this._httpHeaders[Ft]=Ct)}this._httpHeaders.Range=`bytes=${q}-${tt-1}`;const vt=Ft=>{if(Ft.statusCode===404){const Ct=new f.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Ct;return}this._setReadableStream(Ft)};this._request=null,this._url.protocol==="http:"?this._request=g.request(k(this._url,this._httpHeaders),vt):this._request=H.request(k(this._url,this._httpHeaders),vt),this._request.on("error",Ft=>{this._storedError=Ft}),this._request.end()}}class M extends N{constructor(O){super(O);let q=decodeURIComponent(this._url.path);A.test(this._url.href)&&(q=q.replace(/^\//,"")),_.promises.lstat(q).then(tt=>{this._contentLength=tt.size,this._setReadableStream(_.createReadStream(q)),this._headersCapability.resolve()},tt=>{tt.code==="ENOENT"&&(tt=new f.MissingPDFException(`Missing PDF "${q}".`)),this._storedError=tt,this._headersCapability.reject(tt)})}}class j extends X{constructor(O,q,tt){super(O);let vt=decodeURIComponent(this._url.path);A.test(this._url.href)&&(vt=vt.replace(/^\//,"")),this._setReadableStream(_.createReadStream(vt,{start:q,end:tt-1}))}}w()}catch(W){w(W)}},1)},573:(r,m,u)=>{u.a(r,async(e,w)=>{try{u.d(m,{NodeCMapReaderFactory:()=>A,NodeCanvasFactory:()=>S,NodeFilterFactory:()=>H,NodeStandardFontDataFactory:()=>F});var f=u(583),T=u(292);let W,k,_;if(T.isNodeJS){W=await vs(()=>import("./chunk.js"),[]);try{k=await vs(()=>import("./chunk.js"),[])}catch{}try{_=await vs(()=>import("./chunk2.js"),[])}catch{}}const g=function(N){return W.promises.readFile(N).then(X=>new Uint8Array(X))};class H extends f.BaseFilterFactory{}class S extends f.BaseCanvasFactory{_createCanvas(X,rt){return k.createCanvas(X,rt)}}class A extends f.BaseCMapReaderFactory{_fetchData(X,rt){return g(X).then(J=>({cMapData:J,compressionType:rt}))}}class F extends f.BaseStandardFontDataFactory{_fetchData(X){return g(X)}}w()}catch(W){w(W)}},1)},626:(r,m,u)=>{var k,_,g,H,S,A,F,N,X,yr;u.d(m,{OptionalContentConfig:()=>W});var e=u(292),w=u(651);const f=Symbol("INTERNAL");class T{constructor(M,{name:j,intent:$,usage:O}){l(this,k,!1);l(this,_,!1);l(this,g,!1);l(this,H,!0);I(this,k,!!(M&e.RenderingIntentFlag.DISPLAY)),I(this,_,!!(M&e.RenderingIntentFlag.PRINT)),this.name=j,this.intent=$,this.usage=O}get visible(){if(t(this,g))return t(this,H);if(!t(this,H))return!1;const{print:M,view:j}=this.usage;return t(this,k)?(j==null?void 0:j.viewState)!=="OFF":t(this,_)?(M==null?void 0:M.printState)!=="OFF":!0}_setVisible(M,j,$=!1){M!==f&&(0,e.unreachable)("Internal method `_setVisible` called."),I(this,g,$),I(this,H,j)}}k=new WeakMap,_=new WeakMap,g=new WeakMap,H=new WeakMap;class W{constructor(M,j=e.RenderingIntentFlag.DISPLAY){l(this,X);l(this,S,null);l(this,A,new Map);l(this,F,null);l(this,N,null);if(this.renderingIntent=j,this.name=null,this.creator=null,M!==null){this.name=M.name,this.creator=M.creator,I(this,N,M.order);for(const $ of M.groups)t(this,A).set($.id,new T(j,$));if(M.baseState==="OFF")for(const $ of t(this,A).values())$._setVisible(f,!1);for(const $ of M.on)t(this,A).get($)._setVisible(f,!0);for(const $ of M.off)t(this,A).get($)._setVisible(f,!1);I(this,F,this.getHash())}}isVisible(M){if(t(this,A).size===0)return!0;if(!M)return(0,e.info)("Optional content group not defined."),!0;if(M.type==="OCG")return t(this,A).has(M.id)?t(this,A).get(M.id).visible:((0,e.warn)(`Optional content group not found: ${M.id}`),!0);if(M.type==="OCMD"){if(M.expression)return C(this,X,yr).call(this,M.expression);if(!M.policy||M.policy==="AnyOn"){for(const j of M.ids){if(!t(this,A).has(j))return(0,e.warn)(`Optional content group not found: ${j}`),!0;if(t(this,A).get(j).visible)return!0}return!1}else if(M.policy==="AllOn"){for(const j of M.ids){if(!t(this,A).has(j))return(0,e.warn)(`Optional content group not found: ${j}`),!0;if(!t(this,A).get(j).visible)return!1}return!0}else if(M.policy==="AnyOff"){for(const j of M.ids){if(!t(this,A).has(j))return(0,e.warn)(`Optional content group not found: ${j}`),!0;if(!t(this,A).get(j).visible)return!0}return!1}else if(M.policy==="AllOff"){for(const j of M.ids){if(!t(this,A).has(j))return(0,e.warn)(`Optional content group not found: ${j}`),!0;if(t(this,A).get(j).visible)return!1}return!0}return(0,e.warn)(`Unknown optional content policy ${M.policy}.`),!0}return(0,e.warn)(`Unknown group type ${M.type}.`),!0}setVisibility(M,j=!0){const $=t(this,A).get(M);if(!$){(0,e.warn)(`Optional content group not found: ${M}`);return}$._setVisible(f,!!j,!0),I(this,S,null)}setOCGState({state:M,preserveRB:j}){let $;for(const O of M){switch(O){case"ON":case"OFF":case"Toggle":$=O;continue}const q=t(this,A).get(O);if(q)switch($){case"ON":q._setVisible(f,!0);break;case"OFF":q._setVisible(f,!1);break;case"Toggle":q._setVisible(f,!q.visible);break}}I(this,S,null)}get hasInitialVisibility(){return t(this,F)===null||this.getHash()===t(this,F)}getOrder(){return t(this,A).size?t(this,N)?t(this,N).slice():[...t(this,A).keys()]:null}getGroups(){return t(this,A).size>0?(0,e.objectFromMap)(t(this,A)):null}getGroup(M){return t(this,A).get(M)||null}getHash(){if(t(this,S)!==null)return t(this,S);const M=new w.MurmurHash3_64;for(const[j,$]of t(this,A))M.update(`${j}:${$.visible}`);return I(this,S,M.hexdigest())}}S=new WeakMap,A=new WeakMap,F=new WeakMap,N=new WeakMap,X=new WeakSet,yr=function(M){const j=M.length;if(j<2)return!0;const $=M[0];for(let O=1;O<j;O++){const q=M[O];let tt;if(Array.isArray(q))tt=C(this,X,yr).call(this,q);else if(t(this,A).has(q))tt=t(this,A).get(q).visible;else return(0,e.warn)(`Optional content group not found: ${q}`),!0;switch($){case"And":if(!tt)return!1;break;case"Or":if(tt)return!0;break;case"Not":return!tt;default:return!0}}return $==="And"}},814:(r,m,u)=>{u.d(m,{cleanupTextLayer:()=>H,renderTextLayer:()=>rt,updateTextLayer:()=>J});var e=u(292),w=u(419);const f=1e5,T=30,W=.8,k=new Map;let _=null;function g(){if(!_){const M=document.createElement("canvas");M.className="hiddenCanvasElement",document.body.append(M),_=M.getContext("2d",{alpha:!1})}return _}function H(){_==null||_.canvas.remove(),_=null}function S(M){const j=k.get(M);if(j)return j;const $=g(),O=$.font;$.canvas.width=$.canvas.height=T,$.font=`${T}px ${M}`;const q=$.measureText("");let tt=q.fontBoundingBoxAscent,vt=Math.abs(q.fontBoundingBoxDescent);if(tt){const Ct=tt/(tt+vt);return k.set(M,Ct),$.canvas.width=$.canvas.height=0,$.font=O,Ct}$.strokeStyle="red",$.clearRect(0,0,T,T),$.strokeText("g",0,0);let Ft=$.getImageData(0,0,T,T).data;vt=0;for(let Ct=Ft.length-1-3;Ct>=0;Ct-=4)if(Ft[Ct]>0){vt=Math.ceil(Ct/4/T);break}$.clearRect(0,0,T,T),$.strokeText("A",0,T),Ft=$.getImageData(0,0,T,T).data,tt=0;for(let Ct=0,Ot=Ft.length;Ct<Ot;Ct+=4)if(Ft[Ct]>0){tt=T-Math.floor(Ct/4/T);break}if($.canvas.width=$.canvas.height=0,$.font=O,tt){const Ct=tt/(tt+vt);return k.set(M,Ct),Ct}return k.set(M,W),W}function A(M,j,$){const O=document.createElement("span"),q={angle:0,canvasWidth:0,hasText:j.str!=="",hasEOL:j.hasEOL,fontSize:0};M._textDivs.push(O);const tt=e.Util.transform(M._transform,j.transform);let vt=Math.atan2(tt[1],tt[0]);const Ft=$[j.fontName];Ft.vertical&&(vt+=Math.PI/2);const Ct=M._fontInspectorEnabled&&Ft.fontSubstitution||Ft.fontFamily,Ot=Math.hypot(tt[2],tt[3]),_t=Ot*S(Ct);let Lt,kt;vt===0?(Lt=tt[4],kt=tt[5]-_t):(Lt=tt[4]+_t*Math.sin(vt),kt=tt[5]-_t*Math.cos(vt));const Et="calc(var(--scale-factor)*",Z=O.style;M._container===M._rootContainer?(Z.left=`${(100*Lt/M._pageWidth).toFixed(2)}%`,Z.top=`${(100*kt/M._pageHeight).toFixed(2)}%`):(Z.left=`${Et}${Lt.toFixed(2)}px)`,Z.top=`${Et}${kt.toFixed(2)}px)`),Z.fontSize=`${Et}${Ot.toFixed(2)}px)`,Z.fontFamily=Ct,q.fontSize=Ot,O.setAttribute("role","presentation"),O.textContent=j.str,O.dir=j.dir,M._fontInspectorEnabled&&(O.dataset.fontName=Ft.fontSubstitutionLoadedName||j.fontName),vt!==0&&(q.angle=vt*(180/Math.PI));let gt=!1;if(j.str.length>1)gt=!0;else if(j.str!==" "&&j.transform[0]!==j.transform[3]){const Rt=Math.abs(j.transform[0]),Pt=Math.abs(j.transform[3]);Rt!==Pt&&Math.max(Rt,Pt)/Math.min(Rt,Pt)>1.5&&(gt=!0)}gt&&(q.canvasWidth=Ft.vertical?j.height:j.width),M._textDivProperties.set(O,q),M._isReadableStream&&M._layoutText(O)}function F(M){const{div:j,scale:$,properties:O,ctx:q,prevFontSize:tt,prevFontFamily:vt}=M,{style:Ft}=j;let Ct="";if(O.canvasWidth!==0&&O.hasText){const{fontFamily:Ot}=Ft,{canvasWidth:_t,fontSize:Lt}=O;(tt!==Lt||vt!==Ot)&&(q.font=`${Lt*$}px ${Ot}`,M.prevFontSize=Lt,M.prevFontFamily=Ot);const{width:kt}=q.measureText(j.textContent);kt>0&&(Ct=`scaleX(${_t*$/kt})`)}O.angle!==0&&(Ct=`rotate(${O.angle}deg) ${Ct}`),Ct.length>0&&(Ft.transform=Ct)}function N(M){if(M._canceled)return;const j=M._textDivs,$=M._capability;if(j.length>f){$.resolve();return}if(!M._isReadableStream)for(const O of j)M._layoutText(O);$.resolve()}class X{constructor({textContentSource:j,container:$,viewport:O,textDivs:q,textDivProperties:tt,textContentItemsStr:vt}){var Lt;this._textContentSource=j,this._isReadableStream=j instanceof ReadableStream,this._container=this._rootContainer=$,this._textDivs=q||[],this._textContentItemsStr=vt||[],this._fontInspectorEnabled=!!((Lt=globalThis.FontInspector)!=null&&Lt.enabled),this._reader=null,this._textDivProperties=tt||new WeakMap,this._canceled=!1,this._capability=Promise.withResolvers(),this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:O.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:g()};const{pageWidth:Ft,pageHeight:Ct,pageX:Ot,pageY:_t}=O.rawDims;this._transform=[1,0,0,-1,-Ot,_t+Ct],this._pageWidth=Ft,this._pageHeight=Ct,(0,w.setLayerDimensions)($,O),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new e.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new e.AbortException("TextLayer task cancelled."))}_processItems(j,$){for(const O of j){if(O.str===void 0){if(O.type==="beginMarkedContentProps"||O.type==="beginMarkedContent"){const q=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),O.id!==null&&this._container.setAttribute("id",`${O.id}`),q.append(this._container)}else O.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(O.str),A(this,O,$)}}_layoutText(j){const $=this._layoutTextParams.properties=this._textDivProperties.get(j);if(this._layoutTextParams.div=j,F(this._layoutTextParams),$.hasText&&this._container.append(j),$.hasEOL){const O=document.createElement("br");O.setAttribute("role","presentation"),this._container.append(O)}}_render(){const{promise:j,resolve:$,reject:O}=Promise.withResolvers();let q=Object.create(null);if(this._isReadableStream){const tt=()=>{this._reader.read().then(({value:vt,done:Ft})=>{if(Ft){$();return}Object.assign(q,vt.styles),this._processItems(vt.items,q),tt()},O)};this._reader=this._textContentSource.getReader(),tt()}else if(this._textContentSource){const{items:tt,styles:vt}=this._textContentSource;this._processItems(tt,vt),$()}else throw new Error('No "textContentSource" parameter specified.');j.then(()=>{q=null,N(this)},this._capability.reject)}}function rt(M){const j=new X(M);return j._render(),j}function J({container:M,viewport:j,textDivs:$,textDivProperties:O,mustRotate:q=!0,mustRescale:tt=!0}){if(q&&(0,w.setLayerDimensions)(M,{rotation:j.rotation}),tt){const vt=g(),Ft={prevFontSize:null,prevFontFamily:null,div:null,scale:j.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:vt};for(const Ct of $)Ft.properties=O.get(Ct),Ft.div=Ct,F(Ft)}}},585:(r,m,u)=>{u.d(m,{PDFDataTransportStream:()=>f});var e=u(292),w=u(419);class f{constructor(_,{disableRange:g=!1,disableStream:H=!1}){(0,e.assert)(_,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:S,initialData:A,progressiveDone:F,contentDispositionFilename:N}=_;if(this._queuedChunks=[],this._progressiveDone=F,this._contentDispositionFilename=N,(A==null?void 0:A.length)>0){const X=A instanceof Uint8Array&&A.byteLength===A.buffer.byteLength?A.buffer:new Uint8Array(A).buffer;this._queuedChunks.push(X)}this._pdfDataRangeTransport=_,this._isStreamingSupported=!H,this._isRangeSupported=!g,this._contentLength=S,this._fullRequestReader=null,this._rangeReaders=[],_.addRangeListener((X,rt)=>{this._onReceiveData({begin:X,chunk:rt})}),_.addProgressListener((X,rt)=>{this._onProgress({loaded:X,total:rt})}),_.addProgressiveReadListener(X=>{this._onReceiveData({chunk:X})}),_.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),_.transportReady()}_onReceiveData({begin:_,chunk:g}){const H=g instanceof Uint8Array&&g.byteLength===g.buffer.byteLength?g.buffer:new Uint8Array(g).buffer;if(_===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(H):this._queuedChunks.push(H);else{const S=this._rangeReaders.some(function(A){return A._begin!==_?!1:(A._enqueue(H),!0)});(0,e.assert)(S,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var _;return((_=this._fullRequestReader)==null?void 0:_._loaded)??0}_onProgress(_){var g,H,S,A;_.total===void 0?(H=(g=this._rangeReaders[0])==null?void 0:g.onProgress)==null||H.call(g,{loaded:_.loaded}):(A=(S=this._fullRequestReader)==null?void 0:S.onProgress)==null||A.call(S,{loaded:_.loaded,total:_.total})}_onProgressiveDone(){var _;(_=this._fullRequestReader)==null||_.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(_){const g=this._rangeReaders.indexOf(_);g>=0&&this._rangeReaders.splice(g,1)}getFullReader(){(0,e.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const _=this._queuedChunks;return this._queuedChunks=null,new T(this,_,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(_,g){if(g<=this._progressiveDataLength)return null;const H=new W(this,_,g);return this._pdfDataRangeTransport.requestDataRange(_,g),this._rangeReaders.push(H),H}cancelAllRequests(_){var g;(g=this._fullRequestReader)==null||g.cancel(_);for(const H of this._rangeReaders.slice(0))H.cancel(_);this._pdfDataRangeTransport.abort()}}class T{constructor(_,g,H=!1,S=null){this._stream=_,this._done=H||!1,this._filename=(0,w.isPdfFile)(S)?S:null,this._queuedChunks=g||[],this._loaded=0;for(const A of this._queuedChunks)this._loaded+=A.byteLength;this._requests=[],this._headersReady=Promise.resolve(),_._fullRequestReader=this,this.onProgress=null}_enqueue(_){this._done||(this._requests.length>0?this._requests.shift().resolve({value:_,done:!1}):this._queuedChunks.push(_),this._loaded+=_.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const _=Promise.withResolvers();return this._requests.push(_),_.promise}cancel(_){this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class W{constructor(_,g,H){this._stream=_,this._begin=g,this._end=H,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(_){if(!this._done){if(this._requests.length===0)this._queuedChunk=_;else{this._requests.shift().resolve({value:_,done:!1});for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const g=this._queuedChunk;return this._queuedChunk=null,{value:g,done:!1}}if(this._done)return{value:void 0,done:!0};const _=Promise.withResolvers();return this._requests.push(_),_.promise}cancel(_){this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},164:(r,m,u)=>{var w,f;u.d(m,{GlobalWorkerOptions:()=>e});class e{static get workerPort(){return t(this,w)}static set workerPort(W){if(!(typeof Worker<"u"&&W instanceof Worker)&&W!==null)throw new Error("Invalid `workerPort` type.");I(this,w,W)}static get workerSrc(){return t(this,f)}static set workerSrc(W){if(typeof W!="string")throw new Error("Invalid `workerSrc` type.");I(this,f,W)}}w=new WeakMap,f=new WeakMap,l(e,w,null),l(e,f,"")},284:(r,m,u)=>{u.d(m,{XfaLayer:()=>w});var e=u(50);class w{static setupStorage(T,W,k,_,g){const H=_.getValue(W,{value:null});switch(k.name){case"textarea":if(H.value!==null&&(T.textContent=H.value),g==="print")break;T.addEventListener("input",S=>{_.setValue(W,{value:S.target.value})});break;case"input":if(k.attributes.type==="radio"||k.attributes.type==="checkbox"){if(H.value===k.attributes.xfaOn?T.setAttribute("checked",!0):H.value===k.attributes.xfaOff&&T.removeAttribute("checked"),g==="print")break;T.addEventListener("change",S=>{_.setValue(W,{value:S.target.checked?S.target.getAttribute("xfaOn"):S.target.getAttribute("xfaOff")})})}else{if(H.value!==null&&T.setAttribute("value",H.value),g==="print")break;T.addEventListener("input",S=>{_.setValue(W,{value:S.target.value})})}break;case"select":if(H.value!==null){T.setAttribute("value",H.value);for(const S of k.children)S.attributes.value===H.value?S.attributes.selected=!0:S.attributes.hasOwnProperty("selected")&&delete S.attributes.selected}T.addEventListener("input",S=>{const A=S.target.options,F=A.selectedIndex===-1?"":A[A.selectedIndex].value;_.setValue(W,{value:F})});break}}static setAttributes({html:T,element:W,storage:k=null,intent:_,linkService:g}){const{attributes:H}=W,S=T instanceof HTMLAnchorElement;H.type==="radio"&&(H.name=`${H.name}-${_}`);for(const[A,F]of Object.entries(H))if(F!=null)switch(A){case"class":F.length&&T.setAttribute(A,F.join(" "));break;case"dataId":break;case"id":T.setAttribute("data-element-id",F);break;case"style":Object.assign(T.style,F);break;case"textContent":T.textContent=F;break;default:(!S||A!=="href"&&A!=="newWindow")&&T.setAttribute(A,F)}S&&g.addLinkAttributes(T,H.href,H.newWindow),k&&H.dataId&&this.setupStorage(T,H.dataId,W,k)}static render(T){var X,rt;const W=T.annotationStorage,k=T.linkService,_=T.xfaHtml,g=T.intent||"display",H=document.createElement(_.name);_.attributes&&this.setAttributes({html:H,element:_,intent:g,linkService:k});const S=g!=="richText",A=T.div;if(A.append(H),T.viewport){const J=`matrix(${T.viewport.transform.join(",")})`;A.style.transform=J}S&&A.setAttribute("class","xfaLayer xfaFont");const F=[];if(_.children.length===0){if(_.value){const J=document.createTextNode(_.value);H.append(J),S&&e.XfaText.shouldBuildText(_.name)&&F.push(J)}return{textDivs:F}}const N=[[_,-1,H]];for(;N.length>0;){const[J,M,j]=N.at(-1);if(M+1===J.children.length){N.pop();continue}const $=J.children[++N.at(-1)[1]];if($===null)continue;const{name:O}=$;if(O==="#text"){const tt=document.createTextNode($.value);F.push(tt),j.append(tt);continue}const q=(X=$==null?void 0:$.attributes)!=null&&X.xmlns?document.createElementNS($.attributes.xmlns,O):document.createElement(O);if(j.append(q),$.attributes&&this.setAttributes({html:q,element:$,storage:W,intent:g,linkService:k}),((rt=$.children)==null?void 0:rt.length)>0)N.push([$,-1,q]);else if($.value){const tt=document.createTextNode($.value);S&&e.XfaText.shouldBuildText(O)&&F.push(tt),q.append(tt)}}for(const J of A.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))J.setAttribute("readOnly",!0);return{textDivs:F}}static update(T){const W=`matrix(${T.viewport.transform.join(",")})`;T.div.style.transform=W,T.div.hidden=!1}}},50:(r,m,u)=>{u.d(m,{XfaText:()=>e});class e{static textContent(f){const T=[],W={items:T,styles:Object.create(null)};function k(_){var S;if(!_)return;let g=null;const H=_.name;if(H==="#text")g=_.value;else if(e.shouldBuildText(H))(S=_==null?void 0:_.attributes)!=null&&S.textContent?g=_.attributes.textContent:_.value&&(g=_.value);else return;if(g!==null&&T.push({str:g}),!!_.children)for(const A of _.children)k(A)}return k(f),W}static shouldBuildText(f){return!(f==="textarea"||f==="input"||f==="option"||f==="select")}}},228:(r,m,u)=>{u.a(r,async(e,w)=>{try{u.d(m,{AbortException:()=>f.AbortException,AnnotationEditorLayer:()=>_.AnnotationEditorLayer,AnnotationEditorParamsType:()=>f.AnnotationEditorParamsType,AnnotationEditorType:()=>f.AnnotationEditorType,AnnotationEditorUIManager:()=>g.AnnotationEditorUIManager,AnnotationLayer:()=>H.AnnotationLayer,AnnotationMode:()=>f.AnnotationMode,CMapCompressionType:()=>f.CMapCompressionType,ColorPicker:()=>S.ColorPicker,DOMSVGFactory:()=>W.DOMSVGFactory,DrawLayer:()=>A.DrawLayer,FeatureTest:()=>f.FeatureTest,GlobalWorkerOptions:()=>F.GlobalWorkerOptions,ImageKind:()=>f.ImageKind,InvalidPDFException:()=>f.InvalidPDFException,MissingPDFException:()=>f.MissingPDFException,OPS:()=>f.OPS,Outliner:()=>N.Outliner,PDFDataRangeTransport:()=>T.PDFDataRangeTransport,PDFDateString:()=>W.PDFDateString,PDFWorker:()=>T.PDFWorker,PasswordResponses:()=>f.PasswordResponses,PermissionFlag:()=>f.PermissionFlag,PixelsPerInch:()=>W.PixelsPerInch,RenderingCancelledException:()=>W.RenderingCancelledException,UnexpectedResponseException:()=>f.UnexpectedResponseException,Util:()=>f.Util,VerbosityLevel:()=>f.VerbosityLevel,XfaLayer:()=>X.XfaLayer,build:()=>T.build,createValidAbsoluteUrl:()=>f.createValidAbsoluteUrl,fetchData:()=>W.fetchData,getDocument:()=>T.getDocument,getFilenameFromUrl:()=>W.getFilenameFromUrl,getPdfFilenameFromUrl:()=>W.getPdfFilenameFromUrl,getXfaPageViewport:()=>W.getXfaPageViewport,isDataScheme:()=>W.isDataScheme,isPdfFile:()=>W.isPdfFile,noContextMenu:()=>W.noContextMenu,normalizeUnicode:()=>f.normalizeUnicode,renderTextLayer:()=>k.renderTextLayer,setLayerDimensions:()=>W.setLayerDimensions,shadow:()=>f.shadow,updateTextLayer:()=>k.updateTextLayer,version:()=>T.version});var f=u(292),T=u(831),W=u(419),k=u(814),_=u(731),g=u(830),H=u(976),S=u(259),A=u(47),F=u(164),N=u(61),X=u(284),rt=e([T]);T=(rt.then?(await rt)():rt)[0];const J="4.1.392",M="fcb76a78d";w()}catch(J){w(J)}})},178:(r,m,u)=>{var k,to,g,eo,S,mn;u.d(m,{MessageHandler:()=>W});var e=u(292);const w={UNKNOWN:0,DATA:1,ERROR:2},f={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function T(F){switch(F instanceof Error||typeof F=="object"&&F!==null||(0,e.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),F.name){case"AbortException":return new e.AbortException(F.message);case"MissingPDFException":return new e.MissingPDFException(F.message);case"PasswordException":return new e.PasswordException(F.message,F.code);case"UnexpectedResponseException":return new e.UnexpectedResponseException(F.message,F.status);case"UnknownErrorException":return new e.UnknownErrorException(F.message,F.details);default:return new e.UnknownErrorException(F.message,F.toString())}}class W{constructor(N,X,rt){l(this,k);l(this,g);l(this,S);this.sourceName=N,this.targetName=X,this.comObj=rt,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=J=>{const M=J.data;if(M.targetName!==this.sourceName)return;if(M.stream){C(this,g,eo).call(this,M);return}if(M.callback){const $=M.callbackId,O=this.callbackCapabilities[$];if(!O)throw new Error(`Cannot resolve callback ${$}`);if(delete this.callbackCapabilities[$],M.callback===w.DATA)O.resolve(M.data);else if(M.callback===w.ERROR)O.reject(T(M.reason));else throw new Error("Unexpected callback case");return}const j=this.actionHandler[M.action];if(!j)throw new Error(`Unknown action from worker: ${M.action}`);if(M.callbackId){const $=this.sourceName,O=M.sourceName;new Promise(function(q){q(j(M.data))}).then(function(q){rt.postMessage({sourceName:$,targetName:O,callback:w.DATA,callbackId:M.callbackId,data:q})},function(q){rt.postMessage({sourceName:$,targetName:O,callback:w.ERROR,callbackId:M.callbackId,reason:T(q)})});return}if(M.streamId){C(this,k,to).call(this,M);return}j(M.data)},rt.addEventListener("message",this._onComObjOnMessage)}on(N,X){const rt=this.actionHandler;if(rt[N])throw new Error(`There is already an actionName called "${N}"`);rt[N]=X}send(N,X,rt){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:N,data:X},rt)}sendWithPromise(N,X,rt){const J=this.callbackId++,M=Promise.withResolvers();this.callbackCapabilities[J]=M;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:N,callbackId:J,data:X},rt)}catch(j){M.reject(j)}return M.promise}sendWithStream(N,X,rt,J){const M=this.streamId++,j=this.sourceName,$=this.targetName,O=this.comObj;return new ReadableStream({start:q=>{const tt=Promise.withResolvers();return this.streamControllers[M]={controller:q,startCall:tt,pullCall:null,cancelCall:null,isClosed:!1},O.postMessage({sourceName:j,targetName:$,action:N,streamId:M,data:X,desiredSize:q.desiredSize},J),tt.promise},pull:q=>{const tt=Promise.withResolvers();return this.streamControllers[M].pullCall=tt,O.postMessage({sourceName:j,targetName:$,stream:f.PULL,streamId:M,desiredSize:q.desiredSize}),tt.promise},cancel:q=>{(0,e.assert)(q instanceof Error,"cancel must have a valid reason");const tt=Promise.withResolvers();return this.streamControllers[M].cancelCall=tt,this.streamControllers[M].isClosed=!0,O.postMessage({sourceName:j,targetName:$,stream:f.CANCEL,streamId:M,reason:T(q)}),tt.promise}},rt)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}k=new WeakSet,to=function(N){const X=N.streamId,rt=this.sourceName,J=N.sourceName,M=this.comObj,j=this,$=this.actionHandler[N.action],O={enqueue(q,tt=1,vt){if(this.isCancelled)return;const Ft=this.desiredSize;this.desiredSize-=tt,Ft>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),M.postMessage({sourceName:rt,targetName:J,stream:f.ENQUEUE,streamId:X,chunk:q},vt)},close(){this.isCancelled||(this.isCancelled=!0,M.postMessage({sourceName:rt,targetName:J,stream:f.CLOSE,streamId:X}),delete j.streamSinks[X])},error(q){(0,e.assert)(q instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,M.postMessage({sourceName:rt,targetName:J,stream:f.ERROR,streamId:X,reason:T(q)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:N.desiredSize,ready:null};O.sinkCapability.resolve(),O.ready=O.sinkCapability.promise,this.streamSinks[X]=O,new Promise(function(q){q($(N.data,O))}).then(function(){M.postMessage({sourceName:rt,targetName:J,stream:f.START_COMPLETE,streamId:X,success:!0})},function(q){M.postMessage({sourceName:rt,targetName:J,stream:f.START_COMPLETE,streamId:X,reason:T(q)})})},g=new WeakSet,eo=function(N){const X=N.streamId,rt=this.sourceName,J=N.sourceName,M=this.comObj,j=this.streamControllers[X],$=this.streamSinks[X];switch(N.stream){case f.START_COMPLETE:N.success?j.startCall.resolve():j.startCall.reject(T(N.reason));break;case f.PULL_COMPLETE:N.success?j.pullCall.resolve():j.pullCall.reject(T(N.reason));break;case f.PULL:if(!$){M.postMessage({sourceName:rt,targetName:J,stream:f.PULL_COMPLETE,streamId:X,success:!0});break}$.desiredSize<=0&&N.desiredSize>0&&$.sinkCapability.resolve(),$.desiredSize=N.desiredSize,new Promise(function(O){var q;O((q=$.onPull)==null?void 0:q.call($))}).then(function(){M.postMessage({sourceName:rt,targetName:J,stream:f.PULL_COMPLETE,streamId:X,success:!0})},function(O){M.postMessage({sourceName:rt,targetName:J,stream:f.PULL_COMPLETE,streamId:X,reason:T(O)})});break;case f.ENQUEUE:if((0,e.assert)(j,"enqueue should have stream controller"),j.isClosed)break;j.controller.enqueue(N.chunk);break;case f.CLOSE:if((0,e.assert)(j,"close should have stream controller"),j.isClosed)break;j.isClosed=!0,j.controller.close(),C(this,S,mn).call(this,j,X);break;case f.ERROR:(0,e.assert)(j,"error should have stream controller"),j.controller.error(T(N.reason)),C(this,S,mn).call(this,j,X);break;case f.CANCEL_COMPLETE:N.success?j.cancelCall.resolve():j.cancelCall.reject(T(N.reason)),C(this,S,mn).call(this,j,X);break;case f.CANCEL:if(!$)break;new Promise(function(O){var q;O((q=$.onCancel)==null?void 0:q.call($,T(N.reason)))}).then(function(){M.postMessage({sourceName:rt,targetName:J,stream:f.CANCEL_COMPLETE,streamId:X,success:!0})},function(O){M.postMessage({sourceName:rt,targetName:J,stream:f.CANCEL_COMPLETE,streamId:X,reason:T(O)})}),$.sinkCapability.reject(T(N.reason)),$.isCancelled=!0,delete this.streamSinks[X];break;default:throw new Error("Unexpected stream case")}},S=new WeakSet,mn=async function(N,X){var rt,J,M;await Promise.allSettled([(rt=N.startCall)==null?void 0:rt.promise,(J=N.pullCall)==null?void 0:J.promise,(M=N.cancelCall)==null?void 0:M.promise]),delete this.streamControllers[X]}},651:(r,m,u)=>{u.d(m,{MurmurHash3_64:()=>T});const e=3285377520,w=4294901760,f=65535;class T{constructor(k){this.h1=k?k&4294967295:e,this.h2=k?k&4294967295:e}update(k){let _,g;if(typeof k=="string"){_=new Uint8Array(k.length*2),g=0;for(let O=0,q=k.length;O<q;O++){const tt=k.charCodeAt(O);tt<=255?_[g++]=tt:(_[g++]=tt>>>8,_[g++]=tt&255)}}else if(ArrayBuffer.isView(k))_=k.slice(),g=_.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const H=g>>2,S=g-H*4,A=new Uint32Array(_.buffer,0,H);let F=0,N=0,X=this.h1,rt=this.h2;const J=3432918353,M=461845907,j=J&f,$=M&f;for(let O=0;O<H;O++)O&1?(F=A[O],F=F*J&w|F*j&f,F=F<<15|F>>>17,F=F*M&w|F*$&f,X^=F,X=X<<13|X>>>19,X=X*5+3864292196):(N=A[O],N=N*J&w|N*j&f,N=N<<15|N>>>17,N=N*M&w|N*$&f,rt^=N,rt=rt<<13|rt>>>19,rt=rt*5+3864292196);switch(F=0,S){case 3:F^=_[H*4+2]<<16;case 2:F^=_[H*4+1]<<8;case 1:F^=_[H*4],F=F*J&w|F*j&f,F=F<<15|F>>>17,F=F*M&w|F*$&f,H&1?X^=F:rt^=F}this.h1=X,this.h2=rt}hexdigest(){let k=this.h1,_=this.h2;return k^=_>>>1,k=k*3981806797&w|k*36045&f,_=_*4283543511&w|((_<<16|k>>>16)*2950163797&w)>>>16,k^=_>>>1,k=k*444984403&w|k*60499&f,_=_*3301882366&w|((_<<16|k>>>16)*3120437893&w)>>>16,k^=_>>>1,(k>>>0).toString(16).padStart(8,"0")+(_>>>0).toString(16).padStart(8,"0")}}},292:(r,m,u)=>{var o,fn,b,_r;u.d(m,{AbortException:()=>ie,AnnotationBorderStyleType:()=>rt,AnnotationEditorParamsType:()=>S,AnnotationEditorPrefix:()=>g,AnnotationEditorType:()=>H,AnnotationMode:()=>_,AnnotationPrefix:()=>p,AnnotationType:()=>X,BaseException:()=>Et,CMapCompressionType:()=>M,FONT_IDENTITY_MATRIX:()=>f,FeatureTest:()=>Ce,FormatError:()=>Kt,IDENTITY_MATRIX:()=>w,ImageKind:()=>N,InvalidPDFException:()=>Rt,LINE_FACTOR:()=>W,MAX_IMAGE_SIZE_TO_CACHE:()=>T,MissingPDFException:()=>Pt,OPS:()=>j,PasswordException:()=>Z,PasswordResponses:()=>$,PermissionFlag:()=>A,RenderingIntentFlag:()=>k,TextRenderingMode:()=>F,UnexpectedResponseException:()=>qt,UnknownErrorException:()=>gt,Util:()=>Ee,VerbosityLevel:()=>J,assert:()=>Ot,bytesToString:()=>Se,createValidAbsoluteUrl:()=>Lt,getUuid:()=>c,getVerbosityLevel:()=>tt,info:()=>vt,isNodeJS:()=>e,normalizeUnicode:()=>n,objectFromMap:()=>ve,setVerbosityLevel:()=>q,shadow:()=>kt,string32:()=>le,stringToBytes:()=>de,unreachable:()=>Ct,warn:()=>Ft});const e=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),w=[1,0,0,1,0,0],f=[.001,0,0,.001,0,0],T=1e7,W=1.35,k={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},_={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},g="pdfjs_internal_editor_",H={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},S={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},A={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},F={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},N={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},X={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},rt={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},J={ERRORS:0,WARNINGS:1,INFOS:5},M={NONE:0,BINARY:1},j={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},$={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let O=J.WARNINGS;function q(d){Number.isInteger(d)&&(O=d)}function tt(){return O}function vt(d){O>=J.INFOS&&console.log(`Info: ${d}`)}function Ft(d){O>=J.WARNINGS&&console.log(`Warning: ${d}`)}function Ct(d){throw new Error(d)}function Ot(d,a){d||Ct(a)}function _t(d){switch(d==null?void 0:d.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Lt(d,a=null,h=null){var R;if(!d)return null;try{if(h&&typeof d=="string"&&(h.addDefaultProtocol&&d.startsWith("www.")&&((R=d.match(/\./g))==null?void 0:R.length)>=2&&(d=`http://${d}`),h.tryConvertEncoding))try{d=ne(d)}catch{}const V=a?new URL(d,a):new URL(d);if(_t(V))return V}catch{}return null}function kt(d,a,h,R=!1){return Object.defineProperty(d,a,{value:h,enumerable:!R,configurable:!0,writable:!1}),h}const Et=function(){function d(a,h){this.constructor===d&&Ct("Cannot initialize BaseException."),this.message=a,this.name=h}return d.prototype=new Error,d.constructor=d,d}();class Z extends Et{constructor(a,h){super(a,"PasswordException"),this.code=h}}class gt extends Et{constructor(a,h){super(a,"UnknownErrorException"),this.details=h}}class Rt extends Et{constructor(a){super(a,"InvalidPDFException")}}class Pt extends Et{constructor(a){super(a,"MissingPDFException")}}class qt extends Et{constructor(a,h){super(a,"UnexpectedResponseException"),this.status=h}}class Kt extends Et{constructor(a){super(a,"FormatError")}}class ie extends Et{constructor(a){super(a,"AbortException")}}function Se(d){(typeof d!="object"||(d==null?void 0:d.length)===void 0)&&Ct("Invalid argument for bytesToString");const a=d.length,h=8192;if(a<h)return String.fromCharCode.apply(null,d);const R=[];for(let V=0;V<a;V+=h){const G=Math.min(V+h,a),at=d.subarray(V,G);R.push(String.fromCharCode.apply(null,at))}return R.join("")}function de(d){typeof d!="string"&&Ct("Invalid argument for stringToBytes");const a=d.length,h=new Uint8Array(a);for(let R=0;R<a;++R)h[R]=d.charCodeAt(R)&255;return h}function le(d){return String.fromCharCode(d>>24&255,d>>16&255,d>>8&255,d&255)}function ve(d){const a=Object.create(null);for(const[h,R]of d)a[h]=R;return a}function jt(){const d=new Uint8Array(4);return d[0]=1,new Uint32Array(d.buffer,0,1)[0]===1}function ae(){try{return new Function(""),!0}catch{return!1}}class Ce{static get isLittleEndian(){return kt(this,"isLittleEndian",jt())}static get isEvalSupported(){return kt(this,"isEvalSupported",ae())}static get isOffscreenCanvasSupported(){return kt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?kt(this,"platform",{isMac:navigator.platform.includes("Mac")}):kt(this,"platform",{isMac:!1})}static get isCSSRoundSupported(){var a,h;return kt(this,"isCSSRoundSupported",(h=(a=globalThis.CSS)==null?void 0:a.supports)==null?void 0:h.call(a,"width: round(1.5px, 1px)"))}}const ee=Array.from(Array(256).keys(),d=>d.toString(16).padStart(2,"0"));class Ee{static makeHexColor(a,h,R){return`#${ee[a]}${ee[h]}${ee[R]}`}static scaleMinMax(a,h){let R;a[0]?(a[0]<0&&(R=h[0],h[0]=h[2],h[2]=R),h[0]*=a[0],h[2]*=a[0],a[3]<0&&(R=h[1],h[1]=h[3],h[3]=R),h[1]*=a[3],h[3]*=a[3]):(R=h[0],h[0]=h[1],h[1]=R,R=h[2],h[2]=h[3],h[3]=R,a[1]<0&&(R=h[1],h[1]=h[3],h[3]=R),h[1]*=a[1],h[3]*=a[1],a[2]<0&&(R=h[0],h[0]=h[2],h[2]=R),h[0]*=a[2],h[2]*=a[2]),h[0]+=a[4],h[1]+=a[5],h[2]+=a[4],h[3]+=a[5]}static transform(a,h){return[a[0]*h[0]+a[2]*h[1],a[1]*h[0]+a[3]*h[1],a[0]*h[2]+a[2]*h[3],a[1]*h[2]+a[3]*h[3],a[0]*h[4]+a[2]*h[5]+a[4],a[1]*h[4]+a[3]*h[5]+a[5]]}static applyTransform(a,h){const R=a[0]*h[0]+a[1]*h[2]+h[4],V=a[0]*h[1]+a[1]*h[3]+h[5];return[R,V]}static applyInverseTransform(a,h){const R=h[0]*h[3]-h[1]*h[2],V=(a[0]*h[3]-a[1]*h[2]+h[2]*h[5]-h[4]*h[3])/R,G=(-a[0]*h[1]+a[1]*h[0]+h[4]*h[1]-h[5]*h[0])/R;return[V,G]}static getAxialAlignedBoundingBox(a,h){const R=this.applyTransform(a,h),V=this.applyTransform(a.slice(2,4),h),G=this.applyTransform([a[0],a[3]],h),at=this.applyTransform([a[2],a[1]],h);return[Math.min(R[0],V[0],G[0],at[0]),Math.min(R[1],V[1],G[1],at[1]),Math.max(R[0],V[0],G[0],at[0]),Math.max(R[1],V[1],G[1],at[1])]}static inverseTransform(a){const h=a[0]*a[3]-a[1]*a[2];return[a[3]/h,-a[1]/h,-a[2]/h,a[0]/h,(a[2]*a[5]-a[4]*a[3])/h,(a[4]*a[1]-a[5]*a[0])/h]}static singularValueDecompose2dScale(a){const h=[a[0],a[2],a[1],a[3]],R=a[0]*h[0]+a[1]*h[2],V=a[0]*h[1]+a[1]*h[3],G=a[2]*h[0]+a[3]*h[2],at=a[2]*h[1]+a[3]*h[3],ot=(R+at)/2,yt=Math.sqrt((R+at)**2-4*(R*at-G*V))/2,At=ot+yt||1,ut=ot-yt||1;return[Math.sqrt(At),Math.sqrt(ut)]}static normalizeRect(a){const h=a.slice(0);return a[0]>a[2]&&(h[0]=a[2],h[2]=a[0]),a[1]>a[3]&&(h[1]=a[3],h[3]=a[1]),h}static intersect(a,h){const R=Math.max(Math.min(a[0],a[2]),Math.min(h[0],h[2])),V=Math.min(Math.max(a[0],a[2]),Math.max(h[0],h[2]));if(R>V)return null;const G=Math.max(Math.min(a[1],a[3]),Math.min(h[1],h[3])),at=Math.min(Math.max(a[1],a[3]),Math.max(h[1],h[3]));return G>at?null:[R,G,V,at]}static bezierBoundingBox(a,h,R,V,G,at,ot,yt,At){return At?(At[0]=Math.min(At[0],a,ot),At[1]=Math.min(At[1],h,yt),At[2]=Math.max(At[2],a,ot),At[3]=Math.max(At[3],h,yt)):At=[Math.min(a,ot),Math.min(h,yt),Math.max(a,ot),Math.max(h,yt)],C(this,b,_r).call(this,a,R,G,ot,h,V,at,yt,3*(-a+3*(R-G)+ot),6*(a-2*R+G),3*(R-a),At),C(this,b,_r).call(this,a,R,G,ot,h,V,at,yt,3*(-h+3*(V-at)+yt),6*(h-2*V+at),3*(V-h),At),At}}o=new WeakSet,fn=function(a,h,R,V,G,at,ot,yt,At,ut){if(At<=0||At>=1)return;const xt=1-At,P=At*At,Y=P*At,nt=xt*(xt*(xt*a+3*At*h)+3*P*R)+Y*V,U=xt*(xt*(xt*G+3*At*at)+3*P*ot)+Y*yt;ut[0]=Math.min(ut[0],nt),ut[1]=Math.min(ut[1],U),ut[2]=Math.max(ut[2],nt),ut[3]=Math.max(ut[3],U)},b=new WeakSet,_r=function(a,h,R,V,G,at,ot,yt,At,ut,xt,P){if(Math.abs(At)<1e-12){Math.abs(ut)>=1e-12&&C(this,o,fn).call(this,a,h,R,V,G,at,ot,yt,-xt/ut,P);return}const Y=ut**2-4*xt*At;if(Y<0)return;const nt=Math.sqrt(Y),U=2*At;C(this,o,fn).call(this,a,h,R,V,G,at,ot,yt,(-ut+nt)/U,P),C(this,o,fn).call(this,a,h,R,V,G,at,ot,yt,(-ut-nt)/U,P)},l(Ee,o),l(Ee,b);function ne(d){return decodeURIComponent(escape(d))}let et=null,i=null;function n(d){return et||(et=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,i=new Map([["\uFB05","\u017Ft"]])),d.replaceAll(et,(a,h,R)=>h?h.normalize("NFKC"):i.get(R))}function c(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const d=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(d);else for(let a=0;a<32;a++)d[a]=Math.floor(Math.random()*255);return Se(d)}const p="pdfjs_internal_id_"}},Hr={};function Cs(r){var m=Hr[r];if(m!==void 0)return m.exports;var u=Hr[r]={exports:{}};return Xo[r](u,u.exports,Cs),u.exports}(()=>{var r=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",m=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",u=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",e=f=>{f&&f.d<1&&(f.d=1,f.forEach(T=>T.r--),f.forEach(T=>T.r--?T.r++:T()))},w=f=>f.map(T=>{if(T!==null&&typeof T=="object"){if(T[r])return T;if(T.then){var W=[];W.d=0,T.then(g=>{k[m]=g,e(W)},g=>{k[u]=g,e(W)});var k={};return k[r]=g=>g(W),k}}var _={};return _[r]=g=>{},_[m]=T,_});Cs.a=(f,T,W)=>{var k;W&&((k=[]).d=-1);var _=new Set,g=f.exports,H,S,A,F=new Promise((N,X)=>{A=X,S=N});F[m]=g,F[r]=N=>(k&&N(k),_.forEach(N),F.catch(X=>{})),f.exports=F,T(N=>{H=w(N);var X,rt=()=>H.map(M=>{if(M[u])throw M[u];return M[m]}),J=new Promise(M=>{X=()=>M(rt),X.r=0;var j=$=>$!==k&&!_.has($)&&(_.add($),$&&!$.d&&(X.r++,$.push(X)));H.map($=>$[r](j))});return X.r?J:rt()},N=>(N?A(F[u]=N):S(g),e(k))),k&&k.d<0&&(k.d=0)}})(),Cs.d=(r,m)=>{for(var u in m)Cs.o(m,u)&&!Cs.o(r,u)&&Object.defineProperty(r,u,{enumerable:!0,get:m[u]})},Cs.o=(r,m)=>Object.prototype.hasOwnProperty.call(r,m);var ge=Cs(228);ge=globalThis.pdfjsLib=await(globalThis.pdfjsLibPromise=ge),ge.AbortException,ge.AnnotationEditorLayer,ge.AnnotationEditorParamsType,ge.AnnotationEditorType,ge.AnnotationEditorUIManager,ge.AnnotationLayer,ge.AnnotationMode,ge.CMapCompressionType,ge.ColorPicker,ge.DOMSVGFactory,ge.DrawLayer,ge.FeatureTest;var Ko=ge.GlobalWorkerOptions;ge.ImageKind,ge.InvalidPDFException,ge.MissingPDFException,ge.OPS,ge.Outliner,ge.PDFDataRangeTransport,ge.PDFDateString,ge.PDFWorker,ge.PasswordResponses,ge.PermissionFlag,ge.PixelsPerInch,ge.RenderingCancelledException,ge.UnexpectedResponseException,ge.Util,ge.VerbosityLevel,ge.XfaLayer,ge.build,ge.createValidAbsoluteUrl,ge.fetchData;var Yo=ge.getDocument;ge.getFilenameFromUrl,ge.getPdfFilenameFromUrl,ge.getXfaPageViewport,ge.isDataScheme,ge.isPdfFile,ge.noContextMenu,ge.normalizeUnicode,ge.renderTextLayer,ge.setLayerDimensions,ge.shadow,ge.updateTextLayer,ge.version;const Jo="https://cdn.jsdelivr.net/gh/DaimlarTech/blitz-ui-cdn/cdn/cmaps/",Qo="https://cdn.jsdelivr.net/gh/DaimlarTech/blitz-ui-cdn/cdn/pdf.worker.mjs";class Br{constructor(m,u=2,e=(w,f)=>{}){if(!m||!m.dataset.url)throw new Error("PdfConvert: failed to instanciate");this.element=m,this.url=m.dataset.url,this.scale=u,this.data=[],this.callback=e}async init(){fetch(this.url,{headers:{"Content-Type":"application/pdf"}}).then(m=>m.blob()).then(m=>{var u=new Blob([m],{type:"application/pdf"});return $r(u)}).then(m=>this.convertFiles(m)).catch(m=>{this.loading=!1,this.error=m})}async blobInit(){var m=Ur(this.url,"application/pdf");$r(m).then(u=>this.convertFiles(u)).catch(u=>{this.loading=!1,this.error=u})}convertFiles(m){Ko.workerSrc=Qo,Yo({data:atob(m),cMapUrl:Jo,cMapPacked:!0}).promise.then(async u=>{for(let e=1;e<=u.numPages;e++)await this.pdf2png(e,u)},u=>{console.error(u)}).then(async()=>{await this.callback(this.data,this.element)})}async pdf2png(m,u){const e=this.scale,w=this.data;return new Promise(f=>{u.getPage(m).then(function(T){var W=T.getViewport({scale:e});let k=200/72;var _=document.createElement("canvas"),g=_.getContext("2d");_.height=W.height*k,_.width=W.width*k;var H={canvasContext:g,viewport:W,transform:[k,0,0,k,0,0]},S=T.render(H);S.promise.then(async()=>{w.push(_.toDataURL("image/png")),f()})})})}}function Zo(r,m){var u="application/"+m;if(m=="pdf")var e=Ur(r,u);else return;var w=(window.URL||window.webkitURL).createObjectURL(e);return w}function Ur(r,m){const u=atob(r),e=new Uint8Array(u.length);for(let w=0;w<u.length;w++)e[w]=u.charCodeAt(w);return new Blob([e.buffer],{type:m})}function $r(r){return new Promise(m=>{const u=new FileReader;u.readAsDataURL(r),u.onload=()=>{m(u.result.replace("data:application/pdf;base64,",""))}})}document.querySelectorAll('[data-role="file-display"]').forEach(r=>{const m=r.dataset.fileData,u="data:image/"+r.dataset.extension+";base64,"+m;r.src=u}),document.querySelectorAll('[data-role="additionalFiles"]').forEach(r=>{const m=r.dataset.fileData,u=r.dataset.extension,e=Zo(m,u);r.removeAttribute("data-file-data"),r.removeAttribute("data-extension"),r.download=r.dataset.download??`test.${u}`,r.setAttribute("target","_blank"),r.href=e}),document.querySelectorAll('[data-role="pdf-preview-dl"]').forEach(r=>{const m=async(e,w)=>{const f=document.createElement("div");f.classList.add("pdf-preview__container");for(const T of e)await new Promise(W=>{const k=document.createElement("img");k.classList.add("pdf__img"),k.onload=()=>{f.appendChild(k),w.innerHTML=null,w.appendChild(f),W()},k.src=T})},u=new Br(r,2,m);r.dataset.value==="blob"?u.blobInit():u.init()}),document.querySelectorAll('[data-role="download-document-dialog"]').forEach(r=>{const m=document.querySelector(r.dataset.target),u=m.querySelector('[data-role="dialog-dismiss"]'),e=r.querySelector(".download-document__value"),w=r.querySelector('input[type="hidden"]'),f=r.querySelector("a"),T=m.querySelector(".scroll-check>button"),W=m.querySelector('input[type="checkbox"]'),k=m.querySelector(".dialog__body"),_=m.querySelector(".pdf-preview");W&&T&&(W.addEventListener("change",A=>{T.disabled=!A.target.checked}),T.addEventListener("click",A=>{f.click(),u.click();const F=new Date().toISOString();w.value=F,w.dispatchEvent(new Event("change")),e.textContent=`\u627F\u8AFE\u6E08\u307F ${F.slice(0,10)}`}));const g=()=>{g.read||!W||(g.read=Math.abs(k.scrollHeight-k.clientHeight-k.scrollTop)<3,g.read&&W&&(W.disabled=!1))},H=async(A,F)=>{const N=document.createElement("div");N.classList.add("pdf-preview__container");let X=0;for(const rt of A)await new Promise(J=>{const M=document.createElement("img");M.classList.add("pdf__img"),M.onload=()=>{if(N.appendChild(M),X===A.length-1){if(W){let j=new MutationObserver(function($){F.contains(M)&&(g(),window.addEventListener("resize",g),k.addEventListener("scroll",g),j.disconnect())});j.observe(F,{attributes:!1,childList:!0,characterData:!1,subtree:!0})}F.innerHTML=null,F.appendChild(N)}J()},M.src=rt}),X+=1},S=new Br(_,2,H);r.dataset.value==="blob"?S.blobInit():S.init()}),document.querySelectorAll('[data-role="open-blank"]').forEach(r=>{fetch(r.dataset.url,{headers:{"Content-Type":"application/pdf"}}).then(m=>m.blob()).then(m=>{var u=new Blob([m],{type:"application/pdf"});r.href=(window.URL||window.webkitURL).createObjectURL(u)})}),document.querySelectorAll('tbody>tr[data-role="tr-link"]').forEach(r=>r.addEventListener("click",()=>{location.href=r.dataset.url}))})();
