var Qo=Object.defineProperty;var Zo=(Re,Ie,Ne)=>Ie in Re?Qo(Re,Ie,{enumerable:!0,configurable:!0,writable:!0,value:Ne}):Re[Ie]=Ne;var me=(Re,Ie,Ne)=>(Zo(Re,typeof Ie!="symbol"?Ie+"":Ie,Ne),Ne),xn=(Re,Ie,Ne)=>{if(!Ie.has(Re))throw TypeError("Cannot "+Ne)};var t=(Re,Ie,Ne)=>(xn(Re,Ie,"read from private field"),Ne?Ne.call(Re):Ie.get(Re)),l=(Re,Ie,Ne)=>{if(Ie.has(Re))throw TypeError("Cannot add the same private member more than once");Ie instanceof WeakSet?Ie.add(Re):Ie.set(Re,Ne)},P=(Re,Ie,Ne,Cs)=>(xn(Re,Ie,"write to private field"),Cs?Cs.call(Re,Ne):Ie.set(Re,Ne),Ne);var vs=(Re,Ie,Ne,Cs)=>({set _(fn){P(Re,Ie,fn,Ne)},get _(){return t(Re,Ie,Cs)}}),S=(Re,Ie,Ne)=>(xn(Re,Ie,"access private method"),Ne);(async()=>{(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))d(e);new MutationObserver(e=>{for(const w of e)if(w.type==="childList")for(const v of w.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&d(v)}).observe(document,{childList:!0,subtree:!0});function b(e){const w={};return e.integrity&&(w.integrity=e.integrity),e.referrerPolicy&&(w.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?w.credentials="include":e.crossOrigin==="anonymous"?w.credentials="omit":w.credentials="same-origin",w}function d(e){if(e.ep)return;e.ep=!0;const w=b(e);fetch(e.href,w)}})();const Re=document.querySelectorAll(".drawer"),Ie=document.querySelectorAll(".drawer__dialog"),Ne=document.querySelectorAll('[data-role="drawer"]');Ne.forEach(o=>o.addEventListener("click",Cs)),Re.forEach(o=>o.addEventListener("click",Cs)),Ie.forEach(o=>o.addEventListener("click",b=>{b.stopPropagation()}));function Cs(){Re.forEach(o=>o.classList.toggle("drawer_show")),Ne.forEach(o=>o.classList.toggle("toggler_show"))}const fn=document.querySelectorAll('[data-role="drop-down"]'),eo=document.querySelectorAll(".drop-down");fn.forEach(o=>o.addEventListener("click",so));function so(){const o=document.querySelector(this.dataset.target);eo.forEach(b=>{b.id!==o.id&&b.classList.remove("drop-down_open")}),o.classList.toggle("drop-down_open")}const io=document.getElementById("js-modal-area"),no=document.querySelectorAll(".MODAL"),ro=document.querySelectorAll('[data-role="modal"]'),ao=document.querySelectorAll(".MODAL__dialog");no.forEach(o=>{lo(),document.getElementById("js-modal-area").appendChild(o)}),ro.forEach(o=>{o.addEventListener("click",oo)}),ao.forEach(o=>o.addEventListener("click",ho));function oo(){document.querySelector(this.dataset.target).classList.toggle("MODAL_open")}function ho(o){o.stopPropagation()}function lo(){if(!io){const o=document.createElement("div");o.setAttribute("id","js-modal-area"),o.style.zIndex="100",o.style.position="relative",document.body.appendChild(o)}}function co(){const o=document.querySelector('[data-role="modal-open"]');o&&o.dataset.errors!="{}"&&document.querySelector(o.dataset.target).classList.add("MODAL_open")}window.onload=co,document.addEventListener("DOMContentLoaded",function(){const o=document.getElementById("agreement-box"),b=document.getElementById("agreement-check"),d=document.getElementById("agree_chk_id");if(d&&o){let e=function(v,R){let K;return function(...k){const y=()=>{clearTimeout(K),v(...k)};clearTimeout(K),K=setTimeout(y,R)}},w=function(){Math.abs(o.scrollHeight-o.clientHeight-o.scrollTop)<=1&&d.disabled&&(d.disabled=!1,b.classList.remove("check-disabled"),b.classList.add("check-enabled"),d.classList.add("check-enabled"))};d.disabled=!0,o.addEventListener("scroll",e(w,100)),window.addEventListener("load",w)}}),document.addEventListener("DOMContentLoaded",function(){const o="noantisocial",b="edelivery",d=document.getElementById("confirmButton");if(d){let e=function(){const v=document.getElementById(o).checked,R=document.getElementById(b).checked;d.disabled=!(v&&R)},w=function(v,R,K,k,y,g,G){const I=document.getElementById(v),E=document.getElementById(R),H=document.getElementById(K),$=document.getElementById(k),Y=document.getElementById(y),at=document.getElementById(g),Q=document.getElementById(G);$.disabled=!0,Y.disabled=!0;function M(){let U=!(E.clientHeight<H.scrollHeight)||E.scrollHeight-E.scrollTop<=E.clientHeight+1;$.disabled=!U}I.addEventListener("shown.bs.modal",function(){M(),E.addEventListener("scroll",M)}),$.addEventListener("click",function(){this.disabled||(at.style.display="none",Y.disabled=!1,Q.classList.remove("check-disabled"),Q.classList.add("check-enabled"),Y.classList.remove("check-disabled"),Y.classList.add("check-enabled"))}),Y.addEventListener("change",e)};d.disabled=!0,w("noantisocialModal","noantisocialBox","noantisocialItem","noantisocialButton",o,"noantisocialText","noantisocialLabel"),w("edeliveryModal","edeliveryBox","edeliveryItem","edeliveryButton",b,"edeliveryText","edeliveryLabel"),e()}}),document.querySelectorAll(".password__toggler").forEach(o=>o.addEventListener("click",uo));function uo(){const o=document.querySelector(this.dataset.target);o.type=o.type==="password"?"text":"password"}const po=document.querySelectorAll(".format_num"),go=document.querySelectorAll(".format_date"),fo=document.querySelectorAll(".format_datetime"),mo=document.querySelectorAll(".format_datetime_second"),Qe="--";po.forEach(o=>{if(o.textContent){let b;o.classList.contains("format_area")&&(b={minimumFractionDigits:2});const d=Number(o.textContent).toLocaleString(void 0,b);o.innerHTML=isNaN(parseFloat(o.textContent))?o.textContent:d}}),go.forEach(o=>{if(o.textContent){let b=o.textContent.replaceAll(`
`,"").replaceAll(" ","").split("/");o.innerHTML=`${b[0]??(b[0]=Qe)}`,o.innerHTML+='<span class="format_unit">\u5E74 </span>',o.innerHTML+=`${b[1]??(b[1]=Qe)}`,o.innerHTML+='<span class="format_unit">\u6708 </span>',o.innerHTML+=`${b[2]??(b[2]=Qe)}`,o.innerHTML+='<span class="format_unit">\u65E5</span>'}}),fo.forEach(o=>{if(o.textContent){let b=new Date(o.textContent);b!="Invalid Date"?(o.innerHTML=b.getFullYear(),o.innerHTML+='<span class="format_unit">\u5E74 </span>',o.innerHTML+=b.getMonth()+1,o.innerHTML+='<span class="format_unit">\u6708 </span>',o.innerHTML+=b.getDate(),o.innerHTML+='<span class="format_unit">\u65E5 </span>',o.innerHTML+=`${b.getHours()}:${b.getMinutes()<10?"0":""}${b.getMinutes()}`):(o.innerHTML=`${Qe}`,o.innerHTML+='<span class="format_unit">\u5E74 </span>',o.innerHTML+=`${Qe}`,o.innerHTML+='<span class="format_unit">\u6708 </span>',o.innerHTML+=`${Qe}`,o.innerHTML+='<span class="format_unit">\u65E5 </span>',o.innerHTML+=`${Qe}`)}}),mo.forEach(o=>{if(o.textContent){let[b,d]=o.textContent.replaceAll(`
`,"").split(" ");b=b.split("/"),o.innerHTML=`${b[0]??(b[0]=Qe)}`,o.innerHTML+='<span class="format_unit">\u5E74 </span>',o.innerHTML+=`${b[1]??(b[1]=Qe)}`,o.innerHTML+='<span class="format_unit">\u6708 </span>',o.innerHTML+=`${b[2]??(b[2]=Qe)}`,o.innerHTML+='<span class="format_unit">\u65E5</span>',d=d.split(":"),o.innerHTML+=` ${d[0]??(d[0]=Qe)}`,o.innerHTML+='<span class="format_unit">\u6642 </span>',o.innerHTML+=`${d[1]??(d[1]=Qe)}`,o.innerHTML+='<span class="format_unit">\u5206 </span>',o.innerHTML+=`${d[2]??(d[2]=Qe)}`,o.innerHTML+='<span class="format_unit">\u79D2 </span>'}});const vo=document.querySelectorAll('[data-role="auth-menu"'),Ar=document.querySelector(".main-header__auth-menu"),yr=document.querySelector(".main-header__auth-bg");Ar&&yr&&(vo.forEach(o=>o.addEventListener("click",_r)),yr.addEventListener("click",_r));function _r(){Ar.classList.toggle("main-header__auth-menu_open")}const wr=document.querySelectorAll('[data-role="toggle-section"]'),bo=document.querySelectorAll(".toggle-section__item");wr.forEach(o=>o.addEventListener("click",Ao));function Ao(){bo.forEach(o=>o.classList.remove("toggle-section__item_show")),wr.forEach(o=>o.classList.remove("toggle-btn__item_active")),document.querySelector(this.dataset.target).classList.add("toggle-section__item_show"),this.classList.add("toggle-btn__item_active"),window.scrollTo({top:window.scrollY+document.querySelector(".fund-detail__thumbnail").getBoundingClientRect().bottom-57})}document.querySelectorAll(".schedule__status").forEach(o=>{if(o.dataset){const b=new Date,d=new Date(o.dataset.start),e=new Date(o.dataset.end);d!=="Invalid Date"&&e!=="Invalid Date"?b>e?(o.classList.remove("schedule__status_yet"),o.classList.add("schedule__status_complete")):d<=b&&b<=e&&(o.classList.remove("schedule__status_yet"),o.classList.add("schedule__status_current")):console.log("invalid date!",`
 start: ${d}`,`
end: ${e}`)}else console.log(o.dataset)}),document.querySelectorAll('[data-role="short-schedule"]').forEach(o=>{const b=["\u62BD\u9078\u4E88\u5B9A\u65E5","\u30AD\u30E3\u30F3\u30BB\u30EB\u5F85\u3061\u62BD\u9078\u4E88\u5B9A\u65E5","\u632F\u8FBC\u671F\u9650\u65E5\u6642","\u904B\u7528\u958B\u59CB\u4E88\u5B9A\u65E5","\u904B\u7528\u7D42\u4E86\u4E88\u5B9A\u65E5","\u511F\u9084\u4E88\u5B9A\u65E5"],d=["\u632F\u8FBC\u671F\u9650\u65E5\u6642"],e=o.dataset.value.split(",");e.length===4&&b.splice(0,2);let w={},v="--",R;e.forEach((k,y)=>{const g=new Date(k),G=isNaN(g);G||(v=String(g.getFullYear()),R=Math.round((new Date().getTime()-g.getTime())/(24*36e5))),Object.keys(w).indexOf(v)===-1&&(w[v]=[]);const I={year:G?"--":g.getFullYear(),month:G?"--":g.getMonth()+1,date:G?"--":g.getDate(),hour:G?"--":("00"+g.getHours()).slice(-2),minute:G?"--":("00"+g.getMinutes()).slice(-2),status:R>1?"complete":R!==1?"yet":"current",lastRaw:y===b.length-1,hasTime:d.includes(b[y]),label:b[y]};w[v].push(I)});let K="";for(let[k,y]of Object.entries(w))K+=`            <div class="fund-shcedule-short__row">                 <div class="fund-schedule-short__year">                     ${k}                 </div>             <div class="fund-schedule-short__items">         `,y.forEach(g=>{K+=g.lastRaw?'<div class="fund-schedule-short__content fund-schedule-short__content_last">':'<div class="fund-schedule-short__content">',K+=`<span class="fund-schedule-short__value">                         <span style="display:inline-block; width: 1rem;">${g.month}</span>                        <span class="format_unit">\u6708</span>                        <span style="display:inline-block; width: 1rem;">${g.date}</span>                        <span class="format_unit">\u65E5</span>                    `,g.hasTime&&(K+=`<div class="fund-schedule-short__time">${g.hour}:${g.minute}</div>`),K+=`   </span>                     <div class="schedule__status schedule__status_${g.status}"></div>                     <span class="fund-schedule-short__label">${g.label}</span>                     </div>                     `}),K+="</div></div>";o.innerHTML=K});var Hs=function(){return Hs=Object.assign||function(o){for(var b,d=1,e=arguments.length;d<e;d++)for(var w in b=arguments[d])Object.prototype.hasOwnProperty.call(b,w)&&(o[w]=b[w]);return o},Hs.apply(this,arguments)};function Er(o,b,d){if(d||arguments.length===2)for(var e,w=0,v=b.length;w<v;w++)!e&&w in b||(e||(e=Array.prototype.slice.call(b,0,w)),e[w]=b[w]);return o.concat(e||Array.prototype.slice.call(b))}function xr(o){return Array.prototype.slice.call(o)}function Sr(o,b){var d=Math.floor(o);return d===b||d+1===b?o:b}function Cr(){return Date.now()}function mn(o,b,d){if(b="data-keen-slider-"+b,d===null)return o.removeAttribute(b);o.setAttribute(b,d||"")}function Pi(o,b){return b=b||document,typeof o=="function"&&(o=o(b)),Array.isArray(o)?o:typeof o=="string"?xr(b.querySelectorAll(o)):o instanceof HTMLElement?[o]:o instanceof NodeList?xr(o):[]}function si(o){o.raw&&(o=o.raw),o.cancelable&&!o.defaultPrevented&&o.preventDefault()}function ii(o){o.raw&&(o=o.raw),o.stopPropagation&&o.stopPropagation()}function Mr(){var o=[];return{add:function(b,d,e,w){b.addListener?b.addListener(e):b.addEventListener(d,e,w),o.push([b,d,e,w])},input:function(b,d,e,w){this.add(b,d,function(v){return function(R){R.nativeEvent&&(R=R.nativeEvent);var K=R.changedTouches||[],k=R.targetTouches||[],y=R.detail&&R.detail.x?R.detail:null;return v({id:y?y.identifier?y.identifier:"i":k[0]?k[0]?k[0].identifier:"e":"d",idChanged:y?y.identifier?y.identifier:"i":K[0]?K[0]?K[0].identifier:"e":"d",raw:R,x:y&&y.x?y.x:k[0]?k[0].screenX:y?y.x:R.pageX,y:y&&y.y?y.y:k[0]?k[0].screenY:y?y.y:R.pageY})}}(e),w)},purge:function(){o.forEach(function(b){b[0].removeListener?b[0].removeListener(b[2]):b[0].removeEventListener(b[1],b[2],b[3])}),o=[]}}}function vn(o,b,d){return Math.min(Math.max(o,b),d)}function is(o){return(o>0?1:0)-(o<0?1:0)||+o}function Tr(o){var b=o.getBoundingClientRect();return{height:Sr(b.height,o.offsetHeight),width:Sr(b.width,o.offsetWidth)}}function ze(o,b,d,e){var w=o&&o[b];return w==null?d:e&&typeof w=="function"?w():w}function ss(o){return Math.round(1e6*o)/1e6}function yo(o){var b,d,e,w,v,R;function K(I){R||(R=I),k(!0);var E=I-R;E>e&&(E=e);var H=w[d];if(H[3]<E)return d++,K(I);var $=H[2],Y=H[4],at=H[0],Q=H[1]*(0,H[5])(Y===0?1:(E-$)/Y);if(Q&&o.track.to(at+Q),E<e)return g();R=null,k(!1),y(null),o.emit("animationEnded")}function k(I){b.active=I}function y(I){b.targetIdx=I}function g(){var I;I=K,v=window.requestAnimationFrame(I)}function G(){var I;I=v,window.cancelAnimationFrame(I),k(!1),y(null),R&&o.emit("animationStopped"),R=null}return b={active:!1,start:function(I){if(G(),o.track.details){var E=0,H=o.track.details.position;d=0,e=0,w=I.map(function($){var Y,at=Number(H),Q=(Y=$.earlyExit)!==null&&Y!==void 0?Y:$.duration,M=$.easing,U=$.distance*M(Q/$.duration)||0;H+=U;var B=e;return e+=Q,E+=U,[at,$.distance,B,e,$.duration,M]}),y(o.track.distToIdx(E)),g(),o.emit("animationStarted")}},stop:G,targetIdx:null}}function _o(o){var b,d,e,w,v,R,K,k,y,g,G,I,E,H,$=1/0,Y=[],at=null,Q=0;function M(Tt){Nt(Q+Tt)}function U(Tt){var Pt=B(Q+Tt).abs;return tt(Pt)?Pt:null}function B(Tt){var Pt=Math.floor(Math.abs(ss(Tt/d))),Et=ss((Tt%d+d)%d);Et===d&&(Et=0);var Z=is(Tt),gt=K.indexOf(Er([],K,!0).reduce(function(Rt,qt){return Math.abs(qt-Et)<Math.abs(Rt-Et)?qt:Rt})),kt=gt;return Z<0&&Pt++,gt===R&&(kt=0,Pt+=Z>0?1:-1),{abs:kt+Pt*R*Z,origin:gt,rel:kt}}function D(Tt,Pt,Et){var Z;if(Pt||!Ft())return q(Tt,Et);if(!tt(Tt))return null;var gt=B(Et??Q),kt=gt.abs,Rt=Tt-gt.rel,qt=kt+Rt;Z=q(qt);var Kt=q(qt-R*is(Rt));return(Kt!==null&&Math.abs(Kt)<Math.abs(Z)||Z===null)&&(Z=Kt),ss(Z)}function q(Tt,Pt){if(Pt==null&&(Pt=ss(Q)),!tt(Tt)||Tt===null)return null;Tt=Math.round(Tt);var Et=B(Pt),Z=Et.abs,gt=Et.rel,kt=Et.origin,Rt=Ct(Tt),qt=(Pt%d+d)%d,Kt=K[kt],ie=Math.floor((Tt-(Z-gt))/R)*d;return ss(Kt-qt-Kt+K[Rt]+ie+(kt===R?d:0))}function tt(Tt){return vt(Tt)===Tt}function vt(Tt){return vn(Tt,y,g)}function Ft(){return w.loop}function Ct(Tt){return(Tt%R+R)%R}function Nt(Tt){var Pt;Pt=Tt-Q,Y.push({distance:Pt,timestamp:Cr()}),Y.length>6&&(Y=Y.slice(-6)),Q=ss(Tt);var Et=_t().abs;if(Et!==at){var Z=at!==null;at=Et,Z&&o.emit("slideChanged")}}function _t(Tt){var Pt=Tt?null:function(){if(R){var Et=Ft(),Z=Et?(Q%d+d)%d:Q,gt=(Et?Q%d:Q)-v[0][2],kt=0-(gt<0&&Et?d-Math.abs(gt):gt),Rt=0,qt=B(Q),Kt=qt.abs,ie=qt.rel,Se=v[ie][2],de=v.map(function(le,ve){var Vt=kt+Rt;(Vt<0-le[0]||Vt>1)&&(Vt+=(Math.abs(Vt)>d-1&&Et?d:0)*is(-Vt));var ae=ve-ie,Ce=is(ae),ee=ae+Kt;Et&&(Ce===-1&&Vt>Se&&(ee+=R),Ce===1&&Vt<Se&&(ee-=R),G!==null&&ee<G&&(Vt+=d),I!==null&&ee>I&&(Vt-=d));var Ee=Vt+le[0]+le[1],ne=Math.max(Vt>=0&&Ee<=1?1:Ee<0||Vt>1?0:Vt<0?Math.min(1,(le[0]+Vt)/le[0]):(1-Vt)/le[0],0);return Rt+=le[0]+le[1],{abs:ee,distance:w.rtl?-1*Vt+1-le[0]:Vt,portion:ne,size:le[0]}});return Kt=vt(Kt),ie=Ct(Kt),{abs:vt(Kt),length:e,max:H,maxIdx:g,min:E,minIdx:y,position:Q,progress:Et?Z/d:Q/e,rel:ie,slides:de,slidesLength:d}}}();return b.details=Pt,o.emit("detailsChanged"),Pt}return b={absToRel:Ct,add:M,details:null,distToIdx:U,idxToDist:D,init:function(Tt){if(function(){if(w=o.options,v=(w.trackConfig||[]).map(function(gt){return[ze(gt,"size",1),ze(gt,"spacing",0),ze(gt,"origin",0)]}),R=v.length){d=ss(v.reduce(function(gt,kt){return gt+kt[0]+kt[1]},0));var Et,Z=R-1;e=ss(d+v[0][2]-v[Z][0]-v[Z][2]-v[Z][1]),K=v.reduce(function(gt,kt){if(!gt)return[0];var Rt=v[gt.length-1],qt=gt[gt.length-1]+(Rt[0]+Rt[2])+Rt[1];return qt-=kt[2],gt[gt.length-1]>qt&&(qt=gt[gt.length-1]),qt=ss(qt),gt.push(qt),(!Et||Et<qt)&&(k=gt.length-1),Et=qt,gt},null),e===0&&(k=0),K.push(ss(d))}}(),!R)return _t(!0);var Pt;(function(){var Et=o.options.range,Z=o.options.loop;G=y=Z?ze(Z,"min",-1/0):0,I=g=Z?ze(Z,"max",$):k;var gt=ze(Et,"min",null),kt=ze(Et,"max",null);gt!==null&&(y=gt),kt!==null&&(g=kt),E=y===-1/0?y:o.track.idxToDist(y||0,!0,0),H=g===$?g:D(g,!0,0),kt===null&&(I=g),ze(Et,"align",!1)&&g!==$&&v[Ct(g)][2]===0&&(H-=1-v[Ct(g)][0],g=U(H-Q)),E=ss(E),H=ss(H)})(),Pt=Tt,Number(Pt)===Pt?M(q(vt(Tt))):_t()},to:Nt,velocity:function(){var Tt=Cr(),Pt=Y.reduce(function(Et,Z){var gt=Z.distance,kt=Z.timestamp;return Tt-kt>200||(is(gt)!==is(Et.distance)&&Et.distance&&(Et={distance:0,lastTimestamp:0,time:0}),Et.time&&(Et.distance+=gt),Et.lastTimestamp&&(Et.time+=kt-Et.lastTimestamp),Et.lastTimestamp=kt),Et},{distance:0,lastTimestamp:0,time:0});return Pt.distance/Pt.time||0}}}function wo(o){var b,d,e,w,v,R,K,k;function y(at){return 2*at}function g(at){return vn(at,K,k)}function G(at){return 1-Math.pow(1-at,3)}function I(){return e?o.track.velocity():0}function E(){Y();var at=o.options.mode==="free-snap",Q=o.track,M=I();w=is(M);var U=o.track.details,B=[];if(M||!at){var D=H(M),q=D.dist,tt=D.dur;if(tt=y(tt),q*=w,at){var vt=Q.idxToDist(Q.distToIdx(q),!0);vt&&(q=vt)}B.push({distance:q,duration:tt,easing:G});var Ft=U.position,Ct=Ft+q;if(Ct<v||Ct>R){var Nt=Ct<v?v-Ft:R-Ft,_t=0,Tt=M;if(is(Nt)===w){var Pt=Math.min(Math.abs(Nt)/Math.abs(q),1),Et=function(kt){return 1-Math.pow(1-kt,1/3)}(Pt)*tt;B[0].earlyExit=Et,Tt=M*(1-Pt)}else B[0].earlyExit=0,_t+=Nt;var Z=H(Tt,100),gt=Z.dist*w;o.options.rubberband&&(B.push({distance:gt,duration:y(Z.dur),easing:G}),B.push({distance:-gt+_t,duration:500,easing:G}))}o.animator.start(B)}else o.moveToIdx(g(U.abs),!0,{duration:500,easing:function(kt){return 1+--kt*kt*kt*kt*kt}})}function H(at,Q){Q===void 0&&(Q=1e3);var M=147e-9+(at=Math.abs(at))/Q;return{dist:Math.pow(at,2)/M,dur:at/M}}function $(){var at=o.track.details;at&&(v=at.min,R=at.max,K=at.minIdx,k=at.maxIdx)}function Y(){o.animator.stop()}o.on("updated",$),o.on("optionsChanged",$),o.on("created",$),o.on("dragStarted",function(){e=!1,Y(),b=d=o.track.details.abs}),o.on("dragChecked",function(){e=!0}),o.on("dragEnded",function(){var at=o.options.mode;at==="snap"&&function(){var Q=o.track,M=o.track.details,U=M.position,B=is(I());(U>R||U<v)&&(B=0);var D=b+B;M.slides[Q.absToRel(D)].portion===0&&(D-=B),b!==d&&(D=d),is(Q.idxToDist(D,!0))!==B&&(D+=B),D=g(D);var q=Q.idxToDist(D,!0);o.animator.start([{distance:q,duration:500,easing:function(tt){return 1+--tt*tt*tt*tt*tt}}])}(),at!=="free"&&at!=="free-snap"||E()}),o.on("dragged",function(){d=o.track.details.abs})}function Eo(o){var b,d,e,w,v,R,K,k,y,g,G,I,E,H,$,Y,at,Q,M=Mr();function U(_t){if(R&&k===_t.id){var Tt=tt(_t);if(y){if(!q(_t))return D(_t);g=Tt,y=!1,o.emit("dragChecked")}if(Y)return g=Tt;si(_t);var Pt=function(Z){if(at===-1/0&&Q===1/0)return Z;var gt=o.track.details,kt=gt.length,Rt=gt.position,qt=vn(Z,at-Rt,Q-Rt);if(kt===0)return 0;if(!o.options.rubberband)return qt;if(Rt<=Q&&Rt>=at||Rt<at&&d>0||Rt>Q&&d<0)return Z;var Kt=(Rt<at?Rt-at:Rt-Q)/kt,ie=w*kt,Se=Math.abs(Kt*ie),de=Math.max(0,1-Se/v*2);return de*de*Z}(K(g-Tt)/w*e);d=is(Pt);var Et=o.track.details.position;(Et>at&&Et<Q||Et===at&&d>0||Et===Q&&d<0)&&ii(_t),G+=Pt,!I&&Math.abs(G*w)>5&&(I=!0),o.track.add(Pt),g=Tt,o.emit("dragged")}}function B(_t){!R&&o.track.details&&o.track.details.length&&(G=0,R=!0,I=!1,y=!0,k=_t.id,q(_t),g=tt(_t),o.emit("dragStarted"))}function D(_t){R&&k===_t.idChanged&&(R=!1,o.emit("dragEnded"))}function q(_t){var Tt=vt(),Pt=Tt?_t.y:_t.x,Et=Tt?_t.x:_t.y,Z=E!==void 0&&H!==void 0&&Math.abs(H-Et)<=Math.abs(E-Pt);return E=Pt,H=Et,Z}function tt(_t){return vt()?_t.y:_t.x}function vt(){return o.options.vertical}function Ft(){w=o.size,v=vt()?window.innerHeight:window.innerWidth;var _t=o.track.details;_t&&(at=_t.min,Q=_t.max)}function Ct(_t){I&&(ii(_t),si(_t))}function Nt(){if(M.purge(),o.options.drag&&!o.options.disabled){var _t;_t=o.options.dragSpeed||1,K=typeof _t=="function"?_t:function(Pt){return Pt*_t},e=o.options.rtl?-1:1,Ft(),b=o.container,function(){var Pt="data-keen-slider-clickable";Pi("[".concat(Pt,"]:not([").concat(Pt,"=false])"),b).map(function(Et){M.add(Et,"dragstart",ii),M.add(Et,"mousedown",ii),M.add(Et,"touchstart",ii)})}(),M.add(b,"dragstart",function(Pt){si(Pt)}),M.add(b,"click",Ct,{capture:!0}),M.input(b,"ksDragStart",B),M.input(b,"ksDrag",U),M.input(b,"ksDragEnd",D),M.input(b,"mousedown",B),M.input(b,"mousemove",U),M.input(b,"mouseleave",D),M.input(b,"mouseup",D),M.input(b,"touchstart",B,{passive:!0}),M.input(b,"touchmove",U,{passive:!1}),M.input(b,"touchend",D),M.input(b,"touchcancel",D),M.add(window,"wheel",function(Pt){R&&si(Pt)});var Tt="data-keen-slider-scrollable";Pi("[".concat(Tt,"]:not([").concat(Tt,"=false])"),o.container).map(function(Pt){return function(Et){var Z;M.input(Et,"touchstart",function(gt){Z=tt(gt),Y=!0,$=!0},{passive:!0}),M.input(Et,"touchmove",function(gt){var kt=vt(),Rt=kt?Et.scrollHeight-Et.clientHeight:Et.scrollWidth-Et.clientWidth,qt=Z-tt(gt),Kt=kt?Et.scrollTop:Et.scrollLeft,ie=kt&&Et.style.overflowY==="scroll"||!kt&&Et.style.overflowX==="scroll";if(Z=tt(gt),(qt<0&&Kt>0||qt>0&&Kt<Rt)&&$&&ie)return Y=!0;$=!1,si(gt),Y=!1}),M.input(Et,"touchend",function(){Y=!1})}(Pt)})}}o.on("updated",Ft),o.on("optionsChanged",Nt),o.on("created",Nt),o.on("destroyed",M.purge)}function xo(o){var b,d,e=null;function w(E,H,$){o.animator.active?R(E,H,$):requestAnimationFrame(function(){return R(E,H,$)})}function v(){w(!1,!1,d)}function R(E,H,$){var Y=0,at=o.size,Q=o.track.details;if(Q&&b){var M=Q.slides;b.forEach(function(U,B){if(E)!e&&H&&k(U,null,$),y(U,null,$);else{if(!M[B])return;var D=M[B].size*at;!e&&H&&k(U,D,$),y(U,M[B].distance*at-Y,$),Y+=D}})}}function K(E){return o.options.renderMode==="performance"?Math.round(E):E}function k(E,H,$){var Y=$?"height":"width";H!==null&&(H=K(H)+"px"),E.style["min-"+Y]=H,E.style["max-"+Y]=H}function y(E,H,$){if(H!==null){H=K(H);var Y=$?H:0;H="translate3d(".concat($?0:H,"px, ").concat(Y,"px, 0)")}E.style.transform=H,E.style["-webkit-transform"]=H}function g(){b&&(R(!0,!0,d),b=null),o.on("detailsChanged",v,!0)}function G(){w(!1,!0,d)}function I(){g(),d=o.options.vertical,o.options.disabled||o.options.renderMode==="custom"||(e=ze(o.options.slides,"perView",null)==="auto",o.on("detailsChanged",v),(b=o.slides).length&&G())}o.on("created",I),o.on("optionsChanged",I),o.on("beforeOptionsChanged",function(){g()}),o.on("updated",G),o.on("destroyed",g)}function So(o,b){return function(d){var e,w,v,R,K,k=Mr();function y(q){var tt;mn(d.container,"reverse",(tt=d.container,window.getComputedStyle(tt,null).getPropertyValue("direction")!=="rtl"||q?null:"")),mn(d.container,"v",d.options.vertical&&!q?"":null),mn(d.container,"disabled",d.options.disabled&&!q?"":null)}function g(){G()&&Y()}function G(){var q=null;if(R.forEach(function(vt){vt.matches&&(q=vt.__media)}),q===e)return!1;e||d.emit("beforeOptionsChanged"),e=q;var tt=q?v.breakpoints[q]:v;return d.options=Hs(Hs({},v),tt),y(),B(),D(),Q(),!0}function I(q){var tt=Tr(q);return(d.options.vertical?tt.height:tt.width)/d.size||1}function E(){return d.options.trackConfig.length}function H(q){for(var tt in e=!1,v=Hs(Hs({},b),q),k.purge(),w=d.size,R=[],v.breakpoints||[]){var vt=window.matchMedia(tt);vt.__media=tt,R.push(vt),k.add(vt,"change",g)}k.add(window,"orientationchange",U),k.add(window,"resize",M),G()}function $(q){d.animator.stop();var tt=d.track.details;d.track.init(q??(tt?tt.abs:0))}function Y(q){$(q),d.emit("optionsChanged")}function at(q,tt){if(q)return H(q),void Y(tt);B(),D();var vt=E();Q(),E()!==vt?Y(tt):$(tt),d.emit("updated")}function Q(){var q=d.options.slides;if(typeof q=="function")return d.options.trackConfig=q(d.size,d.slides);for(var tt=d.slides,vt=tt.length,Ft=typeof q=="number"?q:ze(q,"number",vt,!0),Ct=[],Nt=ze(q,"perView",1,!0),_t=ze(q,"spacing",0,!0)/d.size||0,Tt=Nt==="auto"?_t:_t/Nt,Pt=ze(q,"origin","auto"),Et=0,Z=0;Z<Ft;Z++){var gt=Nt==="auto"?I(tt[Z]):1/Nt-_t+Tt,kt=Pt==="center"?.5-gt/2:Pt==="auto"?0:Pt;Ct.push({origin:kt,size:gt,spacing:_t}),Et+=gt}if(Et+=_t*(Ft-1),Pt==="auto"&&!d.options.loop&&Nt!==1){var Rt=0;Ct.map(function(qt){var Kt=Et-Rt;return Rt+=qt.size+_t,Kt>=1||(qt.origin=1-Kt-(Et>1?0:1-Et)),qt})}d.options.trackConfig=Ct}function M(){B();var q=d.size;d.options.disabled||q===w||(w=q,at())}function U(){M(),setTimeout(M,500),setTimeout(M,2e3)}function B(){var q=Tr(d.container);d.size=(d.options.vertical?q.height:q.width)||1}function D(){d.slides=Pi(d.options.selector,d.container)}d.container=(K=Pi(o,document)).length?K[0]:null,d.destroy=function(){k.purge(),d.emit("destroyed"),y(!0)},d.prev=function(){d.moveToIdx(d.track.details.abs-1,!0)},d.next=function(){d.moveToIdx(d.track.details.abs+1,!0)},d.update=at,H(d.options)}}var Co=function(o,b,d){try{return function(e,w){var v,R={};return v={emit:function(K){R[K]&&R[K].forEach(function(y){y(v)});var k=v.options&&v.options[K];k&&k(v)},moveToIdx:function(K,k,y){var g=v.track.idxToDist(K,k);if(g){var G=v.options.defaultAnimation;v.animator.start([{distance:g,duration:ze(y||G,"duration",500),easing:ze(y||G,"easing",function(I){return 1+--I*I*I*I*I})}])}},on:function(K,k,y){y===void 0&&(y=!1),R[K]||(R[K]=[]);var g=R[K].indexOf(k);g>-1?y&&delete R[K][g]:y||R[K].push(k)},options:e},function(){if(v.track=_o(v),v.animator=yo(v),w)for(var K=0,k=w;K<k.length;K++)(0,k[K])(v);v.track.init(v.options.initial||0),v.emit("created")}(),v}(b,Er([So(o,{drag:!0,mode:"snap",renderMode:"precision",rubberband:!0,selector:".keen-slider__slide"}),xo,Eo,wo],d||[],!0))}catch(e){console.error(e)}};const Mo=document.querySelectorAll('[data-role="slider-thumbnail"]'),Lr=document.getElementById("js-main-slider");function To(o){return b=>{function d(){o.forEach(e=>{e.addEventListener("click",()=>{b.moveToIdx(Number(e.dataset.target)),o.forEach(w=>{w.dataset.target!=e.dataset.target?w.classList.remove("slider-thumbnail__img_active"):w.classList.add("slider-thumbnail__img_active")})})})}b.on("created",()=>{d()}),b.on("animationEnded",()=>{const e=b.track.details.rel;o.forEach(w=>{w.dataset.target==e?w.classList.add("slider-thumbnail__img_active"):w.classList.remove("slider-thumbnail__img_active")})})}}Lr&&new Co(Lr,{slides:{perView:1},defaultAnimation:{duration:0}},[To(Mo)]),document.querySelectorAll('[data-role="zengin-input"]').forEach(o=>{o.addEventListener("change",Lo)});function Lo(o){let b=o.target.value;if(b){const d=Po(b);o.target.value=d}}function Po(o){const b=/[^0-9A-Zｱｲｳｴｵｶｷｸｹｺｻｼｽｾｿﾀﾁﾂﾃﾄﾅﾆﾇﾈﾉﾊﾋﾌﾍﾎﾏﾐﾑﾒﾓﾔﾕﾖﾗﾘﾙﾚﾛﾜﾝﾞﾟ\(\)｢｣\/\-\.\\ ]/g,d=["\uFF70","\uFF67","\uFF68","\uFF69","\uFF6A","\uFF6B","\uFF6F","\uFF6C","\uFF6D","\uFF6E","\uFF08","\uFF09"],e=["-","\uFF71","\uFF72","\uFF73","\uFF74","\uFF75","\uFF82","\uFF94","\uFF95","\uFF96","(",")"];let w;return w=o.toUpperCase(),w=ko(w,"khsa"),d.forEach((v,R)=>{w=w.replaceAll(v,e[R])}),w=w.replace(b,""),w}function ko(o,b){var d,e,w,v,R,K;if(d=["\uFF76\uFF9E","\uFF77\uFF9E","\uFF78\uFF9E","\uFF79\uFF9E","\uFF7A\uFF9E","\uFF7B\uFF9E","\uFF7C\uFF9E","\uFF7D\uFF9E","\uFF7E\uFF9E","\uFF7F\uFF9E","\uFF80\uFF9E","\uFF81\uFF9E","\uFF82\uFF9E","\uFF83\uFF9E","\uFF84\uFF9E","\uFF8A\uFF9E","\uFF8A\uFF9F","\uFF8B\uFF9E","\uFF8B\uFF9F","\uFF8C\uFF9E","\uFF8C\uFF9F","\uFF8D\uFF9E","\uFF8D\uFF9F","\uFF8E\uFF9E","\uFF8E\uFF9F","\uFF73\uFF9E","\uFF70","\uFF67","\uFF71","\uFF68","\uFF72","\uFF69","\uFF73","\uFF6A","\uFF74","\uFF6B","\uFF75","\uFF76","\uFF77","\uFF78","\uFF79","\uFF7A","\uFF7B","\uFF7C","\uFF7D","\uFF7E","\uFF7F","\uFF80","\uFF81","\uFF6F","\uFF82","\uFF83","\uFF84","\uFF85","\uFF86","\uFF87","\uFF88","\uFF89","\uFF8A","\uFF8B","\uFF8C","\uFF8D","\uFF8E","\uFF8F","\uFF90","\uFF91","\uFF92","\uFF93","\uFF6C","\uFF94","\uFF6D","\uFF95","\uFF6E","\uFF96","\uFF97","\uFF98","\uFF99","\uFF9A","\uFF9B","\uFF9C","\uFF66","\uFF9D","\uFF76","\uFF79","\uFF9C","\uFF72","\uFF74","\uFF9E","\uFF9F"],e=["\u30AC","\u30AE","\u30B0","\u30B2","\u30B4","\u30B6","\u30B8","\u30BA","\u30BC","\u30BE","\u30C0","\u30C2","\u30C5","\u30C7","\u30C9","\u30D0","\u30D1","\u30D3","\u30D4","\u30D6","\u30D7","\u30D9","\u30DA","\u30DC","\u30DD","\u30F4","\u30FC","\u30A1","\u30A2","\u30A3","\u30A4","\u30A5","\u30A6","\u30A7","\u30A8","\u30A9","\u30AA","\u30AB","\u30AD","\u30AF","\u30B1","\u30B3","\u30B5","\u30B7","\u30B9","\u30BB","\u30BD","\u30BF","\u30C1","\u30C3","\u30C4","\u30C6","\u30C8","\u30CA","\u30CB","\u30CC","\u30CD","\u30CE","\u30CF","\u30D2","\u30D5","\u30D8","\u30DB","\u30DE","\u30DF","\u30E0","\u30E1","\u30E2","\u30E3","\u30E4","\u30E5","\u30E6","\u30E7","\u30E8","\u30E9","\u30EA","\u30EB","\u30EC","\u30ED","\u30EF","\u30F2","\u30F3","\u30F5","\u30F6","\u30EE","\u30F0","\u30F1","\u309B","\u309C"],w=["\u304C","\u304E","\u3050","\u3052","\u3054","\u3056","\u3058","\u305A","\u305C","\u305E","\u3060","\u3062","\u3065","\u3067","\u3069","\u3070","\u3071","\u3073","\u3074","\u3076","\u3077","\u3079","\u307A","\u307C","\u307D","\u30F4","\u30FC","\u3041","\u3042","\u3043","\u3044","\u3045","\u3046","\u3047","\u3048","\u3049","\u304A","\u304B","\u304D","\u304F","\u3051","\u3053","\u3055","\u3057","\u3059","\u305B","\u305D","\u305F","\u3061","\u3063","\u3064","\u3066","\u3068","\u306A","\u306B","\u306C","\u306D","\u306E","\u306F","\u3072","\u3075","\u3078","\u307B","\u307E","\u307F","\u3080","\u3081","\u3082","\u3083","\u3084","\u3085","\u3086","\u3087","\u3088","\u3089","\u308A","\u308B","\u308C","\u308D","\u308F","\u3092","\u3093","\u304B","\u3051","\u308E","\u3090","\u3091","\u309B","\u309C"],v=d.length,b.match(/[ra]/)&&(o=o.replace(/[Ａ-ｚ]/g,function(k){return String.fromCharCode(parseInt(k.charCodeAt(0))-65248)})),b.match(/[RA]/)&&(o=o.replace(/[A-z]/g,function(k){return String.fromCharCode(parseInt(k.charCodeAt(0))+65248)})),b.match(/[na]/)&&(o=o.replace(/[０-９]/g,function(k){return String.fromCharCode(parseInt(k.charCodeAt(0))-65248)})),b.match(/[NA]/)&&(o=o.replace(/[0-9]/g,function(k){return String.fromCharCode(parseInt(k.charCodeAt(0))+65248)})),b.match(/s/)&&(o=o.replace(/　/g," ")),b.match(/S/)&&(o=o.replace(/ /g,"\u3000")),b.match(/k/))for(R=0;R<v;R++)K=new RegExp(e[R],"g"),o=o.replace(K,d[R]);if(b.match(/K/))for(b.match(/V/)||(o=o.replace(/ﾞ/g,"\u309B"),o=o.replace(/ﾟ/g,"\u309C")),R=0;R<v;R++)K=new RegExp(d[R],"g"),o=o.replace(K,e[R]);if(b.match(/h/))for(R=0;R<v;R++)K=new RegExp(w[R],"g"),o=o.replace(K,d[R]);if(b.match(/H/))for(b.match(/V/)||(o=o.replace(/ﾞ/g,"\u309B"),o=o.replace(/ﾟ/g,"\u309C")),R=0;R<v;R++)K=new RegExp(d[R],"g"),o=o.replace(K,w[R]);if(b.match(/c/))for(R=0;R<v;R++)K=new RegExp(e[R],"g"),o=o.replace(K,w[R]);if(b.match(/C/))for(R=0;R<v;R++)K=new RegExp(w[R],"g"),o=o.replace(K,e[R]);return o}document.querySelectorAll('[data-role="toggle-input--btn"]').forEach(o=>{o.addEventListener("click",b=>{const d=b.target.dataset.group;document.querySelectorAll(`[data-group="${d}"][data-role="toggle-input--value"], [data-group="${d}"][data-role="toggle-input--input"]`).forEach(e=>{e.classList.toggle("toggle-input_show")})})});const Ro=document.querySelectorAll('[data-role="resize"]');window.addEventListener("load",()=>{Ro.forEach(o=>{const b=o.dataset.field,d=document.querySelector(`[name="uploadFilesBlock${b}"]`),e=document.querySelector(`input[name='selectFiles${b}']`),w=document.createElement("div"),v=document.createElement("div"),R=document.createElement("div"),K=document.createElement("input"),k=document.createElement("p"),y=document.createElement("button");K.setAttribute("type","file"),K.style.display="none",K.addEventListener("change",g=>{const G=g.target.files[0];Pr(G,e)}),v.appendChild(w),v.classList.add("coverDiv"),v.addEventListener("dragstart",g=>{g.dataTransfer.clearData(),bn(g)}),v.addEventListener("dragover",g=>{bn(g)}),v.addEventListener("dragleave",g=>{}),v.addEventListener("drop",g=>{bn(g);const G=g.target.files||g.dataTransfer.files;G.length>0&&Pr(G[0],e)}),w.appendChild(R),w.classList.add("sp-flex-align-center","sp-flex-content-center","sp-flex","sp-from-file-default-drag-drop-area"),w.addEventListener("dragover",g=>{w.classList.remove("sp-from-file-ondragleave-drag-drop-area"),w.classList.remove("sp-from-file-ondrop-drag-drop-area"),w.classList.add("sp-from-file-ondraghover-drag-drop-area")}),w.addEventListener("dragleave",g=>{w.classList.add("sp-from-file-ondragleave-drag-drop-area"),w.classList.remove("sp-from-file-ondrop-drag-drop-area"),w.classList.remove("sp-from-file-ondraghover-drag-drop-area")}),w.addEventListener("drop",g=>{w.classList.remove("sp-from-file-ondragleave-drag-drop-area"),w.classList.add("sp-from-file-ondrop-drag-drop-area"),w.classList.remove("sp-from-file-ondraghover-drag-drop-area")}),R.appendChild(k),R.appendChild(y),R.appendChild(K),k.textContent="\u3053\u3053\u306B\u30D5\u30A1\u30A4\u30EB\u3092\u30C9\u30ED\u30C3\u30D7\u3057\u3066\u304F\u3060\u3055\u3044",k.classList.add("small"),y.type="button",y.textContent="\u30D5\u30A1\u30A4\u30EB\u53C2\u7167",y.classList.add("sp-form-file-button"),y.addEventListener("click",()=>K.click()),K.accept=".jpg,.png,.jpeg,.webp",d.style.position="relative",d.appendChild(v)})});const Io=/^(image\/jpg|image\/jpeg|image\/png|image\/webp)$/,Fo=256;async function Pr(o,b){if(!b)throw new Error("spiral input not found");const d=Do(o)?await Oo(o):o,e=new DataTransfer;e.items.add(d),b.files=e.files,b.dispatchEvent(new Event("change"))}function Do(o){return!(!o.type.match(Io)||o.name>Fo)}function Oo(o){const b=o.name.split(".").slice(0,-1).join(".");let d=new FileReader;return new Promise((e,w)=>{d.onload=async()=>{const v=d.result,R=await No(v),K=await(await fetch(R)).blob();e(new File([K],`${b}.jpeg`,{type:"image/jpeg"}))},d.readAsDataURL(o)})}async function No(o){const b=await new Promise((v,R)=>{const K=new Image;K.onload=()=>{v(K)},K.onerror=()=>{R()},K.src=o}),d=document.createElement("canvas");let e=b.naturalWidth,w=b.naturalHeight;for(;e*w>5e5;)e/=10,w/=10;return d.width=e,d.height=w,d.getContext("2d").drawImage(b,0,0,e,w),d.toDataURL("image/jpeg")}function bn(o){o.stopPropagation(),o.preventDefault()}const Ho="modulepreload",Bo=function(o){return"/"+o},kr={},bs=function(o,b,d){let e=Promise.resolve();if(b&&b.length>0){const w=document.getElementsByTagName("link"),v=document.querySelector("meta[property=csp-nonce]"),R=(v==null?void 0:v.nonce)||(v==null?void 0:v.getAttribute("nonce"));e=Promise.all(b.map(K=>{if(K=Bo(K),K in kr)return;kr[K]=!0;const k=K.endsWith(".css"),y=k?'[rel="stylesheet"]':"";if(d)for(let G=w.length-1;G>=0;G--){const I=w[G];if(I.href===K&&(!k||I.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${K}"]${y}`))return;const g=document.createElement("link");if(g.rel=k?"stylesheet":Ho,k||(g.as="script",g.crossOrigin=""),g.href=K,R&&g.setAttribute("nonce",R),document.head.appendChild(g),k)return new Promise((G,I)=>{g.addEventListener("load",G),g.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${K}`)))})}))}return e.then(()=>o()).catch(w=>{const v=new Event("vite:preloadError",{cancelable:!0});if(v.payload=w,window.dispatchEvent(v),!v.defaultPrevented)throw w})};var $o={976:(o,b,d)=>{var le,Vt,Ds,Ce,jr,Ee,Gr,et,i,n,c,p,a,A,m,_,u,r,h,T,V,j,rt,ot,yt,qr,ut,zi,L,Sn,nt,Cn,f,z,W,lt,ft,Mt,Dt,Mn,re,he,Me,_e,zr,fe,Tn;d.d(b,{AnnotationLayer:()=>de,FreeTextAnnotationElement:()=>Ct,InkAnnotationElement:()=>gt,StampAnnotationElement:()=>ie});var e=d(292),w=d(419),v=d(792);function R(se){return Math.floor(Math.max(0,Math.min(1,se))*255).toString(16).padStart(2,"0")}function K(se){return Math.max(0,Math.min(255,255*se))}class k{static CMYK_G([F,x,J,it]){return["G",1-Math.min(1,.3*F+.59*J+.11*x+it)]}static G_CMYK([F]){return["CMYK",0,0,0,1-F]}static G_RGB([F]){return["RGB",F,F,F]}static G_rgb([F]){return F=K(F),[F,F,F]}static G_HTML([F]){const x=R(F);return`#${x}${x}${x}`}static RGB_G([F,x,J]){return["G",.3*F+.59*x+.11*J]}static RGB_rgb(F){return F.map(K)}static RGB_HTML(F){return`#${F.map(R).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([F,x,J,it]){return["RGB",1-Math.min(1,F+it),1-Math.min(1,J+it),1-Math.min(1,x+it)]}static CMYK_rgb([F,x,J,it]){return[K(1-Math.min(1,F+it)),K(1-Math.min(1,J+it)),K(1-Math.min(1,x+it))]}static CMYK_HTML(F){const x=this.CMYK_RGB(F).slice(1);return this.RGB_HTML(x)}static RGB_CMYK([F,x,J]){const it=1-F,ct=1-x,wt=1-J,bt=Math.min(it,ct,wt);return["CMYK",it,ct,wt,bt]}}var y=d(284);const g=1e3,G=9,I=new WeakSet;function E(se){return{width:se[2]-se[0],height:se[3]-se[1]}}class H{static create(F){switch(F.data.annotationType){case e.AnnotationType.LINK:return new Y(F);case e.AnnotationType.TEXT:return new at(F);case e.AnnotationType.WIDGET:switch(F.data.fieldType){case"Tx":return new M(F);case"Btn":return F.data.radioButton?new D(F):F.data.checkBox?new B(F):new q(F);case"Ch":return new tt(F);case"Sig":return new U(F)}return new Q(F);case e.AnnotationType.POPUP:return new vt(F);case e.AnnotationType.FREETEXT:return new Ct(F);case e.AnnotationType.LINE:return new Nt(F);case e.AnnotationType.SQUARE:return new _t(F);case e.AnnotationType.CIRCLE:return new Tt(F);case e.AnnotationType.POLYLINE:return new Pt(F);case e.AnnotationType.CARET:return new Z(F);case e.AnnotationType.INK:return new gt(F);case e.AnnotationType.POLYGON:return new Et(F);case e.AnnotationType.HIGHLIGHT:return new kt(F);case e.AnnotationType.UNDERLINE:return new Rt(F);case e.AnnotationType.SQUIGGLY:return new qt(F);case e.AnnotationType.STRIKEOUT:return new Kt(F);case e.AnnotationType.STAMP:return new ie(F);case e.AnnotationType.FILEATTACHMENT:return new Se(F);default:return new $(F)}}}const ve=class ve{constructor(F,{isRenderable:x=!1,ignoreBorder:J=!1,createQuadrilaterals:it=!1}={}){l(this,le,!1);this.isRenderable=x,this.data=F.data,this.layer=F.layer,this.linkService=F.linkService,this.downloadManager=F.downloadManager,this.imageResourcesPath=F.imageResourcesPath,this.renderForms=F.renderForms,this.svgFactory=F.svgFactory,this.annotationStorage=F.annotationStorage,this.enableScripting=F.enableScripting,this.hasJSActions=F.hasJSActions,this._fieldObjects=F.fieldObjects,this.parent=F.parent,x&&(this.container=this._createContainer(J)),it&&this._createQuadrilaterals()}static _hasPopupData({titleObj:F,contentsObj:x,richText:J}){return!!(F!=null&&F.str||x!=null&&x.str||J!=null&&J.str)}get hasPopupData(){return ve._hasPopupData(this.data)}_createContainer(F){const{data:x,parent:{page:J,viewport:it}}=this,ct=document.createElement("section");ct.setAttribute("data-annotation-id",x.id),this instanceof Q||(ct.tabIndex=g),ct.style.zIndex=this.parent.zIndex++,x.popupRef&&ct.setAttribute("aria-haspopup","dialog"),x.alternativeText&&(ct.title=x.alternativeText),x.noRotate&&ct.classList.add("norotate");const{pageWidth:wt,pageHeight:bt,pageX:zt,pageY:jt}=it.rawDims;if(!x.rect||this instanceof vt){const{rotation:Bt}=x;return!x.hasOwnCanvas&&Bt!==0&&this.setRotation(Bt,ct),ct}const{width:Ot,height:Yt}=E(x.rect),Ut=e.Util.normalizeRect([x.rect[0],J.view[3]-x.rect[1]+J.view[1],x.rect[2],J.view[3]-x.rect[3]+J.view[1]]);if(!F&&x.borderStyle.width>0){ct.style.borderWidth=`${x.borderStyle.width}px`;const Bt=x.borderStyle.horizontalCornerRadius,Qt=x.borderStyle.verticalCornerRadius;if(Bt>0||Qt>0){const ce=`calc(${Bt}px * var(--scale-factor)) / calc(${Qt}px * var(--scale-factor))`;ct.style.borderRadius=ce}else if(this instanceof D){const ce=`calc(${Ot}px * var(--scale-factor)) / calc(${Yt}px * var(--scale-factor))`;ct.style.borderRadius=ce}switch(x.borderStyle.style){case e.AnnotationBorderStyleType.SOLID:ct.style.borderStyle="solid";break;case e.AnnotationBorderStyleType.DASHED:ct.style.borderStyle="dashed";break;case e.AnnotationBorderStyleType.BEVELED:(0,e.warn)("Unimplemented border style: beveled");break;case e.AnnotationBorderStyleType.INSET:(0,e.warn)("Unimplemented border style: inset");break;case e.AnnotationBorderStyleType.UNDERLINE:ct.style.borderBottomStyle="solid";break}const ue=x.borderColor||null;ue?(P(this,le,!0),ct.style.borderColor=e.Util.makeHexColor(ue[0]|0,ue[1]|0,ue[2]|0)):ct.style.borderWidth=0}ct.style.left=`${100*(Ut[0]-zt)/wt}%`,ct.style.top=`${100*(Ut[1]-jt)/bt}%`;const{rotation:St}=x;return x.hasOwnCanvas||St===0?(ct.style.width=`${100*Ot/wt}%`,ct.style.height=`${100*Yt/bt}%`):this.setRotation(St,ct),ct}setRotation(F,x=this.container){if(!this.data.rect)return;const{pageWidth:J,pageHeight:it}=this.parent.viewport.rawDims,{width:ct,height:wt}=E(this.data.rect);let bt,zt;F%180===0?(bt=100*ct/J,zt=100*wt/it):(bt=100*wt/J,zt=100*ct/it),x.style.width=`${bt}%`,x.style.height=`${zt}%`,x.setAttribute("data-main-rotation",(360-F)%360)}get _commonActions(){const F=(x,J,it)=>{const ct=it.detail[x],wt=ct[0],bt=ct.slice(1);it.target.style[J]=k[`${wt}_HTML`](bt),this.annotationStorage.setValue(this.data.id,{[J]:k[`${wt}_rgb`](bt)})};return(0,e.shadow)(this,"_commonActions",{display:x=>{const{display:J}=x.detail,it=J%2===1;this.container.style.visibility=it?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:it,noPrint:J===1||J===2})},print:x=>{this.annotationStorage.setValue(this.data.id,{noPrint:!x.detail.print})},hidden:x=>{const{hidden:J}=x.detail;this.container.style.visibility=J?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:J,noView:J})},focus:x=>{setTimeout(()=>x.target.focus({preventScroll:!1}),0)},userName:x=>{x.target.title=x.detail.userName},readonly:x=>{x.target.disabled=x.detail.readonly},required:x=>{this._setRequired(x.target,x.detail.required)},bgColor:x=>{F("bgColor","backgroundColor",x)},fillColor:x=>{F("fillColor","backgroundColor",x)},fgColor:x=>{F("fgColor","color",x)},textColor:x=>{F("textColor","color",x)},borderColor:x=>{F("borderColor","borderColor",x)},strokeColor:x=>{F("strokeColor","borderColor",x)},rotation:x=>{const J=x.detail.rotation;this.setRotation(J),this.annotationStorage.setValue(this.data.id,{rotation:J})}})}_dispatchEventFromSandbox(F,x){var it;const J=this._commonActions;for(const ct of Object.keys(x.detail))(it=F[ct]||J[ct])==null||it(x)}_setDefaultPropertiesFromJS(F){if(!this.enableScripting)return;const x=this.annotationStorage.getRawValue(this.data.id);if(!x)return;const J=this._commonActions;for(const[it,ct]of Object.entries(x)){const wt=J[it];if(wt){const bt={detail:{[it]:ct},target:F};wt(bt),delete x[it]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:F}=this.data;if(!F)return;const[x,J,it,ct]=this.data.rect;if(F.length===1){const[,{x:Qt,y:ue},{x:ce,y:we}]=F[0];if(it===Qt&&ct===ue&&x===ce&&J===we)return}const{style:wt}=this.container;let bt;if(t(this,le)){const{borderColor:Qt,borderWidth:ue}=wt;wt.borderWidth=0,bt=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Qt}" stroke-width="${ue}">`],this.container.classList.add("hasBorder")}const zt=it-x,jt=ct-J,{svgFactory:Ot}=this,Yt=Ot.createElement("svg");Yt.classList.add("quadrilateralsContainer"),Yt.setAttribute("width",0),Yt.setAttribute("height",0);const Ut=Ot.createElement("defs");Yt.append(Ut);const St=Ot.createElement("clipPath"),Bt=`clippath_${this.data.id}`;St.setAttribute("id",Bt),St.setAttribute("clipPathUnits","objectBoundingBox"),Ut.append(St);for(const[,{x:Qt,y:ue},{x:ce,y:we}]of F){const Te=Ot.createElement("rect"),ts=(ce-x)/zt,We=(ct-ue)/jt,Xe=(Qt-ce)/zt,ns=(ue-we)/jt;Te.setAttribute("x",ts),Te.setAttribute("y",We),Te.setAttribute("width",Xe),Te.setAttribute("height",ns),St.append(Te),bt==null||bt.push(`<rect vector-effect="non-scaling-stroke" x="${ts}" y="${We}" width="${Xe}" height="${ns}"/>`)}t(this,le)&&(bt.push("</g></svg>')"),wt.backgroundImage=bt.join("")),this.container.append(Yt),this.container.style.clipPath=`url(#${Bt})`}_createPopup(){const{container:F,data:x}=this;F.setAttribute("aria-haspopup","dialog");const J=new vt({data:{color:x.color,titleObj:x.titleObj,modificationDate:x.modificationDate,contentsObj:x.contentsObj,richText:x.richText,parentRect:x.rect,borderStyle:0,id:`popup_${x.id}`,rotation:x.rotation},parent:this.parent,elements:[this]});this.parent.div.append(J.render())}render(){(0,e.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(F,x=null){const J=[];if(this._fieldObjects){const it=this._fieldObjects[F];if(it)for(const{page:ct,id:wt,exportValues:bt}of it){if(ct===-1||wt===x)continue;const zt=typeof bt=="string"?bt:null,jt=document.querySelector(`[data-element-id="${wt}"]`);if(jt&&!I.has(jt)){(0,e.warn)(`_getElementsByName - element not allowed: ${wt}`);continue}J.push({id:wt,exportValue:zt,domElement:jt})}return J}for(const it of document.getElementsByName(F)){const{exportValue:ct}=it,wt=it.getAttribute("data-element-id");wt!==x&&I.has(it)&&J.push({id:wt,exportValue:ct,domElement:it})}return J}show(){var F;this.container&&(this.container.hidden=!1),(F=this.popup)==null||F.maybeShow()}hide(){var F;this.container&&(this.container.hidden=!0),(F=this.popup)==null||F.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const F=this.getElementsToTriggerPopup();if(Array.isArray(F))for(const x of F)x.classList.add("highlightArea");else F.classList.add("highlightArea")}get _isEditable(){return!1}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:F,data:{id:x}}=this;this.container.addEventListener("dblclick",()=>{var J;(J=this.linkService.eventBus)==null||J.dispatch("switchannotationeditormode",{source:this,mode:F,editId:x})})}};le=new WeakMap;let $=ve;class Y extends ${constructor(x,J=null){super(x,{isRenderable:!0,ignoreBorder:!!(J!=null&&J.ignoreBorder),createQuadrilaterals:!0});l(this,Vt);l(this,Ce);l(this,Ee);this.isTooltipOnly=x.data.isTooltipOnly}render(){const{data:x,linkService:J}=this,it=document.createElement("a");it.setAttribute("data-element-id",x.id);let ct=!1;return x.url?(J.addLinkAttributes(it,x.url,x.newWindow),ct=!0):x.action?(this._bindNamedAction(it,x.action),ct=!0):x.attachment?(S(this,Ce,jr).call(this,it,x.attachment,x.attachmentDest),ct=!0):x.setOCGState?(S(this,Ee,Gr).call(this,it,x.setOCGState),ct=!0):x.dest?(this._bindLink(it,x.dest),ct=!0):(x.actions&&(x.actions.Action||x.actions["Mouse Up"]||x.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(it,x),ct=!0),x.resetForm?(this._bindResetFormAction(it,x.resetForm),ct=!0):this.isTooltipOnly&&!ct&&(this._bindLink(it,""),ct=!0)),this.container.classList.add("linkAnnotation"),ct&&this.container.append(it),this.container}_bindLink(x,J){x.href=this.linkService.getDestinationHash(J),x.onclick=()=>(J&&this.linkService.goToDestination(J),!1),(J||J==="")&&S(this,Vt,Ds).call(this)}_bindNamedAction(x,J){x.href=this.linkService.getAnchorUrl(""),x.onclick=()=>(this.linkService.executeNamedAction(J),!1),S(this,Vt,Ds).call(this)}_bindJSAction(x,J){x.href=this.linkService.getAnchorUrl("");const it=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const ct of Object.keys(J.actions)){const wt=it.get(ct);wt&&(x[wt]=()=>{var bt;return(bt=this.linkService.eventBus)==null||bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:J.id,name:ct}}),!1})}x.onclick||(x.onclick=()=>!1),S(this,Vt,Ds).call(this)}_bindResetFormAction(x,J){const it=x.onclick;if(it||(x.href=this.linkService.getAnchorUrl("")),S(this,Vt,Ds).call(this),!this._fieldObjects){(0,e.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),it||(x.onclick=()=>!1);return}x.onclick=()=>{var Yt;it==null||it();const{fields:ct,refs:wt,include:bt}=J,zt=[];if(ct.length!==0||wt.length!==0){const Ut=new Set(wt);for(const St of ct){const Bt=this._fieldObjects[St]||[];for(const{id:Qt}of Bt)Ut.add(Qt)}for(const St of Object.values(this._fieldObjects))for(const Bt of St)Ut.has(Bt.id)===bt&&zt.push(Bt)}else for(const Ut of Object.values(this._fieldObjects))zt.push(...Ut);const jt=this.annotationStorage,Ot=[];for(const Ut of zt){const{id:St}=Ut;switch(Ot.push(St),Ut.type){case"text":{const Qt=Ut.defaultValue||"";jt.setValue(St,{value:Qt});break}case"checkbox":case"radiobutton":{const Qt=Ut.defaultValue===Ut.exportValues;jt.setValue(St,{value:Qt});break}case"combobox":case"listbox":{const Qt=Ut.defaultValue||"";jt.setValue(St,{value:Qt});break}default:continue}const Bt=document.querySelector(`[data-element-id="${St}"]`);if(Bt){if(!I.has(Bt)){(0,e.warn)(`_bindResetFormAction - element not allowed: ${St}`);continue}}else continue;Bt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Yt=this.linkService.eventBus)==null||Yt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Ot,name:"ResetForm"}})),!1}}}Vt=new WeakSet,Ds=function(){this.container.setAttribute("data-internal-link","")},Ce=new WeakSet,jr=function(x,J,it=null){x.href=this.linkService.getAnchorUrl(""),x.onclick=()=>{var ct;return(ct=this.downloadManager)==null||ct.openOrDownloadData(J.content,J.filename,it),!1},S(this,Vt,Ds).call(this)},Ee=new WeakSet,Gr=function(x,J){x.href=this.linkService.getAnchorUrl(""),x.onclick=()=>(this.linkService.executeSetOCGState(J),!1),S(this,Vt,Ds).call(this)};class at extends ${constructor(F){super(F,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const F=document.createElement("img");return F.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",F.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),F.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(F),this.container}}class Q extends ${render(){return this.container}showElementAndHideCanvas(F){var x;this.data.hasOwnCanvas&&(((x=F.previousSibling)==null?void 0:x.nodeName)==="CANVAS"&&(F.previousSibling.hidden=!0),F.hidden=!1)}_getKeyModifier(F){return e.FeatureTest.platform.isMac?F.metaKey:F.ctrlKey}_setEventListener(F,x,J,it,ct){J.includes("mouse")?F.addEventListener(J,wt=>{var bt;(bt=this.linkService.eventBus)==null||bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:it,value:ct(wt),shift:wt.shiftKey,modifier:this._getKeyModifier(wt)}})}):F.addEventListener(J,wt=>{var bt;if(J==="blur"){if(!x.focused||!wt.relatedTarget)return;x.focused=!1}else if(J==="focus"){if(x.focused)return;x.focused=!0}ct&&((bt=this.linkService.eventBus)==null||bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:it,value:ct(wt)}}))})}_setEventListeners(F,x,J,it){var ct,wt,bt;for(const[zt,jt]of J)(jt==="Action"||(ct=this.data.actions)!=null&&ct[jt])&&((jt==="Focus"||jt==="Blur")&&(x||(x={focused:!1})),this._setEventListener(F,x,zt,jt,it),jt==="Focus"&&!((wt=this.data.actions)!=null&&wt.Blur)?this._setEventListener(F,x,"blur","Blur",null):jt==="Blur"&&!((bt=this.data.actions)!=null&&bt.Focus)&&this._setEventListener(F,x,"focus","Focus",null))}_setBackgroundColor(F){const x=this.data.backgroundColor||null;F.style.backgroundColor=x===null?"transparent":e.Util.makeHexColor(x[0],x[1],x[2])}_setTextStyle(F){const x=["left","center","right"],{fontColor:J}=this.data.defaultAppearanceData,it=this.data.defaultAppearanceData.fontSize||G,ct=F.style;let wt;const bt=2,zt=jt=>Math.round(10*jt)/10;if(this.data.multiLine){const jt=Math.abs(this.data.rect[3]-this.data.rect[1]-bt),Ot=Math.round(jt/(e.LINE_FACTOR*it))||1,Yt=jt/Ot;wt=Math.min(it,zt(Yt/e.LINE_FACTOR))}else{const jt=Math.abs(this.data.rect[3]-this.data.rect[1]-bt);wt=Math.min(it,zt(jt/e.LINE_FACTOR))}ct.fontSize=`calc(${wt}px * var(--scale-factor))`,ct.color=e.Util.makeHexColor(J[0],J[1],J[2]),this.data.textAlignment!==null&&(ct.textAlign=x[this.data.textAlignment])}_setRequired(F,x){x?F.setAttribute("required",!0):F.removeAttribute("required"),F.setAttribute("aria-required",x)}}class M extends Q{constructor(F){const x=F.renderForms||F.data.hasOwnCanvas||!F.data.hasAppearance&&!!F.data.fieldValue;super(F,{isRenderable:x})}setPropertyOnSiblings(F,x,J,it){const ct=this.annotationStorage;for(const wt of this._getElementsByName(F.name,F.id))wt.domElement&&(wt.domElement[x]=J),ct.setValue(wt.id,{[it]:J})}render(){var it,ct;const F=this.annotationStorage,x=this.data.id;this.container.classList.add("textWidgetAnnotation");let J=null;if(this.renderForms){const wt=F.getValue(x,{value:this.data.fieldValue});let bt=wt.value||"";const zt=F.getValue(x,{charLimit:this.data.maxLen}).charLimit;zt&&bt.length>zt&&(bt=bt.slice(0,zt));let jt=wt.formattedValue||((it=this.data.textContent)==null?void 0:it.join(`
`))||null;jt&&this.data.comb&&(jt=jt.replaceAll(/\s+/g,""));const Ot={userValue:bt,formattedValue:jt,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(J=document.createElement("textarea"),J.textContent=jt??bt,this.data.doNotScroll&&(J.style.overflowY="hidden")):(J=document.createElement("input"),J.type="text",J.setAttribute("value",jt??bt),this.data.doNotScroll&&(J.style.overflowX="hidden")),this.data.hasOwnCanvas&&(J.hidden=!0),I.add(J),J.setAttribute("data-element-id",x),J.disabled=this.data.readOnly,J.name=this.data.fieldName,J.tabIndex=g,this._setRequired(J,this.data.required),zt&&(J.maxLength=zt),J.addEventListener("input",Ut=>{F.setValue(x,{value:Ut.target.value}),this.setPropertyOnSiblings(J,"value",Ut.target.value,"value"),Ot.formattedValue=null}),J.addEventListener("resetform",Ut=>{const St=this.data.defaultFieldValue??"";J.value=Ot.userValue=St,Ot.formattedValue=null});let Yt=Ut=>{const{formattedValue:St}=Ot;St!=null&&(Ut.target.value=St),Ut.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){J.addEventListener("focus",St=>{var Qt;if(Ot.focused)return;const{target:Bt}=St;Ot.userValue&&(Bt.value=Ot.userValue),Ot.lastCommittedValue=Bt.value,Ot.commitKey=1,(Qt=this.data.actions)!=null&&Qt.Focus||(Ot.focused=!0)}),J.addEventListener("updatefromsandbox",St=>{this.showElementAndHideCanvas(St.target);const Bt={value(Qt){Ot.userValue=Qt.detail.value??"",F.setValue(x,{value:Ot.userValue.toString()}),Qt.target.value=Ot.userValue},formattedValue(Qt){const{formattedValue:ue}=Qt.detail;Ot.formattedValue=ue,ue!=null&&Qt.target!==document.activeElement&&(Qt.target.value=ue),F.setValue(x,{formattedValue:ue})},selRange(Qt){Qt.target.setSelectionRange(...Qt.detail.selRange)},charLimit:Qt=>{var Te;const{charLimit:ue}=Qt.detail,{target:ce}=Qt;if(ue===0){ce.removeAttribute("maxLength");return}ce.setAttribute("maxLength",ue);let we=Ot.userValue;!we||we.length<=ue||(we=we.slice(0,ue),ce.value=Ot.userValue=we,F.setValue(x,{value:we}),(Te=this.linkService.eventBus)==null||Te.dispatch("dispatcheventinsandbox",{source:this,detail:{id:x,name:"Keystroke",value:we,willCommit:!0,commitKey:1,selStart:ce.selectionStart,selEnd:ce.selectionEnd}}))}};this._dispatchEventFromSandbox(Bt,St)}),J.addEventListener("keydown",St=>{var ue;Ot.commitKey=1;let Bt=-1;if(St.key==="Escape"?Bt=0:St.key==="Enter"&&!this.data.multiLine?Bt=2:St.key==="Tab"&&(Ot.commitKey=3),Bt===-1)return;const{value:Qt}=St.target;Ot.lastCommittedValue!==Qt&&(Ot.lastCommittedValue=Qt,Ot.userValue=Qt,(ue=this.linkService.eventBus)==null||ue.dispatch("dispatcheventinsandbox",{source:this,detail:{id:x,name:"Keystroke",value:Qt,willCommit:!0,commitKey:Bt,selStart:St.target.selectionStart,selEnd:St.target.selectionEnd}}))});const Ut=Yt;Yt=null,J.addEventListener("blur",St=>{var Qt,ue;if(!Ot.focused||!St.relatedTarget)return;(Qt=this.data.actions)!=null&&Qt.Blur||(Ot.focused=!1);const{value:Bt}=St.target;Ot.userValue=Bt,Ot.lastCommittedValue!==Bt&&((ue=this.linkService.eventBus)==null||ue.dispatch("dispatcheventinsandbox",{source:this,detail:{id:x,name:"Keystroke",value:Bt,willCommit:!0,commitKey:Ot.commitKey,selStart:St.target.selectionStart,selEnd:St.target.selectionEnd}})),Ut(St)}),(ct=this.data.actions)!=null&&ct.Keystroke&&J.addEventListener("beforeinput",St=>{var We;Ot.lastCommittedValue=null;const{data:Bt,target:Qt}=St,{value:ue,selectionStart:ce,selectionEnd:we}=Qt;let Te=ce,ts=we;switch(St.inputType){case"deleteWordBackward":{const Xe=ue.substring(0,ce).match(/\w*[^\w]*$/);Xe&&(Te-=Xe[0].length);break}case"deleteWordForward":{const Xe=ue.substring(ce).match(/^[^\w]*\w*/);Xe&&(ts+=Xe[0].length);break}case"deleteContentBackward":ce===we&&(Te-=1);break;case"deleteContentForward":ce===we&&(ts+=1);break}St.preventDefault(),(We=this.linkService.eventBus)==null||We.dispatch("dispatcheventinsandbox",{source:this,detail:{id:x,name:"Keystroke",value:ue,change:Bt||"",willCommit:!1,selStart:Te,selEnd:ts}})}),this._setEventListeners(J,Ot,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],St=>St.target.value)}if(Yt&&J.addEventListener("blur",Yt),this.data.comb){const Ut=(this.data.rect[2]-this.data.rect[0])/zt;J.classList.add("comb"),J.style.letterSpacing=`calc(${Ut}px * var(--scale-factor) - 1ch)`}}else J=document.createElement("div"),J.textContent=this.data.fieldValue,J.style.verticalAlign="middle",J.style.display="table-cell",this.data.hasOwnCanvas&&(J.hidden=!0);return this._setTextStyle(J),this._setBackgroundColor(J),this._setDefaultPropertiesFromJS(J),this.container.append(J),this.container}}class U extends Q{constructor(F){super(F,{isRenderable:!!F.data.hasOwnCanvas})}}class B extends Q{constructor(F){super(F,{isRenderable:F.renderForms})}render(){const F=this.annotationStorage,x=this.data,J=x.id;let it=F.getValue(J,{value:x.exportValue===x.fieldValue}).value;typeof it=="string"&&(it=it!=="Off",F.setValue(J,{value:it})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const ct=document.createElement("input");return I.add(ct),ct.setAttribute("data-element-id",J),ct.disabled=x.readOnly,this._setRequired(ct,this.data.required),ct.type="checkbox",ct.name=x.fieldName,it&&ct.setAttribute("checked",!0),ct.setAttribute("exportValue",x.exportValue),ct.tabIndex=g,ct.addEventListener("change",wt=>{const{name:bt,checked:zt}=wt.target;for(const jt of this._getElementsByName(bt,J)){const Ot=zt&&jt.exportValue===x.exportValue;jt.domElement&&(jt.domElement.checked=Ot),F.setValue(jt.id,{value:Ot})}F.setValue(J,{value:zt})}),ct.addEventListener("resetform",wt=>{const bt=x.defaultFieldValue||"Off";wt.target.checked=bt===x.exportValue}),this.enableScripting&&this.hasJSActions&&(ct.addEventListener("updatefromsandbox",wt=>{const bt={value(zt){zt.target.checked=zt.detail.value!=="Off",F.setValue(J,{value:zt.target.checked})}};this._dispatchEventFromSandbox(bt,wt)}),this._setEventListeners(ct,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],wt=>wt.target.checked)),this._setBackgroundColor(ct),this._setDefaultPropertiesFromJS(ct),this.container.append(ct),this.container}}class D extends Q{constructor(F){super(F,{isRenderable:F.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const F=this.annotationStorage,x=this.data,J=x.id;let it=F.getValue(J,{value:x.fieldValue===x.buttonValue}).value;if(typeof it=="string"&&(it=it!==x.buttonValue,F.setValue(J,{value:it})),it)for(const wt of this._getElementsByName(x.fieldName,J))F.setValue(wt.id,{value:!1});const ct=document.createElement("input");if(I.add(ct),ct.setAttribute("data-element-id",J),ct.disabled=x.readOnly,this._setRequired(ct,this.data.required),ct.type="radio",ct.name=x.fieldName,it&&ct.setAttribute("checked",!0),ct.tabIndex=g,ct.addEventListener("change",wt=>{const{name:bt,checked:zt}=wt.target;for(const jt of this._getElementsByName(bt,J))F.setValue(jt.id,{value:!1});F.setValue(J,{value:zt})}),ct.addEventListener("resetform",wt=>{const bt=x.defaultFieldValue;wt.target.checked=bt!=null&&bt===x.buttonValue}),this.enableScripting&&this.hasJSActions){const wt=x.buttonValue;ct.addEventListener("updatefromsandbox",bt=>{const zt={value:jt=>{const Ot=wt===jt.detail.value;for(const Yt of this._getElementsByName(jt.target.name)){const Ut=Ot&&Yt.id===J;Yt.domElement&&(Yt.domElement.checked=Ut),F.setValue(Yt.id,{value:Ut})}}};this._dispatchEventFromSandbox(zt,bt)}),this._setEventListeners(ct,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],bt=>bt.target.checked)}return this._setBackgroundColor(ct),this._setDefaultPropertiesFromJS(ct),this.container.append(ct),this.container}}class q extends Y{constructor(F){super(F,{ignoreBorder:F.data.hasAppearance})}render(){const F=super.render();F.classList.add("buttonWidgetAnnotation","pushButton");const x=F.lastChild;return this.enableScripting&&this.hasJSActions&&x&&(this._setDefaultPropertiesFromJS(x),x.addEventListener("updatefromsandbox",J=>{this._dispatchEventFromSandbox({},J)})),F}}class tt extends Q{constructor(F){super(F,{isRenderable:F.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const F=this.annotationStorage,x=this.data.id,J=F.getValue(x,{value:this.data.fieldValue}),it=document.createElement("select");I.add(it),it.setAttribute("data-element-id",x),it.disabled=this.data.readOnly,this._setRequired(it,this.data.required),it.name=this.data.fieldName,it.tabIndex=g;let ct=this.data.combo&&this.data.options.length>0;this.data.combo||(it.size=this.data.options.length,this.data.multiSelect&&(it.multiple=!0)),it.addEventListener("resetform",Ot=>{const Yt=this.data.defaultFieldValue;for(const Ut of it.options)Ut.selected=Ut.value===Yt});for(const Ot of this.data.options){const Yt=document.createElement("option");Yt.textContent=Ot.displayValue,Yt.value=Ot.exportValue,J.value.includes(Ot.exportValue)&&(Yt.setAttribute("selected",!0),ct=!1),it.append(Yt)}let wt=null;if(ct){const Ot=document.createElement("option");Ot.value=" ",Ot.setAttribute("hidden",!0),Ot.setAttribute("selected",!0),it.prepend(Ot),wt=()=>{Ot.remove(),it.removeEventListener("input",wt),wt=null},it.addEventListener("input",wt)}const bt=Ot=>{const Yt=Ot?"value":"textContent",{options:Ut,multiple:St}=it;return St?Array.prototype.filter.call(Ut,Bt=>Bt.selected).map(Bt=>Bt[Yt]):Ut.selectedIndex===-1?null:Ut[Ut.selectedIndex][Yt]};let zt=bt(!1);const jt=Ot=>{const Yt=Ot.target.options;return Array.prototype.map.call(Yt,Ut=>({displayValue:Ut.textContent,exportValue:Ut.value}))};return this.enableScripting&&this.hasJSActions?(it.addEventListener("updatefromsandbox",Ot=>{const Yt={value(Ut){wt==null||wt();const St=Ut.detail.value,Bt=new Set(Array.isArray(St)?St:[St]);for(const Qt of it.options)Qt.selected=Bt.has(Qt.value);F.setValue(x,{value:bt(!0)}),zt=bt(!1)},multipleSelection(Ut){it.multiple=!0},remove(Ut){const St=it.options,Bt=Ut.detail.remove;St[Bt].selected=!1,it.remove(Bt),St.length>0&&Array.prototype.findIndex.call(St,Qt=>Qt.selected)===-1&&(St[0].selected=!0),F.setValue(x,{value:bt(!0),items:jt(Ut)}),zt=bt(!1)},clear(Ut){for(;it.length!==0;)it.remove(0);F.setValue(x,{value:null,items:[]}),zt=bt(!1)},insert(Ut){const{index:St,displayValue:Bt,exportValue:Qt}=Ut.detail.insert,ue=it.children[St],ce=document.createElement("option");ce.textContent=Bt,ce.value=Qt,ue?ue.before(ce):it.append(ce),F.setValue(x,{value:bt(!0),items:jt(Ut)}),zt=bt(!1)},items(Ut){const{items:St}=Ut.detail;for(;it.length!==0;)it.remove(0);for(const Bt of St){const{displayValue:Qt,exportValue:ue}=Bt,ce=document.createElement("option");ce.textContent=Qt,ce.value=ue,it.append(ce)}it.options.length>0&&(it.options[0].selected=!0),F.setValue(x,{value:bt(!0),items:jt(Ut)}),zt=bt(!1)},indices(Ut){const St=new Set(Ut.detail.indices);for(const Bt of Ut.target.options)Bt.selected=St.has(Bt.index);F.setValue(x,{value:bt(!0)}),zt=bt(!1)},editable(Ut){Ut.target.disabled=!Ut.detail.editable}};this._dispatchEventFromSandbox(Yt,Ot)}),it.addEventListener("input",Ot=>{var Ut;const Yt=bt(!0);F.setValue(x,{value:Yt}),Ot.preventDefault(),(Ut=this.linkService.eventBus)==null||Ut.dispatch("dispatcheventinsandbox",{source:this,detail:{id:x,name:"Keystroke",value:zt,changeEx:Yt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(it,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Ot=>Ot.target.value)):it.addEventListener("input",function(Ot){F.setValue(x,{value:bt(!0)})}),this.data.combo&&this._setTextStyle(it),this._setBackgroundColor(it),this._setDefaultPropertiesFromJS(it),this.container.append(it),this.container}}class vt extends ${constructor(F){const{data:x,elements:J}=F;super(F,{isRenderable:$._hasPopupData(x)}),this.elements=J}render(){this.container.classList.add("popupAnnotation");const F=new Ft({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),x=[];for(const J of this.elements)J.popup=F,x.push(J.data.id),J.addHighlightArea();return this.container.setAttribute("aria-controls",x.map(J=>`${e.AnnotationPrefix}${J}`).join(",")),this.container}}class Ft{constructor({container:F,color:x,elements:J,titleObj:it,modificationDate:ct,contentsObj:wt,richText:bt,parent:zt,rect:jt,parentRect:Ot,open:Yt}){l(this,yt);l(this,ut);l(this,L);l(this,nt);l(this,et,S(this,yt,qr).bind(this));l(this,i,S(this,nt,Cn).bind(this));l(this,n,S(this,L,Sn).bind(this));l(this,c,S(this,ut,zi).bind(this));l(this,p,null);l(this,a,null);l(this,A,null);l(this,m,null);l(this,_,null);l(this,u,null);l(this,r,null);l(this,h,!1);l(this,T,null);l(this,V,null);l(this,j,null);l(this,rt,null);l(this,ot,!1);var Ut;P(this,a,F),P(this,rt,it),P(this,A,wt),P(this,j,bt),P(this,u,zt),P(this,p,x),P(this,V,jt),P(this,r,Ot),P(this,_,J),P(this,m,w.PDFDateString.toDateObject(ct)),this.trigger=J.flatMap(St=>St.getElementsToTriggerPopup());for(const St of this.trigger)St.addEventListener("click",t(this,c)),St.addEventListener("mouseenter",t(this,n)),St.addEventListener("mouseleave",t(this,i)),St.classList.add("popupTriggerArea");for(const St of J)(Ut=St.container)==null||Ut.addEventListener("keydown",t(this,et));t(this,a).hidden=!0,Yt&&S(this,ut,zi).call(this)}render(){if(t(this,T))return;const{page:{view:F},viewport:{rawDims:{pageWidth:x,pageHeight:J,pageX:it,pageY:ct}}}=t(this,u),wt=P(this,T,document.createElement("div"));if(wt.className="popup",t(this,p)){const we=wt.style.outlineColor=e.Util.makeHexColor(...t(this,p));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?wt.style.backgroundColor=`color-mix(in srgb, ${we} 30%, white)`:wt.style.backgroundColor=e.Util.makeHexColor(...t(this,p).map(Te=>Math.floor(.7*(255-Te)+Te)))}const bt=document.createElement("span");bt.className="header";const zt=document.createElement("h1");if(bt.append(zt),{dir:zt.dir,str:zt.textContent}=t(this,rt),wt.append(bt),t(this,m)){const we=document.createElement("span");we.classList.add("popupDate"),we.setAttribute("data-l10n-id","pdfjs-annotation-date-string"),we.setAttribute("data-l10n-args",JSON.stringify({date:t(this,m).toLocaleDateString(),time:t(this,m).toLocaleTimeString()})),bt.append(we)}const jt=t(this,A),Ot=t(this,j);if(Ot!=null&&Ot.str&&(!(jt!=null&&jt.str)||jt.str===Ot.str))y.XfaLayer.render({xfaHtml:Ot.html,intent:"richText",div:wt}),wt.lastChild.classList.add("richText","popupContent");else{const we=this._formatContents(jt);wt.append(we)}let Yt=!!t(this,r),Ut=Yt?t(this,r):t(this,V);for(const we of t(this,_))if(!Ut||e.Util.intersect(we.data.rect,Ut)!==null){Ut=we.data.rect,Yt=!0;break}const St=e.Util.normalizeRect([Ut[0],F[3]-Ut[1]+F[1],Ut[2],F[3]-Ut[3]+F[1]]),Bt=Yt?Ut[2]-Ut[0]+5:0,Qt=St[0]+Bt,ue=St[1],{style:ce}=t(this,a);ce.left=`${100*(Qt-it)/x}%`,ce.top=`${100*(ue-ct)/J}%`,t(this,a).append(wt)}_formatContents({str:F,dir:x}){const J=document.createElement("p");J.classList.add("popupContent"),J.dir=x;const it=F.split(/(?:\r\n?|\n)/);for(let ct=0,wt=it.length;ct<wt;++ct){const bt=it[ct];J.append(document.createTextNode(bt)),ct<wt-1&&J.append(document.createElement("br"))}return J}forceHide(){P(this,ot,this.isVisible),t(this,ot)&&(t(this,a).hidden=!0)}maybeShow(){t(this,ot)&&(P(this,ot,!1),t(this,a).hidden=!1)}get isVisible(){return t(this,a).hidden===!1}}et=new WeakMap,i=new WeakMap,n=new WeakMap,c=new WeakMap,p=new WeakMap,a=new WeakMap,A=new WeakMap,m=new WeakMap,_=new WeakMap,u=new WeakMap,r=new WeakMap,h=new WeakMap,T=new WeakMap,V=new WeakMap,j=new WeakMap,rt=new WeakMap,ot=new WeakMap,yt=new WeakSet,qr=function(F){F.altKey||F.shiftKey||F.ctrlKey||F.metaKey||(F.key==="Enter"||F.key==="Escape"&&t(this,h))&&S(this,ut,zi).call(this)},ut=new WeakSet,zi=function(){P(this,h,!t(this,h)),t(this,h)?(S(this,L,Sn).call(this),t(this,a).addEventListener("click",t(this,c)),t(this,a).addEventListener("keydown",t(this,et))):(S(this,nt,Cn).call(this),t(this,a).removeEventListener("click",t(this,c)),t(this,a).removeEventListener("keydown",t(this,et)))},L=new WeakSet,Sn=function(){t(this,T)||this.render(),this.isVisible?t(this,h)&&t(this,a).classList.add("focused"):(t(this,a).hidden=!1,t(this,a).style.zIndex=parseInt(t(this,a).style.zIndex)+1e3)},nt=new WeakSet,Cn=function(){t(this,a).classList.remove("focused"),!(t(this,h)||!this.isVisible)&&(t(this,a).hidden=!0,t(this,a).style.zIndex=parseInt(t(this,a).style.zIndex)-1e3)};class Ct extends ${constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0}),this.textContent=F.data.textContent,this.textPosition=F.data.textPosition,this.annotationEditorType=e.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const F=document.createElement("div");F.classList.add("annotationTextContent"),F.setAttribute("role","comment");for(const x of this.textContent){const J=document.createElement("span");J.textContent=x,F.append(J)}this.container.append(F)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}get _isEditable(){return this.data.hasOwnCanvas}}class Nt extends ${constructor(x){super(x,{isRenderable:!0,ignoreBorder:!0});l(this,f,null)}render(){this.container.classList.add("lineAnnotation");const x=this.data,{width:J,height:it}=E(x.rect),ct=this.svgFactory.create(J,it,!0),wt=P(this,f,this.svgFactory.createElement("svg:line"));return wt.setAttribute("x1",x.rect[2]-x.lineCoordinates[0]),wt.setAttribute("y1",x.rect[3]-x.lineCoordinates[1]),wt.setAttribute("x2",x.rect[2]-x.lineCoordinates[2]),wt.setAttribute("y2",x.rect[3]-x.lineCoordinates[3]),wt.setAttribute("stroke-width",x.borderStyle.width||1),wt.setAttribute("stroke","transparent"),wt.setAttribute("fill","transparent"),ct.append(wt),this.container.append(ct),!x.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,f)}addHighlightArea(){this.container.classList.add("highlightArea")}}f=new WeakMap;class _t extends ${constructor(x){super(x,{isRenderable:!0,ignoreBorder:!0});l(this,z,null)}render(){this.container.classList.add("squareAnnotation");const x=this.data,{width:J,height:it}=E(x.rect),ct=this.svgFactory.create(J,it,!0),wt=x.borderStyle.width,bt=P(this,z,this.svgFactory.createElement("svg:rect"));return bt.setAttribute("x",wt/2),bt.setAttribute("y",wt/2),bt.setAttribute("width",J-wt),bt.setAttribute("height",it-wt),bt.setAttribute("stroke-width",wt||1),bt.setAttribute("stroke","transparent"),bt.setAttribute("fill","transparent"),ct.append(bt),this.container.append(ct),!x.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,z)}addHighlightArea(){this.container.classList.add("highlightArea")}}z=new WeakMap;class Tt extends ${constructor(x){super(x,{isRenderable:!0,ignoreBorder:!0});l(this,W,null)}render(){this.container.classList.add("circleAnnotation");const x=this.data,{width:J,height:it}=E(x.rect),ct=this.svgFactory.create(J,it,!0),wt=x.borderStyle.width,bt=P(this,W,this.svgFactory.createElement("svg:ellipse"));return bt.setAttribute("cx",J/2),bt.setAttribute("cy",it/2),bt.setAttribute("rx",J/2-wt/2),bt.setAttribute("ry",it/2-wt/2),bt.setAttribute("stroke-width",wt||1),bt.setAttribute("stroke","transparent"),bt.setAttribute("fill","transparent"),ct.append(bt),this.container.append(ct),!x.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,W)}addHighlightArea(){this.container.classList.add("highlightArea")}}W=new WeakMap;class Pt extends ${constructor(x){super(x,{isRenderable:!0,ignoreBorder:!0});l(this,lt,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const x=this.data,{width:J,height:it}=E(x.rect),ct=this.svgFactory.create(J,it,!0);let wt=[];for(const zt of x.vertices){const jt=zt.x-x.rect[0],Ot=x.rect[3]-zt.y;wt.push(jt+","+Ot)}wt=wt.join(" ");const bt=P(this,lt,this.svgFactory.createElement(this.svgElementName));return bt.setAttribute("points",wt),bt.setAttribute("stroke-width",x.borderStyle.width||1),bt.setAttribute("stroke","transparent"),bt.setAttribute("fill","transparent"),ct.append(bt),this.container.append(ct),!x.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,lt)}addHighlightArea(){this.container.classList.add("highlightArea")}}lt=new WeakMap;class Et extends Pt{constructor(F){super(F),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Z extends ${constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class gt extends ${constructor(x){super(x,{isRenderable:!0,ignoreBorder:!0});l(this,ft,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=e.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const x=this.data,{width:J,height:it}=E(x.rect),ct=this.svgFactory.create(J,it,!0);for(const wt of x.inkLists){let bt=[];for(const jt of wt){const Ot=jt.x-x.rect[0],Yt=x.rect[3]-jt.y;bt.push(`${Ot},${Yt}`)}bt=bt.join(" ");const zt=this.svgFactory.createElement(this.svgElementName);t(this,ft).push(zt),zt.setAttribute("points",bt),zt.setAttribute("stroke-width",x.borderStyle.width||1),zt.setAttribute("stroke","transparent"),zt.setAttribute("fill","transparent"),!x.popupRef&&this.hasPopupData&&this._createPopup(),ct.append(zt)}return this.container.append(ct),this.container}getElementsToTriggerPopup(){return t(this,ft)}addHighlightArea(){this.container.classList.add("highlightArea")}}ft=new WeakMap;class kt extends ${constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class Rt extends ${constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class qt extends ${constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Kt extends ${constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class ie extends ${constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Se extends ${constructor(x){var ct;super(x,{isRenderable:!0});l(this,Dt);l(this,Mt,null);const{filename:J,content:it}=this.data.file;this.filename=(0,w.getFilenameFromUrl)(J,!0),this.content=it,(ct=this.linkService.eventBus)==null||ct.dispatch("fileattachmentannotation",{source:this,filename:J,content:it})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:x,data:J}=this;let it;J.hasAppearance||J.fillAlpha===0?it=document.createElement("div"):(it=document.createElement("img"),it.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(J.name)?"paperclip":"pushpin"}.svg`,J.fillAlpha&&J.fillAlpha<1&&(it.style=`filter: opacity(${Math.round(J.fillAlpha*100)}%);`)),it.addEventListener("dblclick",S(this,Dt,Mn).bind(this)),P(this,Mt,it);const{isMac:ct}=e.FeatureTest.platform;return x.addEventListener("keydown",wt=>{wt.key==="Enter"&&(ct?wt.metaKey:wt.ctrlKey)&&S(this,Dt,Mn).call(this)}),!J.popupRef&&this.hasPopupData?this._createPopup():it.classList.add("popupTriggerArea"),x.append(it),x}getElementsToTriggerPopup(){return t(this,Mt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Mt=new WeakMap,Dt=new WeakSet,Mn=function(){var x;(x=this.downloadManager)==null||x.openOrDownloadData(this.content,this.filename)};class de{constructor({div:F,accessibilityManager:x,annotationCanvasMap:J,page:it,viewport:ct}){l(this,_e);l(this,fe);l(this,re,null);l(this,he,null);l(this,Me,new Map);this.div=F,P(this,re,x),P(this,he,J),this.page=it,this.viewport=ct,this.zIndex=0}async render(F){const{annotations:x}=F,J=this.div;(0,w.setLayerDimensions)(J,this.viewport);const it=new Map,ct={data:null,layer:J,linkService:F.linkService,downloadManager:F.downloadManager,imageResourcesPath:F.imageResourcesPath||"",renderForms:F.renderForms!==!1,svgFactory:new w.DOMSVGFactory,annotationStorage:F.annotationStorage||new v.AnnotationStorage,enableScripting:F.enableScripting===!0,hasJSActions:F.hasJSActions,fieldObjects:F.fieldObjects,parent:this,elements:null};for(const wt of x){if(wt.noHTML)continue;const bt=wt.annotationType===e.AnnotationType.POPUP;if(bt){const Ot=it.get(wt.id);if(!Ot)continue;ct.elements=Ot}else{const{width:Ot,height:Yt}=E(wt.rect);if(Ot<=0||Yt<=0)continue}ct.data=wt;const zt=H.create(ct);if(!zt.isRenderable)continue;if(!bt&&wt.popupRef){const Ot=it.get(wt.popupRef);Ot?Ot.push(zt):it.set(wt.popupRef,[zt])}zt.annotationEditorType>0&&t(this,Me).set(zt.data.id,zt);const jt=zt.render();wt.hidden&&(jt.style.visibility="hidden"),S(this,_e,zr).call(this,jt,wt.id)}S(this,fe,Tn).call(this)}update({viewport:F}){const x=this.div;this.viewport=F,(0,w.setLayerDimensions)(x,{rotation:F.rotation}),S(this,fe,Tn).call(this),x.hidden=!1}getEditableAnnotations(){return Array.from(t(this,Me).values())}getEditableAnnotation(F){return t(this,Me).get(F)}}re=new WeakMap,he=new WeakMap,Me=new WeakMap,_e=new WeakSet,zr=function(F,x){var it;const J=F.firstChild||F;J.id=`${e.AnnotationPrefix}${x}`,this.div.append(F),(it=t(this,re))==null||it.moveElementInDOM(this.div,F,J,!1)},fe=new WeakSet,Tn=function(){if(!t(this,he))return;const F=this.div;for(const[x,J]of t(this,he)){const it=F.querySelector(`[data-annotation-id="${x}"]`);if(!it)continue;const{firstChild:ct}=it;ct?ct.nodeName==="CANVAS"?ct.replaceWith(J):ct.before(J):it.append(J)}t(this,he).clear()}},792:(o,b,d)=>{var y,g,G,Wr,E;d.d(b,{AnnotationStorage:()=>K,PrintAnnotationStorage:()=>k,SerializableEmpty:()=>R});var e=d(292),w=d(310),v=d(651);const R=Object.freeze({map:null,hash:"",transfer:void 0});class K{constructor(){l(this,G);l(this,y,!1);l(this,g,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue($,Y){const at=t(this,g).get($);return at===void 0?Y:Object.assign(Y,at)}getRawValue($){return t(this,g).get($)}remove($){if(t(this,g).delete($),t(this,g).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const Y of t(this,g).values())if(Y instanceof w.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue($,Y){const at=t(this,g).get($);let Q=!1;if(at!==void 0)for(const[M,U]of Object.entries(Y))at[M]!==U&&(Q=!0,at[M]=U);else Q=!0,t(this,g).set($,Y);Q&&S(this,G,Wr).call(this),Y instanceof w.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(Y.constructor._type)}has($){return t(this,g).has($)}getAll(){return t(this,g).size>0?(0,e.objectFromMap)(t(this,g)):null}setAll($){for(const[Y,at]of Object.entries($))this.setValue(Y,at)}get size(){return t(this,g).size}resetModified(){t(this,y)&&(P(this,y,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new k(this)}get serializable(){if(t(this,g).size===0)return R;const $=new Map,Y=new v.MurmurHash3_64,at=[],Q=Object.create(null);let M=!1;for(const[U,B]of t(this,g)){const D=B instanceof w.AnnotationEditor?B.serialize(!1,Q):B;D&&($.set(U,D),Y.update(`${U}:${JSON.stringify(D)}`),M||(M=!!D.bitmap))}if(M)for(const U of $.values())U.bitmap&&at.push(U.bitmap);return $.size>0?{map:$,hash:Y.hexdigest(),transfer:at}:R}get editorStats(){let $=null;const Y=new Map;for(const at of t(this,g).values()){if(!(at instanceof w.AnnotationEditor))continue;const Q=at.telemetryFinalData;if(!Q)continue;const{type:M}=Q;Y.has(M)||Y.set(M,Object.getPrototypeOf(at).constructor),$||($=Object.create(null));const U=$[M]||($[M]=new Map);for(const[B,D]of Object.entries(Q)){if(B==="type")continue;let q=U.get(B);q||(q=new Map,U.set(B,q));const tt=q.get(D)??0;q.set(D,tt+1)}}for(const[at,Q]of Y)$[at]=Q.computeTelemetryFinalData($[at]);return $}}y=new WeakMap,g=new WeakMap,G=new WeakSet,Wr=function(){t(this,y)||(P(this,y,!0),typeof this.onSetModified=="function"&&this.onSetModified())};class k extends K{constructor(Y){super();l(this,E,void 0);const{map:at,hash:Q,transfer:M}=Y.serializable,U=structuredClone(at,M?{transfer:M}:null);P(this,E,{map:U,hash:Q,transfer:M})}get print(){(0,e.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,E)}}E=new WeakMap},831:(o,b,d)=>{d.a(o,async(e,w)=>{var D,q,tt,vt,Ys,Ct,Wi,_t,Tt,Pt,Et,Z,Xi,kt,Rt,qt,Kt,ie,bi,de,le,Ln,Vt,ae;try{let Ce=function(N){if(typeof N=="string"||N instanceof URL?N={url:N}:(N instanceof ArrayBuffer||ArrayBuffer.isView(N))&&(N={data:N}),typeof N!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!N.url&&!N.data&&!N.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const f=new m,{docId:z}=f,W=N.url?ee(N.url):null,lt=N.data?Ee(N.data):null,ft=N.httpHeaders||null,Mt=N.withCredentials===!0,Dt=N.password??null,te=N.range instanceof _?N.range:null,re=Number.isInteger(N.rangeChunkSize)&&N.rangeChunkSize>0?N.rangeChunkSize:ne;let he=N.worker instanceof V?N.worker:null;const Me=N.verbosity,_e=typeof N.docBaseUrl=="string"&&!(0,K.isDataScheme)(N.docBaseUrl)?N.docBaseUrl:null,Fe=typeof N.cMapUrl=="string"?N.cMapUrl:null,fe=N.cMapPacked!==!1,Pe=N.CMapReaderFactory||c,se=typeof N.standardFontDataUrl=="string"?N.standardFontDataUrl:null,F=N.StandardFontDataFactory||a,x=N.stopAtErrors!==!0,J=Number.isInteger(N.maxImageSize)&&N.maxImageSize>-1?N.maxImageSize:-1,it=N.isEvalSupported!==!1,ct=typeof N.isOffscreenCanvasSupported=="boolean"?N.isOffscreenCanvasSupported:!v.isNodeJS,wt=Number.isInteger(N.canvasMaxAreaInBytes)?N.canvasMaxAreaInBytes:-1,bt=typeof N.disableFontFace=="boolean"?N.disableFontFace:v.isNodeJS,zt=N.fontExtraProperties===!0,jt=N.enableXfa===!0,Ot=N.ownerDocument||globalThis.document,Yt=N.disableRange===!0,Ut=N.disableStream===!0,St=N.disableAutoFetch===!0,Bt=N.pdfBug===!0,Qt=te?te.length:N.length??NaN,ue=typeof N.useSystemFonts=="boolean"?N.useSystemFonts:!v.isNodeJS&&!bt,ce=typeof N.useWorkerFetch=="boolean"?N.useWorkerFetch:Pe===K.DOMCMapReaderFactory&&F===K.DOMStandardFontDataFactory&&Fe&&se&&(0,K.isValidFetchUrl)(Fe,document.baseURI)&&(0,K.isValidFetchUrl)(se,document.baseURI),we=N.canvasFactory||new n({ownerDocument:Ot}),Te=N.filterFactory||new p({docId:z,ownerDocument:Ot}),ts=null;(0,v.setVerbosityLevel)(Me);const We={canvasFactory:we,filterFactory:Te};if(ce||(We.cMapReaderFactory=new Pe({baseUrl:Fe,isCompressed:fe}),We.standardFontDataFactory=new F({baseUrl:se})),!he){const Ve={verbosity:Me,port:I.GlobalWorkerOptions.workerPort};he=Ve.port?V.fromPort(Ve):new V(Ve),f._worker=he}const Xe={docId:z,apiVersion:"4.1.392",data:lt,password:Dt,disableAutoFetch:St,rangeChunkSize:re,length:Qt,docBaseUrl:_e,enableXfa:jt,evaluatorOptions:{maxImageSize:J,disableFontFace:bt,ignoreErrors:x,isEvalSupported:it,isOffscreenCanvasSupported:ct,canvasMaxAreaInBytes:wt,fontExtraProperties:zt,useSystemFonts:ue,cMapUrl:ce?Fe:null,standardFontDataUrl:ce?se:null}},ns={ignoreErrors:x,isEvalSupported:it,disableFontFace:bt,fontExtraProperties:zt,enableXfa:jt,ownerDocument:Ot,disableAutoFetch:St,pdfBug:Bt,styleElement:ts};return he.promise.then(function(){if(f.destroyed)throw new Error("Loading aborted");const Ve=A(he,Xe),O=new Promise(function(dt){let Ht;te?Ht=new Y.PDFDataTransportStream(te,{disableRange:Yt,disableStream:Ut}):lt||(Ht=($t=>v.isNodeJS?function(){return typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype}()&&(0,K.isValidFetchUrl)($t.url)?new at.PDFFetchStream($t):new M.PDFNodeStream($t):(0,K.isValidFetchUrl)($t.url)?new at.PDFFetchStream($t):new Q.PDFNetworkStream($t))({url:W,length:Qt,httpHeaders:ft,withCredentials:Mt,rangeChunkSize:re,disableRange:Yt,disableStream:Ut})),dt(Ht)});return Promise.all([Ve,O]).then(function([dt,Ht]){if(f.destroyed)throw new Error("Loading aborted");const $t=new E.MessageHandler(z,dt,he.port),Jt=new j($t,f,Ht,ns,We);f._transport=Jt,$t.send("Ready",null)})}).catch(f._capability.reject),f},ee=function(N){if(N instanceof URL)return N.href;try{return new URL(N,window.location).href}catch{if(v.isNodeJS&&typeof N=="string")return N}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")},Ee=function(N){if(v.isNodeJS&&typeof Buffer<"u"&&N instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(N instanceof Uint8Array&&N.byteLength===N.buffer.byteLength)return N;if(typeof N=="string")return(0,v.stringToBytes)(N);if(N instanceof ArrayBuffer||ArrayBuffer.isView(N)||typeof N=="object"&&!isNaN(N==null?void 0:N.length))return new Uint8Array(N);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")};d.d(b,{PDFDataRangeTransport:()=>_,PDFWorker:()=>V,build:()=>xt,getDocument:()=>Ce,version:()=>ut});var v=d(292),R=d(792),K=d(419),k=d(10),y=d(573),g=d(923),G=d(814),I=d(164),E=d(178),H=d(62),$=d(626),Y=d(585),at=d(94),Q=d(457),M=d(786),U=d(50),B=e([y,M]);[y,M]=B.then?(await B)():B;const ne=65536,et=100,i=5e3,n=v.isNodeJS?y.NodeCanvasFactory:K.DOMCanvasFactory,c=v.isNodeJS?y.NodeCMapReaderFactory:K.DOMCMapReaderFactory,p=v.isNodeJS?y.NodeFilterFactory:K.DOMFilterFactory,a=v.isNodeJS?y.NodeStandardFontDataFactory:K.DOMStandardFontDataFactory;async function A(N,f){if(N.destroyed)throw new Error("Worker was destroyed");const z=await N.messageHandler.sendWithPromise("GetDocRequest",f,f.data?[f.data.buffer]:null);if(N.destroyed)throw new Error("Worker was destroyed");return z}const L=class L{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${vs(L,D)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var f,z,W;this.destroyed=!0;try{(f=this._worker)!=null&&f.port&&(this._worker._pendingDestroy=!0),await((z=this._transport)==null?void 0:z.destroy())}catch(lt){throw(W=this._worker)!=null&&W.port&&delete this._worker._pendingDestroy,lt}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};D=new WeakMap,l(L,D,0);let m=L;class _{constructor(f,z,W=!1,lt=null){this.length=f,this.initialData=z,this.progressiveDone=W,this.contentDispositionFilename=lt,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(f){this._rangeListeners.push(f)}addProgressListener(f){this._progressListeners.push(f)}addProgressiveReadListener(f){this._progressiveReadListeners.push(f)}addProgressiveDoneListener(f){this._progressiveDoneListeners.push(f)}onDataRange(f,z){for(const W of this._rangeListeners)W(f,z)}onDataProgress(f,z){this._readyCapability.promise.then(()=>{for(const W of this._progressListeners)W(f,z)})}onDataProgressiveRead(f){this._readyCapability.promise.then(()=>{for(const z of this._progressiveReadListeners)z(f)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const f of this._progressiveDoneListeners)f()})}transportReady(){this._readyCapability.resolve()}requestDataRange(f,z){(0,v.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class u{constructor(f,z){this._pdfInfo=f,this._transport=z}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,v.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(f){return this._transport.getPage(f)}getPageIndex(f){return this._transport.getPageIndex(f)}getDestinations(){return this._transport.getDestinations()}getDestination(f){return this._transport.getDestination(f)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:f="display"}={}){const{renderingIntent:z}=this._transport.getRenderingIntent(f);return this._transport.getOptionalContentConfig(z)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(f=!1){return this._transport.startCleanup(f||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class r{constructor(f,z,W,lt=!1){l(this,vt);l(this,Ct);l(this,q,null);l(this,tt,!1);this._pageIndex=f,this._pageInfo=z,this._transport=W,this._stats=lt?new K.StatTimer:null,this._pdfBug=lt,this.commonObjs=W.commonObjs,this.objs=new ot,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:f,rotation:z=this.rotate,offsetX:W=0,offsetY:lt=0,dontFlip:ft=!1}={}){return new K.PageViewport({viewBox:this.view,scale:f,rotation:z,offsetX:W,offsetY:lt,dontFlip:ft})}getAnnotations({intent:f="display"}={}){const{renderingIntent:z}=this._transport.getRenderingIntent(f);return this._transport.getAnnotations(this._pageIndex,z)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,v.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var f;return((f=this._transport._htmlForXfa)==null?void 0:f.children[this._pageIndex])||null}render({canvasContext:f,viewport:z,intent:W="display",annotationMode:lt=v.AnnotationMode.ENABLE,transform:ft=null,background:Mt=null,optionalContentConfigPromise:Dt=null,annotationCanvasMap:te=null,pageColors:re=null,printAnnotationStorage:he=null}){var J,it;(J=this._stats)==null||J.time("Overall");const Me=this._transport.getRenderingIntent(W,lt,he),{renderingIntent:_e,cacheKey:Fe}=Me;P(this,tt,!1),S(this,Ct,Wi).call(this),Dt||(Dt=this._transport.getOptionalContentConfig(_e));let fe=this._intentStates.get(Fe);fe||(fe=Object.create(null),this._intentStates.set(Fe,fe)),fe.streamReaderCancelTimeout&&(clearTimeout(fe.streamReaderCancelTimeout),fe.streamReaderCancelTimeout=null);const Pe=!!(_e&v.RenderingIntentFlag.PRINT);fe.displayReadyCapability||(fe.displayReadyCapability=Promise.withResolvers(),fe.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(it=this._stats)==null||it.time("Page Request"),this._pumpOperatorList(Me));const se=ct=>{var wt,bt;fe.renderTasks.delete(F),(this._maybeCleanupAfterRender||Pe)&&P(this,tt,!0),S(this,vt,Ys).call(this,!Pe),ct?(F.capability.reject(ct),this._abortOperatorList({intentState:fe,reason:ct instanceof Error?ct:new Error(ct)})):F.capability.resolve(),(wt=this._stats)==null||wt.timeEnd("Rendering"),(bt=this._stats)==null||bt.timeEnd("Overall")},F=new At({callback:se,params:{canvasContext:f,viewport:z,transform:ft,background:Mt},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:te,operatorList:fe.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!Pe,pdfBug:this._pdfBug,pageColors:re});(fe.renderTasks||(fe.renderTasks=new Set)).add(F);const x=F.task;return Promise.all([fe.displayReadyCapability.promise,Dt]).then(([ct,wt])=>{var bt;if(this.destroyed){se();return}if((bt=this._stats)==null||bt.time("Rendering"),!(wt.renderingIntent&_e))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");F.initializeGraphics({transparency:ct,optionalContentConfig:wt}),F.operatorListChanged()}).catch(se),x}getOperatorList({intent:f="display",annotationMode:z=v.AnnotationMode.ENABLE,printAnnotationStorage:W=null}={}){var te;function lt(){Mt.operatorList.lastChunk&&(Mt.opListReadCapability.resolve(Mt.operatorList),Mt.renderTasks.delete(Dt))}const ft=this._transport.getRenderingIntent(f,z,W,!0);let Mt=this._intentStates.get(ft.cacheKey);Mt||(Mt=Object.create(null),this._intentStates.set(ft.cacheKey,Mt));let Dt;return Mt.opListReadCapability||(Dt=Object.create(null),Dt.operatorListChanged=lt,Mt.opListReadCapability=Promise.withResolvers(),(Mt.renderTasks||(Mt.renderTasks=new Set)).add(Dt),Mt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(te=this._stats)==null||te.time("Page Request"),this._pumpOperatorList(ft)),Mt.opListReadCapability.promise}streamTextContent({includeMarkedContent:f=!1,disableNormalization:z=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:f===!0,disableNormalization:z===!0},{highWaterMark:100,size(W){return W.items.length}})}getTextContent(f={}){if(this._transport._htmlForXfa)return this.getXfa().then(W=>U.XfaText.textContent(W));const z=this.streamTextContent(f);return new Promise(function(W,lt){function ft(){Mt.read().then(function({value:te,done:re}){if(re){W(Dt);return}Object.assign(Dt.styles,te.styles),Dt.items.push(...te.items),ft()},lt)}const Mt=z.getReader(),Dt={items:[],styles:Object.create(null)};ft()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const f=[];for(const z of this._intentStates.values())if(this._abortOperatorList({intentState:z,reason:new Error("Page was destroyed."),force:!0}),!z.opListReadCapability)for(const W of z.renderTasks)f.push(W.completed),W.cancel();return this.objs.clear(),P(this,tt,!1),S(this,Ct,Wi).call(this),Promise.all(f)}cleanup(f=!1){P(this,tt,!0);const z=S(this,vt,Ys).call(this,!1);return f&&z&&this._stats&&(this._stats=new K.StatTimer),z}_startRenderPage(f,z){var lt,ft;const W=this._intentStates.get(z);W&&((lt=this._stats)==null||lt.timeEnd("Page Request"),(ft=W.displayReadyCapability)==null||ft.resolve(f))}_renderPageChunk(f,z){for(let W=0,lt=f.length;W<lt;W++)z.operatorList.fnArray.push(f.fnArray[W]),z.operatorList.argsArray.push(f.argsArray[W]);z.operatorList.lastChunk=f.lastChunk,z.operatorList.separateAnnots=f.separateAnnots;for(const W of z.renderTasks)W.operatorListChanged();f.lastChunk&&S(this,vt,Ys).call(this,!0)}_pumpOperatorList({renderingIntent:f,cacheKey:z,annotationStorageSerializable:W}){const{map:lt,transfer:ft}=W,Mt=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:f,cacheKey:z,annotationStorage:lt},ft).getReader(),Dt=this._intentStates.get(z);Dt.streamReader=Mt;const te=()=>{Mt.read().then(({value:re,done:he})=>{if(he){Dt.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(re,Dt),te())},re=>{if(Dt.streamReader=null,!this._transport.destroyed){if(Dt.operatorList){Dt.operatorList.lastChunk=!0;for(const he of Dt.renderTasks)he.operatorListChanged();S(this,vt,Ys).call(this,!0)}if(Dt.displayReadyCapability)Dt.displayReadyCapability.reject(re);else if(Dt.opListReadCapability)Dt.opListReadCapability.reject(re);else throw re}})};te()}_abortOperatorList({intentState:f,reason:z,force:W=!1}){if(f.streamReader){if(f.streamReaderCancelTimeout&&(clearTimeout(f.streamReaderCancelTimeout),f.streamReaderCancelTimeout=null),!W){if(f.renderTasks.size>0)return;if(z instanceof K.RenderingCancelledException){let lt=et;z.extraDelay>0&&z.extraDelay<1e3&&(lt+=z.extraDelay),f.streamReaderCancelTimeout=setTimeout(()=>{f.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:f,reason:z,force:!0})},lt);return}}if(f.streamReader.cancel(new v.AbortException(z.message)).catch(()=>{}),f.streamReader=null,!this._transport.destroyed){for(const[lt,ft]of this._intentStates)if(ft===f){this._intentStates.delete(lt);break}this.cleanup()}}}get stats(){return this._stats}}q=new WeakMap,tt=new WeakMap,vt=new WeakSet,Ys=function(f=!1){if(S(this,Ct,Wi).call(this),!t(this,tt)||this.destroyed)return!1;if(f)return P(this,q,setTimeout(()=>{P(this,q,null),S(this,vt,Ys).call(this,!1)},i)),!1;for(const{renderTasks:z,operatorList:W}of this._intentStates.values())if(z.size>0||!W.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),P(this,tt,!1),!0},Ct=new WeakSet,Wi=function(){t(this,q)&&(clearTimeout(t(this,q)),P(this,q,null))};class h{constructor(){l(this,_t,new Set);l(this,Tt,Promise.resolve())}postMessage(f,z){const W={data:structuredClone(f,z?{transfer:z}:null)};t(this,Tt).then(()=>{for(const lt of t(this,_t))lt.call(this,W)})}addEventListener(f,z){t(this,_t).add(z)}removeEventListener(f,z){t(this,_t).delete(z)}terminate(){t(this,_t).clear()}}_t=new WeakMap,Tt=new WeakMap;const T={isWorkerDisabled:!1,fakeWorkerId:0};v.isNodeJS&&(T.isWorkerDisabled=!0,(Pt=I.GlobalWorkerOptions).workerSrc||(Pt.workerSrc="./pdf.worker.mjs")),T.isSameOrigin=function(N,f){let z;try{if(z=new URL(N),!z.origin||z.origin==="null")return!1}catch{return!1}const W=new URL(f,z);return z.origin===W.origin},T.createCDNWrapper=function(N){const f=`await import("${N}");`;return URL.createObjectURL(new Blob([f],{type:"text/javascript"}))};const X=class X{constructor({name:f=null,port:z=null,verbosity:W=(0,v.getVerbosityLevel)()}={}){var lt;if(this.name=f,this.destroyed=!1,this.verbosity=W,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,z){if((lt=t(X,Et))!=null&&lt.has(z))throw new Error("Cannot use more than one PDFWorker per port.");(t(X,Et)||P(X,Et,new WeakMap)).set(z,this),this._initializeFromPort(z);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(f){this._port=f,this._messageHandler=new E.MessageHandler("main","worker",f),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!T.isWorkerDisabled&&!t(X,Z,Xi)){let{workerSrc:f}=X;try{T.isSameOrigin(window.location.href,f)||(f=T.createCDNWrapper(new URL(f,window.location).href));const z=new Worker(f,{type:"module"}),W=new E.MessageHandler("main","worker",z),lt=()=>{z.removeEventListener("error",ft),W.destroy(),z.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},ft=()=>{this._webWorker||lt()};z.addEventListener("error",ft),W.on("test",Dt=>{if(z.removeEventListener("error",ft),this.destroyed){lt();return}Dt?(this._messageHandler=W,this._port=z,this._webWorker=z,this._readyCapability.resolve(),W.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),W.destroy(),z.terminate())}),W.on("ready",Dt=>{if(z.removeEventListener("error",ft),this.destroyed){lt();return}try{Mt()}catch{this._setupFakeWorker()}});const Mt=()=>{const Dt=new Uint8Array;W.send("test",Dt,[Dt.buffer])};Mt();return}catch{(0,v.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){T.isWorkerDisabled||((0,v.warn)("Setting up fake worker."),T.isWorkerDisabled=!0),X._setupFakeWorkerGlobal.then(f=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const z=new h;this._port=z;const W=`fake${T.fakeWorkerId++}`,lt=new E.MessageHandler(W+"_worker",W,z);f.setup(lt,z);const ft=new E.MessageHandler(W,W+"_worker",z);this._messageHandler=ft,this._readyCapability.resolve(),ft.send("configure",{verbosity:this.verbosity})}).catch(f=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${f.message}".`))})}destroy(){var f;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(f=t(X,Et))==null||f.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(f){var W;if(!(f!=null&&f.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const z=(W=t(this,Et))==null?void 0:W.get(f.port);if(z){if(z._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return z}return new X(f)}static get workerSrc(){if(I.GlobalWorkerOptions.workerSrc)return I.GlobalWorkerOptions.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){const f=async()=>t(this,Z,Xi)?t(this,Z,Xi):(await bs(()=>import(this.workerSrc).then(async z=>(await z.__tla,z)),[])).WorkerMessageHandler;return(0,v.shadow)(this,"_setupFakeWorkerGlobal",f())}};Et=new WeakMap,Z=new WeakSet,Xi=function(){var f;try{return((f=globalThis.pdfjsWorker)==null?void 0:f.WorkerMessageHandler)||null}catch{return null}},l(X,Z),l(X,Et,void 0);let V=X;class j{constructor(f,z,W,lt,ft){l(this,ie);l(this,kt,new Map);l(this,Rt,new Map);l(this,qt,new Map);l(this,Kt,null);this.messageHandler=f,this.loadingTask=z,this.commonObjs=new ot,this.fontLoader=new k.FontLoader({ownerDocument:lt.ownerDocument,styleElement:lt.styleElement}),this._params=lt,this.canvasFactory=ft.canvasFactory,this.filterFactory=ft.filterFactory,this.cMapReaderFactory=ft.cMapReaderFactory,this.standardFontDataFactory=ft.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=W,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return(0,v.shadow)(this,"annotationStorage",new R.AnnotationStorage)}getRenderingIntent(f,z=v.AnnotationMode.ENABLE,W=null,lt=!1){let ft=v.RenderingIntentFlag.DISPLAY,Mt=R.SerializableEmpty;switch(f){case"any":ft=v.RenderingIntentFlag.ANY;break;case"display":break;case"print":ft=v.RenderingIntentFlag.PRINT;break;default:(0,v.warn)(`getRenderingIntent - invalid intent: ${f}`)}switch(z){case v.AnnotationMode.DISABLE:ft+=v.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case v.AnnotationMode.ENABLE:break;case v.AnnotationMode.ENABLE_FORMS:ft+=v.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case v.AnnotationMode.ENABLE_STORAGE:ft+=v.RenderingIntentFlag.ANNOTATIONS_STORAGE,Mt=(ft&v.RenderingIntentFlag.PRINT&&W instanceof R.PrintAnnotationStorage?W:this.annotationStorage).serializable;break;default:(0,v.warn)(`getRenderingIntent - invalid annotationMode: ${z}`)}return lt&&(ft+=v.RenderingIntentFlag.OPLIST),{renderingIntent:ft,cacheKey:`${ft}_${Mt.hash}`,annotationStorageSerializable:Mt}}destroy(){var W;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(W=t(this,Kt))==null||W.reject(new Error("Worker was destroyed during onPassword callback"));const f=[];for(const lt of t(this,Rt).values())f.push(lt._destroy());t(this,Rt).clear(),t(this,qt).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const z=this.messageHandler.sendWithPromise("Terminate",null);return f.push(z),Promise.all(f).then(()=>{var lt;this.commonObjs.clear(),this.fontLoader.clear(),t(this,kt).clear(),this.filterFactory.destroy(),(0,G.cleanupTextLayer)(),(lt=this._networkStream)==null||lt.cancelAllRequests(new v.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:f,loadingTask:z}=this;f.on("GetReader",(W,lt)=>{(0,v.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=ft=>{this._lastProgress={loaded:ft.loaded,total:ft.total}},lt.onPull=()=>{this._fullReader.read().then(function({value:ft,done:Mt}){if(Mt){lt.close();return}(0,v.assert)(ft instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),lt.enqueue(new Uint8Array(ft),1,[ft])}).catch(ft=>{lt.error(ft)})},lt.onCancel=ft=>{this._fullReader.cancel(ft),lt.ready.catch(Mt=>{if(!this.destroyed)throw Mt})}}),f.on("ReaderHeadersReady",W=>{const lt=Promise.withResolvers(),ft=this._fullReader;return ft.headersReady.then(()=>{var Mt;(!ft.isStreamingSupported||!ft.isRangeSupported)&&(this._lastProgress&&((Mt=z.onProgress)==null||Mt.call(z,this._lastProgress)),ft.onProgress=Dt=>{var te;(te=z.onProgress)==null||te.call(z,{loaded:Dt.loaded,total:Dt.total})}),lt.resolve({isStreamingSupported:ft.isStreamingSupported,isRangeSupported:ft.isRangeSupported,contentLength:ft.contentLength})},lt.reject),lt.promise}),f.on("GetRangeReader",(W,lt)=>{(0,v.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const ft=this._networkStream.getRangeReader(W.begin,W.end);if(!ft){lt.close();return}lt.onPull=()=>{ft.read().then(function({value:Mt,done:Dt}){if(Dt){lt.close();return}(0,v.assert)(Mt instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),lt.enqueue(new Uint8Array(Mt),1,[Mt])}).catch(Mt=>{lt.error(Mt)})},lt.onCancel=Mt=>{ft.cancel(Mt),lt.ready.catch(Dt=>{if(!this.destroyed)throw Dt})}}),f.on("GetDoc",({pdfInfo:W})=>{this._numPages=W.numPages,this._htmlForXfa=W.htmlForXfa,delete W.htmlForXfa,z._capability.resolve(new u(W,this))}),f.on("DocException",function(W){let lt;switch(W.name){case"PasswordException":lt=new v.PasswordException(W.message,W.code);break;case"InvalidPDFException":lt=new v.InvalidPDFException(W.message);break;case"MissingPDFException":lt=new v.MissingPDFException(W.message);break;case"UnexpectedResponseException":lt=new v.UnexpectedResponseException(W.message,W.status);break;case"UnknownErrorException":lt=new v.UnknownErrorException(W.message,W.details);break;default:(0,v.unreachable)("DocException - expected a valid Error.")}z._capability.reject(lt)}),f.on("PasswordRequest",W=>{if(P(this,Kt,Promise.withResolvers()),z.onPassword){const lt=ft=>{ft instanceof Error?t(this,Kt).reject(ft):t(this,Kt).resolve({password:ft})};try{z.onPassword(lt,W.code)}catch(ft){t(this,Kt).reject(ft)}}else t(this,Kt).reject(new v.PasswordException(W.message,W.code));return t(this,Kt).promise}),f.on("DataLoaded",W=>{var lt;(lt=z.onProgress)==null||lt.call(z,{loaded:W.length,total:W.length}),this.downloadInfoCapability.resolve(W)}),f.on("StartRenderPage",W=>{this.destroyed||t(this,Rt).get(W.pageIndex)._startRenderPage(W.transparency,W.cacheKey)}),f.on("commonobj",([W,lt,ft])=>{var Mt;if(this.destroyed||this.commonObjs.has(W))return null;switch(lt){case"Font":const Dt=this._params;if("error"in ft){const Me=ft.error;(0,v.warn)(`Error during font loading: ${Me}`),this.commonObjs.resolve(W,Me);break}const te=Dt.pdfBug&&((Mt=globalThis.FontInspector)!=null&&Mt.enabled)?(Me,_e)=>globalThis.FontInspector.fontAdded(Me,_e):null,re=new k.FontFaceObject(ft,{isEvalSupported:Dt.isEvalSupported,disableFontFace:Dt.disableFontFace,ignoreErrors:Dt.ignoreErrors,inspectFont:te});this.fontLoader.bind(re).catch(()=>f.sendWithPromise("FontFallback",{id:W})).finally(()=>{!Dt.fontExtraProperties&&re.data&&(re.data=null),this.commonObjs.resolve(W,re)});break;case"CopyLocalImage":const{imageRef:he}=ft;(0,v.assert)(he,"The imageRef must be defined.");for(const Me of t(this,Rt).values())for(const[,_e]of Me.objs)if(_e.ref===he)return _e.dataLen?(this.commonObjs.resolve(W,structuredClone(_e)),_e.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(W,ft);break;default:throw new Error(`Got unknown common object type ${lt}`)}return null}),f.on("obj",([W,lt,ft,Mt])=>{var te;if(this.destroyed)return;const Dt=t(this,Rt).get(lt);if(!Dt.objs.has(W)){if(Dt._intentStates.size===0){(te=Mt==null?void 0:Mt.bitmap)==null||te.close();return}switch(ft){case"Image":Dt.objs.resolve(W,Mt),(Mt==null?void 0:Mt.dataLen)>v.MAX_IMAGE_SIZE_TO_CACHE&&(Dt._maybeCleanupAfterRender=!0);break;case"Pattern":Dt.objs.resolve(W,Mt);break;default:throw new Error(`Got unknown object type ${ft}`)}}}),f.on("DocProgress",W=>{var lt;this.destroyed||((lt=z.onProgress)==null||lt.call(z,{loaded:W.loaded,total:W.total}))}),f.on("FetchBuiltInCMap",W=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(W):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),f.on("FetchStandardFontData",W=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(W):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var W;this.annotationStorage.size<=0&&(0,v.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:f,transfer:z}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:f,filename:((W=this._fullReader)==null?void 0:W.filename)??null},z).finally(()=>{this.annotationStorage.resetModified()})}getPage(f){if(!Number.isInteger(f)||f<=0||f>this._numPages)return Promise.reject(new Error("Invalid page request."));const z=f-1,W=t(this,qt).get(z);if(W)return W;const lt=this.messageHandler.sendWithPromise("GetPage",{pageIndex:z}).then(ft=>{if(this.destroyed)throw new Error("Transport destroyed");const Mt=new r(z,ft,this,this._params.pdfBug);return t(this,Rt).set(z,Mt),Mt});return t(this,qt).set(z,lt),lt}getPageIndex(f){return typeof f!="object"||f===null||!Number.isInteger(f.num)||f.num<0||!Number.isInteger(f.gen)||f.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:f.num,gen:f.gen})}getAnnotations(f,z){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:f,intent:z})}getFieldObjects(){return S(this,ie,bi).call(this,"GetFieldObjects")}hasJSActions(){return S(this,ie,bi).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(f){return typeof f!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:f})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return S(this,ie,bi).call(this,"GetDocJSActions")}getPageJSActions(f){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:f})}getStructTree(f){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:f})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(f){return S(this,ie,bi).call(this,"GetOptionalContentConfig").then(z=>new $.OptionalContentConfig(z,f))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const f="GetMetadata",z=t(this,kt).get(f);if(z)return z;const W=this.messageHandler.sendWithPromise(f,null).then(lt=>{var ft,Mt;return{info:lt[0],metadata:lt[1]?new H.Metadata(lt[1]):null,contentDispositionFilename:((ft=this._fullReader)==null?void 0:ft.filename)??null,contentLength:((Mt=this._fullReader)==null?void 0:Mt.contentLength)??null}});return t(this,kt).set(f,W),W}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(f=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const z of t(this,Rt).values())if(!z.cleanup())throw new Error(`startCleanup: Page ${z.pageNumber} is currently rendering.`);this.commonObjs.clear(),f||this.fontLoader.clear(),t(this,kt).clear(),this.filterFactory.destroy(!0),(0,G.cleanupTextLayer)()}}get loadingParams(){const{disableAutoFetch:f,enableXfa:z}=this._params;return(0,v.shadow)(this,"loadingParams",{disableAutoFetch:f,enableXfa:z})}}kt=new WeakMap,Rt=new WeakMap,qt=new WeakMap,Kt=new WeakMap,ie=new WeakSet,bi=function(f,z=null){const W=t(this,kt).get(f);if(W)return W;const lt=this.messageHandler.sendWithPromise(f,z);return t(this,kt).set(f,lt),lt};const rt=Symbol("INITIAL_DATA");class ot{constructor(){l(this,le);l(this,de,Object.create(null))}get(f,z=null){if(z){const lt=S(this,le,Ln).call(this,f);return lt.promise.then(()=>z(lt.data)),null}const W=t(this,de)[f];if(!W||W.data===rt)throw new Error(`Requesting object that isn't resolved yet ${f}.`);return W.data}has(f){const z=t(this,de)[f];return!!z&&z.data!==rt}resolve(f,z=null){const W=S(this,le,Ln).call(this,f);W.data=z,W.resolve()}clear(){var f;for(const z in t(this,de)){const{data:W}=t(this,de)[z];(f=W==null?void 0:W.bitmap)==null||f.close()}P(this,de,Object.create(null))}*[Symbol.iterator](){for(const f in t(this,de)){const{data:z}=t(this,de)[f];z!==rt&&(yield[f,z])}}}de=new WeakMap,le=new WeakSet,Ln=function(f){var z;return(z=t(this,de))[f]||(z[f]={...Promise.withResolvers(),data:rt})};class yt{constructor(f){l(this,Vt,null);P(this,Vt,f),this.onContinue=null}get promise(){return t(this,Vt).capability.promise}cancel(f=0){t(this,Vt).cancel(null,f)}get separateAnnots(){const{separateAnnots:f}=t(this,Vt).operatorList;if(!f)return!1;const{annotationCanvasMap:z}=t(this,Vt);return f.form||f.canvas&&(z==null?void 0:z.size)>0}}Vt=new WeakMap;const nt=class nt{constructor({callback:f,params:z,objs:W,commonObjs:lt,annotationCanvasMap:ft,operatorList:Mt,pageIndex:Dt,canvasFactory:te,filterFactory:re,useRequestAnimationFrame:he=!1,pdfBug:Me=!1,pageColors:_e=null}){this.callback=f,this.params=z,this.objs=W,this.commonObjs=lt,this.annotationCanvasMap=ft,this.operatorListIdx=null,this.operatorList=Mt,this._pageIndex=Dt,this.canvasFactory=te,this.filterFactory=re,this._pdfBug=Me,this.pageColors=_e,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=he===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new yt(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=z.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:f=!1,optionalContentConfig:z}){var Dt,te;if(this.cancelled)return;if(this._canvas){if(t(nt,ae).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(nt,ae).add(this._canvas)}this._pdfBug&&((Dt=globalThis.StepperManager)!=null&&Dt.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:W,viewport:lt,transform:ft,background:Mt}=this.params;this.gfx=new g.CanvasGraphics(W,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:z},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:ft,viewport:lt,transparency:f,background:Mt}),this.operatorListIdx=0,this.graphicsReady=!0,(te=this.graphicsReadyCallback)==null||te.call(this)}cancel(f=null,z=0){var W;this.running=!1,this.cancelled=!0,(W=this.gfx)==null||W.endDrawing(),t(nt,ae).delete(this._canvas),this.callback(f||new K.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,z))}operatorListChanged(){var f;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(f=this.stepper)==null||f.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(nt,ae).delete(this._canvas),this.callback())))}};ae=new WeakMap,l(nt,ae,new WeakSet);let At=nt;const ut="4.1.392",xt="fcb76a78d";w()}catch(Ce){w(Ce)}})},583:(o,b,d)=>{d.d(b,{BaseCMapReaderFactory:()=>R,BaseCanvasFactory:()=>v,BaseFilterFactory:()=>w,BaseSVGFactory:()=>k,BaseStandardFontDataFactory:()=>K});var e=d(292);class w{constructor(){this.constructor===w&&(0,e.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(g){return"none"}addHCMFilter(g,G){return"none"}addHighlightHCMFilter(g,G,I,E,H){return"none"}destroy(g=!1){}}class v{constructor(){this.constructor===v&&(0,e.unreachable)("Cannot initialize BaseCanvasFactory.")}create(g,G){if(g<=0||G<=0)throw new Error("Invalid canvas size");const I=this._createCanvas(g,G);return{canvas:I,context:I.getContext("2d")}}reset(g,G,I){if(!g.canvas)throw new Error("Canvas is not specified");if(G<=0||I<=0)throw new Error("Invalid canvas size");g.canvas.width=G,g.canvas.height=I}destroy(g){if(!g.canvas)throw new Error("Canvas is not specified");g.canvas.width=0,g.canvas.height=0,g.canvas=null,g.context=null}_createCanvas(g,G){(0,e.unreachable)("Abstract method `_createCanvas` called.")}}class R{constructor({baseUrl:g=null,isCompressed:G=!0}){this.constructor===R&&(0,e.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=g,this.isCompressed=G}async fetch({name:g}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!g)throw new Error("CMap name must be specified.");const G=this.baseUrl+g+(this.isCompressed?".bcmap":""),I=this.isCompressed?e.CMapCompressionType.BINARY:e.CMapCompressionType.NONE;return this._fetchData(G,I).catch(E=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${G}`)})}_fetchData(g,G){(0,e.unreachable)("Abstract method `_fetchData` called.")}}class K{constructor({baseUrl:g=null}){this.constructor===K&&(0,e.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=g}async fetch({filename:g}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!g)throw new Error("Font filename must be specified.");const G=`${this.baseUrl}${g}`;return this._fetchData(G).catch(I=>{throw new Error(`Unable to load font data at: ${G}`)})}_fetchData(g){(0,e.unreachable)("Abstract method `_fetchData` called.")}}class k{constructor(){this.constructor===k&&(0,e.unreachable)("Cannot initialize BaseSVGFactory.")}create(g,G,I=!1){if(g<=0||G<=0)throw new Error("Invalid SVG dimensions");const E=this._createSVG("svg:svg");return E.setAttribute("version","1.1"),I||(E.setAttribute("width",`${g}px`),E.setAttribute("height",`${G}px`)),E.setAttribute("preserveAspectRatio","none"),E.setAttribute("viewBox",`0 0 ${g} ${G}`),E}createElement(g){if(typeof g!="string")throw new Error("Invalid SVG element type");return this._createSVG(g)}_createSVG(g){(0,e.unreachable)("Abstract method `_createSVG` called.")}}},923:(o,b,d)=>{var ae,Pn,ee,kn;d.d(b,{CanvasGraphics:()=>ve});var e=d(292),w=d(419);const v={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function R(et,i){if(!i)return;const n=i[2]-i[0],c=i[3]-i[1],p=new Path2D;p.rect(i[0],i[1],n,c),et.clip(p)}class K{constructor(){this.constructor===K&&(0,e.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,e.unreachable)("Abstract method `getPattern` called.")}}class k extends K{constructor(i){super(),this._type=i[1],this._bbox=i[2],this._colorStops=i[3],this._p0=i[4],this._p1=i[5],this._r0=i[6],this._r1=i[7],this.matrix=null}_createGradient(i){let n;this._type==="axial"?n=i.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(n=i.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const c of this._colorStops)n.addColorStop(c[0],c[1]);return n}getPattern(i,n,c,p){let a;if(p===v.STROKE||p===v.FILL){const A=n.current.getClippedPathBoundingBox(p,(0,w.getCurrentTransform)(i))||[0,0,0,0],m=Math.ceil(A[2]-A[0])||1,_=Math.ceil(A[3]-A[1])||1,u=n.cachedCanvases.getCanvas("pattern",m,_,!0),r=u.context;r.clearRect(0,0,r.canvas.width,r.canvas.height),r.beginPath(),r.rect(0,0,r.canvas.width,r.canvas.height),r.translate(-A[0],-A[1]),c=e.Util.transform(c,[1,0,0,1,A[0],A[1]]),r.transform(...n.baseTransform),this.matrix&&r.transform(...this.matrix),R(r,this._bbox),r.fillStyle=this._createGradient(r),r.fill(),a=i.createPattern(u.canvas,"no-repeat");const h=new DOMMatrix(c);a.setTransform(h)}else R(i,this._bbox),a=this._createGradient(i);return a}}function y(et,i,n,c,p,a,A,m){const _=i.coords,u=i.colors,r=et.data,h=et.width*4;let T;_[n+1]>_[c+1]&&(T=n,n=c,c=T,T=a,a=A,A=T),_[c+1]>_[p+1]&&(T=c,c=p,p=T,T=A,A=m,m=T),_[n+1]>_[c+1]&&(T=n,n=c,c=T,T=a,a=A,A=T);const V=(_[n]+i.offsetX)*i.scaleX,j=(_[n+1]+i.offsetY)*i.scaleY,rt=(_[c]+i.offsetX)*i.scaleX,ot=(_[c+1]+i.offsetY)*i.scaleY,yt=(_[p]+i.offsetX)*i.scaleX,At=(_[p+1]+i.offsetY)*i.scaleY;if(j>=At)return;const ut=u[a],xt=u[a+1],L=u[a+2],X=u[A],nt=u[A+1],N=u[A+2],f=u[m],z=u[m+1],W=u[m+2],lt=Math.round(j),ft=Math.round(At);let Mt,Dt,te,re,he,Me,_e,Fe;for(let fe=lt;fe<=ft;fe++){if(fe<ot){const J=fe<j?0:(j-fe)/(j-ot);Mt=V-(V-rt)*J,Dt=ut-(ut-X)*J,te=xt-(xt-nt)*J,re=L-(L-N)*J}else{let J;fe>At?J=1:ot===At?J=0:J=(ot-fe)/(ot-At),Mt=rt-(rt-yt)*J,Dt=X-(X-f)*J,te=nt-(nt-z)*J,re=N-(N-W)*J}let Pe;fe<j?Pe=0:fe>At?Pe=1:Pe=(j-fe)/(j-At),he=V-(V-yt)*Pe,Me=ut-(ut-f)*Pe,_e=xt-(xt-z)*Pe,Fe=L-(L-W)*Pe;const se=Math.round(Math.min(Mt,he)),F=Math.round(Math.max(Mt,he));let x=h*fe+se*4;for(let J=se;J<=F;J++)Pe=(Mt-J)/(Mt-he),Pe<0?Pe=0:Pe>1&&(Pe=1),r[x++]=Dt-(Dt-Me)*Pe|0,r[x++]=te-(te-_e)*Pe|0,r[x++]=re-(re-Fe)*Pe|0,r[x++]=255}}function g(et,i,n){const c=i.coords,p=i.colors;let a,A;switch(i.type){case"lattice":const m=i.verticesPerRow,_=Math.floor(c.length/m)-1,u=m-1;for(a=0;a<_;a++){let r=a*m;for(let h=0;h<u;h++,r++)y(et,n,c[r],c[r+1],c[r+m],p[r],p[r+1],p[r+m]),y(et,n,c[r+m+1],c[r+1],c[r+m],p[r+m+1],p[r+1],p[r+m])}break;case"triangles":for(a=0,A=c.length;a<A;a+=3)y(et,n,c[a],c[a+1],c[a+2],p[a],p[a+1],p[a+2]);break;default:throw new Error("illegal figure")}}class G extends K{constructor(i){super(),this._coords=i[2],this._colors=i[3],this._figures=i[4],this._bounds=i[5],this._bbox=i[7],this._background=i[8],this.matrix=null}_createMeshCanvas(i,n,c){const p=Math.floor(this._bounds[0]),a=Math.floor(this._bounds[1]),A=Math.ceil(this._bounds[2])-p,m=Math.ceil(this._bounds[3])-a,_=Math.min(Math.ceil(Math.abs(A*i[0]*1.1)),3e3),u=Math.min(Math.ceil(Math.abs(m*i[1]*1.1)),3e3),r=A/_,h=m/u,T={coords:this._coords,colors:this._colors,offsetX:-p,offsetY:-a,scaleX:1/r,scaleY:1/h},V=_+2*2,j=u+2*2,rt=c.getCanvas("mesh",V,j,!1),ot=rt.context,yt=ot.createImageData(_,u);if(n){const At=yt.data;for(let ut=0,xt=At.length;ut<xt;ut+=4)At[ut]=n[0],At[ut+1]=n[1],At[ut+2]=n[2],At[ut+3]=255}for(const At of this._figures)g(yt,At,T);return ot.putImageData(yt,2,2),{canvas:rt.canvas,offsetX:p-2*r,offsetY:a-2*h,scaleX:r,scaleY:h}}getPattern(i,n,c,p){R(i,this._bbox);let a;if(p===v.SHADING)a=e.Util.singularValueDecompose2dScale((0,w.getCurrentTransform)(i));else if(a=e.Util.singularValueDecompose2dScale(n.baseTransform),this.matrix){const m=e.Util.singularValueDecompose2dScale(this.matrix);a=[a[0]*m[0],a[1]*m[1]]}const A=this._createMeshCanvas(a,p===v.SHADING?null:this._background,n.cachedCanvases);return p!==v.SHADING&&(i.setTransform(...n.baseTransform),this.matrix&&i.transform(...this.matrix)),i.translate(A.offsetX,A.offsetY),i.scale(A.scaleX,A.scaleY),i.createPattern(A.canvas,"no-repeat")}}class I extends K{getPattern(){return"hotpink"}}function E(et){switch(et[0]){case"RadialAxial":return new k(et);case"Mesh":return new G(et);case"Dummy":return new I}throw new Error(`Unknown IR type: ${et[0]}`)}const H={COLORED:1,UNCOLORED:2},Vt=class Vt{constructor(i,n,c,p,a){this.operatorList=i[2],this.matrix=i[3]||[1,0,0,1,0,0],this.bbox=i[4],this.xstep=i[5],this.ystep=i[6],this.paintType=i[7],this.tilingType=i[8],this.color=n,this.ctx=c,this.canvasGraphicsFactory=p,this.baseTransform=a}createPatternCanvas(i){const n=this.operatorList,c=this.bbox,p=this.xstep,a=this.ystep,A=this.paintType,m=this.tilingType,_=this.color,u=this.canvasGraphicsFactory;(0,e.info)("TilingType: "+m);const r=c[0],h=c[1],T=c[2],V=c[3],j=e.Util.singularValueDecompose2dScale(this.matrix),rt=e.Util.singularValueDecompose2dScale(this.baseTransform),ot=[j[0]*rt[0],j[1]*rt[1]],yt=this.getSizeAndScale(p,this.ctx.canvas.width,ot[0]),At=this.getSizeAndScale(a,this.ctx.canvas.height,ot[1]),ut=i.cachedCanvases.getCanvas("pattern",yt.size,At.size,!0),xt=ut.context,L=u.createCanvasGraphics(xt);L.groupLevel=i.groupLevel,this.setFillAndStrokeStyleToContext(L,A,_);let X=r,nt=h,N=T,f=V;return r<0&&(X=0,N+=Math.abs(r)),h<0&&(nt=0,f+=Math.abs(h)),xt.translate(-(yt.scale*X),-(At.scale*nt)),L.transform(yt.scale,0,0,At.scale,0,0),xt.save(),this.clipBbox(L,X,nt,N,f),L.baseTransform=(0,w.getCurrentTransform)(L.ctx),L.executeOperatorList(n),L.endDrawing(),{canvas:ut.canvas,scaleX:yt.scale,scaleY:At.scale,offsetX:X,offsetY:nt}}getSizeAndScale(i,n,c){i=Math.abs(i);const p=Math.max(Vt.MAX_PATTERN_SIZE,n);let a=Math.ceil(i*c);return a>=p?a=p:c=a/i,{scale:c,size:a}}clipBbox(i,n,c,p,a){const A=p-n,m=a-c;i.ctx.rect(n,c,A,m),i.current.updateRectMinMax((0,w.getCurrentTransform)(i.ctx),[n,c,p,a]),i.clip(),i.endPath()}setFillAndStrokeStyleToContext(i,n,c){const p=i.ctx,a=i.current;switch(n){case H.COLORED:const A=this.ctx;p.fillStyle=A.fillStyle,p.strokeStyle=A.strokeStyle,a.fillColor=A.fillStyle,a.strokeColor=A.strokeStyle;break;case H.UNCOLORED:const m=e.Util.makeHexColor(c[0],c[1],c[2]);p.fillStyle=m,p.strokeStyle=m,a.fillColor=m,a.strokeColor=m;break;default:throw new e.FormatError(`Unsupported paint type: ${n}`)}}getPattern(i,n,c,p){let a=c;p!==v.SHADING&&(a=e.Util.transform(a,n.baseTransform),this.matrix&&(a=e.Util.transform(a,this.matrix)));const A=this.createPatternCanvas(n);let m=new DOMMatrix(a);m=m.translate(A.offsetX,A.offsetY),m=m.scale(1/A.scaleX,1/A.scaleY);const _=i.createPattern(A.canvas,"repeat");return _.setTransform(m),_}};me(Vt,"MAX_PATTERN_SIZE",3e3);let $=Vt;function Y({src:et,srcPos:i=0,dest:n,width:c,height:p,nonBlackColor:a=4294967295,inverseDecode:A=!1}){const m=e.FeatureTest.isLittleEndian?4278190080:255,[_,u]=A?[a,m]:[m,a],r=c>>3,h=c&7,T=et.length;n=new Uint32Array(n.buffer);let V=0;for(let j=0;j<p;j++){for(const ot=i+r;i<ot;i++){const yt=i<T?et[i]:255;n[V++]=yt&128?u:_,n[V++]=yt&64?u:_,n[V++]=yt&32?u:_,n[V++]=yt&16?u:_,n[V++]=yt&8?u:_,n[V++]=yt&4?u:_,n[V++]=yt&2?u:_,n[V++]=yt&1?u:_}if(h===0)continue;const rt=i<T?et[i++]:255;for(let ot=0;ot<h;ot++)n[V++]=rt&1<<7-ot?u:_}return{srcPos:i,destPos:V}}const at=16,Q=100,M=4096,U=15,B=10,D=1e3,q=16;function tt(et,i){if(et._removeMirroring)throw new Error("Context is already forwarding operations.");et.__originalSave=et.save,et.__originalRestore=et.restore,et.__originalRotate=et.rotate,et.__originalScale=et.scale,et.__originalTranslate=et.translate,et.__originalTransform=et.transform,et.__originalSetTransform=et.setTransform,et.__originalResetTransform=et.resetTransform,et.__originalClip=et.clip,et.__originalMoveTo=et.moveTo,et.__originalLineTo=et.lineTo,et.__originalBezierCurveTo=et.bezierCurveTo,et.__originalRect=et.rect,et.__originalClosePath=et.closePath,et.__originalBeginPath=et.beginPath,et._removeMirroring=()=>{et.save=et.__originalSave,et.restore=et.__originalRestore,et.rotate=et.__originalRotate,et.scale=et.__originalScale,et.translate=et.__originalTranslate,et.transform=et.__originalTransform,et.setTransform=et.__originalSetTransform,et.resetTransform=et.__originalResetTransform,et.clip=et.__originalClip,et.moveTo=et.__originalMoveTo,et.lineTo=et.__originalLineTo,et.bezierCurveTo=et.__originalBezierCurveTo,et.rect=et.__originalRect,et.closePath=et.__originalClosePath,et.beginPath=et.__originalBeginPath,delete et._removeMirroring},et.save=function(){i.save(),this.__originalSave()},et.restore=function(){i.restore(),this.__originalRestore()},et.translate=function(n,c){i.translate(n,c),this.__originalTranslate(n,c)},et.scale=function(n,c){i.scale(n,c),this.__originalScale(n,c)},et.transform=function(n,c,p,a,A,m){i.transform(n,c,p,a,A,m),this.__originalTransform(n,c,p,a,A,m)},et.setTransform=function(n,c,p,a,A,m){i.setTransform(n,c,p,a,A,m),this.__originalSetTransform(n,c,p,a,A,m)},et.resetTransform=function(){i.resetTransform(),this.__originalResetTransform()},et.rotate=function(n){i.rotate(n),this.__originalRotate(n)},et.clip=function(n){i.clip(n),this.__originalClip(n)},et.moveTo=function(n,c){i.moveTo(n,c),this.__originalMoveTo(n,c)},et.lineTo=function(n,c){i.lineTo(n,c),this.__originalLineTo(n,c)},et.bezierCurveTo=function(n,c,p,a,A,m){i.bezierCurveTo(n,c,p,a,A,m),this.__originalBezierCurveTo(n,c,p,a,A,m)},et.rect=function(n,c,p,a){i.rect(n,c,p,a),this.__originalRect(n,c,p,a)},et.closePath=function(){i.closePath(),this.__originalClosePath()},et.beginPath=function(){i.beginPath(),this.__originalBeginPath()}}class vt{constructor(i){this.canvasFactory=i,this.cache=Object.create(null)}getCanvas(i,n,c){let p;return this.cache[i]!==void 0?(p=this.cache[i],this.canvasFactory.reset(p,n,c)):(p=this.canvasFactory.create(n,c),this.cache[i]=p),p}delete(i){delete this.cache[i]}clear(){for(const i in this.cache){const n=this.cache[i];this.canvasFactory.destroy(n),delete this.cache[i]}}}function Ft(et,i,n,c,p,a,A,m,_,u){const[r,h,T,V,j,rt]=(0,w.getCurrentTransform)(et);if(h===0&&T===0){const At=A*r+j,ut=Math.round(At),xt=m*V+rt,L=Math.round(xt),X=(A+_)*r+j,nt=Math.abs(Math.round(X)-ut)||1,N=(m+u)*V+rt,f=Math.abs(Math.round(N)-L)||1;return et.setTransform(Math.sign(r),0,0,Math.sign(V),ut,L),et.drawImage(i,n,c,p,a,0,0,nt,f),et.setTransform(r,h,T,V,j,rt),[nt,f]}if(r===0&&V===0){const At=m*T+j,ut=Math.round(At),xt=A*h+rt,L=Math.round(xt),X=(m+u)*T+j,nt=Math.abs(Math.round(X)-ut)||1,N=(A+_)*h+rt,f=Math.abs(Math.round(N)-L)||1;return et.setTransform(0,Math.sign(h),Math.sign(T),0,ut,L),et.drawImage(i,n,c,p,a,0,0,f,nt),et.setTransform(r,h,T,V,j,rt),[f,nt]}et.drawImage(i,n,c,p,a,A,m,_,u);const ot=Math.hypot(r,h),yt=Math.hypot(T,V);return[ot*_,yt*u]}function Ct(et){const{width:i,height:n}=et;if(i>D||n>D)return null;const c=1e3,p=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),a=i+1;let A=new Uint8Array(a*(n+1)),m,_,u;const r=i+7&-8;let h=new Uint8Array(r*n),T=0;for(const ot of et.data){let yt=128;for(;yt>0;)h[T++]=ot&yt?0:255,yt>>=1}let V=0;for(T=0,h[T]!==0&&(A[0]=1,++V),_=1;_<i;_++)h[T]!==h[T+1]&&(A[_]=h[T]?2:1,++V),T++;for(h[T]!==0&&(A[_]=2,++V),m=1;m<n;m++){T=m*r,u=m*a,h[T-r]!==h[T]&&(A[u]=h[T]?1:8,++V);let ot=(h[T]?4:0)+(h[T-r]?8:0);for(_=1;_<i;_++)ot=(ot>>2)+(h[T+1]?4:0)+(h[T-r+1]?8:0),p[ot]&&(A[u+_]=p[ot],++V),T++;if(h[T-r]!==h[T]&&(A[u+_]=h[T]?2:4,++V),V>c)return null}for(T=r*(n-1),u=m*a,h[T]!==0&&(A[u]=8,++V),_=1;_<i;_++)h[T]!==h[T+1]&&(A[u+_]=h[T]?4:8,++V),T++;if(h[T]!==0&&(A[u+_]=4,++V),V>c)return null;const j=new Int32Array([0,a,-1,0,-a,0,0,0,1]),rt=new Path2D;for(m=0;V&&m<=n;m++){let ot=m*a;const yt=ot+i;for(;ot<yt&&!A[ot];)ot++;if(ot===yt)continue;rt.moveTo(ot%a,m);const At=ot;let ut=A[ot];do{const xt=j[ut];do ot+=xt;while(!A[ot]);const L=A[ot];L!==5&&L!==10?(ut=L,A[ot]=0):(ut=L&51*ut>>4,A[ot]&=ut>>2|ut<<2),rt.lineTo(ot%a,ot/a|0),A[ot]||--V}while(At!==ot);--m}return h=null,A=null,function(ot){ot.save(),ot.scale(1/i,-1/n),ot.translate(0,-n),ot.fill(rt),ot.beginPath(),ot.restore()}}class Nt{constructor(i,n){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=e.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=e.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=e.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,i,n])}clone(){const i=Object.create(this);return i.clipBox=this.clipBox.slice(),i}setCurrentPoint(i,n){this.x=i,this.y=n}updatePathMinMax(i,n,c){[n,c]=e.Util.applyTransform([n,c],i),this.minX=Math.min(this.minX,n),this.minY=Math.min(this.minY,c),this.maxX=Math.max(this.maxX,n),this.maxY=Math.max(this.maxY,c)}updateRectMinMax(i,n){const c=e.Util.applyTransform(n,i),p=e.Util.applyTransform(n.slice(2),i),a=e.Util.applyTransform([n[0],n[3]],i),A=e.Util.applyTransform([n[2],n[1]],i);this.minX=Math.min(this.minX,c[0],p[0],a[0],A[0]),this.minY=Math.min(this.minY,c[1],p[1],a[1],A[1]),this.maxX=Math.max(this.maxX,c[0],p[0],a[0],A[0]),this.maxY=Math.max(this.maxY,c[1],p[1],a[1],A[1])}updateScalingPathMinMax(i,n){e.Util.scaleMinMax(i,n),this.minX=Math.min(this.minX,n[0]),this.minY=Math.min(this.minY,n[1]),this.maxX=Math.max(this.maxX,n[2]),this.maxY=Math.max(this.maxY,n[3])}updateCurvePathMinMax(i,n,c,p,a,A,m,_,u,r){const h=e.Util.bezierBoundingBox(n,c,p,a,A,m,_,u,r);r||this.updateRectMinMax(i,h)}getPathBoundingBox(i=v.FILL,n=null){const c=[this.minX,this.minY,this.maxX,this.maxY];if(i===v.STROKE){n||(0,e.unreachable)("Stroke bounding box must include transform.");const p=e.Util.singularValueDecompose2dScale(n),a=p[0]*this.lineWidth/2,A=p[1]*this.lineWidth/2;c[0]-=a,c[1]-=A,c[2]+=a,c[3]+=A}return c}updateClipFromPath(){const i=e.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(i||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(i){this.clipBox=i,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(i=v.FILL,n=null){return e.Util.intersect(this.clipBox,this.getPathBoundingBox(i,n))}}function _t(et,i){if(typeof ImageData<"u"&&i instanceof ImageData){et.putImageData(i,0,0);return}const n=i.height,c=i.width,p=n%q,a=(n-p)/q,A=p===0?a:a+1,m=et.createImageData(c,q);let _=0,u;const r=i.data,h=m.data;let T,V,j,rt;if(i.kind===e.ImageKind.GRAYSCALE_1BPP){const ot=r.byteLength,yt=new Uint32Array(h.buffer,0,h.byteLength>>2),At=yt.length,ut=c+7>>3,xt=4294967295,L=e.FeatureTest.isLittleEndian?4278190080:255;for(T=0;T<A;T++){for(j=T<a?q:p,u=0,V=0;V<j;V++){const X=ot-_;let nt=0;const N=X>ut?c:X*8-7,f=N&-8;let z=0,W=0;for(;nt<f;nt+=8)W=r[_++],yt[u++]=W&128?xt:L,yt[u++]=W&64?xt:L,yt[u++]=W&32?xt:L,yt[u++]=W&16?xt:L,yt[u++]=W&8?xt:L,yt[u++]=W&4?xt:L,yt[u++]=W&2?xt:L,yt[u++]=W&1?xt:L;for(;nt<N;nt++)z===0&&(W=r[_++],z=128),yt[u++]=W&z?xt:L,z>>=1}for(;u<At;)yt[u++]=0;et.putImageData(m,0,T*q)}}else if(i.kind===e.ImageKind.RGBA_32BPP){for(V=0,rt=c*q*4,T=0;T<a;T++)h.set(r.subarray(_,_+rt)),_+=rt,et.putImageData(m,0,V),V+=q;T<A&&(rt=c*p*4,h.set(r.subarray(_,_+rt)),et.putImageData(m,0,V))}else if(i.kind===e.ImageKind.RGB_24BPP)for(j=q,rt=c*j,T=0;T<A;T++){for(T>=a&&(j=p,rt=c*j),u=0,V=rt;V--;)h[u++]=r[_++],h[u++]=r[_++],h[u++]=r[_++],h[u++]=255;et.putImageData(m,0,T*q)}else throw new Error(`bad image kind: ${i.kind}`)}function Tt(et,i){if(i.bitmap){et.drawImage(i.bitmap,0,0);return}const n=i.height,c=i.width,p=n%q,a=(n-p)/q,A=p===0?a:a+1,m=et.createImageData(c,q);let _=0;const u=i.data,r=m.data;for(let h=0;h<A;h++){const T=h<a?q:p;({srcPos:_}=Y({src:u,srcPos:_,dest:r,width:c,height:T,nonBlackColor:0})),et.putImageData(m,0,h*q)}}function Pt(et,i){const n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const c of n)et[c]!==void 0&&(i[c]=et[c]);et.setLineDash!==void 0&&(i.setLineDash(et.getLineDash()),i.lineDashOffset=et.lineDashOffset)}function Et(et){if(et.strokeStyle=et.fillStyle="#000000",et.fillRule="nonzero",et.globalAlpha=1,et.lineWidth=1,et.lineCap="butt",et.lineJoin="miter",et.miterLimit=10,et.globalCompositeOperation="source-over",et.font="10px sans-serif",et.setLineDash!==void 0&&(et.setLineDash([]),et.lineDashOffset=0),!e.isNodeJS){const{filter:i}=et;i!=="none"&&i!==""&&(et.filter="none")}}function Z(et,i,n,c){const p=et.length;for(let a=3;a<p;a+=4){const A=et[a];if(A===0)et[a-3]=i,et[a-2]=n,et[a-1]=c;else if(A<255){const m=255-A;et[a-3]=et[a-3]*A+i*m>>8,et[a-2]=et[a-2]*A+n*m>>8,et[a-1]=et[a-1]*A+c*m>>8}}}function gt(et,i,n){const c=et.length,p=1/255;for(let a=3;a<c;a+=4){const A=n?n[et[a]]:et[a];i[a]=i[a]*A*p|0}}function kt(et,i,n){const c=et.length;for(let p=3;p<c;p+=4){const a=et[p-3]*77+et[p-2]*152+et[p-1]*28;i[p]=n?i[p]*n[a>>8]>>8:i[p]*a>>16}}function Rt(et,i,n,c,p,a,A,m,_,u,r){const h=!!a,T=h?a[0]:0,V=h?a[1]:0,j=h?a[2]:0,rt=p==="Luminosity"?kt:gt,ot=Math.min(c,Math.ceil(1048576/n));for(let yt=0;yt<c;yt+=ot){const At=Math.min(ot,c-yt),ut=et.getImageData(m-u,yt+(_-r),n,At),xt=i.getImageData(m,yt+_,n,At);h&&Z(ut.data,T,V,j),rt(ut.data,xt.data,A),i.putImageData(xt,m,yt+_)}}function qt(et,i,n,c){const p=c[0],a=c[1],A=c[2]-p,m=c[3]-a;A===0||m===0||(Rt(i.context,n,A,m,i.subtype,i.backdrop,i.transferMap,p,a,i.offsetX,i.offsetY),et.save(),et.globalAlpha=1,et.globalCompositeOperation="source-over",et.setTransform(1,0,0,1,0,0),et.drawImage(n.canvas,0,0),et.restore())}function Kt(et,i){const n=e.Util.singularValueDecompose2dScale(et);n[0]=Math.fround(n[0]),n[1]=Math.fround(n[1]);const c=Math.fround((globalThis.devicePixelRatio||1)*w.PixelsPerInch.PDF_TO_CSS_UNITS);return i!==void 0?i:n[0]<=c||n[1]<=c}const ie=["butt","round","square"],Se=["miter","round","bevel"],de={},le={},ne=class ne{constructor(i,n,c,p,a,{optionalContentConfig:A,markedContentStack:m=null},_,u){l(this,ae);l(this,ee);this.ctx=i,this.current=new Nt(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=n,this.objs=c,this.canvasFactory=p,this.filterFactory=a,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=m||[],this.optionalContentConfig=A,this.cachedCanvases=new vt(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=_,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(i,n=null){return typeof i=="string"?i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i):n}beginDrawing({transform:i,viewport:n,transparency:c=!1,background:p=null}){const a=this.ctx.canvas.width,A=this.ctx.canvas.height,m=this.ctx.fillStyle;if(this.ctx.fillStyle=p||"#ffffff",this.ctx.fillRect(0,0,a,A),this.ctx.fillStyle=m,c){const _=this.cachedCanvases.getCanvas("transparent",a,A);this.compositeCtx=this.ctx,this.transparentCanvas=_.canvas,this.ctx=_.context,this.ctx.save(),this.ctx.transform(...(0,w.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),Et(this.ctx),i&&(this.ctx.transform(...i),this.outputScaleX=i[0],this.outputScaleY=i[0]),this.ctx.transform(...n.transform),this.viewportScale=n.scale,this.baseTransform=(0,w.getCurrentTransform)(this.ctx)}executeOperatorList(i,n,c,p){const a=i.argsArray,A=i.fnArray;let m=n||0;const _=a.length;if(_===m)return m;const u=_-m>B&&typeof c=="function",r=u?Date.now()+U:0;let h=0;const T=this.commonObjs,V=this.objs;let j;for(;;){if(p!==void 0&&m===p.nextBreakPoint)return p.breakIt(m,c),m;if(j=A[m],j!==e.OPS.dependency)this[j].apply(this,a[m]);else for(const rt of a[m]){const ot=rt.startsWith("g_")?T:V;if(!ot.has(rt))return ot.get(rt,c),m}if(m++,m===_)return m;if(u&&++h>B){if(Date.now()>r)return c(),m;h=0}}}endDrawing(){S(this,ae,Pn).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const i of this._cachedBitmapsMap.values()){for(const n of i.values())typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&(n.width=n.height=0);i.clear()}this._cachedBitmapsMap.clear(),S(this,ee,kn).call(this)}_scaleImage(i,n){const c=i.width,p=i.height;let a=Math.max(Math.hypot(n[0],n[1]),1),A=Math.max(Math.hypot(n[2],n[3]),1),m=c,_=p,u="prescale1",r,h;for(;a>2&&m>1||A>2&&_>1;){let T=m,V=_;a>2&&m>1&&(T=m>=16384?Math.floor(m/2)-1||1:Math.ceil(m/2),a/=m/T),A>2&&_>1&&(V=_>=16384?Math.floor(_/2)-1||1:Math.ceil(_)/2,A/=_/V),r=this.cachedCanvases.getCanvas(u,T,V),h=r.context,h.clearRect(0,0,T,V),h.drawImage(i,0,0,m,_,0,0,T,V),i=r.canvas,m=T,_=V,u=u==="prescale1"?"prescale2":"prescale1"}return{img:i,paintWidth:m,paintHeight:_}}_createMaskCanvas(i){const n=this.ctx,{width:c,height:p}=i,a=this.current.fillColor,A=this.current.patternFill,m=(0,w.getCurrentTransform)(n);let _,u,r,h;if((i.bitmap||i.data)&&i.count>1){const N=i.bitmap||i.data.buffer;u=JSON.stringify(A?m:[m.slice(0,4),a]),_=this._cachedBitmapsMap.get(N),_||(_=new Map,this._cachedBitmapsMap.set(N,_));const f=_.get(u);if(f&&!A){const z=Math.round(Math.min(m[0],m[2])+m[4]),W=Math.round(Math.min(m[1],m[3])+m[5]);return{canvas:f,offsetX:z,offsetY:W}}r=f}r||(h=this.cachedCanvases.getCanvas("maskCanvas",c,p),Tt(h.context,i));let T=e.Util.transform(m,[1/c,0,0,-1/p,0,0]);T=e.Util.transform(T,[1,0,0,1,0,-p]);const[V,j,rt,ot]=e.Util.getAxialAlignedBoundingBox([0,0,c,p],T),yt=Math.round(rt-V)||1,At=Math.round(ot-j)||1,ut=this.cachedCanvases.getCanvas("fillCanvas",yt,At),xt=ut.context,L=V,X=j;xt.translate(-L,-X),xt.transform(...T),r||(r=this._scaleImage(h.canvas,(0,w.getCurrentTransformInverse)(xt)),r=r.img,_&&A&&_.set(u,r)),xt.imageSmoothingEnabled=Kt((0,w.getCurrentTransform)(xt),i.interpolate),Ft(xt,r,0,0,r.width,r.height,0,0,c,p),xt.globalCompositeOperation="source-in";const nt=e.Util.transform((0,w.getCurrentTransformInverse)(xt),[1,0,0,1,-L,-X]);return xt.fillStyle=A?a.getPattern(n,this,nt,v.FILL):a,xt.fillRect(0,0,c,p),_&&!A&&(this.cachedCanvases.delete("fillCanvas"),_.set(u,ut.canvas)),{canvas:ut.canvas,offsetX:Math.round(L),offsetY:Math.round(X)}}setLineWidth(i){i!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=i,this.ctx.lineWidth=i}setLineCap(i){this.ctx.lineCap=ie[i]}setLineJoin(i){this.ctx.lineJoin=Se[i]}setMiterLimit(i){this.ctx.miterLimit=i}setDash(i,n){const c=this.ctx;c.setLineDash!==void 0&&(c.setLineDash(i),c.lineDashOffset=n)}setRenderingIntent(i){}setFlatness(i){}setGState(i){for(const[n,c]of i)switch(n){case"LW":this.setLineWidth(c);break;case"LC":this.setLineCap(c);break;case"LJ":this.setLineJoin(c);break;case"ML":this.setMiterLimit(c);break;case"D":this.setDash(c[0],c[1]);break;case"RI":this.setRenderingIntent(c);break;case"FL":this.setFlatness(c);break;case"Font":this.setFont(c[0],c[1]);break;case"CA":this.current.strokeAlpha=c;break;case"ca":this.current.fillAlpha=c,this.ctx.globalAlpha=c;break;case"BM":this.ctx.globalCompositeOperation=c;break;case"SMask":this.current.activeSMask=c?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(c);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const i=this.inSMaskMode;this.current.activeSMask&&!i?this.beginSMaskMode():!this.current.activeSMask&&i&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const i=this.ctx.canvas.width,n=this.ctx.canvas.height,c="smaskGroupAt"+this.groupLevel,p=this.cachedCanvases.getCanvas(c,i,n);this.suspendedCtx=this.ctx,this.ctx=p.context;const a=this.ctx;a.setTransform(...(0,w.getCurrentTransform)(this.suspendedCtx)),Pt(this.suspendedCtx,a),tt(a,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Pt(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(i){if(!this.current.activeSMask)return;i?(i[0]=Math.floor(i[0]),i[1]=Math.floor(i[1]),i[2]=Math.ceil(i[2]),i[3]=Math.ceil(i[3])):i=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const n=this.current.activeSMask,c=this.suspendedCtx;qt(c,n,this.ctx,i),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(Pt(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const i=this.current;this.stateStack.push(i),this.current=i.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Pt(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(i,n,c,p,a,A){this.ctx.transform(i,n,c,p,a,A),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(i,n,c){const p=this.ctx,a=this.current;let A=a.x,m=a.y,_,u;const r=(0,w.getCurrentTransform)(p),h=r[0]===0&&r[3]===0||r[1]===0&&r[2]===0,T=h?c.slice(0):null;for(let V=0,j=0,rt=i.length;V<rt;V++)switch(i[V]|0){case e.OPS.rectangle:A=n[j++],m=n[j++];const ot=n[j++],yt=n[j++],At=A+ot,ut=m+yt;p.moveTo(A,m),ot===0||yt===0?p.lineTo(At,ut):(p.lineTo(At,m),p.lineTo(At,ut),p.lineTo(A,ut)),h||a.updateRectMinMax(r,[A,m,At,ut]),p.closePath();break;case e.OPS.moveTo:A=n[j++],m=n[j++],p.moveTo(A,m),h||a.updatePathMinMax(r,A,m);break;case e.OPS.lineTo:A=n[j++],m=n[j++],p.lineTo(A,m),h||a.updatePathMinMax(r,A,m);break;case e.OPS.curveTo:_=A,u=m,A=n[j+4],m=n[j+5],p.bezierCurveTo(n[j],n[j+1],n[j+2],n[j+3],A,m),a.updateCurvePathMinMax(r,_,u,n[j],n[j+1],n[j+2],n[j+3],A,m,T),j+=6;break;case e.OPS.curveTo2:_=A,u=m,p.bezierCurveTo(A,m,n[j],n[j+1],n[j+2],n[j+3]),a.updateCurvePathMinMax(r,_,u,A,m,n[j],n[j+1],n[j+2],n[j+3],T),A=n[j+2],m=n[j+3],j+=4;break;case e.OPS.curveTo3:_=A,u=m,A=n[j+2],m=n[j+3],p.bezierCurveTo(n[j],n[j+1],A,m,A,m),a.updateCurvePathMinMax(r,_,u,n[j],n[j+1],A,m,A,m,T),j+=4;break;case e.OPS.closePath:p.closePath();break}h&&a.updateScalingPathMinMax(r,T),a.setCurrentPoint(A,m)}closePath(){this.ctx.closePath()}stroke(i=!0){const n=this.ctx,c=this.current.strokeColor;n.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof c=="object"&&(c!=null&&c.getPattern)?(n.save(),n.strokeStyle=c.getPattern(n,this,(0,w.getCurrentTransformInverse)(n),v.STROKE),this.rescaleAndStroke(!1),n.restore()):this.rescaleAndStroke(!0)),i&&this.consumePath(this.current.getClippedPathBoundingBox()),n.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(i=!0){const n=this.ctx,c=this.current.fillColor,p=this.current.patternFill;let a=!1;p&&(n.save(),n.fillStyle=c.getPattern(n,this,(0,w.getCurrentTransformInverse)(n),v.FILL),a=!0);const A=this.current.getClippedPathBoundingBox();this.contentVisible&&A!==null&&(this.pendingEOFill?(n.fill("evenodd"),this.pendingEOFill=!1):n.fill()),a&&n.restore(),i&&this.consumePath(A)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=de}eoClip(){this.pendingClip=le}beginText(){this.current.textMatrix=e.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const i=this.pendingTextPaths,n=this.ctx;if(i===void 0){n.beginPath();return}n.save(),n.beginPath();for(const c of i)n.setTransform(...c.transform),n.translate(c.x,c.y),c.addToPath(n,c.fontSize);n.restore(),n.clip(),n.beginPath(),delete this.pendingTextPaths}setCharSpacing(i){this.current.charSpacing=i}setWordSpacing(i){this.current.wordSpacing=i}setHScale(i){this.current.textHScale=i/100}setLeading(i){this.current.leading=-i}setFont(i,n){var r;const c=this.commonObjs.get(i),p=this.current;if(!c)throw new Error(`Can't find font for ${i}`);if(p.fontMatrix=c.fontMatrix||e.FONT_IDENTITY_MATRIX,(p.fontMatrix[0]===0||p.fontMatrix[3]===0)&&(0,e.warn)("Invalid font matrix for font "+i),n<0?(n=-n,p.fontDirection=-1):p.fontDirection=1,this.current.font=c,this.current.fontSize=n,c.isType3Font)return;const a=c.loadedName||"sans-serif",A=((r=c.systemFontInfo)==null?void 0:r.css)||`"${a}", ${c.fallbackName}`;let m="normal";c.black?m="900":c.bold&&(m="bold");const _=c.italic?"italic":"normal";let u=n;n<at?u=at:n>Q&&(u=Q),this.current.fontSizeScale=n/u,this.ctx.font=`${_} ${m} ${u}px ${A}`}setTextRenderingMode(i){this.current.textRenderingMode=i}setTextRise(i){this.current.textRise=i}moveText(i,n){this.current.x=this.current.lineX+=i,this.current.y=this.current.lineY+=n}setLeadingMoveText(i,n){this.setLeading(-n),this.moveText(i,n)}setTextMatrix(i,n,c,p,a,A){this.current.textMatrix=[i,n,c,p,a,A],this.current.textMatrixScale=Math.hypot(i,n),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(i,n,c,p){const a=this.ctx,A=this.current,m=A.font,_=A.textRenderingMode,u=A.fontSize/A.fontSizeScale,r=_&e.TextRenderingMode.FILL_STROKE_MASK,h=!!(_&e.TextRenderingMode.ADD_TO_PATH_FLAG),T=A.patternFill&&!m.missingFile;let V;(m.disableFontFace||h||T)&&(V=m.getPathGenerator(this.commonObjs,i)),m.disableFontFace||T?(a.save(),a.translate(n,c),a.beginPath(),V(a,u),p&&a.setTransform(...p),(r===e.TextRenderingMode.FILL||r===e.TextRenderingMode.FILL_STROKE)&&a.fill(),(r===e.TextRenderingMode.STROKE||r===e.TextRenderingMode.FILL_STROKE)&&a.stroke(),a.restore()):((r===e.TextRenderingMode.FILL||r===e.TextRenderingMode.FILL_STROKE)&&a.fillText(i,n,c),(r===e.TextRenderingMode.STROKE||r===e.TextRenderingMode.FILL_STROKE)&&a.strokeText(i,n,c)),h&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,w.getCurrentTransform)(a),x:n,y:c,fontSize:u,addToPath:V})}get isFontSubpixelAAEnabled(){const{context:i}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);i.scale(1.5,1),i.fillText("I",0,10);const n=i.getImageData(0,0,10,10).data;let c=!1;for(let p=3;p<n.length;p+=4)if(n[p]>0&&n[p]<255){c=!0;break}return(0,e.shadow)(this,"isFontSubpixelAAEnabled",c)}showText(i){const n=this.current,c=n.font;if(c.isType3Font)return this.showType3Text(i);const p=n.fontSize;if(p===0)return;const a=this.ctx,A=n.fontSizeScale,m=n.charSpacing,_=n.wordSpacing,u=n.fontDirection,r=n.textHScale*u,h=i.length,T=c.vertical,V=T?1:-1,j=c.defaultVMetrics,rt=p*n.fontMatrix[0],ot=n.textRenderingMode===e.TextRenderingMode.FILL&&!c.disableFontFace&&!n.patternFill;a.save(),a.transform(...n.textMatrix),a.translate(n.x,n.y+n.textRise),u>0?a.scale(r,-1):a.scale(r,1);let yt;if(n.patternFill){a.save();const X=n.fillColor.getPattern(a,this,(0,w.getCurrentTransformInverse)(a),v.FILL);yt=(0,w.getCurrentTransform)(a),a.restore(),a.fillStyle=X}let At=n.lineWidth;const ut=n.textMatrixScale;if(ut===0||At===0){const X=n.textRenderingMode&e.TextRenderingMode.FILL_STROKE_MASK;(X===e.TextRenderingMode.STROKE||X===e.TextRenderingMode.FILL_STROKE)&&(At=this.getSinglePixelWidth())}else At/=ut;if(A!==1&&(a.scale(A,A),At/=A),a.lineWidth=At,c.isInvalidPDFjsFont){const X=[];let nt=0;for(const N of i)X.push(N.unicode),nt+=N.width;a.fillText(X.join(""),0,0),n.x+=nt*rt*r,a.restore(),this.compose();return}let xt=0,L;for(L=0;L<h;++L){const X=i[L];if(typeof X=="number"){xt+=V*X*p/1e3;continue}let nt=!1;const N=(X.isSpace?_:0)+m,f=X.fontChar,z=X.accent;let W,lt,ft=X.width;if(T){const Dt=X.vmetric||j,te=-(X.vmetric?Dt[1]:ft*.5)*rt,re=Dt[2]*rt;ft=Dt?-Dt[0]:ft,W=te/A,lt=(xt+re)/A}else W=xt/A,lt=0;if(c.remeasure&&ft>0){const Dt=a.measureText(f).width*1e3/p*A;if(ft<Dt&&this.isFontSubpixelAAEnabled){const te=ft/Dt;nt=!0,a.save(),a.scale(te,1),W/=te}else ft!==Dt&&(W+=(ft-Dt)/2e3*p/A)}if(this.contentVisible&&(X.isInFont||c.missingFile)){if(ot&&!z)a.fillText(f,W,lt);else if(this.paintChar(f,W,lt,yt),z){const Dt=W+p*z.offset.x/A,te=lt-p*z.offset.y/A;this.paintChar(z.fontChar,Dt,te,yt)}}const Mt=T?ft*rt-N*u:ft*rt+N*u;xt+=Mt,nt&&a.restore()}T?n.y-=xt:n.x+=xt*r,a.restore(),this.compose()}showType3Text(i){const n=this.ctx,c=this.current,p=c.font,a=c.fontSize,A=c.fontDirection,m=p.vertical?1:-1,_=c.charSpacing,u=c.wordSpacing,r=c.textHScale*A,h=c.fontMatrix||e.FONT_IDENTITY_MATRIX,T=i.length,V=c.textRenderingMode===e.TextRenderingMode.INVISIBLE;let j,rt,ot,yt;if(!(V||a===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),n.transform(...c.textMatrix),n.translate(c.x,c.y),n.scale(r,A),j=0;j<T;++j){if(rt=i[j],typeof rt=="number"){yt=m*rt*a/1e3,this.ctx.translate(yt,0),c.x+=yt*r;continue}const At=(rt.isSpace?u:0)+_,ut=p.charProcOperatorList[rt.operatorListId];if(!ut){(0,e.warn)(`Type3 character "${rt.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=rt,this.save(),n.scale(a,a),n.transform(...h),this.executeOperatorList(ut),this.restore()),ot=e.Util.applyTransform([rt.width,0],h)[0]*a+At,n.translate(ot,0),c.x+=ot*r}n.restore(),this.processingType3=null}}setCharWidth(i,n){}setCharWidthAndBounds(i,n,c,p,a,A){this.ctx.rect(c,p,a-c,A-p),this.ctx.clip(),this.endPath()}getColorN_Pattern(i){let n;if(i[0]==="TilingPattern"){const c=i[1],p=this.baseTransform||(0,w.getCurrentTransform)(this.ctx),a={createCanvasGraphics:A=>new ne(A,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};n=new $(i,c,this.ctx,a,p)}else n=this._getPattern(i[1],i[2]);return n}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(i,n,c){const p=e.Util.makeHexColor(i,n,c);this.ctx.strokeStyle=p,this.current.strokeColor=p}setFillRGBColor(i,n,c){const p=e.Util.makeHexColor(i,n,c);this.ctx.fillStyle=p,this.current.fillColor=p,this.current.patternFill=!1}_getPattern(i,n=null){let c;return this.cachedPatterns.has(i)?c=this.cachedPatterns.get(i):(c=E(this.getObject(i)),this.cachedPatterns.set(i,c)),n&&(c.matrix=n),c}shadingFill(i){if(!this.contentVisible)return;const n=this.ctx;this.save();const c=this._getPattern(i);n.fillStyle=c.getPattern(n,this,(0,w.getCurrentTransformInverse)(n),v.SHADING);const p=(0,w.getCurrentTransformInverse)(n);if(p){const{width:a,height:A}=n.canvas,[m,_,u,r]=e.Util.getAxialAlignedBoundingBox([0,0,a,A],p);this.ctx.fillRect(m,_,u-m,r-_)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,e.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,e.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(i,n){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(i)&&i.length===6&&this.transform(...i),this.baseTransform=(0,w.getCurrentTransform)(this.ctx),n)){const c=n[2]-n[0],p=n[3]-n[1];this.ctx.rect(n[0],n[1],c,p),this.current.updateRectMinMax((0,w.getCurrentTransform)(this.ctx),n),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(i){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;i.isolated||(0,e.info)("TODO: Support non-isolated groups."),i.knockout&&(0,e.warn)("Knockout groups not supported.");const c=(0,w.getCurrentTransform)(n);if(i.matrix&&n.transform(...i.matrix),!i.bbox)throw new Error("Bounding box is required.");let p=e.Util.getAxialAlignedBoundingBox(i.bbox,(0,w.getCurrentTransform)(n));const a=[0,0,n.canvas.width,n.canvas.height];p=e.Util.intersect(p,a)||[0,0,0,0];const A=Math.floor(p[0]),m=Math.floor(p[1]);let _=Math.max(Math.ceil(p[2])-A,1),u=Math.max(Math.ceil(p[3])-m,1),r=1,h=1;_>M&&(r=_/M,_=M),u>M&&(h=u/M,u=M),this.current.startNewPathAndClipBox([0,0,_,u]);let T="groupAt"+this.groupLevel;i.smask&&(T+="_smask_"+this.smaskCounter++%2);const V=this.cachedCanvases.getCanvas(T,_,u),j=V.context;j.scale(1/r,1/h),j.translate(-A,-m),j.transform(...c),i.smask?this.smaskStack.push({canvas:V.canvas,context:j,offsetX:A,offsetY:m,scaleX:r,scaleY:h,subtype:i.smask.subtype,backdrop:i.smask.backdrop,transferMap:i.smask.transferMap||null,startTransformInverse:null}):(n.setTransform(1,0,0,1,0,0),n.translate(A,m),n.scale(r,h),n.save()),Pt(n,j),this.ctx=j,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(i){if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,c=this.groupStack.pop();if(this.ctx=c,this.ctx.imageSmoothingEnabled=!1,i.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const p=(0,w.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...p);const a=e.Util.getAxialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],p);this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(a)}}beginAnnotation(i,n,c,p,a){if(S(this,ae,Pn).call(this),Et(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(n)&&n.length===4){const A=n[2]-n[0],m=n[3]-n[1];if(a&&this.annotationCanvasMap){c=c.slice(),c[4]-=n[0],c[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=A,n[3]=m;const[_,u]=e.Util.singularValueDecompose2dScale((0,w.getCurrentTransform)(this.ctx)),{viewportScale:r}=this,h=Math.ceil(A*this.outputScaleX*r),T=Math.ceil(m*this.outputScaleY*r);this.annotationCanvas=this.canvasFactory.create(h,T);const{canvas:V,context:j}=this.annotationCanvas;this.annotationCanvasMap.set(i,V),this.annotationCanvas.savedCtx=this.ctx,this.ctx=j,this.ctx.save(),this.ctx.setTransform(_,0,0,-u,0,m*u),Et(this.ctx)}else Et(this.ctx),this.ctx.rect(n[0],n[1],A,m),this.ctx.clip(),this.endPath()}this.current=new Nt(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...c),this.transform(...p)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),S(this,ee,kn).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(i){if(!this.contentVisible)return;const n=i.count;i=this.getObject(i.data,i),i.count=n;const c=this.ctx,p=this.processingType3;if(p&&(p.compiled===void 0&&(p.compiled=Ct(i)),p.compiled)){p.compiled(c);return}const a=this._createMaskCanvas(i),A=a.canvas;c.save(),c.setTransform(1,0,0,1,0,0),c.drawImage(A,a.offsetX,a.offsetY),c.restore(),this.compose()}paintImageMaskXObjectRepeat(i,n,c=0,p=0,a,A){if(!this.contentVisible)return;i=this.getObject(i.data,i);const m=this.ctx;m.save();const _=(0,w.getCurrentTransform)(m);m.transform(n,c,p,a,0,0);const u=this._createMaskCanvas(i);m.setTransform(1,0,0,1,u.offsetX-_[4],u.offsetY-_[5]);for(let r=0,h=A.length;r<h;r+=2){const T=e.Util.transform(_,[n,c,p,a,A[r],A[r+1]]),[V,j]=e.Util.applyTransform([0,0],T);m.drawImage(u.canvas,V,j)}m.restore(),this.compose()}paintImageMaskXObjectGroup(i){if(!this.contentVisible)return;const n=this.ctx,c=this.current.fillColor,p=this.current.patternFill;for(const a of i){const{data:A,width:m,height:_,transform:u}=a,r=this.cachedCanvases.getCanvas("maskCanvas",m,_),h=r.context;h.save();const T=this.getObject(A,a);Tt(h,T),h.globalCompositeOperation="source-in",h.fillStyle=p?c.getPattern(h,this,(0,w.getCurrentTransformInverse)(n),v.FILL):c,h.fillRect(0,0,m,_),h.restore(),n.save(),n.transform(...u),n.scale(1,-1),Ft(n,r.canvas,0,0,m,_,0,-1,1,1),n.restore()}this.compose()}paintImageXObject(i){if(!this.contentVisible)return;const n=this.getObject(i);if(!n){(0,e.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(n)}paintImageXObjectRepeat(i,n,c,p){if(!this.contentVisible)return;const a=this.getObject(i);if(!a){(0,e.warn)("Dependent image isn't ready yet");return}const A=a.width,m=a.height,_=[];for(let u=0,r=p.length;u<r;u+=2)_.push({transform:[n,0,0,c,p[u],p[u+1]],x:0,y:0,w:A,h:m});this.paintInlineImageXObjectGroup(a,_)}applyTransferMapsToCanvas(i){return this.current.transferMaps!=="none"&&(i.filter=this.current.transferMaps,i.drawImage(i.canvas,0,0),i.filter="none"),i.canvas}applyTransferMapsToBitmap(i){if(this.current.transferMaps==="none")return i.bitmap;const{bitmap:n,width:c,height:p}=i,a=this.cachedCanvases.getCanvas("inlineImage",c,p),A=a.context;return A.filter=this.current.transferMaps,A.drawImage(n,0,0),A.filter="none",a.canvas}paintInlineImageXObject(i){if(!this.contentVisible)return;const n=i.width,c=i.height,p=this.ctx;if(this.save(),!e.isNodeJS){const{filter:m}=p;m!=="none"&&m!==""&&(p.filter="none")}p.scale(1/n,-1/c);let a;if(i.bitmap)a=this.applyTransferMapsToBitmap(i);else if(typeof HTMLElement=="function"&&i instanceof HTMLElement||!i.data)a=i;else{const m=this.cachedCanvases.getCanvas("inlineImage",n,c).context;_t(m,i),a=this.applyTransferMapsToCanvas(m)}const A=this._scaleImage(a,(0,w.getCurrentTransformInverse)(p));p.imageSmoothingEnabled=Kt((0,w.getCurrentTransform)(p),i.interpolate),Ft(p,A.img,0,0,A.paintWidth,A.paintHeight,0,-c,n,c),this.compose(),this.restore()}paintInlineImageXObjectGroup(i,n){if(!this.contentVisible)return;const c=this.ctx;let p;if(i.bitmap)p=i.bitmap;else{const a=i.width,A=i.height,m=this.cachedCanvases.getCanvas("inlineImage",a,A).context;_t(m,i),p=this.applyTransferMapsToCanvas(m)}for(const a of n)c.save(),c.transform(...a.transform),c.scale(1,-1),Ft(c,p,a.x,a.y,a.w,a.h,0,-1,1,1),c.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(i){}markPointProps(i,n){}beginMarkedContent(i){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(i,n){i==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(i){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const c=this.ctx;this.pendingClip&&(n||(this.pendingClip===le?c.clip("evenodd"):c.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),c.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const i=(0,w.getCurrentTransform)(this.ctx);if(i[1]===0&&i[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(i[0]),Math.abs(i[3]));else{const n=Math.abs(i[0]*i[3]-i[2]*i[1]),c=Math.hypot(i[0],i[2]),p=Math.hypot(i[1],i[3]);this._cachedGetSinglePixelWidth=Math.max(c,p)/n}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:i}=this.current,{a:n,b:c,c:p,d:a}=this.ctx.getTransform();let A,m;if(c===0&&p===0){const _=Math.abs(n),u=Math.abs(a);if(_===u)if(i===0)A=m=1/_;else{const r=_*i;A=m=r<1?1/r:1}else if(i===0)A=1/_,m=1/u;else{const r=_*i,h=u*i;A=r<1?1/r:1,m=h<1?1/h:1}}else{const _=Math.abs(n*a-c*p),u=Math.hypot(n,c),r=Math.hypot(p,a);if(i===0)A=r/_,m=u/_;else{const h=i*_;A=r>h?r/h:1,m=u>h?u/h:1}}this._cachedScaleForStroking[0]=A,this._cachedScaleForStroking[1]=m}return this._cachedScaleForStroking}rescaleAndStroke(i){const{ctx:n}=this,{lineWidth:c}=this.current,[p,a]=this.getScaleForStroking();if(n.lineWidth=c||1,p===1&&a===1){n.stroke();return}const A=n.getLineDash();if(i&&n.save(),n.scale(p,a),A.length>0){const m=Math.max(p,a);n.setLineDash(A.map(_=>_/m)),n.lineDashOffset/=m}n.stroke(),i&&n.restore()}isContentVisible(){for(let i=this.markedContentStack.length-1;i>=0;i--)if(!this.markedContentStack[i].visible)return!1;return!0}};ae=new WeakSet,Pn=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},ee=new WeakSet,kn=function(){if(this.pageColors){const i=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(i!=="none"){const n=this.ctx.filter;this.ctx.filter=i,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=n}}};let ve=ne;for(const et in e.OPS)ve.prototype[et]!==void 0&&(ve.prototype[e.OPS[et]]=ve.prototype[et])},419:(o,b,d)=>{var Pt,Et,Z,gt,kt,Rt,qt,Js,ie,Qs,de,Zs,ve,Rn,ae,Ki,ee,Yi,ne,Ai,i,yi;d.d(b,{DOMCMapReaderFactory:()=>g,DOMCanvasFactory:()=>k,DOMFilterFactory:()=>K,DOMSVGFactory:()=>I,DOMStandardFontDataFactory:()=>G,PDFDateString:()=>q,PageViewport:()=>E,PixelsPerInch:()=>R,RenderingCancelledException:()=>H,StatTimer:()=>M,fetchData:()=>y,getColorValues:()=>Ft,getCurrentTransform:()=>Ct,getCurrentTransformInverse:()=>Nt,getFilenameFromUrl:()=>at,getPdfFilenameFromUrl:()=>Q,getRGB:()=>vt,getXfaPageViewport:()=>tt,isDataScheme:()=>$,isPdfFile:()=>Y,isValidFetchUrl:()=>U,noContextMenu:()=>B,setLayerDimensions:()=>_t});var e=d(583),w=d(292);const v="http://www.w3.org/2000/svg",Tt=class Tt{};me(Tt,"CSS",96),me(Tt,"PDF",72),me(Tt,"PDF_TO_CSS_UNITS",Tt.CSS/Tt.PDF);let R=Tt;class K extends e.BaseFilterFactory{constructor({docId:a,ownerDocument:A=globalThis.document}={}){super();l(this,qt);l(this,ie);l(this,de);l(this,ve);l(this,ae);l(this,ee);l(this,ne);l(this,i);l(this,Pt,void 0);l(this,Et,void 0);l(this,Z,void 0);l(this,gt,void 0);l(this,kt,void 0);l(this,Rt,0);P(this,Z,a),P(this,gt,A)}addFilter(a){if(!a)return"none";let A=t(this,qt,Js).get(a);if(A)return A;let m,_,u,r;if(a.length===1){const j=a[0],rt=new Array(256);for(let ot=0;ot<256;ot++)rt[ot]=j[ot]/255;r=m=_=u=rt.join(",")}else{const[j,rt,ot]=a,yt=new Array(256),At=new Array(256),ut=new Array(256);for(let xt=0;xt<256;xt++)yt[xt]=j[xt]/255,At[xt]=rt[xt]/255,ut[xt]=ot[xt]/255;m=yt.join(","),_=At.join(","),u=ut.join(","),r=`${m}${_}${u}`}if(A=t(this,qt,Js).get(r),A)return t(this,qt,Js).set(a,A),A;const h=`g_${t(this,Z)}_transfer_map_${vs(this,Rt)._++}`,T=`url(#${h})`;t(this,qt,Js).set(a,T),t(this,qt,Js).set(r,T);const V=S(this,ae,Ki).call(this,h);return S(this,ne,Ai).call(this,m,_,u,V),T}addHCMFilter(a,A){var yt;const m=`${a}-${A}`,_="base";let u=t(this,ie,Qs).get(_);if((u==null?void 0:u.key)===m||(u?((yt=u.filter)==null||yt.remove(),u.key=m,u.url="none",u.filter=null):(u={key:m,url:"none",filter:null},t(this,ie,Qs).set(_,u)),!a||!A))return u.url;const r=S(this,i,yi).call(this,a);a=w.Util.makeHexColor(...r);const h=S(this,i,yi).call(this,A);if(A=w.Util.makeHexColor(...h),t(this,de,Zs).style.color="",a==="#000000"&&A==="#ffffff"||a===A)return u.url;const T=new Array(256);for(let At=0;At<=255;At++){const ut=At/255;T[At]=ut<=.03928?ut/12.92:((ut+.055)/1.055)**2.4}const V=T.join(","),j=`g_${t(this,Z)}_hcm_filter`,rt=u.filter=S(this,ae,Ki).call(this,j);S(this,ne,Ai).call(this,V,V,V,rt),S(this,ve,Rn).call(this,rt);const ot=(At,ut)=>{const xt=r[At]/255,L=h[At]/255,X=new Array(ut+1);for(let nt=0;nt<=ut;nt++)X[nt]=xt+nt/ut*(L-xt);return X.join(",")};return S(this,ne,Ai).call(this,ot(0,5),ot(1,5),ot(2,5),rt),u.url=`url(#${j})`,u.url}addHighlightHCMFilter(a,A,m,_,u){var L;const r=`${A}-${m}-${_}-${u}`;let h=t(this,ie,Qs).get(a);if((h==null?void 0:h.key)===r||(h?((L=h.filter)==null||L.remove(),h.key=r,h.url="none",h.filter=null):(h={key:r,url:"none",filter:null},t(this,ie,Qs).set(a,h)),!A||!m))return h.url;const[T,V]=[A,m].map(S(this,i,yi).bind(this));let j=Math.round(.2126*T[0]+.7152*T[1]+.0722*T[2]),rt=Math.round(.2126*V[0]+.7152*V[1]+.0722*V[2]),[ot,yt]=[_,u].map(S(this,i,yi).bind(this));rt<j&&([j,rt,ot,yt]=[rt,j,yt,ot]),t(this,de,Zs).style.color="";const At=(X,nt,N)=>{const f=new Array(256),z=(rt-j)/N,W=X/255,lt=(nt-X)/(255*N);let ft=0;for(let Mt=0;Mt<=N;Mt++){const Dt=Math.round(j+Mt*z),te=W+Mt*lt;for(let re=ft;re<=Dt;re++)f[re]=te;ft=Dt+1}for(let Mt=ft;Mt<256;Mt++)f[Mt]=f[ft-1];return f.join(",")},ut=`g_${t(this,Z)}_hcm_${a}_filter`,xt=h.filter=S(this,ae,Ki).call(this,ut);return S(this,ve,Rn).call(this,xt),S(this,ne,Ai).call(this,At(ot[0],yt[0],5),At(ot[1],yt[1],5),At(ot[2],yt[2],5),xt),h.url=`url(#${ut})`,h.url}destroy(a=!1){a&&t(this,ie,Qs).size!==0||(t(this,Et)&&(t(this,Et).parentNode.parentNode.remove(),P(this,Et,null)),t(this,Pt)&&(t(this,Pt).clear(),P(this,Pt,null)),P(this,Rt,0))}}Pt=new WeakMap,Et=new WeakMap,Z=new WeakMap,gt=new WeakMap,kt=new WeakMap,Rt=new WeakMap,qt=new WeakSet,Js=function(){return t(this,Pt)||P(this,Pt,new Map)},ie=new WeakSet,Qs=function(){return t(this,kt)||P(this,kt,new Map)},de=new WeakSet,Zs=function(){if(!t(this,Et)){const a=t(this,gt).createElement("div"),{style:A}=a;A.visibility="hidden",A.contain="strict",A.width=A.height=0,A.position="absolute",A.top=A.left=0,A.zIndex=-1;const m=t(this,gt).createElementNS(v,"svg");m.setAttribute("width",0),m.setAttribute("height",0),P(this,Et,t(this,gt).createElementNS(v,"defs")),a.append(m),m.append(t(this,Et)),t(this,gt).body.append(a)}return t(this,Et)},ve=new WeakSet,Rn=function(a){const A=t(this,gt).createElementNS(v,"feColorMatrix");A.setAttribute("type","matrix"),A.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),a.append(A)},ae=new WeakSet,Ki=function(a){const A=t(this,gt).createElementNS(v,"filter");return A.setAttribute("color-interpolation-filters","sRGB"),A.setAttribute("id",a),t(this,de,Zs).append(A),A},ee=new WeakSet,Yi=function(a,A,m){const _=t(this,gt).createElementNS(v,A);_.setAttribute("type","discrete"),_.setAttribute("tableValues",m),a.append(_)},ne=new WeakSet,Ai=function(a,A,m,_){const u=t(this,gt).createElementNS(v,"feComponentTransfer");_.append(u),S(this,ee,Yi).call(this,u,"feFuncR",a),S(this,ee,Yi).call(this,u,"feFuncG",A),S(this,ee,Yi).call(this,u,"feFuncB",m)},i=new WeakSet,yi=function(a){return t(this,de,Zs).style.color=a,vt(getComputedStyle(t(this,de,Zs)).getPropertyValue("color"))};class k extends e.BaseCanvasFactory{constructor({ownerDocument:p=globalThis.document}={}){super(),this._document=p}_createCanvas(p,a){const A=this._document.createElement("canvas");return A.width=p,A.height=a,A}}async function y(c,p="text"){if(U(c,document.baseURI)){const a=await fetch(c);if(!a.ok)throw new Error(a.statusText);switch(p){case"arraybuffer":return a.arrayBuffer();case"blob":return a.blob();case"json":return a.json()}return a.text()}return new Promise((a,A)=>{const m=new XMLHttpRequest;m.open("GET",c,!0),m.responseType=p,m.onreadystatechange=()=>{if(m.readyState===XMLHttpRequest.DONE){if(m.status===200||m.status===0){switch(p){case"arraybuffer":case"blob":case"json":a(m.response);return}a(m.responseText);return}A(new Error(m.statusText))}},m.send(null)})}class g extends e.BaseCMapReaderFactory{_fetchData(p,a){return y(p,this.isCompressed?"arraybuffer":"text").then(A=>({cMapData:A instanceof ArrayBuffer?new Uint8Array(A):(0,w.stringToBytes)(A),compressionType:a}))}}class G extends e.BaseStandardFontDataFactory{_fetchData(p){return y(p,"arraybuffer").then(a=>new Uint8Array(a))}}class I extends e.BaseSVGFactory{_createSVG(p){return document.createElementNS(v,p)}}class E{constructor({viewBox:p,scale:a,rotation:A,offsetX:m=0,offsetY:_=0,dontFlip:u=!1}){this.viewBox=p,this.scale=a,this.rotation=A,this.offsetX=m,this.offsetY=_;const r=(p[2]+p[0])/2,h=(p[3]+p[1])/2;let T,V,j,rt;switch(A%=360,A<0&&(A+=360),A){case 180:T=-1,V=0,j=0,rt=1;break;case 90:T=0,V=1,j=1,rt=0;break;case 270:T=0,V=-1,j=-1,rt=0;break;case 0:T=1,V=0,j=0,rt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(j=-j,rt=-rt);let ot,yt,At,ut;T===0?(ot=Math.abs(h-p[1])*a+m,yt=Math.abs(r-p[0])*a+_,At=(p[3]-p[1])*a,ut=(p[2]-p[0])*a):(ot=Math.abs(r-p[0])*a+m,yt=Math.abs(h-p[1])*a+_,At=(p[2]-p[0])*a,ut=(p[3]-p[1])*a),this.transform=[T*a,V*a,j*a,rt*a,ot-T*a*r-j*a*h,yt-V*a*r-rt*a*h],this.width=At,this.height=ut}get rawDims(){const{viewBox:p}=this;return(0,w.shadow)(this,"rawDims",{pageWidth:p[2]-p[0],pageHeight:p[3]-p[1],pageX:p[0],pageY:p[1]})}clone({scale:p=this.scale,rotation:a=this.rotation,offsetX:A=this.offsetX,offsetY:m=this.offsetY,dontFlip:_=!1}={}){return new E({viewBox:this.viewBox.slice(),scale:p,rotation:a,offsetX:A,offsetY:m,dontFlip:_})}convertToViewportPoint(p,a){return w.Util.applyTransform([p,a],this.transform)}convertToViewportRectangle(p){const a=w.Util.applyTransform([p[0],p[1]],this.transform),A=w.Util.applyTransform([p[2],p[3]],this.transform);return[a[0],a[1],A[0],A[1]]}convertToPdfPoint(p,a){return w.Util.applyInverseTransform([p,a],this.transform)}}class H extends w.BaseException{constructor(p,a=0){super(p,"RenderingCancelledException"),this.extraDelay=a}}function $(c){const p=c.length;let a=0;for(;a<p&&c[a].trim()==="";)a++;return c.substring(a,a+5).toLowerCase()==="data:"}function Y(c){return typeof c=="string"&&/\.pdf$/i.test(c)}function at(c,p=!1){return p||([c]=c.split(/[#?]/,1)),c.substring(c.lastIndexOf("/")+1)}function Q(c,p="document.pdf"){if(typeof c!="string")return p;if($(c))return(0,w.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),p;const a=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,A=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,m=a.exec(c);let _=A.exec(m[1])||A.exec(m[2])||A.exec(m[3]);if(_&&(_=_[0],_.includes("%")))try{_=A.exec(decodeURIComponent(_))[0]}catch{}return _||p}class M{constructor(){me(this,"started",Object.create(null));me(this,"times",[])}time(p){p in this.started&&(0,w.warn)(`Timer is already running for ${p}`),this.started[p]=Date.now()}timeEnd(p){p in this.started||(0,w.warn)(`Timer has not been started for ${p}`),this.times.push({name:p,start:this.started[p],end:Date.now()}),delete this.started[p]}toString(){const p=[];let a=0;for(const{name:A}of this.times)a=Math.max(A.length,a);for(const{name:A,start:m,end:_}of this.times)p.push(`${A.padEnd(a)} ${_-m}ms
`);return p.join("")}}function U(c,p){try{const{protocol:a}=p?new URL(c,p):new URL(c);return a==="http:"||a==="https:"}catch{return!1}}function B(c){c.preventDefault()}let D;class q{static toDateObject(p){if(!p||typeof p!="string")return null;D||(D=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const a=D.exec(p);if(!a)return null;const A=parseInt(a[1],10);let m=parseInt(a[2],10);m=m>=1&&m<=12?m-1:0;let _=parseInt(a[3],10);_=_>=1&&_<=31?_:1;let u=parseInt(a[4],10);u=u>=0&&u<=23?u:0;let r=parseInt(a[5],10);r=r>=0&&r<=59?r:0;let h=parseInt(a[6],10);h=h>=0&&h<=59?h:0;const T=a[7]||"Z";let V=parseInt(a[8],10);V=V>=0&&V<=23?V:0;let j=parseInt(a[9],10)||0;return j=j>=0&&j<=59?j:0,T==="-"?(u+=V,r+=j):T==="+"&&(u-=V,r-=j),new Date(Date.UTC(A,m,_,u,r,h))}}function tt(c,{scale:p=1,rotation:a=0}){const{width:A,height:m}=c.attributes.style,_=[0,0,parseInt(A),parseInt(m)];return new E({viewBox:_,scale:p,rotation:a})}function vt(c){if(c.startsWith("#")){const p=parseInt(c.slice(1),16);return[(p&16711680)>>16,(p&65280)>>8,p&255]}return c.startsWith("rgb(")?c.slice(4,-1).split(",").map(p=>parseInt(p)):c.startsWith("rgba(")?c.slice(5,-1).split(",").map(p=>parseInt(p)).slice(0,3):((0,w.warn)(`Not a valid color format: "${c}"`),[0,0,0])}function Ft(c){const p=document.createElement("span");p.style.visibility="hidden",document.body.append(p);for(const a of c.keys()){p.style.color=a;const A=window.getComputedStyle(p).color;c.set(a,vt(A))}p.remove()}function Ct(c){const{a:p,b:a,c:A,d:m,e:_,f:u}=c.getTransform();return[p,a,A,m,_,u]}function Nt(c){const{a:p,b:a,c:A,d:m,e:_,f:u}=c.getTransform().invertSelf();return[p,a,A,m,_,u]}function _t(c,p,a=!1,A=!0){if(p instanceof E){const{pageWidth:m,pageHeight:_}=p.rawDims,{style:u}=c,r=w.FeatureTest.isCSSRoundSupported,h=`var(--scale-factor) * ${m}px`,T=`var(--scale-factor) * ${_}px`,V=r?`round(${h}, 1px)`:`calc(${h})`,j=r?`round(${T}, 1px)`:`calc(${T})`;!a||p.rotation%180===0?(u.width=V,u.height=j):(u.width=j,u.height=V)}A&&c.setAttribute("data-main-rotation",p.rotation)}},47:(o,b,d)=>{var R,K,k,y,g,In,I,Fn,H,Xr;d.d(b,{DrawLayer:()=>v});var e=d(419),w=d(292);const Y=class Y{constructor({pageIndex:Q}){l(this,I);l(this,H);l(this,R,null);l(this,K,0);l(this,k,new Map);l(this,y,new Map);this.pageIndex=Q}setParent(Q){if(!t(this,R)){P(this,R,Q);return}if(t(this,R)!==Q){if(t(this,k).size>0)for(const M of t(this,k).values())M.remove(),Q.append(M);P(this,R,Q)}}static get _svgFactory(){return(0,w.shadow)(this,"_svgFactory",new e.DOMSVGFactory)}highlight(Q,M,U,B=!1){const D=vs(this,K)._++,q=S(this,I,Fn).call(this,Q.box);q.classList.add("highlight"),Q.free&&q.classList.add("free");const tt=Y._svgFactory.createElement("defs");q.append(tt);const vt=Y._svgFactory.createElement("path");tt.append(vt);const Ft=`path_p${this.pageIndex}_${D}`;vt.setAttribute("id",Ft),vt.setAttribute("d",Q.toSVGPath()),B&&t(this,y).set(D,vt);const Ct=S(this,H,Xr).call(this,tt,Ft),Nt=Y._svgFactory.createElement("use");return q.append(Nt),q.setAttribute("fill",M),q.setAttribute("fill-opacity",U),Nt.setAttribute("href",`#${Ft}`),t(this,k).set(D,q),{id:D,clipPathId:`url(#${Ct})`}}highlightOutline(Q){const M=vs(this,K)._++,U=S(this,I,Fn).call(this,Q.box);U.classList.add("highlightOutline");const B=Y._svgFactory.createElement("defs");U.append(B);const D=Y._svgFactory.createElement("path");B.append(D);const q=`path_p${this.pageIndex}_${M}`;D.setAttribute("id",q),D.setAttribute("d",Q.toSVGPath()),D.setAttribute("vector-effect","non-scaling-stroke");let tt;if(Q.free){U.classList.add("free");const Ct=Y._svgFactory.createElement("mask");B.append(Ct),tt=`mask_p${this.pageIndex}_${M}`,Ct.setAttribute("id",tt),Ct.setAttribute("maskUnits","objectBoundingBox");const Nt=Y._svgFactory.createElement("rect");Ct.append(Nt),Nt.setAttribute("width","1"),Nt.setAttribute("height","1"),Nt.setAttribute("fill","white");const _t=Y._svgFactory.createElement("use");Ct.append(_t),_t.setAttribute("href",`#${q}`),_t.setAttribute("stroke","none"),_t.setAttribute("fill","black"),_t.setAttribute("fill-rule","nonzero"),_t.classList.add("mask")}const vt=Y._svgFactory.createElement("use");U.append(vt),vt.setAttribute("href",`#${q}`),tt&&vt.setAttribute("mask",`url(#${tt})`);const Ft=vt.cloneNode();return U.append(Ft),vt.classList.add("mainOutline"),Ft.classList.add("secondaryOutline"),t(this,k).set(M,U),M}finalizeLine(Q,M){const U=t(this,y).get(Q);t(this,y).delete(Q),this.updateBox(Q,M.box),U.setAttribute("d",M.toSVGPath())}updateLine(Q,M){t(this,k).get(Q).firstChild.firstChild.setAttribute("d",M.toSVGPath())}removeFreeHighlight(Q){this.remove(Q),t(this,y).delete(Q)}updatePath(Q,M){t(this,y).get(Q).setAttribute("d",M.toSVGPath())}updateBox(Q,M){var U;S(U=Y,g,In).call(U,t(this,k).get(Q),M)}show(Q,M){t(this,k).get(Q).classList.toggle("hidden",!M)}rotate(Q,M){t(this,k).get(Q).setAttribute("data-main-rotation",M)}changeColor(Q,M){t(this,k).get(Q).setAttribute("fill",M)}changeOpacity(Q,M){t(this,k).get(Q).setAttribute("fill-opacity",M)}addClass(Q,M){t(this,k).get(Q).classList.add(M)}removeClass(Q,M){t(this,k).get(Q).classList.remove(M)}remove(Q){t(this,R)!==null&&(t(this,k).get(Q).remove(),t(this,k).delete(Q))}destroy(){P(this,R,null);for(const Q of t(this,k).values())Q.remove();t(this,k).clear()}};R=new WeakMap,K=new WeakMap,k=new WeakMap,y=new WeakMap,g=new WeakSet,In=function(Q,{x:M=0,y:U=0,width:B=1,height:D=1}={}){const{style:q}=Q;q.top=`${100*U}%`,q.left=`${100*M}%`,q.width=`${100*B}%`,q.height=`${100*D}%`},I=new WeakSet,Fn=function(Q){var U;const M=Y._svgFactory.create(1,1,!0);return t(this,R).append(M),M.setAttribute("aria-hidden",!0),S(U=Y,g,In).call(U,M,Q),M},H=new WeakSet,Xr=function(Q,M){const U=Y._svgFactory.createElement("clipPath");Q.append(U);const B=`clip_${M}`;U.setAttribute("id",B),U.setAttribute("clipPathUnits","objectBoundingBox");const D=Y._svgFactory.createElement("use");return U.append(D),D.setAttribute("href",`#${M}`),D.classList.add("clip"),B},l(Y,g);let v=Y},731:(o,b,d)=>{var Y,at,Q,M,U,B,D,q,tt,vt,Ft,Kr,Nt,Yr,Tt,Jr,Et,Ji,gt,Qi,Rt,Zi,Kt,Qr,Se,Dn,le,Zr,ae,Ce,ee,Ee,ne,et,i,n,c,p,a,A,m,_,u,r,h,T,V,j,On,ot,Nn,At,ta,xt,ea,X,sa,N,Hn,z,_i,lt,ti,Mt,ia,te,tn,he,wi,_e,na,fe,ra,se,aa,x,oa,ct,wt,bt,zt,jt,Ot,Yt,Ut,St,Bt,Qt,ue,ce,we,Te,ts,ha,Xe,la,Ve,ca,dt,da,$t,Bn,Zt,ua,be,$n,He,pa,qe,ga,Ts,fa,Ii,ma,Fi,va,us,Os,ni,Un,Bs,en,$s,sn,As,ei,ri,Vn,Us,nn,Di,ba,ai,jn,Oi,Aa,Ni,ya,oi,Gn,Vs,rn,Ls,Ei,je,Ge,ys,ps,_s,js,hs,Ps,ls,rs,hi,ks,xi,Rs,Si,Gs,an,li,qn,Hi,_a,Bi,wa,ci,zn,qs,on,$i,Ea,Is,zs,cs,Fs,gs,fs,ms,es,ws,Ws,Xs,Ye,pe,Es,Ui,xa,ui,Wn,pi,Xn,gi,Kn,Ks,hn;d.d(b,{AnnotationEditorLayer:()=>$});var e=d(292),w=d(310),v=d(830),R=d(976);const K=/\r\n?|\n/g,Vt=class Vt extends w.AnnotationEditor{constructor(s){super({...s,name:"freeTextEditor"});l(this,Ft);l(this,Nt);l(this,Tt);l(this,Et);l(this,Rt);l(this,Kt);l(this,le);l(this,Y,this.editorDivBlur.bind(this));l(this,at,this.editorDivFocus.bind(this));l(this,Q,this.editorDivInput.bind(this));l(this,M,this.editorDivKeydown.bind(this));l(this,U,this.editorDivPaste.bind(this));l(this,B,void 0);l(this,D,"");l(this,q,`${this.id}-editor`);l(this,tt,void 0);l(this,vt,null);P(this,B,s.color||Vt._defaultColor||w.AnnotationEditor._defaultLineColor),P(this,tt,s.fontSize||Vt._defaultFontSize)}static get _keyboardManager(){const s=Vt.prototype,C=mt=>mt.isEmpty(),st=v.AnnotationEditorUIManager.TRANSLATE_SMALL,ht=v.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,e.shadow)(this,"_keyboardManager",new v.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],s.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],s.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],s._translateEmpty,{args:[-st,0],checker:C}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],s._translateEmpty,{args:[-ht,0],checker:C}],[["ArrowRight","mac+ArrowRight"],s._translateEmpty,{args:[st,0],checker:C}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],s._translateEmpty,{args:[ht,0],checker:C}],[["ArrowUp","mac+ArrowUp"],s._translateEmpty,{args:[0,-st],checker:C}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],s._translateEmpty,{args:[0,-ht],checker:C}],[["ArrowDown","mac+ArrowDown"],s._translateEmpty,{args:[0,st],checker:C}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],s._translateEmpty,{args:[0,ht],checker:C}]]))}static initialize(s,C){w.AnnotationEditor.initialize(s,C,{strings:["pdfjs-free-text-default-content"]});const st=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(st.getPropertyValue("--freetext-padding"))}static updateDefaultParams(s,C){switch(s){case e.AnnotationEditorParamsType.FREETEXT_SIZE:Vt._defaultFontSize=C;break;case e.AnnotationEditorParamsType.FREETEXT_COLOR:Vt._defaultColor=C;break}}updateParams(s,C){switch(s){case e.AnnotationEditorParamsType.FREETEXT_SIZE:S(this,Ft,Kr).call(this,C);break;case e.AnnotationEditorParamsType.FREETEXT_COLOR:S(this,Nt,Yr).call(this,C);break}}static get defaultPropertiesToUpdate(){return[[e.AnnotationEditorParamsType.FREETEXT_SIZE,Vt._defaultFontSize],[e.AnnotationEditorParamsType.FREETEXT_COLOR,Vt._defaultColor||w.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[e.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,tt)],[e.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,B)]]}_translateEmpty(s,C){this._uiManager.translateSelectedEditors(s,C,!0)}getInitialTranslation(){const s=this.parentScale;return[-Vt._internalPadding*s,-(Vt._internalPadding+t(this,tt))*s]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(e.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,M)),this.editorDiv.addEventListener("focus",t(this,at)),this.editorDiv.addEventListener("blur",t(this,Y)),this.editorDiv.addEventListener("input",t(this,Q)),this.editorDiv.addEventListener("paste",t(this,U)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,q)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,M)),this.editorDiv.removeEventListener("focus",t(this,at)),this.editorDiv.removeEventListener("blur",t(this,Y)),this.editorDiv.removeEventListener("input",t(this,Q)),this.editorDiv.removeEventListener("paste",t(this,U)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(s){this._focusEventsAllowed&&(super.focusin(s),s.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var s;this.width||(this.enableEditMode(),this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const s=t(this,D),C=P(this,D,S(this,Tt,Jr).call(this).trimEnd());if(s===C)return;const st=ht=>{if(P(this,D,ht),!ht){this.remove();return}S(this,Rt,Zi).call(this),this._uiManager.rebuild(this),S(this,Et,Ji).call(this)};this.addCommands({cmd:()=>{st(C)},undo:()=>{st(s)},mustExec:!1}),S(this,Et,Ji).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(s){this.enterInEditMode()}keydown(s){s.target===this.div&&s.key==="Enter"&&(this.enterInEditMode(),s.preventDefault())}editorDivKeydown(s){Vt._keyboardManager.exec(this,s)}editorDivFocus(s){this.isEditing=!0}editorDivBlur(s){this.isEditing=!1}editorDivInput(s){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let s,C;this.width&&(s=this.x,C=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,q)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text"),this.enableEditing(),w.AnnotationEditor._l10nPromise.get("pdfjs-free-text-default-content").then(ht=>{var mt;return(mt=this.editorDiv)==null?void 0:mt.setAttribute("default-content",ht)}),this.editorDiv.contentEditable=!0;const{style:st}=this.editorDiv;if(st.fontSize=`calc(${t(this,tt)}px * var(--scale-factor))`,st.color=t(this,B),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,v.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[ht,mt]=this.parentDimensions;if(this.annotationElementId){const{position:It}=t(this,vt);let[Gt,Lt]=this.getInitialTranslation();[Gt,Lt]=this.pageTranslationToScreen(Gt,Lt);const[Xt,Wt]=this.pageDimensions,[Ae,ye]=this.pageTranslation;let xe,Le;switch(this.rotation){case 0:xe=s+(It[0]-Ae)/Xt,Le=C+this.height-(It[1]-ye)/Wt;break;case 90:xe=s+(It[0]-Ae)/Xt,Le=C-(It[1]-ye)/Wt,[Gt,Lt]=[Lt,-Gt];break;case 180:xe=s-this.width+(It[0]-Ae)/Xt,Le=C-(It[1]-ye)/Wt,[Gt,Lt]=[-Gt,-Lt];break;case 270:xe=s+(It[0]-Ae-this.height*Wt)/Xt,Le=C+(It[1]-ye-this.width*Xt)/Wt,[Gt,Lt]=[-Lt,Gt];break}this.setAt(xe*ht,Le*mt,Gt,Lt)}else this.setAt(s*ht,C*mt,this.width*ht,this.height*mt);S(this,Rt,Zi).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(s){var xe,Le,Ue;const C=s.clipboardData||window.clipboardData,{types:st}=C;if(st.length===1&&st[0]==="text/plain")return;s.preventDefault();const ht=S(xe=Vt,Se,Dn).call(xe,C.getData("text")||"").replaceAll(K,`
`);if(!ht)return;const mt=window.getSelection();if(!mt.rangeCount)return;this.editorDiv.normalize(),mt.deleteFromDocument();const It=mt.getRangeAt(0);if(!ht.includes(`
`)){It.insertNode(document.createTextNode(ht)),this.editorDiv.normalize(),mt.collapseToStart();return}const{startContainer:Gt,startOffset:Lt}=It,Xt=[],Wt=[];if(Gt.nodeType===Node.TEXT_NODE){const De=Gt.parentElement;if(Wt.push(Gt.nodeValue.slice(Lt).replaceAll(K,"")),De!==this.editorDiv){let $e=Xt;for(const Be of this.editorDiv.childNodes){if(Be===De){$e=Wt;continue}$e.push(S(Le=Vt,gt,Qi).call(Le,Be))}}Xt.push(Gt.nodeValue.slice(0,Lt).replaceAll(K,""))}else if(Gt===this.editorDiv){let De=Xt,$e=0;for(const Be of this.editorDiv.childNodes)$e++===Lt&&(De=Wt),De.push(S(Ue=Vt,gt,Qi).call(Ue,Be))}P(this,D,`${Xt.join(`
`)}${ht}${Wt.join(`
`)}`),S(this,Rt,Zi).call(this);const Ae=new Range;let ye=Xt.reduce((De,$e)=>De+$e.length,0);for(const{firstChild:De}of this.editorDiv.childNodes)if(De.nodeType===Node.TEXT_NODE){const $e=De.nodeValue.length;if(ye<=$e){Ae.setStart(De,ye),Ae.setEnd(De,ye);break}ye-=$e}mt.removeAllRanges(),mt.addRange(Ae)}get contentDiv(){return this.editorDiv}static deserialize(s,C,st){var It;let ht=null;if(s instanceof R.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:Gt,fontColor:Lt},rect:Xt,rotation:Wt,id:Ae},textContent:ye,textPosition:xe,parent:{page:{pageNumber:Le}}}=s;if(!ye||ye.length===0)return null;ht=s={annotationType:e.AnnotationEditorType.FREETEXT,color:Array.from(Lt),fontSize:Gt,value:ye.join(`
`),position:xe,pageIndex:Le-1,rect:Xt,rotation:Wt,id:Ae,deleted:!1}}const mt=super.deserialize(s,C,st);return P(mt,tt,s.fontSize),P(mt,B,e.Util.makeHexColor(...s.color)),P(mt,D,S(It=Vt,Se,Dn).call(It,s.value)),mt.annotationElementId=s.id||null,P(mt,vt,ht),mt}serialize(s=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const C=Vt._internalPadding*this.parentScale,st=this.getRect(C,C),ht=w.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,B)),mt={annotationType:e.AnnotationEditorType.FREETEXT,color:ht,fontSize:t(this,tt),value:S(this,Kt,Qr).call(this),pageIndex:this.pageIndex,rect:st,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return s?mt:this.annotationElementId&&!S(this,le,Zr).call(this,mt)?null:(mt.id=this.annotationElementId,mt)}};Y=new WeakMap,at=new WeakMap,Q=new WeakMap,M=new WeakMap,U=new WeakMap,B=new WeakMap,D=new WeakMap,q=new WeakMap,tt=new WeakMap,vt=new WeakMap,Ft=new WeakSet,Kr=function(s){const C=ht=>{this.editorDiv.style.fontSize=`calc(${ht}px * var(--scale-factor))`,this.translate(0,-(ht-t(this,tt))*this.parentScale),P(this,tt,ht),S(this,Et,Ji).call(this)},st=t(this,tt);this.addCommands({cmd:C.bind(this,s),undo:C.bind(this,st),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Nt=new WeakSet,Yr=function(s){const C=ht=>{P(this,B,this.editorDiv.style.color=ht)},st=t(this,B);this.addCommands({cmd:C.bind(this,s),undo:C.bind(this,st),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Tt=new WeakSet,Jr=function(){var C;const s=[];this.editorDiv.normalize();for(const st of this.editorDiv.childNodes)s.push(S(C=Vt,gt,Qi).call(C,st));return s.join(`
`)},Et=new WeakSet,Ji=function(){const[s,C]=this.parentDimensions;let st;if(this.isAttachedToDOM)st=this.div.getBoundingClientRect();else{const{currentLayer:ht,div:mt}=this,It=mt.style.display;mt.style.display="hidden",ht.div.append(this.div),st=mt.getBoundingClientRect(),mt.remove(),mt.style.display=It}this.rotation%180===this.parentRotation%180?(this.width=st.width/s,this.height=st.height/C):(this.width=st.height/s,this.height=st.width/C),this.fixAndSetPosition()},gt=new WeakSet,Qi=function(s){return(s.nodeType===Node.TEXT_NODE?s.nodeValue:s.innerText).replaceAll(K,"")},Rt=new WeakSet,Zi=function(){if(this.editorDiv.replaceChildren(),!!t(this,D))for(const s of t(this,D).split(`
`)){const C=document.createElement("div");C.append(s?document.createTextNode(s):document.createElement("br")),this.editorDiv.append(C)}},Kt=new WeakSet,Qr=function(){return t(this,D).replaceAll("\xA0"," ")},Se=new WeakSet,Dn=function(s){return s.replaceAll(" ","\xA0")},le=new WeakSet,Zr=function(s){const{value:C,fontSize:st,color:ht,pageIndex:mt}=t(this,vt);return this._hasBeenMoved||s.value!==C||s.fontSize!==st||s.color.some((It,Gt)=>It!==ht[Gt])||s.pageIndex!==mt},l(Vt,gt),l(Vt,Se),me(Vt,"_freeTextDefaultContent",""),me(Vt,"_internalPadding",0),me(Vt,"_defaultColor",null),me(Vt,"_defaultFontSize",10),me(Vt,"_type","freetext"),me(Vt,"_editorType",e.AnnotationEditorType.FREETEXT);let k=Vt;var y=d(61),g=d(259),G=d(419);const it=class it extends w.AnnotationEditor{constructor(s){super({...s,name:"highlightEditor"});l(this,j);l(this,ot);l(this,At);l(this,xt);l(this,X);l(this,N);l(this,z);l(this,Mt);l(this,te);l(this,he);l(this,_e);l(this,fe);l(this,ae,null);l(this,Ce,0);l(this,ee,void 0);l(this,Ee,null);l(this,ne,null);l(this,et,null);l(this,i,null);l(this,n,0);l(this,c,null);l(this,p,null);l(this,a,null);l(this,A,!1);l(this,m,S(this,Mt,ia).bind(this));l(this,_,null);l(this,u,void 0);l(this,r,null);l(this,h,"");l(this,T,void 0);l(this,V,"");this.color=s.color||it._defaultColor,P(this,T,s.thickness||it._defaultThickness),P(this,u,s.opacity||it._defaultOpacity),P(this,ee,s.boxes||null),P(this,V,s.methodOfCreation||""),P(this,h,s.text||""),this._isDraggable=!1,s.highlightId>-1?(P(this,A,!0),S(this,ot,Nn).call(this,s),S(this,z,_i).call(this)):(P(this,ae,s.anchorNode),P(this,Ce,s.anchorOffset),P(this,i,s.focusNode),P(this,n,s.focusOffset),S(this,j,On).call(this),S(this,z,_i).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const s=it.prototype;return(0,e.shadow)(this,"_keyboardManager",new v.KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],s._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],s._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],s._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],s._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:t(this,A)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:t(this,T),methodOfCreation:t(this,V)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(s){return{numberOfColors:s.get("color").size}}static initialize(s,C){var st;w.AnnotationEditor.initialize(s,C),it._defaultColor||(it._defaultColor=((st=C.highlightColors)==null?void 0:st.values().next().value)||"#fff066")}static updateDefaultParams(s,C){switch(s){case e.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:it._defaultColor=C;break;case e.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:it._defaultThickness=C;break}}translateInPage(s,C){}get toolbarPosition(){return t(this,_)}updateParams(s,C){switch(s){case e.AnnotationEditorParamsType.HIGHLIGHT_COLOR:S(this,At,ta).call(this,C);break;case e.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:S(this,xt,ea).call(this,C);break}}static get defaultPropertiesToUpdate(){return[[e.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR,it._defaultColor],[e.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS,it._defaultThickness]]}get propertiesToUpdate(){return[[e.AnnotationEditorParamsType.HIGHLIGHT_COLOR,this.color||it._defaultColor],[e.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS,t(this,T)||it._defaultThickness],[e.AnnotationEditorParamsType.HIGHLIGHT_FREE,t(this,A)]]}async addEditToolbar(){const s=await super.addEditToolbar();return s?(this._uiManager.highlightColors&&(P(this,ne,new g.ColorPicker({editor:this})),s.addColorPicker(t(this,ne))),s):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(S(this,he,wi).call(this))}getBaseTranslation(){return[0,0]}getRect(s,C){return super.getRect(s,C,S(this,he,wi).call(this))}onceAdded(){this.parent.addUndoableEditor(this),this.div.focus()}remove(){S(this,N,Hn).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(S(this,z,_i).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(s){var st;let C=!1;this.parent&&!s?S(this,N,Hn).call(this):s&&(S(this,z,_i).call(this,s),C=!this.parent&&((st=this.div)==null?void 0:st.classList.contains("selectedEditor"))),super.setParent(s),this.show(this._isVisible),C&&this.select()}rotate(s){var ht,mt,It;const{drawLayer:C}=this.parent;let st;t(this,A)?(s=(s-this.rotation+360)%360,st=S(ht=it,lt,ti).call(ht,t(this,p).box,s)):st=S(mt=it,lt,ti).call(mt,this,s),C.rotate(t(this,a),s),C.rotate(t(this,r),s),C.updateBox(t(this,a),st),C.updateBox(t(this,r),S(It=it,lt,ti).call(It,t(this,et).box,s))}render(){if(this.div)return this.div;const s=super.render();t(this,h)&&(s.setAttribute("aria-label",t(this,h)),s.setAttribute("role","mark")),t(this,A)?s.classList.add("free"):this.div.addEventListener("keydown",t(this,m));const C=P(this,c,document.createElement("div"));s.append(C),C.setAttribute("aria-hidden","true"),C.className="internal",C.style.clipPath=t(this,Ee);const[st,ht]=this.parentDimensions;return this.setDims(this.width*st,this.height*ht),(0,v.bindEvents)(this,t(this,c),["pointerover","pointerleave"]),this.enableEditing(),s}pointerover(){this.parent.drawLayer.addClass(t(this,r),"hovered")}pointerleave(){this.parent.drawLayer.removeClass(t(this,r),"hovered")}_moveCaret(s){switch(this.parent.unselect(this),s){case 0:case 2:S(this,te,tn).call(this,!0);break;case 1:case 3:S(this,te,tn).call(this,!1);break}}select(){var s,C;super.select(),t(this,r)&&((s=this.parent)==null||s.drawLayer.removeClass(t(this,r),"hovered"),(C=this.parent)==null||C.drawLayer.addClass(t(this,r),"selected"))}unselect(){var s;super.unselect(),t(this,r)&&((s=this.parent)==null||s.drawLayer.removeClass(t(this,r),"selected"),t(this,A)||S(this,te,tn).call(this,!1))}get _mustFixPosition(){return!t(this,A)}show(s=this._isVisible){super.show(s),this.parent&&(this.parent.drawLayer.show(t(this,a),s),this.parent.drawLayer.show(t(this,r),s))}static startHighlighting(s,C,{target:st,x:ht,y:mt}){const{x:It,y:Gt,width:Lt,height:Xt}=st.getBoundingClientRect(),Wt=Le=>{S(this,se,aa).call(this,s,Le)},Ae={capture:!0,passive:!1},ye=Le=>{Le.preventDefault(),Le.stopPropagation()},xe=Le=>{st.removeEventListener("pointermove",Wt),window.removeEventListener("blur",xe),window.removeEventListener("pointerup",xe),window.removeEventListener("pointerdown",ye,Ae),window.removeEventListener("contextmenu",G.noContextMenu),S(this,x,oa).call(this,s,Le)};window.addEventListener("blur",xe),window.addEventListener("pointerup",xe),window.addEventListener("pointerdown",ye,Ae),window.addEventListener("contextmenu",G.noContextMenu),st.addEventListener("pointermove",Wt),this._freeHighlight=new y.FreeOutliner({x:ht,y:mt},[It,Gt,Lt,Xt],s.scale,this._defaultThickness/2,C,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=s.drawLayer.highlight(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static deserialize(s,C,st){var Le;const ht=super.deserialize(s,C,st),{rect:[mt,It,Gt,Lt],color:Xt,quadPoints:Wt}=s;ht.color=e.Util.makeHexColor(...Xt),P(ht,u,s.opacity);const[Ae,ye]=ht.pageDimensions;ht.width=(Gt-mt)/Ae,ht.height=(Lt-It)/ye;const xe=P(ht,ee,[]);for(let Ue=0;Ue<Wt.length;Ue+=8)xe.push({x:(Wt[4]-Gt)/Ae,y:(Lt-(1-Wt[Ue+5]))/ye,width:(Wt[Ue+2]-Wt[Ue])/Ae,height:(Wt[Ue+5]-Wt[Ue+1])/ye});return S(Le=ht,j,On).call(Le),ht}serialize(s=!1){if(this.isEmpty()||s)return null;const C=this.getRect(0,0),st=w.AnnotationEditor._colorManager.convert(this.color);return{annotationType:e.AnnotationEditorType.HIGHLIGHT,color:st,opacity:t(this,u),thickness:t(this,T),quadPoints:S(this,_e,na).call(this),outlines:S(this,fe,ra).call(this,C),pageIndex:this.pageIndex,rect:C,rotation:S(this,he,wi).call(this),structTreeParentId:this._structTreeParentId}}static canCreateNewEmptyEditor(){return!1}};ae=new WeakMap,Ce=new WeakMap,ee=new WeakMap,Ee=new WeakMap,ne=new WeakMap,et=new WeakMap,i=new WeakMap,n=new WeakMap,c=new WeakMap,p=new WeakMap,a=new WeakMap,A=new WeakMap,m=new WeakMap,_=new WeakMap,u=new WeakMap,r=new WeakMap,h=new WeakMap,T=new WeakMap,V=new WeakMap,j=new WeakSet,On=function(){const s=new y.Outliner(t(this,ee),.001);P(this,p,s.getOutlines()),{x:this.x,y:this.y,width:this.width,height:this.height}=t(this,p).box;const C=new y.Outliner(t(this,ee),.0025,.001,this._uiManager.direction==="ltr");P(this,et,C.getOutlines());const{lastPoint:st}=t(this,et).box;P(this,_,[(st[0]-this.x)/this.width,(st[1]-this.y)/this.height])},ot=new WeakSet,Nn=function({highlightOutlines:s,highlightId:C,clipPathId:st}){var Wt,Ae;if(P(this,p,s),P(this,et,s.getNewOutline(t(this,T)/2+1.5,.0025)),C>=0)P(this,a,C),P(this,Ee,st),this.parent.drawLayer.finalizeLine(C,s),P(this,r,this.parent.drawLayer.highlightOutline(t(this,et)));else if(this.parent){const ye=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(t(this,a),s),this.parent.drawLayer.updateBox(t(this,a),S(Wt=it,lt,ti).call(Wt,t(this,p).box,(ye-this.rotation+360)%360)),this.parent.drawLayer.updateLine(t(this,r),t(this,et)),this.parent.drawLayer.updateBox(t(this,r),S(Ae=it,lt,ti).call(Ae,t(this,et).box,ye))}const{x:mt,y:It,width:Gt,height:Lt}=s.box;switch(this.rotation){case 0:this.x=mt,this.y=It,this.width=Gt,this.height=Lt;break;case 90:{const[ye,xe]=this.parentDimensions;this.x=It,this.y=1-mt,this.width=Gt*xe/ye,this.height=Lt*ye/xe;break}case 180:this.x=1-mt,this.y=1-It,this.width=Gt,this.height=Lt;break;case 270:{const[ye,xe]=this.parentDimensions;this.x=1-It,this.y=mt,this.width=Gt*xe/ye,this.height=Lt*ye/xe;break}}const{lastPoint:Xt}=t(this,et).box;P(this,_,[(Xt[0]-mt)/Gt,(Xt[1]-It)/Lt])},At=new WeakSet,ta=function(s){const C=ht=>{var mt,It;this.color=ht,(mt=this.parent)==null||mt.drawLayer.changeColor(t(this,a),ht),(It=t(this,ne))==null||It.updateColor(ht)},st=this.color;this.addCommands({cmd:C.bind(this,s),undo:C.bind(this,st),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e.AnnotationEditorParamsType.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(s)},!0)},xt=new WeakSet,ea=function(s){const C=t(this,T),st=ht=>{P(this,T,ht),S(this,X,sa).call(this,ht)};this.addCommands({cmd:st.bind(this,s),undo:st.bind(this,C),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:s},!0)},X=new WeakSet,sa=function(s){if(!t(this,A))return;S(this,ot,Nn).call(this,{highlightOutlines:t(this,p).getNewOutline(s/2)}),this.fixAndSetPosition();const[C,st]=this.parentDimensions;this.setDims(this.width*C,this.height*st)},N=new WeakSet,Hn=function(){t(this,a)===null||!this.parent||(this.parent.drawLayer.remove(t(this,a)),P(this,a,null),this.parent.drawLayer.remove(t(this,r)),P(this,r,null))},z=new WeakSet,_i=function(s=this.parent){t(this,a)===null&&({id:vs(this,a)._,clipPathId:vs(this,Ee)._}=s.drawLayer.highlight(t(this,p),this.color,t(this,u)),P(this,r,s.drawLayer.highlightOutline(t(this,et))),t(this,c)&&(t(this,c).style.clipPath=t(this,Ee)))},lt=new WeakSet,ti=function({x:s,y:C,width:st,height:ht},mt){switch(mt){case 90:return{x:1-C-ht,y:s,width:ht,height:st};case 180:return{x:1-s-st,y:1-C-ht,width:st,height:ht};case 270:return{x:C,y:1-s-st,width:ht,height:st}}return{x:s,y:C,width:st,height:ht}},Mt=new WeakSet,ia=function(s){it._keyboardManager.exec(this,s)},te=new WeakSet,tn=function(s){if(!t(this,ae))return;const C=window.getSelection();s?C.setPosition(t(this,ae),t(this,Ce)):C.setPosition(t(this,i),t(this,n))},he=new WeakSet,wi=function(){return t(this,A)?this.rotation:0},_e=new WeakSet,na=function(){if(t(this,A))return null;const[s,C]=this.pageDimensions,st=t(this,ee),ht=new Array(st.length*8);let mt=0;for(const{x:It,y:Gt,width:Lt,height:Xt}of st){const Wt=It*s,Ae=(1-Gt-Xt)*C;ht[mt]=ht[mt+4]=Wt,ht[mt+1]=ht[mt+3]=Ae,ht[mt+2]=ht[mt+6]=Wt+Lt*s,ht[mt+5]=ht[mt+7]=Ae+Xt*C,mt+=8}return ht},fe=new WeakSet,ra=function(s){return t(this,p).serialize(s,S(this,he,wi).call(this))},se=new WeakSet,aa=function(s,C){this._freeHighlight.add(C)&&s.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)},x=new WeakSet,oa=function(s,C){this._freeHighlight.isEmpty()?s.drawLayer.removeFreeHighlight(this._freeHighlightId):s.createAndAddNewEditor(C,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},l(it,lt),l(it,se),l(it,x),me(it,"_defaultColor",null),me(it,"_defaultOpacity",1),me(it,"_defaultThickness",12),me(it,"_l10nPromise"),me(it,"_type","highlight"),me(it,"_editorType",e.AnnotationEditorType.HIGHLIGHT),me(it,"_freeHighlightId",-1),me(it,"_freeHighlight",null),me(it,"_freeHighlightClipId","");let I=it;const Oe=class Oe extends w.AnnotationEditor{constructor(s){super({...s,name:"inkEditor"});l(this,ts);l(this,Xe);l(this,Ve);l(this,dt);l(this,$t);l(this,Zt);l(this,be);l(this,He);l(this,qe);l(this,Ts);l(this,Ii);l(this,Fi);l(this,us);l(this,ni);l(this,Bs);l(this,$s);l(this,As);l(this,ri);l(this,Us);l(this,Ni);l(this,oi);l(this,Vs);l(this,Ls);l(this,ct,0);l(this,wt,0);l(this,bt,this.canvasPointermove.bind(this));l(this,zt,this.canvasPointerleave.bind(this));l(this,jt,this.canvasPointerup.bind(this));l(this,Ot,this.canvasPointerdown.bind(this));l(this,Yt,null);l(this,Ut,new Path2D);l(this,St,!1);l(this,Bt,!1);l(this,Qt,!1);l(this,ue,null);l(this,ce,0);l(this,we,0);l(this,Te,null);this.color=s.color||null,this.thickness=s.thickness||null,this.opacity=s.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(s,C){w.AnnotationEditor.initialize(s,C)}static updateDefaultParams(s,C){switch(s){case e.AnnotationEditorParamsType.INK_THICKNESS:Oe._defaultThickness=C;break;case e.AnnotationEditorParamsType.INK_COLOR:Oe._defaultColor=C;break;case e.AnnotationEditorParamsType.INK_OPACITY:Oe._defaultOpacity=C/100;break}}updateParams(s,C){switch(s){case e.AnnotationEditorParamsType.INK_THICKNESS:S(this,ts,ha).call(this,C);break;case e.AnnotationEditorParamsType.INK_COLOR:S(this,Xe,la).call(this,C);break;case e.AnnotationEditorParamsType.INK_OPACITY:S(this,Ve,ca).call(this,C);break}}static get defaultPropertiesToUpdate(){return[[e.AnnotationEditorParamsType.INK_THICKNESS,Oe._defaultThickness],[e.AnnotationEditorParamsType.INK_COLOR,Oe._defaultColor||w.AnnotationEditor._defaultLineColor],[e.AnnotationEditorParamsType.INK_OPACITY,Math.round(Oe._defaultOpacity*100)]]}get propertiesToUpdate(){return[[e.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Oe._defaultThickness],[e.AnnotationEditorParamsType.INK_COLOR,this.color||Oe._defaultColor||w.AnnotationEditor._defaultLineColor],[e.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Oe._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(S(this,Bs,en).call(this),S(this,$s,sn).call(this)),this.isAttachedToDOM||(this.parent.add(this),S(this,As,ei).call(this)),S(this,Ls,Ei).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,Yt)&&(clearTimeout(t(this,Yt)),P(this,Yt,null)),t(this,ue).disconnect(),P(this,ue,null),super.remove())}setParent(s){!this.parent&&s?this._uiManager.removeShouldRescale(this):this.parent&&s===null&&this._uiManager.addShouldRescale(this),super.setParent(s)}onScaleChanging(){const[s,C]=this.parentDimensions,st=this.width*s,ht=this.height*C;this.setDimensions(st,ht)}enableEditMode(){t(this,St)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,Ot)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,Ot)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,St)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),P(this,St,!0),this.div.classList.add("disabled"),S(this,Ls,Ei).call(this,!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(s){this._focusEventsAllowed&&(super.focusin(s),this.enableEditMode())}canvasPointerdown(s){s.button!==0||!this.isInEditMode()||t(this,St)||(this.setInForeground(),s.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),S(this,Zt,ua).call(this,s.offsetX,s.offsetY))}canvasPointermove(s){s.preventDefault(),S(this,be,$n).call(this,s.offsetX,s.offsetY)}canvasPointerup(s){s.preventDefault(),S(this,ni,Un).call(this,s)}canvasPointerleave(s){S(this,ni,Un).call(this,s)}get isResizable(){return!this.isEmpty()&&t(this,St)}render(){if(this.div)return this.div;let s,C;this.width&&(s=this.x,C=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[st,ht,mt,It]=S(this,dt,da).call(this);if(this.setAt(st,ht,0,0),this.setDims(mt,It),S(this,Bs,en).call(this),this.width){const[Gt,Lt]=this.parentDimensions;this.setAspectRatio(this.width*Gt,this.height*Lt),this.setAt(s*Gt,C*Lt,this.width*Gt,this.height*Lt),P(this,Qt,!0),S(this,As,ei).call(this),this.setDims(this.width*Gt,this.height*Lt),S(this,us,Os).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return S(this,$s,sn).call(this),this.div}setDimensions(s,C){const st=Math.round(s),ht=Math.round(C);if(t(this,ce)===st&&t(this,we)===ht)return;P(this,ce,st),P(this,we,ht),this.canvas.style.visibility="hidden";const[mt,It]=this.parentDimensions;this.width=s/mt,this.height=C/It,this.fixAndSetPosition(),t(this,St)&&S(this,ri,Vn).call(this,s,C),S(this,As,ei).call(this),S(this,us,Os).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(s,C,st){var Ue,De,$e;if(s instanceof R.InkAnnotationElement)return null;const ht=super.deserialize(s,C,st);ht.thickness=s.thickness,ht.color=e.Util.makeHexColor(...s.color),ht.opacity=s.opacity;const[mt,It]=ht.pageDimensions,Gt=ht.width*mt,Lt=ht.height*It,Xt=ht.parentScale,Wt=s.thickness/2;P(ht,St,!0),P(ht,ce,Math.round(Gt)),P(ht,we,Math.round(Lt));const{paths:Ae,rect:ye,rotation:xe}=s;for(let{bezier:Be}of Ae){Be=S(Ue=Oe,Oi,Aa).call(Ue,Be,ye,xe);const ds=[];ht.paths.push(ds);let fi=Xt*(Be[0]-Wt),mi=Xt*(Be[1]-Wt);for(let os=2,wn=Be.length;os<wn;os+=6){const En=Xt*(Be[os]-Wt),ji=Xt*(Be[os+1]-Wt),Gi=Xt*(Be[os+2]-Wt),qi=Xt*(Be[os+3]-Wt),vi=Xt*(Be[os+4]-Wt),Vr=Xt*(Be[os+5]-Wt);ds.push([[fi,mi],[En,ji],[Gi,qi],[vi,Vr]]),fi=vi,mi=Vr}const Vi=S(this,Di,ba).call(this,ds);ht.bezierPath2D.push(Vi)}const Le=S(De=ht,oi,Gn).call(De);return P(ht,wt,Math.max(w.AnnotationEditor.MIN_SIZE,Le[2]-Le[0])),P(ht,ct,Math.max(w.AnnotationEditor.MIN_SIZE,Le[3]-Le[1])),S($e=ht,ri,Vn).call($e,Gt,Lt),ht}serialize(){if(this.isEmpty())return null;const s=this.getRect(0,0),C=w.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:e.AnnotationEditorType.INK,color:C,thickness:this.thickness,opacity:this.opacity,paths:S(this,Ni,ya).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,s),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};ct=new WeakMap,wt=new WeakMap,bt=new WeakMap,zt=new WeakMap,jt=new WeakMap,Ot=new WeakMap,Yt=new WeakMap,Ut=new WeakMap,St=new WeakMap,Bt=new WeakMap,Qt=new WeakMap,ue=new WeakMap,ce=new WeakMap,we=new WeakMap,Te=new WeakMap,ts=new WeakSet,ha=function(s){const C=ht=>{this.thickness=ht,S(this,Ls,Ei).call(this)},st=this.thickness;this.addCommands({cmd:C.bind(this,s),undo:C.bind(this,st),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Xe=new WeakSet,la=function(s){const C=ht=>{this.color=ht,S(this,us,Os).call(this)},st=this.color;this.addCommands({cmd:C.bind(this,s),undo:C.bind(this,st),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Ve=new WeakSet,ca=function(s){const C=ht=>{this.opacity=ht,S(this,us,Os).call(this)};s/=100;const st=this.opacity;this.addCommands({cmd:C.bind(this,s),undo:C.bind(this,st),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},dt=new WeakSet,da=function(){const{parentRotation:s,parentDimensions:[C,st]}=this;switch(s){case 90:return[0,st,st,C];case 180:return[C,st,C,st];case 270:return[C,0,st,C];default:return[0,0,C,st]}},$t=new WeakSet,Bn=function(){const{ctx:s,color:C,opacity:st,thickness:ht,parentScale:mt,scaleFactor:It}=this;s.lineWidth=ht*mt/It,s.lineCap="round",s.lineJoin="round",s.miterLimit=10,s.strokeStyle=`${C}${(0,v.opacityToHex)(st)}`},Zt=new WeakSet,ua=function(s,C){this.canvas.addEventListener("contextmenu",G.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,zt)),this.canvas.addEventListener("pointermove",t(this,bt)),this.canvas.addEventListener("pointerup",t(this,jt)),this.canvas.removeEventListener("pointerdown",t(this,Ot)),this.isEditing=!0,t(this,Qt)||(P(this,Qt,!0),S(this,As,ei).call(this),this.thickness||(this.thickness=Oe._defaultThickness),this.color||(this.color=Oe._defaultColor||w.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Oe._defaultOpacity)),this.currentPath.push([s,C]),P(this,Bt,!1),S(this,$t,Bn).call(this),P(this,Te,()=>{S(this,Ts,fa).call(this),t(this,Te)&&window.requestAnimationFrame(t(this,Te))}),window.requestAnimationFrame(t(this,Te))},be=new WeakSet,$n=function(s,C){const[st,ht]=this.currentPath.at(-1);if(this.currentPath.length>1&&s===st&&C===ht)return;const mt=this.currentPath;let It=t(this,Ut);if(mt.push([s,C]),P(this,Bt,!0),mt.length<=2){It.moveTo(...mt[0]),It.lineTo(s,C);return}mt.length===3&&(P(this,Ut,It=new Path2D),It.moveTo(...mt[0])),S(this,Ii,ma).call(this,It,...mt.at(-3),...mt.at(-2),s,C)},He=new WeakSet,pa=function(){if(this.currentPath.length===0)return;const s=this.currentPath.at(-1);t(this,Ut).lineTo(...s)},qe=new WeakSet,ga=function(s,C){P(this,Te,null),s=Math.min(Math.max(s,0),this.canvas.width),C=Math.min(Math.max(C,0),this.canvas.height),S(this,be,$n).call(this,s,C),S(this,He,pa).call(this);let st;if(this.currentPath.length!==1)st=S(this,Fi,va).call(this);else{const Lt=[s,C];st=[[Lt,Lt.slice(),Lt.slice(),Lt]]}const ht=t(this,Ut),mt=this.currentPath;this.currentPath=[],P(this,Ut,new Path2D);const It=()=>{this.allRawPaths.push(mt),this.paths.push(st),this.bezierPath2D.push(ht),this._uiManager.rebuild(this)},Gt=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(S(this,Bs,en).call(this),S(this,$s,sn).call(this)),S(this,Ls,Ei).call(this))};this.addCommands({cmd:It,undo:Gt,mustExec:!0})},Ts=new WeakSet,fa=function(){if(!t(this,Bt))return;P(this,Bt,!1);const s=Math.ceil(this.thickness*this.parentScale),C=this.currentPath.slice(-3),st=C.map(It=>It[0]),ht=C.map(It=>It[1]);Math.min(...st)-s,Math.max(...st)+s,Math.min(...ht)-s,Math.max(...ht)+s;const{ctx:mt}=this;mt.save(),mt.clearRect(0,0,this.canvas.width,this.canvas.height);for(const It of this.bezierPath2D)mt.stroke(It);mt.stroke(t(this,Ut)),mt.restore()},Ii=new WeakSet,ma=function(s,C,st,ht,mt,It,Gt){const Lt=(C+ht)/2,Xt=(st+mt)/2,Wt=(ht+It)/2,Ae=(mt+Gt)/2;s.bezierCurveTo(Lt+2*(ht-Lt)/3,Xt+2*(mt-Xt)/3,Wt+2*(ht-Wt)/3,Ae+2*(mt-Ae)/3,Wt,Ae)},Fi=new WeakSet,va=function(){const s=this.currentPath;if(s.length<=2)return[[s[0],s[0],s.at(-1),s.at(-1)]];const C=[];let st,[ht,mt]=s[0];for(st=1;st<s.length-2;st++){const[ye,xe]=s[st],[Le,Ue]=s[st+1],De=(ye+Le)/2,$e=(xe+Ue)/2,Be=[ht+2*(ye-ht)/3,mt+2*(xe-mt)/3],ds=[De+2*(ye-De)/3,$e+2*(xe-$e)/3];C.push([[ht,mt],Be,ds,[De,$e]]),[ht,mt]=[De,$e]}const[It,Gt]=s[st],[Lt,Xt]=s[st+1],Wt=[ht+2*(It-ht)/3,mt+2*(Gt-mt)/3],Ae=[Lt+2*(It-Lt)/3,Xt+2*(Gt-Xt)/3];return C.push([[ht,mt],Wt,Ae,[Lt,Xt]]),C},us=new WeakSet,Os=function(){if(this.isEmpty()){S(this,Us,nn).call(this);return}S(this,$t,Bn).call(this);const{canvas:s,ctx:C}=this;C.setTransform(1,0,0,1,0,0),C.clearRect(0,0,s.width,s.height),S(this,Us,nn).call(this);for(const st of this.bezierPath2D)C.stroke(st)},ni=new WeakSet,Un=function(s){this.canvas.removeEventListener("pointerleave",t(this,zt)),this.canvas.removeEventListener("pointermove",t(this,bt)),this.canvas.removeEventListener("pointerup",t(this,jt)),this.canvas.addEventListener("pointerdown",t(this,Ot)),t(this,Yt)&&clearTimeout(t(this,Yt)),P(this,Yt,setTimeout(()=>{P(this,Yt,null),this.canvas.removeEventListener("contextmenu",G.noContextMenu)},10)),S(this,qe,ga).call(this,s.offsetX,s.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Bs=new WeakSet,en=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},$s=new WeakSet,sn=function(){P(this,ue,new ResizeObserver(s=>{const C=s[0].contentRect;C.width&&C.height&&this.setDimensions(C.width,C.height)})),t(this,ue).observe(this.div)},As=new WeakSet,ei=function(){if(!t(this,Qt))return;const[s,C]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*s),this.canvas.height=Math.ceil(this.height*C),S(this,Us,nn).call(this)},ri=new WeakSet,Vn=function(s,C){const st=S(this,Vs,rn).call(this),ht=(s-st)/t(this,wt),mt=(C-st)/t(this,ct);this.scaleFactor=Math.min(ht,mt)},Us=new WeakSet,nn=function(){const s=S(this,Vs,rn).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+s,this.translationY*this.scaleFactor+s)},Di=new WeakSet,ba=function(s){const C=new Path2D;for(let st=0,ht=s.length;st<ht;st++){const[mt,It,Gt,Lt]=s[st];st===0&&C.moveTo(...mt),C.bezierCurveTo(It[0],It[1],Gt[0],Gt[1],Lt[0],Lt[1])}return C},ai=new WeakSet,jn=function(s,C,st){const[ht,mt,It,Gt]=C;switch(st){case 0:for(let Lt=0,Xt=s.length;Lt<Xt;Lt+=2)s[Lt]+=ht,s[Lt+1]=Gt-s[Lt+1];break;case 90:for(let Lt=0,Xt=s.length;Lt<Xt;Lt+=2){const Wt=s[Lt];s[Lt]=s[Lt+1]+ht,s[Lt+1]=Wt+mt}break;case 180:for(let Lt=0,Xt=s.length;Lt<Xt;Lt+=2)s[Lt]=It-s[Lt],s[Lt+1]+=mt;break;case 270:for(let Lt=0,Xt=s.length;Lt<Xt;Lt+=2){const Wt=s[Lt];s[Lt]=It-s[Lt+1],s[Lt+1]=Gt-Wt}break;default:throw new Error("Invalid rotation")}return s},Oi=new WeakSet,Aa=function(s,C,st){const[ht,mt,It,Gt]=C;switch(st){case 0:for(let Lt=0,Xt=s.length;Lt<Xt;Lt+=2)s[Lt]-=ht,s[Lt+1]=Gt-s[Lt+1];break;case 90:for(let Lt=0,Xt=s.length;Lt<Xt;Lt+=2){const Wt=s[Lt];s[Lt]=s[Lt+1]-mt,s[Lt+1]=Wt-ht}break;case 180:for(let Lt=0,Xt=s.length;Lt<Xt;Lt+=2)s[Lt]=It-s[Lt],s[Lt+1]-=mt;break;case 270:for(let Lt=0,Xt=s.length;Lt<Xt;Lt+=2){const Wt=s[Lt];s[Lt]=Gt-s[Lt+1],s[Lt+1]=It-Wt}break;default:throw new Error("Invalid rotation")}return s},Ni=new WeakSet,ya=function(s,C,st,ht){var Xt,Wt;const mt=[],It=this.thickness/2,Gt=s*C+It,Lt=s*st+It;for(const Ae of this.paths){const ye=[],xe=[];for(let Le=0,Ue=Ae.length;Le<Ue;Le++){const[De,$e,Be,ds]=Ae[Le];if(De[0]===ds[0]&&De[1]===ds[1]&&Ue===1){const qi=s*De[0]+Gt,vi=s*De[1]+Lt;ye.push(qi,vi),xe.push(qi,vi);break}const fi=s*De[0]+Gt,mi=s*De[1]+Lt,Vi=s*$e[0]+Gt,os=s*$e[1]+Lt,wn=s*Be[0]+Gt,En=s*Be[1]+Lt,ji=s*ds[0]+Gt,Gi=s*ds[1]+Lt;Le===0&&(ye.push(fi,mi),xe.push(fi,mi)),ye.push(Vi,os,wn,En,ji,Gi),xe.push(Vi,os),Le===Ue-1&&xe.push(ji,Gi)}mt.push({bezier:S(Xt=Oe,ai,jn).call(Xt,ye,ht,this.rotation),points:S(Wt=Oe,ai,jn).call(Wt,xe,ht,this.rotation)})}return mt},oi=new WeakSet,Gn=function(){let s=1/0,C=-1/0,st=1/0,ht=-1/0;for(const mt of this.paths)for(const[It,Gt,Lt,Xt]of mt){const Wt=e.Util.bezierBoundingBox(...It,...Gt,...Lt,...Xt);s=Math.min(s,Wt[0]),st=Math.min(st,Wt[1]),C=Math.max(C,Wt[2]),ht=Math.max(ht,Wt[3])}return[s,st,C,ht]},Vs=new WeakSet,rn=function(){return t(this,St)?Math.ceil(this.thickness*this.parentScale):0},Ls=new WeakSet,Ei=function(s=!1){if(this.isEmpty())return;if(!t(this,St)){S(this,us,Os).call(this);return}const C=S(this,oi,Gn).call(this),st=S(this,Vs,rn).call(this);P(this,wt,Math.max(w.AnnotationEditor.MIN_SIZE,C[2]-C[0])),P(this,ct,Math.max(w.AnnotationEditor.MIN_SIZE,C[3]-C[1]));const ht=Math.ceil(st+t(this,wt)*this.scaleFactor),mt=Math.ceil(st+t(this,ct)*this.scaleFactor),[It,Gt]=this.parentDimensions;this.width=ht/It,this.height=mt/Gt,this.setAspectRatio(ht,mt);const Lt=this.translationX,Xt=this.translationY;this.translationX=-C[0],this.translationY=-C[1],S(this,As,ei).call(this),S(this,us,Os).call(this),P(this,ce,ht),P(this,we,mt),this.setDims(ht,mt);const Wt=s?st/this.scaleFactor/2:0;this.translate(Lt-this.translationX-Wt,Xt-this.translationY-Wt)},l(Oe,Di),l(Oe,ai),l(Oe,Oi),me(Oe,"_defaultColor",null),me(Oe,"_defaultOpacity",1),me(Oe,"_defaultThickness",1),me(Oe,"_type","ink"),me(Oe,"_editorType",e.AnnotationEditorType.INK);let E=Oe;const di=class di extends w.AnnotationEditor{constructor(s){super({...s,name:"stampEditor"});l(this,ks);l(this,Rs);l(this,Gs);l(this,li);l(this,Hi);l(this,Bi);l(this,ci);l(this,qs);l(this,$i);l(this,je,null);l(this,Ge,null);l(this,ys,null);l(this,ps,null);l(this,_s,null);l(this,js,"");l(this,hs,null);l(this,Ps,null);l(this,ls,null);l(this,rs,!1);l(this,hi,!1);P(this,ps,s.bitmapUrl),P(this,_s,s.bitmapFile)}static initialize(s,C){w.AnnotationEditor.initialize(s,C)}static get supportedTypes(){const s=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,e.shadow)(this,"supportedTypes",s.map(C=>`image/${C}`))}static get supportedTypesStr(){return(0,e.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(s){return this.supportedTypes.includes(s)}static paste(s,C){C.pasteEditor(e.AnnotationEditorType.STAMP,{bitmapFile:s.getAsFile()})}remove(){var s,C;t(this,Ge)&&(P(this,je,null),this._uiManager.imageManager.deleteId(t(this,Ge)),(s=t(this,hs))==null||s.remove(),P(this,hs,null),(C=t(this,Ps))==null||C.disconnect(),P(this,Ps,null),t(this,ls)&&(clearTimeout(t(this,ls)),P(this,ls,null))),super.remove()}rebuild(){if(!this.parent){t(this,Ge)&&S(this,Gs,an).call(this);return}super.rebuild(),this.div!==null&&(t(this,Ge)&&t(this,hs)===null&&S(this,Gs,an).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,ys)||t(this,je)||t(this,ps)||t(this,_s)||t(this,Ge))}get isResizable(){return!0}render(){if(this.div)return this.div;let s,C;if(this.width&&(s=this.x,C=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),t(this,je)?S(this,li,qn).call(this):S(this,Gs,an).call(this),this.width){const[st,ht]=this.parentDimensions;this.setAt(s*st,C*ht,this.width*st,this.height*ht)}return this.div}getImageForAltText(){return t(this,hs)}static deserialize(s,C,st){if(s instanceof R.StampAnnotationElement)return null;const ht=super.deserialize(s,C,st),{rect:mt,bitmapUrl:It,bitmapId:Gt,isSvg:Lt,accessibilityData:Xt}=s;Gt&&st.imageManager.isValidId(Gt)?P(ht,Ge,Gt):P(ht,ps,It),P(ht,rs,Lt);const[Wt,Ae]=ht.pageDimensions;return ht.width=(mt[2]-mt[0])/Wt,ht.height=(mt[3]-mt[1])/Ae,Xt&&(ht.altTextData=Xt),ht}serialize(s=!1,C=null){if(this.isEmpty())return null;const st={annotationType:e.AnnotationEditorType.STAMP,bitmapId:t(this,Ge),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,rs),structTreeParentId:this._structTreeParentId};if(s)return st.bitmapUrl=S(this,qs,on).call(this,!0),st.accessibilityData=this.altTextData,st;const{decorative:ht,altText:mt}=this.altTextData;if(!ht&&mt&&(st.accessibilityData={type:"Figure",alt:mt}),C===null)return st;C.stamps||(C.stamps=new Map);const It=t(this,rs)?(st.rect[2]-st.rect[0])*(st.rect[3]-st.rect[1]):null;if(!C.stamps.has(t(this,Ge)))C.stamps.set(t(this,Ge),{area:It,serialized:st}),st.bitmap=S(this,qs,on).call(this,!1);else if(t(this,rs)){const Gt=C.stamps.get(t(this,Ge));It>Gt.area&&(Gt.area=It,Gt.serialized.bitmap.close(),Gt.serialized.bitmap=S(this,qs,on).call(this,!1))}return st}};je=new WeakMap,Ge=new WeakMap,ys=new WeakMap,ps=new WeakMap,_s=new WeakMap,js=new WeakMap,hs=new WeakMap,Ps=new WeakMap,ls=new WeakMap,rs=new WeakMap,hi=new WeakMap,ks=new WeakSet,xi=function(s,C=!1){if(!s){this.remove();return}P(this,je,s.bitmap),C||(P(this,Ge,s.id),P(this,rs,s.isSvg)),s.file&&P(this,js,s.file.name),S(this,li,qn).call(this)},Rs=new WeakSet,Si=function(){P(this,ys,null),this._uiManager.enableWaiting(!1),t(this,hs)&&this.div.focus()},Gs=new WeakSet,an=function(){if(t(this,Ge)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,Ge)).then(C=>S(this,ks,xi).call(this,C,!0)).finally(()=>S(this,Rs,Si).call(this));return}if(t(this,ps)){const C=t(this,ps);P(this,ps,null),this._uiManager.enableWaiting(!0),P(this,ys,this._uiManager.imageManager.getFromUrl(C).then(st=>S(this,ks,xi).call(this,st)).finally(()=>S(this,Rs,Si).call(this)));return}if(t(this,_s)){const C=t(this,_s);P(this,_s,null),this._uiManager.enableWaiting(!0),P(this,ys,this._uiManager.imageManager.getFromFile(C).then(st=>S(this,ks,xi).call(this,st)).finally(()=>S(this,Rs,Si).call(this)));return}const s=document.createElement("input");s.type="file",s.accept=di.supportedTypesStr,P(this,ys,new Promise(C=>{s.addEventListener("change",async()=>{if(!s.files||s.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const st=await this._uiManager.imageManager.getFromFile(s.files[0]);S(this,ks,xi).call(this,st)}C()}),s.addEventListener("cancel",()=>{this.remove(),C()})}).finally(()=>S(this,Rs,Si).call(this))),s.click()},li=new WeakSet,qn=function(){const{div:s}=this;let{width:C,height:st}=t(this,je);const[ht,mt]=this.pageDimensions,It=.75;if(this.width)C=this.width*ht,st=this.height*mt;else if(C>It*ht||st>It*mt){const Wt=Math.min(It*ht/C,It*mt/st);C*=Wt,st*=Wt}const[Gt,Lt]=this.parentDimensions;this.setDims(C*Gt/ht,st*Lt/mt),this._uiManager.enableWaiting(!1);const Xt=P(this,hs,document.createElement("canvas"));s.append(Xt),s.hidden=!1,S(this,ci,zn).call(this,C,st),S(this,$i,Ea).call(this),t(this,hi)||(this.parent.addUndoableEditor(this),P(this,hi,!0)),this._reportTelemetry({action:"inserted_image"}),t(this,js)&&Xt.setAttribute("aria-label",t(this,js))},Hi=new WeakSet,_a=function(s,C){var It;const[st,ht]=this.parentDimensions;this.width=s/st,this.height=C/ht,this.setDims(s,C),(It=this._initialOptions)!=null&&It.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,ls)!==null&&clearTimeout(t(this,ls)),P(this,ls,setTimeout(()=>{P(this,ls,null),S(this,ci,zn).call(this,s,C)},200))},Bi=new WeakSet,wa=function(s,C){const{width:st,height:ht}=t(this,je);let mt=st,It=ht,Gt=t(this,je);for(;mt>2*s||It>2*C;){const Lt=mt,Xt=It;mt>2*s&&(mt=mt>=16384?Math.floor(mt/2)-1:Math.ceil(mt/2)),It>2*C&&(It=It>=16384?Math.floor(It/2)-1:Math.ceil(It/2));const Wt=new OffscreenCanvas(mt,It);Wt.getContext("2d").drawImage(Gt,0,0,Lt,Xt,0,0,mt,It),Gt=Wt.transferToImageBitmap()}return Gt},ci=new WeakSet,zn=function(s,C){s=Math.ceil(s),C=Math.ceil(C);const st=t(this,hs);if(!st||st.width===s&&st.height===C)return;st.width=s,st.height=C;const ht=t(this,rs)?t(this,je):S(this,Bi,wa).call(this,s,C);if(this._uiManager.hasMLManager&&!this.hasAltText()){const It=new OffscreenCanvas(s,C);It.getContext("2d").drawImage(ht,0,0,ht.width,ht.height,0,0,s,C),It.convertToBlob().then(Gt=>{const Lt=new FileReader;Lt.onload=()=>{const Xt=Lt.result;this._uiManager.mlGuess({service:"image-to-text",request:{imageData:Xt}}).then(Wt=>{const Ae=(Wt==null?void 0:Wt.output)||"";this.parent&&Ae&&!this.hasAltText()&&(this.altTextData={altText:Ae,decorative:!1})})},Lt.readAsDataURL(Gt)})}const mt=st.getContext("2d");mt.filter=this._uiManager.hcmFilter,mt.drawImage(ht,0,0,ht.width,ht.height,0,0,s,C)},qs=new WeakSet,on=function(s){if(s){if(t(this,rs)){const st=this._uiManager.imageManager.getSvgUrl(t(this,Ge));if(st)return st}const C=document.createElement("canvas");return{width:C.width,height:C.height}=t(this,je),C.getContext("2d").drawImage(t(this,je),0,0),C.toDataURL()}if(t(this,rs)){const[C,st]=this.pageDimensions,ht=Math.round(this.width*C*G.PixelsPerInch.PDF_TO_CSS_UNITS),mt=Math.round(this.height*st*G.PixelsPerInch.PDF_TO_CSS_UNITS),It=new OffscreenCanvas(ht,mt);return It.getContext("2d").drawImage(t(this,je),0,0,t(this,je).width,t(this,je).height,0,0,ht,mt),It.transferToImageBitmap()}return structuredClone(t(this,je))},$i=new WeakSet,Ea=function(){P(this,Ps,new ResizeObserver(s=>{const C=s[0].contentRect;C.width&&C.height&&S(this,Hi,_a).call(this,C.width,C.height)})),t(this,Ps).observe(this.div)},me(di,"_type","stamp"),me(di,"_editorType",e.AnnotationEditorType.STAMP);let H=di;const as=class as{constructor({uiManager:pt,pageIndex:s,div:C,accessibilityManager:st,annotationLayer:ht,drawLayer:mt,textLayer:It,viewport:Gt,l10n:Lt}){l(this,Ui);l(this,ui);l(this,pi);l(this,gi);l(this,Ks);l(this,Is,void 0);l(this,zs,!1);l(this,cs,null);l(this,Fs,null);l(this,gs,null);l(this,fs,null);l(this,ms,null);l(this,es,new Map);l(this,ws,!1);l(this,Ws,!1);l(this,Xs,!1);l(this,Ye,null);l(this,pe,void 0);const Xt=[...t(as,Es).values()];if(!as._initialized){as._initialized=!0;for(const Wt of Xt)Wt.initialize(Lt,pt)}pt.registerEditorTypes(Xt),P(this,pe,pt),this.pageIndex=s,this.div=C,P(this,Is,st),P(this,cs,ht),this.viewport=Gt,P(this,Ye,It),this.drawLayer=mt,t(this,pe).addLayer(this)}get isEmpty(){return t(this,es).size===0}get isInvisible(){return this.isEmpty&&t(this,pe).getMode()===e.AnnotationEditorType.NONE}updateToolbar(pt){t(this,pe).updateToolbar(pt)}updateMode(pt=t(this,pe).getMode()){switch(S(this,Ks,hn).call(this),pt){case e.AnnotationEditorType.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case e.AnnotationEditorType.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case e.AnnotationEditorType.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:s}=this.div;for(const C of t(as,Es).values())s.toggle(`${C._type}Editing`,pt===C._editorType);this.div.hidden=!1}hasTextLayer(pt){var s;return pt===((s=t(this,Ye))==null?void 0:s.div)}addInkEditorIfNeeded(pt){if(t(this,pe).getMode()===e.AnnotationEditorType.INK){if(!pt){for(const s of t(this,es).values())if(s.isEmpty()){s.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}}setEditingState(pt){t(this,pe).setEditingState(pt)}addCommands(pt){t(this,pe).addCommands(pt)}togglePointerEvents(pt=!1){this.div.classList.toggle("disabled",!pt)}toggleAnnotationLayerPointerEvents(pt=!1){var s;(s=t(this,cs))==null||s.div.classList.toggle("disabled",!pt)}enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const pt=new Set;for(const C of t(this,es).values())C.enableEditing(),C.annotationElementId&&pt.add(C.annotationElementId);if(!t(this,cs))return;const s=t(this,cs).getEditableAnnotations();for(const C of s){if(C.hide(),t(this,pe).isDeletedAnnotationElement(C.data.id)||pt.has(C.data.id))continue;const st=this.deserialize(C);st&&(this.addOrRebuild(st),st.enableEditing())}}disable(){var C;P(this,Xs,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const pt=new Set;for(const st of t(this,es).values()){if(st.disableEditing(),!st.annotationElementId||st.serialize()!==null){pt.add(st.annotationElementId);continue}(C=this.getEditableAnnotation(st.annotationElementId))==null||C.show(),st.remove()}if(t(this,cs)){const st=t(this,cs).getEditableAnnotations();for(const ht of st){const{id:mt}=ht.data;pt.has(mt)||t(this,pe).isDeletedAnnotationElement(mt)||ht.show()}}S(this,Ks,hn).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const st of t(as,Es).values())s.remove(`${st._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),P(this,Xs,!1)}getEditableAnnotation(pt){var s;return((s=t(this,cs))==null?void 0:s.getEditableAnnotation(pt))||null}setActiveEditor(pt){t(this,pe).getActive()!==pt&&t(this,pe).setActiveEditor(pt)}enableTextSelection(){var pt;this.div.tabIndex=-1,(pt=t(this,Ye))!=null&&pt.div&&!t(this,fs)&&(P(this,fs,S(this,Ui,xa).bind(this)),t(this,Ye).div.addEventListener("pointerdown",t(this,fs)),t(this,Ye).div.classList.add("highlighting"))}disableTextSelection(){var pt;this.div.tabIndex=0,(pt=t(this,Ye))!=null&&pt.div&&t(this,fs)&&(t(this,Ye).div.removeEventListener("pointerdown",t(this,fs)),P(this,fs,null),t(this,Ye).div.classList.remove("highlighting"))}enableClick(){t(this,gs)||(P(this,gs,this.pointerdown.bind(this)),P(this,Fs,this.pointerup.bind(this)),this.div.addEventListener("pointerdown",t(this,gs)),this.div.addEventListener("pointerup",t(this,Fs)))}disableClick(){t(this,gs)&&(this.div.removeEventListener("pointerdown",t(this,gs)),this.div.removeEventListener("pointerup",t(this,Fs)),P(this,gs,null),P(this,Fs,null))}attach(pt){t(this,es).set(pt.id,pt);const{annotationElementId:s}=pt;s&&t(this,pe).isDeletedAnnotationElement(s)&&t(this,pe).removeDeletedAnnotationElement(pt)}detach(pt){var s;t(this,es).delete(pt.id),(s=t(this,Is))==null||s.removePointerInTextLayer(pt.contentDiv),!t(this,Xs)&&pt.annotationElementId&&t(this,pe).addDeletedAnnotationElement(pt)}remove(pt){this.detach(pt),t(this,pe).removeEditor(pt),pt.div.remove(),pt.isAttachedToDOM=!1,t(this,Ws)||this.addInkEditorIfNeeded(!1)}changeParent(pt){var s;pt.parent!==this&&(pt.annotationElementId&&(t(this,pe).addDeletedAnnotationElement(pt.annotationElementId),w.AnnotationEditor.deleteAnnotationElement(pt),pt.annotationElementId=null),this.attach(pt),(s=pt.parent)==null||s.detach(pt),pt.setParent(this),pt.div&&pt.isAttachedToDOM&&(pt.div.remove(),this.div.append(pt.div)))}add(pt){if(!(pt.parent===this&&pt.isAttachedToDOM)){if(this.changeParent(pt),t(this,pe).addEditor(pt),this.attach(pt),!pt.isAttachedToDOM){const s=pt.render();this.div.append(s),pt.isAttachedToDOM=!0}pt.fixAndSetPosition(),pt.onceAdded(),t(this,pe).addToAnnotationStorage(pt),pt._reportTelemetry(pt.telemetryInitialData)}}moveEditorInDOM(pt){var C;if(!pt.isAttachedToDOM)return;const{activeElement:s}=document;pt.div.contains(s)&&!t(this,ms)&&(pt._focusEventsAllowed=!1,P(this,ms,setTimeout(()=>{P(this,ms,null),pt.div.contains(document.activeElement)?pt._focusEventsAllowed=!0:(pt.div.addEventListener("focusin",()=>{pt._focusEventsAllowed=!0},{once:!0}),s.focus())},0))),pt._structTreeParentId=(C=t(this,Is))==null?void 0:C.moveElementInDOM(this.div,pt.div,pt.contentDiv,!0)}addOrRebuild(pt){pt.needsToBeRebuilt()?(pt.parent||(pt.parent=this),pt.rebuild(),pt.show()):this.add(pt)}addUndoableEditor(pt){const s=()=>pt._uiManager.rebuild(pt),C=()=>{pt.remove()};this.addCommands({cmd:s,undo:C,mustExec:!1})}getNextId(){return t(this,pe).getId()}canCreateNewEmptyEditor(){var pt;return(pt=t(this,ui,Wn))==null?void 0:pt.canCreateNewEmptyEditor()}pasteEditor(pt,s){t(this,pe).updateToolbar(pt),t(this,pe).updateMode(pt);const{offsetX:C,offsetY:st}=S(this,gi,Kn).call(this),ht=this.getNextId(),mt=S(this,pi,Xn).call(this,{parent:this,id:ht,x:C,y:st,uiManager:t(this,pe),isCentered:!0,...s});mt&&this.add(mt)}deserialize(pt){var s;return((s=t(as,Es).get(pt.annotationType??pt.annotationEditorType))==null?void 0:s.deserialize(pt,this,t(this,pe)))||null}createAndAddNewEditor(pt,s,C={}){const st=this.getNextId(),ht=S(this,pi,Xn).call(this,{parent:this,id:st,x:pt.offsetX,y:pt.offsetY,uiManager:t(this,pe),isCentered:s,...C});return ht&&this.add(ht),ht}addNewEditor(){this.createAndAddNewEditor(S(this,gi,Kn).call(this),!0)}setSelected(pt){t(this,pe).setSelected(pt)}toggleSelected(pt){t(this,pe).toggleSelected(pt)}isSelected(pt){return t(this,pe).isSelected(pt)}unselect(pt){t(this,pe).unselect(pt)}pointerup(pt){const{isMac:s}=e.FeatureTest.platform;if(!(pt.button!==0||pt.ctrlKey&&s)&&pt.target===this.div&&t(this,ws)){if(P(this,ws,!1),!t(this,zs)){P(this,zs,!0);return}if(t(this,pe).getMode()===e.AnnotationEditorType.STAMP){t(this,pe).unselectAll();return}this.createAndAddNewEditor(pt,!1)}}pointerdown(pt){if(t(this,pe).getMode()===e.AnnotationEditorType.HIGHLIGHT&&this.enableTextSelection(),t(this,ws)){P(this,ws,!1);return}const{isMac:s}=e.FeatureTest.platform;if(pt.button!==0||pt.ctrlKey&&s||pt.target!==this.div)return;P(this,ws,!0);const C=t(this,pe).getActive();P(this,zs,!C||C.isEmpty())}findNewParent(pt,s,C){const st=t(this,pe).findParent(s,C);return st===null||st===this?!1:(st.changeParent(pt),!0)}destroy(){var pt,s;((pt=t(this,pe).getActive())==null?void 0:pt.parent)===this&&(t(this,pe).commitOrRemove(),t(this,pe).setActiveEditor(null)),t(this,ms)&&(clearTimeout(t(this,ms)),P(this,ms,null));for(const C of t(this,es).values())(s=t(this,Is))==null||s.removePointerInTextLayer(C.contentDiv),C.setParent(null),C.isAttachedToDOM=!1,C.div.remove();this.div=null,t(this,es).clear(),t(this,pe).removeLayer(this)}render({viewport:pt}){this.viewport=pt,(0,G.setLayerDimensions)(this.div,pt);for(const s of t(this,pe).getEditors(this.pageIndex))this.add(s),s.rebuild();this.updateMode()}update({viewport:pt}){t(this,pe).commitOrRemove(),S(this,Ks,hn).call(this);const s=this.viewport.rotation,C=pt.rotation;if(this.viewport=pt,(0,G.setLayerDimensions)(this.div,{rotation:C}),s!==C)for(const st of t(this,es).values())st.rotate(C);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:pt,pageHeight:s}=this.viewport.rawDims;return[pt,s]}get scale(){return t(this,pe).viewParameters.realScale}};Is=new WeakMap,zs=new WeakMap,cs=new WeakMap,Fs=new WeakMap,gs=new WeakMap,fs=new WeakMap,ms=new WeakMap,es=new WeakMap,ws=new WeakMap,Ws=new WeakMap,Xs=new WeakMap,Ye=new WeakMap,pe=new WeakMap,Es=new WeakMap,Ui=new WeakSet,xa=function(pt){if(t(this,pe).unselectAll(),pt.target===t(this,Ye).div){const{isMac:s}=e.FeatureTest.platform;if(pt.button!==0||pt.ctrlKey&&s)return;t(this,pe).showAllEditors("highlight",!0,!0),t(this,Ye).div.classList.add("free"),I.startHighlighting(this,t(this,pe).direction==="ltr",pt),t(this,Ye).div.addEventListener("pointerup",()=>{t(this,Ye).div.classList.remove("free")},{once:!0}),pt.preventDefault()}},ui=new WeakSet,Wn=function(){return t(as,Es).get(t(this,pe).getMode())},pi=new WeakSet,Xn=function(pt){const s=t(this,ui,Wn);return s?new s.prototype.constructor(pt):null},gi=new WeakSet,Kn=function(){const{x:pt,y:s,width:C,height:st}=this.div.getBoundingClientRect(),ht=Math.max(0,pt),mt=Math.max(0,s),It=Math.min(window.innerWidth,pt+C),Gt=Math.min(window.innerHeight,s+st),Lt=(ht+It)/2-pt,Xt=(mt+Gt)/2-s,[Wt,Ae]=this.viewport.rotation%180===0?[Lt,Xt]:[Xt,Lt];return{offsetX:Wt,offsetY:Ae}},Ks=new WeakSet,hn=function(){P(this,Ws,!0);for(const pt of t(this,es).values())pt.isEmpty()&&pt.remove();P(this,Ws,!1)},me(as,"_initialized",!1),l(as,Es,new Map([k,E,H,I].map(pt=>[pt._editorType,pt])));let $=as},259:(o,b,d)=>{var K,k,y,g,G,I,E,H,$,Y,at,Q,M,Yn,B,Jn,q,Sa,vt,Ns,Ct,Ca,_t,xs;d.d(b,{ColorPicker:()=>R});var e=d(292),w=d(830),v=d(419);const Pt=class Pt{constructor({editor:Z=null,uiManager:gt=null}){l(this,M);l(this,B);l(this,q);l(this,vt);l(this,Ct);l(this,_t);l(this,K,S(this,q,Sa).bind(this));l(this,k,S(this,Ct,Ca).bind(this));l(this,y,null);l(this,g,null);l(this,G,void 0);l(this,I,null);l(this,E,!1);l(this,H,!1);l(this,$,null);l(this,Y,void 0);l(this,at,null);l(this,Q,void 0);var kt;Z?(P(this,H,!1),P(this,Q,e.AnnotationEditorParamsType.HIGHLIGHT_COLOR),P(this,$,Z)):(P(this,H,!0),P(this,Q,e.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR)),P(this,at,(Z==null?void 0:Z._uiManager)||gt),P(this,Y,t(this,at)._eventBus),P(this,G,(Z==null?void 0:Z.color)||((kt=t(this,at))==null?void 0:kt.highlightColors.values().next().value)||"#FFFF98")}static get _keyboardManager(){return(0,e.shadow)(this,"_keyboardManager",new w.KeyboardManager([[["Escape","mac+Escape"],Pt.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Pt.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Pt.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Pt.prototype._moveToPrevious],[["Home","mac+Home"],Pt.prototype._moveToBeginning],[["End","mac+End"],Pt.prototype._moveToEnd]]))}renderButton(){const Z=P(this,y,document.createElement("button"));Z.className="colorPicker",Z.tabIndex="0",Z.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),Z.setAttribute("aria-haspopup",!0),Z.addEventListener("click",S(this,vt,Ns).bind(this)),Z.addEventListener("keydown",t(this,K));const gt=P(this,g,document.createElement("span"));return gt.className="swatch",gt.setAttribute("aria-hidden",!0),gt.style.backgroundColor=t(this,G),Z.append(gt),Z}renderMainDropdown(){const Z=P(this,I,S(this,M,Yn).call(this));return Z.setAttribute("aria-orientation","horizontal"),Z.setAttribute("aria-labelledby","highlightColorPickerLabel"),Z}_colorSelectFromKeyboard(Z){if(Z.target===t(this,y)){S(this,vt,Ns).call(this,Z);return}const gt=Z.target.getAttribute("data-color");gt&&S(this,B,Jn).call(this,gt,Z)}_moveToNext(Z){var gt,kt;if(!t(this,_t,xs)){S(this,vt,Ns).call(this,Z);return}if(Z.target===t(this,y)){(gt=t(this,I).firstChild)==null||gt.focus();return}(kt=Z.target.nextSibling)==null||kt.focus()}_moveToPrevious(Z){var gt,kt;if(Z.target===((gt=t(this,I))==null?void 0:gt.firstChild)||Z.target===t(this,y)){t(this,_t,xs)&&this._hideDropdownFromKeyboard();return}t(this,_t,xs)||S(this,vt,Ns).call(this,Z),(kt=Z.target.previousSibling)==null||kt.focus()}_moveToBeginning(Z){var gt;if(!t(this,_t,xs)){S(this,vt,Ns).call(this,Z);return}(gt=t(this,I).firstChild)==null||gt.focus()}_moveToEnd(Z){var gt;if(!t(this,_t,xs)){S(this,vt,Ns).call(this,Z);return}(gt=t(this,I).lastChild)==null||gt.focus()}hideDropdown(){var Z;(Z=t(this,I))==null||Z.classList.add("hidden"),window.removeEventListener("pointerdown",t(this,k))}_hideDropdownFromKeyboard(){var Z;if(!t(this,H)){if(!t(this,_t,xs)){(Z=t(this,$))==null||Z.unselect();return}this.hideDropdown(),t(this,y).focus({preventScroll:!0,focusVisible:t(this,E)})}}updateColor(Z){if(t(this,g)&&(t(this,g).style.backgroundColor=Z),!t(this,I))return;const gt=t(this,at).highlightColors.values();for(const kt of t(this,I).children)kt.setAttribute("aria-selected",gt.next().value===Z)}destroy(){var Z,gt;(Z=t(this,y))==null||Z.remove(),P(this,y,null),P(this,g,null),(gt=t(this,I))==null||gt.remove(),P(this,I,null)}};K=new WeakMap,k=new WeakMap,y=new WeakMap,g=new WeakMap,G=new WeakMap,I=new WeakMap,E=new WeakMap,H=new WeakMap,$=new WeakMap,Y=new WeakMap,at=new WeakMap,Q=new WeakMap,M=new WeakSet,Yn=function(){const Z=document.createElement("div");Z.addEventListener("contextmenu",v.noContextMenu),Z.className="dropdown",Z.role="listbox",Z.setAttribute("aria-multiselectable",!1),Z.setAttribute("aria-orientation","vertical"),Z.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[gt,kt]of t(this,at).highlightColors){const Rt=document.createElement("button");Rt.tabIndex="0",Rt.role="option",Rt.setAttribute("data-color",kt),Rt.title=gt,Rt.setAttribute("data-l10n-id",`pdfjs-editor-colorpicker-${gt}`);const qt=document.createElement("span");Rt.append(qt),qt.className="swatch",qt.style.backgroundColor=kt,Rt.setAttribute("aria-selected",kt===t(this,G)),Rt.addEventListener("click",S(this,B,Jn).bind(this,kt)),Z.append(Rt)}return Z.addEventListener("keydown",t(this,K)),Z},B=new WeakSet,Jn=function(Z,gt){gt.stopPropagation(),t(this,Y).dispatch("switchannotationeditorparams",{source:this,type:t(this,Q),value:Z})},q=new WeakSet,Sa=function(Z){Pt._keyboardManager.exec(this,Z)},vt=new WeakSet,Ns=function(Z){if(t(this,_t,xs)){this.hideDropdown();return}if(P(this,E,Z.detail===0),window.addEventListener("pointerdown",t(this,k)),t(this,I)){t(this,I).classList.remove("hidden");return}const gt=P(this,I,S(this,M,Yn).call(this));t(this,y).append(gt)},Ct=new WeakSet,Ca=function(Z){var gt;(gt=t(this,I))!=null&&gt.contains(Z.target)||this.hideDropdown()},_t=new WeakSet,xs=function(){return t(this,I)&&!t(this,I).classList.contains("hidden")};let R=Pt},310:(o,b,d)=>{var g,G,I,E,H,$,Y,at,Qn,U,B,D,q,tt,vt,Ft,Ct,Nt,_t,Tt,Pt,Et,Z,gt,kt,Rt,qt,Kt,ie,Se,de,Zn,ve,tr,ae,er,ee,Ma,ne,Ta,i,sr,c,ir,a,nr,m,La,u,Pa,h,ka,V,Ra,rt,rr,yt,Ci;d.d(b,{AnnotationEditor:()=>k});var e=d(830),w=d(292),v=d(419);const M=class M{constructor(L){l(this,at);l(this,g,"");l(this,G,!1);l(this,I,null);l(this,E,null);l(this,H,null);l(this,$,!1);l(this,Y,null);P(this,Y,L)}static initialize(L){M._l10nPromise||(M._l10nPromise=L)}async render(){const L=P(this,I,document.createElement("button"));L.className="altText";const X=await M._l10nPromise.get("pdfjs-editor-alt-text-button-label");L.textContent=X,L.setAttribute("aria-label",X),L.tabIndex="0",L.addEventListener("contextmenu",v.noContextMenu),L.addEventListener("pointerdown",N=>N.stopPropagation());const nt=N=>{N.preventDefault(),t(this,Y)._uiManager.editAltText(t(this,Y))};return L.addEventListener("click",nt,{capture:!0}),L.addEventListener("keydown",N=>{N.target===L&&N.key==="Enter"&&(P(this,$,!0),nt(N))}),await S(this,at,Qn).call(this),L}finish(){t(this,I)&&(t(this,I).focus({focusVisible:t(this,$)}),P(this,$,!1))}isEmpty(){return!t(this,g)&&!t(this,G)}get data(){return{altText:t(this,g),decorative:t(this,G)}}set data({altText:L,decorative:X}){t(this,g)===L&&t(this,G)===X||(P(this,g,L),P(this,G,X),S(this,at,Qn).call(this))}toggle(L=!1){t(this,I)&&(!L&&t(this,H)&&(clearTimeout(t(this,H)),P(this,H,null)),t(this,I).disabled=!L)}destroy(){var L;(L=t(this,I))==null||L.remove(),P(this,I,null),P(this,E,null)}};g=new WeakMap,G=new WeakMap,I=new WeakMap,E=new WeakMap,H=new WeakMap,$=new WeakMap,Y=new WeakMap,at=new WeakSet,Qn=async function(){var nt,N;const L=t(this,I);if(!L)return;if(!t(this,g)&&!t(this,G)){L.classList.remove("done"),(nt=t(this,E))==null||nt.remove();return}L.classList.add("done"),M._l10nPromise.get("pdfjs-editor-alt-text-edit-button-label").then(f=>{L.setAttribute("aria-label",f)});let X=t(this,E);if(!X){P(this,E,X=document.createElement("span")),X.className="tooltip",X.setAttribute("role","tooltip");const f=X.id=`alt-text-tooltip-${t(this,Y).id}`;L.setAttribute("aria-describedby",f);const z=100;L.addEventListener("mouseenter",()=>{P(this,H,setTimeout(()=>{P(this,H,null),t(this,E).classList.add("show"),t(this,Y)._reportTelemetry({action:"alt_text_tooltip"})},z))}),L.addEventListener("mouseleave",()=>{var W;t(this,H)&&(clearTimeout(t(this,H)),P(this,H,null)),(W=t(this,E))==null||W.classList.remove("show")})}X.innerText=t(this,G)?await M._l10nPromise.get("pdfjs-editor-alt-text-decorative-tooltip"):t(this,g),X.parentNode||L.append(X),(N=t(this,Y).getImageForAltText())==null||N.setAttribute("aria-describedby",X.id)},me(M,"_l10nPromise",null);let R=M;var K=d(362);const ut=class ut{constructor(L){l(this,de);l(this,ae);l(this,ee);l(this,ne);l(this,i);l(this,c);l(this,a);l(this,m);l(this,u);l(this,h);l(this,V);l(this,rt);l(this,yt);l(this,U,null);l(this,B,null);l(this,D,!1);l(this,q,!1);l(this,tt,null);l(this,vt,null);l(this,Ft,this.focusin.bind(this));l(this,Ct,this.focusout.bind(this));l(this,Nt,null);l(this,_t,"");l(this,Tt,!1);l(this,Pt,null);l(this,Et,!1);l(this,Z,!1);l(this,gt,!1);l(this,kt,null);l(this,Rt,0);l(this,qt,0);l(this,Kt,null);me(this,"_initialOptions",Object.create(null));me(this,"_isVisible",!0);me(this,"_uiManager",null);me(this,"_focusEventsAllowed",!0);me(this,"_l10nPromise",null);l(this,ie,!1);l(this,Se,ut._zIndex++);this.constructor===ut&&(0,w.unreachable)("Cannot initialize AnnotationEditor."),this.parent=L.parent,this.id=L.id,this.width=this.height=null,this.pageIndex=L.parent.pageIndex,this.name=L.name,this.div=null,this._uiManager=L.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=L.isCentered,this._structTreeParentId=null;const{rotation:X,rawDims:{pageWidth:nt,pageHeight:N,pageX:f,pageY:z}}=this.parent.viewport;this.rotation=X,this.pageRotation=(360+X-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[nt,N],this.pageTranslation=[f,z];const[W,lt]=this.parentDimensions;this.x=L.x/W,this.y=L.y/lt,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const L=ut.prototype._resizeWithKeyboard,X=e.AnnotationEditorUIManager.TRANSLATE_SMALL,nt=e.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,w.shadow)(this,"_resizerKeyboardManager",new e.KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],L,{args:[-X,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],L,{args:[-nt,0]}],[["ArrowRight","mac+ArrowRight"],L,{args:[X,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],L,{args:[nt,0]}],[["ArrowUp","mac+ArrowUp"],L,{args:[0,-X]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],L,{args:[0,-nt]}],[["ArrowDown","mac+ArrowDown"],L,{args:[0,X]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],L,{args:[0,nt]}],[["Escape","mac+Escape"],ut.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,w.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(L){const X=new y({id:L.parent.getNextId(),parent:L.parent,uiManager:L._uiManager});X.annotationElementId=L.annotationElementId,X.deleted=!0,X._uiManager.addToAnnotationStorage(X)}static initialize(L,X,nt){if(ut._l10nPromise||(ut._l10nPromise=new Map(["pdfjs-editor-alt-text-button-label","pdfjs-editor-alt-text-edit-button-label","pdfjs-editor-alt-text-decorative-tooltip","pdfjs-editor-resizer-label-topLeft","pdfjs-editor-resizer-label-topMiddle","pdfjs-editor-resizer-label-topRight","pdfjs-editor-resizer-label-middleRight","pdfjs-editor-resizer-label-bottomRight","pdfjs-editor-resizer-label-bottomMiddle","pdfjs-editor-resizer-label-bottomLeft","pdfjs-editor-resizer-label-middleLeft"].map(f=>[f,L.get(f.replaceAll(/([A-Z])/g,z=>`-${z.toLowerCase()}`))]))),nt==null?void 0:nt.strings)for(const f of nt.strings)ut._l10nPromise.set(f,L.get(f));if(ut._borderLineWidth!==-1)return;const N=getComputedStyle(document.documentElement);ut._borderLineWidth=parseFloat(N.getPropertyValue("--outline-width"))||0}static updateDefaultParams(L,X){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(L){return!1}static paste(L,X){(0,w.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,ie)}set _isDraggable(L){var X;P(this,ie,L),(X=this.div)==null||X.classList.toggle("draggable",L)}get isEnterHandled(){return!0}center(){const[L,X]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*X/(L*2),this.y+=this.width*L/(X*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*X/(L*2),this.y-=this.width*L/(X*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(L){this._uiManager.addCommands(L)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,Se)}setParent(L){L!==null?(this.pageIndex=L.pageIndex,this.pageDimensions=L.pageDimensions):S(this,yt,Ci).call(this),this.parent=L}focusin(L){this._focusEventsAllowed&&(t(this,Tt)?P(this,Tt,!1):this.parent.setSelected(this))}focusout(L){var X,nt;!this._focusEventsAllowed||!this.isAttachedToDOM||(X=L.relatedTarget)!=null&&X.closest(`#${this.id}`)||(L.preventDefault(),(nt=this.parent)!=null&&nt.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(L,X,nt,N){const[f,z]=this.parentDimensions;[nt,N]=this.screenToPageTranslation(nt,N),this.x=(L+nt)/f,this.y=(X+N)/z,this.fixAndSetPosition()}translate(L,X){S(this,de,Zn).call(this,this.parentDimensions,L,X)}translateInPage(L,X){t(this,Pt)||P(this,Pt,[this.x,this.y]),S(this,de,Zn).call(this,this.pageDimensions,L,X),this.div.scrollIntoView({block:"nearest"})}drag(L,X){t(this,Pt)||P(this,Pt,[this.x,this.y]);const[nt,N]=this.parentDimensions;if(this.x+=L/nt,this.y+=X/N,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:ft,y:Mt}=this.div.getBoundingClientRect();this.parent.findNewParent(this,ft,Mt)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:f,y:z}=this;const[W,lt]=this.getBaseTranslation();f+=W,z+=lt,this.div.style.left=`${(100*f).toFixed(2)}%`,this.div.style.top=`${(100*z).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!t(this,Pt)&&(t(this,Pt)[0]!==this.x||t(this,Pt)[1]!==this.y)}getBaseTranslation(){const[L,X]=this.parentDimensions,{_borderLineWidth:nt}=ut,N=nt/L,f=nt/X;switch(this.rotation){case 90:return[-N,f];case 180:return[N,f];case 270:return[N,-f];default:return[-N,-f]}}get _mustFixPosition(){return!0}fixAndSetPosition(L=this.rotation){const[X,nt]=this.pageDimensions;let{x:N,y:f,width:z,height:W}=this;if(z*=X,W*=nt,N*=X,f*=nt,this._mustFixPosition)switch(L){case 0:N=Math.max(0,Math.min(X-z,N)),f=Math.max(0,Math.min(nt-W,f));break;case 90:N=Math.max(0,Math.min(X-W,N)),f=Math.min(nt,Math.max(z,f));break;case 180:N=Math.min(X,Math.max(z,N)),f=Math.min(nt,Math.max(W,f));break;case 270:N=Math.min(X,Math.max(W,N)),f=Math.max(0,Math.min(nt-z,f));break}this.x=N/=X,this.y=f/=nt;const[lt,ft]=this.getBaseTranslation();N+=lt,f+=ft;const{style:Mt}=this.div;Mt.left=`${(100*N).toFixed(2)}%`,Mt.top=`${(100*f).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(L,X){var nt;return S(nt=ut,ve,tr).call(nt,L,X,this.parentRotation)}pageTranslationToScreen(L,X){var nt;return S(nt=ut,ve,tr).call(nt,L,X,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:L,pageDimensions:[X,nt]}=this,N=X*L,f=nt*L;return w.FeatureTest.isCSSRoundSupported?[Math.round(N),Math.round(f)]:[N,f]}setDims(L,X){const[nt,N]=this.parentDimensions;this.div.style.width=`${(100*L/nt).toFixed(2)}%`,t(this,q)||(this.div.style.height=`${(100*X/N).toFixed(2)}%`)}fixDims(){const{style:L}=this.div,{height:X,width:nt}=L,N=nt.endsWith("%"),f=!t(this,q)&&X.endsWith("%");if(N&&f)return;const[z,W]=this.parentDimensions;N||(L.width=`${(100*parseFloat(nt)/z).toFixed(2)}%`),!t(this,q)&&!f&&(L.height=`${(100*parseFloat(X)/W).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}altTextFinish(){var L;(L=t(this,B))==null||L.finish()}async addEditToolbar(){return t(this,Nt)||t(this,Z)?t(this,Nt):(P(this,Nt,new K.EditorToolbar(this)),this.div.append(t(this,Nt).render()),t(this,B)&&t(this,Nt).addAltTextButton(await t(this,B).render()),t(this,Nt))}removeEditToolbar(){var L;t(this,Nt)&&(t(this,Nt).remove(),P(this,Nt,null),(L=t(this,B))==null||L.destroy())}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){t(this,B)||(R.initialize(ut._l10nPromise),P(this,B,new R(this)),await this.addEditToolbar())}get altTextData(){var L;return(L=t(this,B))==null?void 0:L.data}set altTextData(L){t(this,B)&&(t(this,B).data=L)}hasAltText(){var L;return!((L=t(this,B))!=null&&L.isEmpty())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=t(this,D)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.div.addEventListener("focusin",t(this,Ft)),this.div.addEventListener("focusout",t(this,Ct));const[L,X]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*X/L).toFixed(2)}%`,this.div.style.maxHeight=`${(100*L/X).toFixed(2)}%`);const[nt,N]=this.getInitialTranslation();return this.translate(nt,N),(0,e.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(L){const{isMac:X}=w.FeatureTest.platform;if(L.button!==0||L.ctrlKey&&X){L.preventDefault();return}if(P(this,Tt,!0),this._isDraggable){S(this,m,La).call(this,L);return}S(this,a,nr).call(this,L)}moveInDOM(){t(this,kt)&&clearTimeout(t(this,kt)),P(this,kt,setTimeout(()=>{var L;P(this,kt,null),(L=this.parent)==null||L.moveEditorInDOM(this)},0))}_setParentAndPosition(L,X,nt){L.changeParent(this),this.x=X,this.y=nt,this.fixAndSetPosition()}getRect(L,X,nt=this.rotation){const N=this.parentScale,[f,z]=this.pageDimensions,[W,lt]=this.pageTranslation,ft=L/N,Mt=X/N,Dt=this.x*f,te=this.y*z,re=this.width*f,he=this.height*z;switch(nt){case 0:return[Dt+ft+W,z-te-Mt-he+lt,Dt+ft+re+W,z-te-Mt+lt];case 90:return[Dt+Mt+W,z-te+ft+lt,Dt+Mt+he+W,z-te+ft+re+lt];case 180:return[Dt-ft-re+W,z-te+Mt+lt,Dt-ft+W,z-te+Mt+he+lt];case 270:return[Dt-Mt-he+W,z-te-ft-re+lt,Dt-Mt+W,z-te-ft+lt];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(L,X){const[nt,N,f,z]=L,W=f-nt,lt=z-N;switch(this.rotation){case 0:return[nt,X-z,W,lt];case 90:return[nt,X-N,lt,W];case 180:return[f,X-N,W,lt];case 270:return[f,X-z,lt,W];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){P(this,Z,!0)}disableEditMode(){P(this,Z,!1)}isInEditMode(){return t(this,Z)}shouldGetKeyboardEvents(){return t(this,gt)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var L,X;(L=this.div)==null||L.addEventListener("focusin",t(this,Ft)),(X=this.div)==null||X.addEventListener("focusout",t(this,Ct))}rotate(L){}serialize(L=!1,X=null){(0,w.unreachable)("An editor must be serializable")}static deserialize(L,X,nt){const N=new this.prototype.constructor({parent:X,id:X.getNextId(),uiManager:nt});N.rotation=L.rotation;const[f,z]=N.pageDimensions,[W,lt,ft,Mt]=N.getRectInCurrentCoords(L.rect,z);return N.x=W/f,N.y=lt/z,N.width=ft/f,N.height=Mt/z,N}remove(){if(this.div.removeEventListener("focusin",t(this,Ft)),this.div.removeEventListener("focusout",t(this,Ct)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),t(this,kt)&&(clearTimeout(t(this,kt)),P(this,kt,null)),S(this,yt,Ci).call(this),this.removeEditToolbar(),t(this,Kt)){for(const L of t(this,Kt).values())clearTimeout(L);P(this,Kt,null)}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(S(this,ee,Ma).call(this),t(this,tt).classList.remove("hidden"),(0,e.bindEvents)(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(L){if(!this.isResizable||L.target!==this.div||L.key!=="Enter")return;this._uiManager.setSelected(this),P(this,vt,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const X=t(this,tt).children;if(!t(this,U)){P(this,U,Array.from(X));const z=S(this,u,Pa).bind(this),W=S(this,h,ka).bind(this);for(const lt of t(this,U)){const ft=lt.getAttribute("data-resizer-name");lt.setAttribute("role","spinbutton"),lt.addEventListener("keydown",z),lt.addEventListener("blur",W),lt.addEventListener("focus",S(this,V,Ra).bind(this,ft)),ut._l10nPromise.get(`pdfjs-editor-resizer-label-${ft}`).then(Mt=>lt.setAttribute("aria-label",Mt))}}const nt=t(this,U)[0];let N=0;for(const z of X){if(z===nt)break;N++}const f=(360-this.rotation+this.parentRotation)%360/90*(t(this,U).length/4);if(f!==N){if(f<N)for(let W=0;W<N-f;W++)t(this,tt).append(t(this,tt).firstChild);else if(f>N)for(let W=0;W<f-N;W++)t(this,tt).firstChild.before(t(this,tt).lastChild);let z=0;for(const W of X){const lt=t(this,U)[z++].getAttribute("data-resizer-name");ut._l10nPromise.get(`pdfjs-editor-resizer-label-${lt}`).then(ft=>W.setAttribute("aria-label",ft))}}S(this,rt,rr).call(this,0),P(this,gt,!0),t(this,tt).firstChild.focus({focusVisible:!0}),L.preventDefault(),L.stopImmediatePropagation()}_resizeWithKeyboard(L,X){t(this,gt)&&S(this,c,ir).call(this,t(this,_t),{movementX:L,movementY:X})}_stopResizingWithKeyboard(){S(this,yt,Ci).call(this),this.div.focus()}select(){var L,X;if(this.makeResizable(),(L=this.div)==null||L.classList.add("selectedEditor"),!t(this,Nt)){this.addEditToolbar().then(()=>{var nt,N;(nt=this.div)!=null&&nt.classList.contains("selectedEditor")&&((N=t(this,Nt))==null||N.show())});return}(X=t(this,Nt))==null||X.show()}unselect(){var L,X,nt,N;(L=t(this,tt))==null||L.classList.add("hidden"),(X=this.div)==null||X.classList.remove("selectedEditor"),(nt=this.div)!=null&&nt.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(N=t(this,Nt))==null||N.hide()}updateParams(L,X){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return t(this,Et)}set isEditing(L){P(this,Et,L),this.parent&&(L?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(L,X){P(this,q,!0);const nt=L/X,{style:N}=this.div;N.aspectRatio=nt,N.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(L,X=!1){if(X){t(this,Kt)||P(this,Kt,new Map);const{action:nt}=L;let N=t(this,Kt).get(nt);N&&clearTimeout(N),N=setTimeout(()=>{this._reportTelemetry(L),t(this,Kt).delete(nt),t(this,Kt).size===0&&P(this,Kt,null)},ut._telemetryTimeout),t(this,Kt).set(nt,N);return}L.type||(L.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:L}})}show(L=this._isVisible){this.div.classList.toggle("hidden",!L),this._isVisible=L}enable(){this.div&&(this.div.tabIndex=0),P(this,D,!1)}disable(){this.div&&(this.div.tabIndex=-1),P(this,D,!0)}};U=new WeakMap,B=new WeakMap,D=new WeakMap,q=new WeakMap,tt=new WeakMap,vt=new WeakMap,Ft=new WeakMap,Ct=new WeakMap,Nt=new WeakMap,_t=new WeakMap,Tt=new WeakMap,Pt=new WeakMap,Et=new WeakMap,Z=new WeakMap,gt=new WeakMap,kt=new WeakMap,Rt=new WeakMap,qt=new WeakMap,Kt=new WeakMap,ie=new WeakMap,Se=new WeakMap,de=new WeakSet,Zn=function([L,X],nt,N){[nt,N]=this.screenToPageTranslation(nt,N),this.x+=nt/L,this.y+=N/X,this.fixAndSetPosition()},ve=new WeakSet,tr=function(L,X,nt){switch(nt){case 90:return[X,-L];case 180:return[-L,-X];case 270:return[-X,L];default:return[L,X]}},ae=new WeakSet,er=function(L){switch(L){case 90:{const[X,nt]=this.pageDimensions;return[0,-X/nt,nt/X,0]}case 180:return[-1,0,0,-1];case 270:{const[X,nt]=this.pageDimensions;return[0,X/nt,-nt/X,0]}default:return[1,0,0,1]}},ee=new WeakSet,Ma=function(){if(t(this,tt))return;P(this,tt,document.createElement("div")),t(this,tt).classList.add("resizers");const L=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"];for(const X of L){const nt=document.createElement("div");t(this,tt).append(nt),nt.classList.add("resizer",X),nt.setAttribute("data-resizer-name",X),nt.addEventListener("pointerdown",S(this,ne,Ta).bind(this,X)),nt.addEventListener("contextmenu",v.noContextMenu),nt.tabIndex=-1}this.div.prepend(t(this,tt))},ne=new WeakSet,Ta=function(L,X){var he;X.preventDefault();const{isMac:nt}=w.FeatureTest.platform;if(X.button!==0||X.ctrlKey&&nt)return;(he=t(this,B))==null||he.toggle(!1);const N=S(this,c,ir).bind(this,L),f=this._isDraggable;this._isDraggable=!1;const z={passive:!0,capture:!0};this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",N,z);const W=this.x,lt=this.y,ft=this.width,Mt=this.height,Dt=this.parent.div.style.cursor,te=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(X.target).cursor;const re=()=>{var Me;this.parent.togglePointerEvents(!0),(Me=t(this,B))==null||Me.toggle(!0),this._isDraggable=f,window.removeEventListener("pointerup",re),window.removeEventListener("blur",re),window.removeEventListener("pointermove",N,z),this.parent.div.style.cursor=Dt,this.div.style.cursor=te,S(this,i,sr).call(this,W,lt,ft,Mt)};window.addEventListener("pointerup",re),window.addEventListener("blur",re)},i=new WeakSet,sr=function(L,X,nt,N){const f=this.x,z=this.y,W=this.width,lt=this.height;f===L&&z===X&&W===nt&&lt===N||this.addCommands({cmd:()=>{this.width=W,this.height=lt,this.x=f,this.y=z;const[ft,Mt]=this.parentDimensions;this.setDims(ft*W,Mt*lt),this.fixAndSetPosition()},undo:()=>{this.width=nt,this.height=N,this.x=L,this.y=X;const[ft,Mt]=this.parentDimensions;this.setDims(ft*nt,Mt*N),this.fixAndSetPosition()},mustExec:!0})},c=new WeakSet,ir=function(L,X){const[nt,N]=this.parentDimensions,f=this.x,z=this.y,W=this.width,lt=this.height,ft=ut.MIN_SIZE/nt,Mt=ut.MIN_SIZE/N,Dt=St=>Math.round(St*1e4)/1e4,te=S(this,ae,er).call(this,this.rotation),re=(St,Bt)=>[te[0]*St+te[2]*Bt,te[1]*St+te[3]*Bt],he=S(this,ae,er).call(this,360-this.rotation),Me=(St,Bt)=>[he[0]*St+he[2]*Bt,he[1]*St+he[3]*Bt];let _e,Fe,fe=!1,Pe=!1;switch(L){case"topLeft":fe=!0,_e=(St,Bt)=>[0,0],Fe=(St,Bt)=>[St,Bt];break;case"topMiddle":_e=(St,Bt)=>[St/2,0],Fe=(St,Bt)=>[St/2,Bt];break;case"topRight":fe=!0,_e=(St,Bt)=>[St,0],Fe=(St,Bt)=>[0,Bt];break;case"middleRight":Pe=!0,_e=(St,Bt)=>[St,Bt/2],Fe=(St,Bt)=>[0,Bt/2];break;case"bottomRight":fe=!0,_e=(St,Bt)=>[St,Bt],Fe=(St,Bt)=>[0,0];break;case"bottomMiddle":_e=(St,Bt)=>[St/2,Bt],Fe=(St,Bt)=>[St/2,0];break;case"bottomLeft":fe=!0,_e=(St,Bt)=>[0,Bt],Fe=(St,Bt)=>[St,0];break;case"middleLeft":Pe=!0,_e=(St,Bt)=>[0,Bt/2],Fe=(St,Bt)=>[St,Bt/2];break}const se=_e(W,lt),F=Fe(W,lt);let x=re(...F);const J=Dt(f+x[0]),it=Dt(z+x[1]);let ct=1,wt=1,[bt,zt]=this.screenToPageTranslation(X.movementX,X.movementY);if([bt,zt]=Me(bt/nt,zt/N),fe){const St=Math.hypot(W,lt);ct=wt=Math.max(Math.min(Math.hypot(F[0]-se[0]-bt,F[1]-se[1]-zt)/St,1/W,1/lt),ft/W,Mt/lt)}else Pe?ct=Math.max(ft,Math.min(1,Math.abs(F[0]-se[0]-bt)))/W:wt=Math.max(Mt,Math.min(1,Math.abs(F[1]-se[1]-zt)))/lt;const jt=Dt(W*ct),Ot=Dt(lt*wt);x=re(...Fe(jt,Ot));const Yt=J-x[0],Ut=it-x[1];this.width=jt,this.height=Ot,this.x=Yt,this.y=Ut,this.setDims(nt*jt,N*Ot),this.fixAndSetPosition()},a=new WeakSet,nr=function(L){const{isMac:X}=w.FeatureTest.platform;L.ctrlKey&&!X||L.shiftKey||L.metaKey&&X?this.parent.toggleSelected(this):this.parent.setSelected(this)},m=new WeakSet,La=function(L){const X=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let nt,N;X&&(this.div.classList.add("moving"),nt={passive:!0,capture:!0},P(this,Rt,L.clientX),P(this,qt,L.clientY),N=z=>{const{clientX:W,clientY:lt}=z,[ft,Mt]=this.screenToPageTranslation(W-t(this,Rt),lt-t(this,qt));P(this,Rt,W),P(this,qt,lt),this._uiManager.dragSelectedEditors(ft,Mt)},window.addEventListener("pointermove",N,nt));const f=()=>{window.removeEventListener("pointerup",f),window.removeEventListener("blur",f),X&&(this.div.classList.remove("moving"),window.removeEventListener("pointermove",N,nt)),P(this,Tt,!1),this._uiManager.endDragSession()||S(this,a,nr).call(this,L)};window.addEventListener("pointerup",f),window.addEventListener("blur",f)},u=new WeakSet,Pa=function(L){ut._resizerKeyboardManager.exec(this,L)},h=new WeakSet,ka=function(L){var X;t(this,gt)&&((X=L.relatedTarget)==null?void 0:X.parentNode)!==t(this,tt)&&S(this,yt,Ci).call(this)},V=new WeakSet,Ra=function(L){P(this,_t,t(this,gt)?L:"")},rt=new WeakSet,rr=function(L){if(t(this,U))for(const X of t(this,U))X.tabIndex=L},yt=new WeakSet,Ci=function(){if(P(this,gt,!1),S(this,rt,rr).call(this,-1),t(this,vt)){const{savedX:L,savedY:X,savedWidth:nt,savedHeight:N}=t(this,vt);S(this,i,sr).call(this,L,X,nt,N),P(this,vt,null)}},l(ut,ve),me(ut,"_borderLineWidth",-1),me(ut,"_colorManager",new e.ColorManager),me(ut,"_zIndex",1),me(ut,"_telemetryTimeout",1e3);let k=ut;class y extends k{constructor(L){super(L),this.annotationElementId=L.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},61:(o,b,d)=>{var y,g,G,I,Ia,H,ln,Y,Fa,Q,Da,U,ar,D,q,tt,vt,Ft,Ct,Nt,_t,Tt,Pt,Et,Z,gt,kt,Rt,qt,Kt,ie,Se,or,ve,Vt,ae,Ce,ee,Ee,ne,et,Mi,n,Ti,p,Oa;d.d(b,{FreeOutliner:()=>K,Outliner:()=>w});var e=d(292);class w{constructor(m,_=0,u=0,r=!0){l(this,I);l(this,H);l(this,Y);l(this,Q);l(this,U);l(this,y,void 0);l(this,g,[]);l(this,G,[]);let h=1/0,T=-1/0,V=1/0,j=-1/0;const rt=10**-4;for(const{x:X,y:nt,width:N,height:f}of m){const z=Math.floor((X-_)/rt)*rt,W=Math.ceil((X+N+_)/rt)*rt,lt=Math.floor((nt-_)/rt)*rt,ft=Math.ceil((nt+f+_)/rt)*rt,Mt=[z,lt,ft,!0],Dt=[W,lt,ft,!1];t(this,g).push(Mt,Dt),h=Math.min(h,z),T=Math.max(T,W),V=Math.min(V,lt),j=Math.max(j,ft)}const ot=T-h+2*u,yt=j-V+2*u,At=h-u,ut=V-u,xt=t(this,g).at(r?-1:-2),L=[xt[0],xt[2]];for(const X of t(this,g)){const[nt,N,f]=X;X[0]=(nt-At)/ot,X[1]=(N-ut)/yt,X[2]=(f-ut)/yt}P(this,y,{x:At,y:ut,width:ot,height:yt,lastPoint:L})}getOutlines(){t(this,g).sort((_,u)=>_[0]-u[0]||_[1]-u[1]||_[2]-u[2]);const m=[];for(const _ of t(this,g))_[3]?(m.push(...S(this,U,ar).call(this,_)),S(this,Y,Fa).call(this,_)):(S(this,Q,Da).call(this,_),m.push(...S(this,U,ar).call(this,_)));return S(this,I,Ia).call(this,m)}}y=new WeakMap,g=new WeakMap,G=new WeakMap,I=new WeakSet,Ia=function(m){const _=[],u=new Set;for(const T of m){const[V,j,rt]=T;_.push([V,j,T],[V,rt,T])}_.sort((T,V)=>T[1]-V[1]||T[0]-V[0]);for(let T=0,V=_.length;T<V;T+=2){const j=_[T][2],rt=_[T+1][2];j.push(rt),rt.push(j),u.add(j),u.add(rt)}const r=[];let h;for(;u.size>0;){const T=u.values().next().value;let[V,j,rt,ot,yt]=T;u.delete(T);let At=V,ut=j;for(h=[V,rt],r.push(h);;){let xt;if(u.has(ot))xt=ot;else if(u.has(yt))xt=yt;else break;u.delete(xt),[V,j,rt,ot,yt]=xt,At!==V&&(h.push(At,ut,V,ut===j?j:rt),At=V),ut=ut===j?rt:j}h.push(At,ut)}return new R(r,t(this,y))},H=new WeakSet,ln=function(m){const _=t(this,G);let u=0,r=_.length-1;for(;u<=r;){const h=u+r>>1,T=_[h][0];if(T===m)return h;T<m?u=h+1:r=h-1}return r+1},Y=new WeakSet,Fa=function([,m,_]){const u=S(this,H,ln).call(this,m);t(this,G).splice(u,0,[m,_])},Q=new WeakSet,Da=function([,m,_]){const u=S(this,H,ln).call(this,m);for(let r=u;r<t(this,G).length;r++){const[h,T]=t(this,G)[r];if(h!==m)break;if(h===m&&T===_){t(this,G).splice(r,1);return}}for(let r=u-1;r>=0;r--){const[h,T]=t(this,G)[r];if(h!==m)break;if(h===m&&T===_){t(this,G).splice(r,1);return}}},U=new WeakSet,ar=function(m){const[_,u,r]=m,h=[[_,u,r]],T=S(this,H,ln).call(this,r);for(let V=0;V<T;V++){const[j,rt]=t(this,G)[V];for(let ot=0,yt=h.length;ot<yt;ot++){const[,At,ut]=h[ot];if(!(rt<=At||ut<=j)){if(At>=j){if(ut>rt)h[ot][1]=rt;else{if(yt===1)return[];h.splice(ot,1),ot--,yt--}continue}h[ot][2]=j,ut>rt&&h.push([_,rt,ut])}}}return h};class v{toSVGPath(){throw new Error("Abstract method `toSVGPath` must be implemented.")}get box(){throw new Error("Abstract getter `box` must be implemented.")}serialize(m,_){throw new Error("Abstract method `serialize` must be implemented.")}get free(){return this instanceof k}}class R extends v{constructor(_,u){super();l(this,D,void 0);l(this,q,void 0);P(this,q,_),P(this,D,u)}toSVGPath(){const _=[];for(const u of t(this,q)){let[r,h]=u;_.push(`M${r} ${h}`);for(let T=2;T<u.length;T+=2){const V=u[T],j=u[T+1];V===r?(_.push(`V${j}`),h=j):j===h&&(_.push(`H${V}`),r=V)}_.push("Z")}return _.join(" ")}serialize([_,u,r,h],T){const V=[],j=r-_,rt=h-u;for(const ot of t(this,q)){const yt=new Array(ot.length);for(let At=0;At<ot.length;At+=2)yt[At]=_+ot[At]*j,yt[At+1]=h-ot[At+1]*rt;V.push(yt)}return V}get box(){return t(this,D)}}D=new WeakMap,q=new WeakMap;const le=class le{constructor({x:m,y:_},u,r,h,T,V=0){l(this,Se);l(this,tt,void 0);l(this,vt,[]);l(this,Ft,void 0);l(this,Ct,void 0);l(this,Nt,[]);l(this,_t,new Float64Array(18));l(this,Tt,void 0);l(this,Pt,void 0);l(this,Et,void 0);l(this,Z,void 0);l(this,gt,void 0);l(this,kt,void 0);l(this,Rt,[]);P(this,tt,u),P(this,kt,h*r),P(this,Ct,T),t(this,_t).set([NaN,NaN,NaN,NaN,m,_],6),P(this,Ft,V),P(this,Z,t(le,qt)*r),P(this,Et,t(le,ie)*r),P(this,gt,r),t(this,Rt).push(m,_)}get free(){return!0}isEmpty(){return isNaN(t(this,_t)[8])}add({x:m,y:_}){var Mt;P(this,Tt,m),P(this,Pt,_);const[u,r,h,T]=t(this,tt);let[V,j,rt,ot]=t(this,_t).subarray(8,12);const yt=m-rt,At=_-ot,ut=Math.hypot(yt,At);if(ut<t(this,Et))return!1;const xt=ut-t(this,Z),L=xt/ut,X=L*yt,nt=L*At;let N=V,f=j;V=rt,j=ot,rt+=X,ot+=nt,(Mt=t(this,Rt))==null||Mt.push(m,_);const z=-nt/xt,W=X/xt,lt=z*t(this,kt),ft=W*t(this,kt);return t(this,_t).set(t(this,_t).subarray(2,8),0),t(this,_t).set([rt+lt,ot+ft],4),t(this,_t).set(t(this,_t).subarray(14,18),12),t(this,_t).set([rt-lt,ot-ft],16),isNaN(t(this,_t)[6])?(t(this,Nt).length===0&&(t(this,_t).set([V+lt,j+ft],2),t(this,Nt).push(NaN,NaN,NaN,NaN,(V+lt-u)/h,(j+ft-r)/T),t(this,_t).set([V-lt,j-ft],14),t(this,vt).push(NaN,NaN,NaN,NaN,(V-lt-u)/h,(j-ft-r)/T)),t(this,_t).set([N,f,V,j,rt,ot],6),!this.isEmpty()):(t(this,_t).set([N,f,V,j,rt,ot],6),Math.abs(Math.atan2(f-j,N-V)-Math.atan2(nt,X))<Math.PI/2?([V,j,rt,ot]=t(this,_t).subarray(2,6),t(this,Nt).push(NaN,NaN,NaN,NaN,((V+rt)/2-u)/h,((j+ot)/2-r)/T),[V,j,N,f]=t(this,_t).subarray(14,18),t(this,vt).push(NaN,NaN,NaN,NaN,((N+V)/2-u)/h,((f+j)/2-r)/T),!0):([N,f,V,j,rt,ot]=t(this,_t).subarray(0,6),t(this,Nt).push(((N+5*V)/6-u)/h,((f+5*j)/6-r)/T,((5*V+rt)/6-u)/h,((5*j+ot)/6-r)/T,((V+rt)/2-u)/h,((j+ot)/2-r)/T),[rt,ot,V,j,N,f]=t(this,_t).subarray(12,18),t(this,vt).push(((N+5*V)/6-u)/h,((f+5*j)/6-r)/T,((5*V+rt)/6-u)/h,((5*j+ot)/6-r)/T,((V+rt)/2-u)/h,((j+ot)/2-r)/T),!0))}toSVGPath(){if(this.isEmpty())return"";const m=t(this,Nt),_=t(this,vt),u=t(this,_t).subarray(4,6),r=t(this,_t).subarray(16,18),[h,T,V,j]=t(this,tt),[rt,ot,yt,At]=S(this,Se,or).call(this);if(isNaN(t(this,_t)[6])&&!this.isEmpty())return`M${(t(this,_t)[2]-h)/V} ${(t(this,_t)[3]-T)/j} L${(t(this,_t)[4]-h)/V} ${(t(this,_t)[5]-T)/j} L${rt} ${ot} L${yt} ${At} L${(t(this,_t)[16]-h)/V} ${(t(this,_t)[17]-T)/j} L${(t(this,_t)[14]-h)/V} ${(t(this,_t)[15]-T)/j} Z`;const ut=[];ut.push(`M${m[4]} ${m[5]}`);for(let xt=6;xt<m.length;xt+=6)isNaN(m[xt])?ut.push(`L${m[xt+4]} ${m[xt+5]}`):ut.push(`C${m[xt]} ${m[xt+1]} ${m[xt+2]} ${m[xt+3]} ${m[xt+4]} ${m[xt+5]}`);ut.push(`L${(u[0]-h)/V} ${(u[1]-T)/j} L${rt} ${ot} L${yt} ${At} L${(r[0]-h)/V} ${(r[1]-T)/j}`);for(let xt=_.length-6;xt>=6;xt-=6)isNaN(_[xt])?ut.push(`L${_[xt+4]} ${_[xt+5]}`):ut.push(`C${_[xt]} ${_[xt+1]} ${_[xt+2]} ${_[xt+3]} ${_[xt+4]} ${_[xt+5]}`);return ut.push(`L${_[4]} ${_[5]} Z`),ut.join(" ")}getOutlines(){var nt;const m=t(this,Nt),_=t(this,vt),u=t(this,_t),r=u.subarray(4,6),h=u.subarray(16,18),[T,V,j,rt]=t(this,tt),ot=new Float64Array((((nt=t(this,Rt))==null?void 0:nt.length)??0)+2);for(let N=0,f=ot.length-2;N<f;N+=2)ot[N]=(t(this,Rt)[N]-T)/j,ot[N+1]=(t(this,Rt)[N+1]-V)/rt;ot[ot.length-2]=(t(this,Tt)-T)/j,ot[ot.length-1]=(t(this,Pt)-V)/rt;const[yt,At,ut,xt]=S(this,Se,or).call(this);if(isNaN(u[6])&&!this.isEmpty()){const N=new Float64Array(36);return N.set([NaN,NaN,NaN,NaN,(u[2]-T)/j,(u[3]-V)/rt,NaN,NaN,NaN,NaN,(u[4]-T)/j,(u[5]-V)/rt,NaN,NaN,NaN,NaN,yt,At,NaN,NaN,NaN,NaN,ut,xt,NaN,NaN,NaN,NaN,(u[16]-T)/j,(u[17]-V)/rt,NaN,NaN,NaN,NaN,(u[14]-T)/j,(u[15]-V)/rt],0),new k(N,ot,t(this,tt),t(this,gt),t(this,Ft),t(this,Ct))}const L=new Float64Array(t(this,Nt).length+24+t(this,vt).length);let X=m.length;for(let N=0;N<X;N+=2){if(isNaN(m[N])){L[N]=L[N+1]=NaN;continue}L[N]=m[N],L[N+1]=m[N+1]}L.set([NaN,NaN,NaN,NaN,(r[0]-T)/j,(r[1]-V)/rt,NaN,NaN,NaN,NaN,yt,At,NaN,NaN,NaN,NaN,ut,xt,NaN,NaN,NaN,NaN,(h[0]-T)/j,(h[1]-V)/rt],X),X+=24;for(let N=_.length-6;N>=6;N-=6)for(let f=0;f<6;f+=2){if(isNaN(_[N+f])){L[X]=L[X+1]=NaN,X+=2;continue}L[X]=_[N+f],L[X+1]=_[N+f+1],X+=2}return L.set([NaN,NaN,NaN,NaN,_[4],_[5]],X),new k(L,ot,t(this,tt),t(this,gt),t(this,Ft),t(this,Ct))}};tt=new WeakMap,vt=new WeakMap,Ft=new WeakMap,Ct=new WeakMap,Nt=new WeakMap,_t=new WeakMap,Tt=new WeakMap,Pt=new WeakMap,Et=new WeakMap,Z=new WeakMap,gt=new WeakMap,kt=new WeakMap,Rt=new WeakMap,qt=new WeakMap,Kt=new WeakMap,ie=new WeakMap,Se=new WeakSet,or=function(){const m=t(this,_t).subarray(4,6),_=t(this,_t).subarray(16,18),[u,r,h,T]=t(this,tt);return[(t(this,Tt)+(m[0]-_[0])/2-u)/h,(t(this,Pt)+(m[1]-_[1])/2-r)/T,(t(this,Tt)+(_[0]-m[0])/2-u)/h,(t(this,Pt)+(_[1]-m[1])/2-r)/T]},l(le,qt,8),l(le,Kt,2),l(le,ie,t(le,qt)+t(le,Kt));let K=le;class k extends v{constructor(_,u,r,h,T,V){super();l(this,et);l(this,n);l(this,p);l(this,ve,void 0);l(this,Vt,null);l(this,ae,void 0);l(this,Ce,void 0);l(this,ee,void 0);l(this,Ee,void 0);l(this,ne,void 0);P(this,ne,_),P(this,ee,u),P(this,ve,r),P(this,Ee,h),P(this,ae,T),P(this,Ce,V),S(this,p,Oa).call(this,V);const{x:j,y:rt,width:ot,height:yt}=t(this,Vt);for(let At=0,ut=_.length;At<ut;At+=2)_[At]=(_[At]-j)/ot,_[At+1]=(_[At+1]-rt)/yt;for(let At=0,ut=u.length;At<ut;At+=2)u[At]=(u[At]-j)/ot,u[At+1]=(u[At+1]-rt)/yt}toSVGPath(){const _=[`M${t(this,ne)[4]} ${t(this,ne)[5]}`];for(let u=6,r=t(this,ne).length;u<r;u+=6){if(isNaN(t(this,ne)[u])){_.push(`L${t(this,ne)[u+4]} ${t(this,ne)[u+5]}`);continue}_.push(`C${t(this,ne)[u]} ${t(this,ne)[u+1]} ${t(this,ne)[u+2]} ${t(this,ne)[u+3]} ${t(this,ne)[u+4]} ${t(this,ne)[u+5]}`)}return _.push("Z"),_.join(" ")}serialize([_,u,r,h],T){const V=r-_,j=h-u;let rt,ot;switch(T){case 0:rt=S(this,et,Mi).call(this,t(this,ne),_,h,V,-j),ot=S(this,et,Mi).call(this,t(this,ee),_,h,V,-j);break;case 90:rt=S(this,n,Ti).call(this,t(this,ne),_,u,V,j),ot=S(this,n,Ti).call(this,t(this,ee),_,u,V,j);break;case 180:rt=S(this,et,Mi).call(this,t(this,ne),r,u,-V,j),ot=S(this,et,Mi).call(this,t(this,ee),r,u,-V,j);break;case 270:rt=S(this,n,Ti).call(this,t(this,ne),r,h,-V,-j),ot=S(this,n,Ti).call(this,t(this,ee),r,h,-V,-j);break}return{outline:Array.from(rt),points:[Array.from(ot)]}}get box(){return t(this,Vt)}getNewOutline(_,u){const{x:r,y:h,width:T,height:V}=t(this,Vt),[j,rt,ot,yt]=t(this,ve),At=T*ot,ut=V*yt,xt=r*ot+j,L=h*yt+rt,X=new K({x:t(this,ee)[0]*At+xt,y:t(this,ee)[1]*ut+L},t(this,ve),t(this,Ee),_,t(this,Ce),u??t(this,ae));for(let nt=2;nt<t(this,ee).length;nt+=2)X.add({x:t(this,ee)[nt]*At+xt,y:t(this,ee)[nt+1]*ut+L});return X.getOutlines()}}ve=new WeakMap,Vt=new WeakMap,ae=new WeakMap,Ce=new WeakMap,ee=new WeakMap,Ee=new WeakMap,ne=new WeakMap,et=new WeakSet,Mi=function(_,u,r,h,T){const V=new Float64Array(_.length);for(let j=0,rt=_.length;j<rt;j+=2)V[j]=u+_[j]*h,V[j+1]=r+_[j+1]*T;return V},n=new WeakSet,Ti=function(_,u,r,h,T){const V=new Float64Array(_.length);for(let j=0,rt=_.length;j<rt;j+=2)V[j]=u+_[j+1]*h,V[j+1]=r+_[j]*T;return V},p=new WeakSet,Oa=function(_){const u=t(this,ne);let r=u[4],h=u[5],T=r,V=h,j=r,rt=h,ot=r,yt=h;const At=_?Math.max:Math.min;for(let nt=6,N=u.length;nt<N;nt+=6){if(isNaN(u[nt]))T=Math.min(T,u[nt+4]),V=Math.min(V,u[nt+5]),j=Math.max(j,u[nt+4]),rt=Math.max(rt,u[nt+5]),yt<u[nt+5]?(ot=u[nt+4],yt=u[nt+5]):yt===u[nt+5]&&(ot=At(ot,u[nt+4]));else{const f=e.Util.bezierBoundingBox(r,h,...u.slice(nt,nt+6));T=Math.min(T,f[0]),V=Math.min(V,f[1]),j=Math.max(j,f[2]),rt=Math.max(rt,f[3]),yt<f[3]?(ot=f[2],yt=f[3]):yt===f[3]&&(ot=At(ot,f[2]))}r=u[nt+4],h=u[nt+5]}const ut=T-t(this,ae),xt=V-t(this,ae),L=j-T+2*t(this,ae),X=rt-V+2*t(this,ae);P(this,Vt,{x:ut,y:xt,width:L,height:X,lastPoint:[ot,yt]})}},362:(o,b,d)=>{var R,K,k,y,g,Na,I,Ha,H,Ba,Y,cn,Q,$a,U,hr,q,tt,vt,Ft,Ua,Nt,Va,Tt,ja;d.d(b,{EditorToolbar:()=>w,HighlightToolbar:()=>v});var e=d(419);const D=class D{constructor(Z){l(this,I);l(this,H);l(this,Y);l(this,Q);l(this,U);l(this,R,null);l(this,K,null);l(this,k,void 0);l(this,y,null);P(this,k,Z)}render(){const Z=P(this,R,document.createElement("div"));Z.className="editToolbar",Z.setAttribute("role","toolbar"),Z.addEventListener("contextmenu",e.noContextMenu),Z.addEventListener("pointerdown",S(D,g,Na));const gt=P(this,y,document.createElement("div"));gt.className="buttons",Z.append(gt);const kt=t(this,k).toolbarPosition;if(kt){const{style:Rt}=Z,qt=t(this,k)._uiManager.direction==="ltr"?1-kt[0]:kt[0];Rt.insetInlineEnd=`${100*qt}%`,Rt.top=`calc(${100*kt[1]}% + var(--editor-toolbar-vert-offset))`}return S(this,Q,$a).call(this),Z}hide(){var Z;t(this,R).classList.add("hidden"),(Z=t(this,K))==null||Z.hideDropdown()}show(){t(this,R).classList.remove("hidden")}addAltTextButton(Z){S(this,Y,cn).call(this,Z),t(this,y).prepend(Z,t(this,U,hr))}addColorPicker(Z){P(this,K,Z);const gt=Z.renderButton();S(this,Y,cn).call(this,gt),t(this,y).prepend(gt,t(this,U,hr))}remove(){var Z;t(this,R).remove(),(Z=t(this,K))==null||Z.destroy(),P(this,K,null)}};R=new WeakMap,K=new WeakMap,k=new WeakMap,y=new WeakMap,g=new WeakSet,Na=function(Z){Z.stopPropagation()},I=new WeakSet,Ha=function(Z){t(this,k)._focusEventsAllowed=!1,Z.preventDefault(),Z.stopPropagation()},H=new WeakSet,Ba=function(Z){t(this,k)._focusEventsAllowed=!0,Z.preventDefault(),Z.stopPropagation()},Y=new WeakSet,cn=function(Z){Z.addEventListener("focusin",S(this,I,Ha).bind(this),{capture:!0}),Z.addEventListener("focusout",S(this,H,Ba).bind(this),{capture:!0}),Z.addEventListener("contextmenu",e.noContextMenu)},Q=new WeakSet,$a=function(){const Z=document.createElement("button");Z.className="delete",Z.tabIndex=0,Z.setAttribute("data-l10n-id",`pdfjs-editor-remove-${t(this,k).editorType}-button`),S(this,Y,cn).call(this,Z),Z.addEventListener("click",gt=>{t(this,k)._uiManager.delete()}),t(this,y).append(Z)},U=new WeakSet,hr=function(){const Z=document.createElement("div");return Z.className="divider",Z},l(D,g);let w=D;class v{constructor(Z){l(this,Ft);l(this,Nt);l(this,Tt);l(this,q,null);l(this,tt,null);l(this,vt,void 0);P(this,vt,Z)}show(Z,gt,kt){const[Rt,qt]=S(this,Nt,Va).call(this,gt,kt),{style:Kt}=t(this,tt)||P(this,tt,S(this,Ft,Ua).call(this));Z.append(t(this,tt)),Kt.insetInlineEnd=`${100*Rt}%`,Kt.top=`calc(${100*qt}% + var(--editor-toolbar-vert-offset))`}hide(){t(this,tt).remove()}}q=new WeakMap,tt=new WeakMap,vt=new WeakMap,Ft=new WeakSet,Ua=function(){const Z=P(this,tt,document.createElement("div"));Z.className="editToolbar",Z.setAttribute("role","toolbar"),Z.addEventListener("contextmenu",e.noContextMenu);const gt=P(this,q,document.createElement("div"));return gt.className="buttons",Z.append(gt),S(this,Tt,ja).call(this),Z},Nt=new WeakSet,Va=function(Z,gt){let kt=0,Rt=0;for(const qt of Z){const Kt=qt.y+qt.height;if(Kt<kt)continue;const ie=qt.x+(gt?qt.width:0);if(Kt>kt){Rt=ie,kt=Kt;continue}gt?ie>Rt&&(Rt=ie):ie<Rt&&(Rt=ie)}return[gt?1-Rt:Rt,kt]},Tt=new WeakSet,ja=function(){const Z=document.createElement("button");Z.className="highlightButton",Z.tabIndex=0,Z.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const gt=document.createElement("span");Z.append(gt),gt.className="visuallyHidden",gt.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label"),Z.addEventListener("contextmenu",e.noContextMenu),Z.addEventListener("click",()=>{t(this,vt).highlightSelection("floating_button")}),t(this,q).append(Z)}},830:(o,b,d)=>{var H,$,Y,at,Q,lr,B,D,q,tt,vt,Ga,Nt,_t,Tt,Pt,Et,Z,gt,kt,Rt,qt,Kt,ie,Se,de,le,ve,Vt,ae,Ce,ee,Ee,ne,et,i,n,c,p,a,A,m,_,u,r,h,T,V,j,rt,ot,yt,At,ut,xt,L,X,nt,dn,f,qa,W,za,ft,un,Dt,Wa,re,Xa,Me,Ka,Fe,cr,Pe,dr,F,ur,J,pr,ct,gr,bt,Je,jt,Ss,Yt,Ya,St,Ja,Qt,fr,ce,Qa,Te,Li,We,mr;d.d(b,{AnnotationEditorUIManager:()=>E,ColorManager:()=>I,KeyboardManager:()=>G,bindEvents:()=>R,opacityToHex:()=>K});var e=d(292),w=d(419),v=d(362);function R(Ve,O,dt){for(const Ht of dt)O.addEventListener(Ht,Ve[Ht].bind(Ve))}function K(Ve){return Math.round(Math.min(255,Math.max(1,255*Ve))).toString(16).padStart(2,"0")}class k{constructor(){l(this,H,0)}get id(){return`${e.AnnotationEditorPrefix}${vs(this,H)._++}`}}H=new WeakMap;const U=class U{constructor(){l(this,Q);l(this,$,(0,e.getUuid)());l(this,Y,0);l(this,at,null)}static get _isSVGFittingCanvas(){const O='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',dt=new OffscreenCanvas(1,3).getContext("2d"),Ht=new Image;Ht.src=O;const $t=Ht.decode().then(()=>(dt.drawImage(Ht,0,0,1,1,0,0,1,3),new Uint32Array(dt.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,e.shadow)(this,"_isSVGFittingCanvas",$t)}async getFromFile(O){const{lastModified:dt,name:Ht,size:$t,type:Jt}=O;return S(this,Q,lr).call(this,`${dt}_${Ht}_${$t}_${Jt}`,O)}async getFromUrl(O){return S(this,Q,lr).call(this,O,O)}async getFromId(O){t(this,at)||P(this,at,new Map);const dt=t(this,at).get(O);return dt?dt.bitmap?(dt.refCounter+=1,dt):dt.file?this.getFromFile(dt.file):this.getFromUrl(dt.url):null}getSvgUrl(O){const dt=t(this,at).get(O);return dt!=null&&dt.isSvg?dt.svgUrl:null}deleteId(O){t(this,at)||P(this,at,new Map);const dt=t(this,at).get(O);dt&&(dt.refCounter-=1,dt.refCounter===0&&(dt.bitmap=null))}isValidId(O){return O.startsWith(`image_${t(this,$)}_`)}};$=new WeakMap,Y=new WeakMap,at=new WeakMap,Q=new WeakSet,lr=async function(O,dt){t(this,at)||P(this,at,new Map);let Ht=t(this,at).get(O);if(Ht===null)return null;if(Ht!=null&&Ht.bitmap)return Ht.refCounter+=1,Ht;try{Ht||(Ht={bitmap:null,id:`image_${t(this,$)}_${vs(this,Y)._++}`,refCounter:0,isSvg:!1});let $t;if(typeof dt=="string"?(Ht.url=dt,$t=await(0,w.fetchData)(dt,"blob")):$t=Ht.file=dt,$t.type==="image/svg+xml"){const Jt=U._isSVGFittingCanvas,Zt=new FileReader,oe=new Image,be=new Promise((ke,He)=>{oe.onload=()=>{Ht.bitmap=oe,Ht.isSvg=!0,ke()},Zt.onload=async()=>{const Ke=Ht.svgUrl=Zt.result;oe.src=await Jt?`${Ke}#svgView(preserveAspectRatio(none))`:Ke},oe.onerror=Zt.onerror=He});Zt.readAsDataURL($t),await be}else Ht.bitmap=await createImageBitmap($t);Ht.refCounter=1}catch($t){console.error($t),Ht=null}return t(this,at).set(O,Ht),Ht&&t(this,at).set(Ht.id,Ht),Ht};let y=U;class g{constructor(O=128){l(this,B,[]);l(this,D,!1);l(this,q,void 0);l(this,tt,-1);P(this,q,O)}add({cmd:O,undo:dt,post:Ht,mustExec:$t,type:Jt=NaN,overwriteIfSameType:Zt=!1,keepUndo:oe=!1}){if($t&&O(),t(this,D))return;const be={cmd:O,undo:dt,post:Ht,type:Jt};if(t(this,tt)===-1){t(this,B).length>0&&(t(this,B).length=0),P(this,tt,0),t(this,B).push(be);return}if(Zt&&t(this,B)[t(this,tt)].type===Jt){oe&&(be.undo=t(this,B)[t(this,tt)].undo),t(this,B)[t(this,tt)]=be;return}const ke=t(this,tt)+1;ke===t(this,q)?t(this,B).splice(0,1):(P(this,tt,ke),ke<t(this,B).length&&t(this,B).splice(ke)),t(this,B).push(be)}undo(){if(t(this,tt)===-1)return;P(this,D,!0);const{undo:O,post:dt}=t(this,B)[t(this,tt)];O(),dt==null||dt(),P(this,D,!1),P(this,tt,t(this,tt)-1)}redo(){if(t(this,tt)<t(this,B).length-1){P(this,tt,t(this,tt)+1),P(this,D,!0);const{cmd:O,post:dt}=t(this,B)[t(this,tt)];O(),dt==null||dt(),P(this,D,!1)}}hasSomethingToUndo(){return t(this,tt)!==-1}hasSomethingToRedo(){return t(this,tt)<t(this,B).length-1}destroy(){P(this,B,null)}}B=new WeakMap,D=new WeakMap,q=new WeakMap,tt=new WeakMap;class G{constructor(O){l(this,vt);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:dt}=e.FeatureTest.platform;for(const[Ht,$t,Jt={}]of O)for(const Zt of Ht){const oe=Zt.startsWith("mac+");dt&&oe?(this.callbacks.set(Zt.slice(4),{callback:$t,options:Jt}),this.allKeys.add(Zt.split("+").at(-1))):!dt&&!oe&&(this.callbacks.set(Zt,{callback:$t,options:Jt}),this.allKeys.add(Zt.split("+").at(-1)))}}exec(O,dt){if(!this.allKeys.has(dt.key))return;const Ht=this.callbacks.get(S(this,vt,Ga).call(this,dt));if(!Ht)return;const{callback:$t,options:{bubbles:Jt=!1,args:Zt=[],checker:oe=null}}=Ht;oe&&!oe(O,dt)||($t.bind(O,...Zt,dt)(),Jt||(dt.stopPropagation(),dt.preventDefault()))}}vt=new WeakSet,Ga=function(O){O.altKey&&this.buffer.push("alt"),O.ctrlKey&&this.buffer.push("ctrl"),O.metaKey&&this.buffer.push("meta"),O.shiftKey&&this.buffer.push("shift"),this.buffer.push(O.key);const dt=this.buffer.join("+");return this.buffer.length=0,dt};const Ct=class Ct{get _colors(){const O=new Map([["CanvasText",null],["Canvas",null]]);return(0,w.getColorValues)(O),(0,e.shadow)(this,"_colors",O)}convert(O){const dt=(0,w.getRGB)(O);if(!window.matchMedia("(forced-colors: active)").matches)return dt;for(const[Ht,$t]of this._colors)if($t.every((Jt,Zt)=>Jt===dt[Zt]))return Ct._colorsMapping.get(Ht);return dt}getHexCode(O){const dt=this._colors.get(O);return dt?e.Util.makeHexColor(...dt):O}};me(Ct,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let I=Ct;const ns=class ns{constructor(O,dt,Ht,$t,Jt,Zt,oe,be,ke){l(this,nt);l(this,f);l(this,W);l(this,ft);l(this,Dt);l(this,re);l(this,Me);l(this,Fe);l(this,Pe);l(this,F);l(this,J);l(this,ct);l(this,bt);l(this,jt);l(this,Yt);l(this,St);l(this,Qt);l(this,ce);l(this,Te);l(this,We);l(this,Nt,null);l(this,_t,new Map);l(this,Tt,new Map);l(this,Pt,null);l(this,Et,null);l(this,Z,new g);l(this,gt,0);l(this,kt,new Set);l(this,Rt,null);l(this,qt,null);l(this,Kt,new Set);l(this,ie,!1);l(this,Se,null);l(this,de,null);l(this,le,null);l(this,ve,!1);l(this,Vt,null);l(this,ae,new k);l(this,Ce,!1);l(this,ee,!1);l(this,Ee,null);l(this,ne,null);l(this,et,null);l(this,i,e.AnnotationEditorType.NONE);l(this,n,new Set);l(this,c,null);l(this,p,null);l(this,a,null);l(this,A,this.blur.bind(this));l(this,m,this.focus.bind(this));l(this,_,this.copy.bind(this));l(this,u,this.cut.bind(this));l(this,r,this.paste.bind(this));l(this,h,this.keydown.bind(this));l(this,T,this.keyup.bind(this));l(this,V,this.onEditingAction.bind(this));l(this,j,this.onPageChanging.bind(this));l(this,rt,this.onScaleChanging.bind(this));l(this,ot,S(this,W,za).bind(this));l(this,yt,this.onRotationChanging.bind(this));l(this,At,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});l(this,ut,[0,0]);l(this,xt,null);l(this,L,null);l(this,X,null);P(this,L,O),P(this,X,dt),P(this,Pt,Ht),this._eventBus=$t,this._eventBus._on("editingaction",t(this,V)),this._eventBus._on("pagechanging",t(this,j)),this._eventBus._on("scalechanging",t(this,rt)),this._eventBus._on("rotationchanging",t(this,yt)),S(this,Dt,Wa).call(this),S(this,Pe,dr).call(this),P(this,Et,Jt.annotationStorage),P(this,Se,Jt.filterFactory),P(this,p,Zt),P(this,le,oe||null),P(this,ie,be),P(this,et,ke||null),this.viewParameters={realScale:w.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}static get _keyboardManager(){const O=ns.prototype,dt=Zt=>t(Zt,L).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&Zt.hasSomethingToControl(),Ht=(Zt,{target:oe})=>{if(oe instanceof HTMLInputElement){const{type:be}=oe;return be!=="text"&&be!=="number"}return!0},$t=this.TRANSLATE_SMALL,Jt=this.TRANSLATE_BIG;return(0,e.shadow)(this,"_keyboardManager",new G([[["ctrl+a","mac+meta+a"],O.selectAll,{checker:Ht}],[["ctrl+z","mac+meta+z"],O.undo,{checker:Ht}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],O.redo,{checker:Ht}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],O.delete,{checker:Ht}],[["Enter","mac+Enter"],O.addNewEditorFromKeyboard,{checker:(Zt,{target:oe})=>!(oe instanceof HTMLButtonElement)&&t(Zt,L).contains(oe)&&!Zt.isEnterHandled}],[[" ","mac+ "],O.addNewEditorFromKeyboard,{checker:(Zt,{target:oe})=>!(oe instanceof HTMLButtonElement)&&t(Zt,L).contains(document.activeElement)}],[["Escape","mac+Escape"],O.unselectAll],[["ArrowLeft","mac+ArrowLeft"],O.translateSelectedEditors,{args:[-$t,0],checker:dt}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],O.translateSelectedEditors,{args:[-Jt,0],checker:dt}],[["ArrowRight","mac+ArrowRight"],O.translateSelectedEditors,{args:[$t,0],checker:dt}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],O.translateSelectedEditors,{args:[Jt,0],checker:dt}],[["ArrowUp","mac+ArrowUp"],O.translateSelectedEditors,{args:[0,-$t],checker:dt}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],O.translateSelectedEditors,{args:[0,-Jt],checker:dt}],[["ArrowDown","mac+ArrowDown"],O.translateSelectedEditors,{args:[0,$t],checker:dt}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],O.translateSelectedEditors,{args:[0,Jt],checker:dt}]]))}destroy(){var O,dt;S(this,F,ur).call(this),S(this,Fe,cr).call(this),this._eventBus._off("editingaction",t(this,V)),this._eventBus._off("pagechanging",t(this,j)),this._eventBus._off("scalechanging",t(this,rt)),this._eventBus._off("rotationchanging",t(this,yt));for(const Ht of t(this,Tt).values())Ht.destroy();t(this,Tt).clear(),t(this,_t).clear(),t(this,Kt).clear(),P(this,Nt,null),t(this,n).clear(),t(this,Z).destroy(),(O=t(this,Pt))==null||O.destroy(),(dt=t(this,Vt))==null||dt.hide(),P(this,Vt,null),t(this,de)&&(clearTimeout(t(this,de)),P(this,de,null)),t(this,xt)&&(clearTimeout(t(this,xt)),P(this,xt,null)),S(this,re,Xa).call(this)}async mlGuess(O){var dt;return((dt=t(this,et))==null?void 0:dt.guess(O))||null}get hasMLManager(){return!!t(this,et)}get hcmFilter(){return(0,e.shadow)(this,"hcmFilter",t(this,p)?t(this,Se).addHCMFilter(t(this,p).foreground,t(this,p).background):"none")}get direction(){return(0,e.shadow)(this,"direction",getComputedStyle(t(this,L)).direction)}get highlightColors(){return(0,e.shadow)(this,"highlightColors",t(this,le)?new Map(t(this,le).split(",").map(O=>O.split("=").map(dt=>dt.trim()))):null)}get highlightColorNames(){return(0,e.shadow)(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,O=>O.reverse())):null)}setMainHighlightColorPicker(O){P(this,ne,O)}editAltText(O){var dt;(dt=t(this,Pt))==null||dt.editAltText(this,O)}onPageChanging({pageNumber:O}){P(this,gt,O-1)}focusMainContainer(){t(this,L).focus()}findParent(O,dt){for(const Ht of t(this,Tt).values()){const{x:$t,y:Jt,width:Zt,height:oe}=Ht.div.getBoundingClientRect();if(O>=$t&&O<=$t+Zt&&dt>=Jt&&dt<=Jt+oe)return Ht}return null}disableUserSelect(O=!1){t(this,X).classList.toggle("noUserSelect",O)}addShouldRescale(O){t(this,Kt).add(O)}removeShouldRescale(O){t(this,Kt).delete(O)}onScaleChanging({scale:O}){this.commitOrRemove(),this.viewParameters.realScale=O*w.PixelsPerInch.PDF_TO_CSS_UNITS;for(const dt of t(this,Kt))dt.onScaleChanging()}onRotationChanging({pagesRotation:O}){this.commitOrRemove(),this.viewParameters.rotation=O}highlightSelection(O=""){const dt=document.getSelection();if(!dt||dt.isCollapsed)return;const{anchorNode:Ht,anchorOffset:$t,focusNode:Jt,focusOffset:Zt}=dt,oe=dt.toString(),be=S(this,nt,dn).call(this,dt).closest(".textLayer"),ke=this.getSelectionBoxes(be);if(ke){dt.empty(),t(this,i)===e.AnnotationEditorType.NONE&&(this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e.AnnotationEditorType.HIGHLIGHT}),this.showAllEditors("highlight",!0,!0));for(const He of t(this,Tt).values())if(He.hasTextLayer(be)){He.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:O,boxes:ke,anchorNode:Ht,anchorOffset:$t,focusNode:Jt,focusOffset:Zt,text:oe});break}}}addToAnnotationStorage(O){!O.isEmpty()&&t(this,Et)&&!t(this,Et).has(O.id)&&t(this,Et).setValue(O.id,O)}blur(){if(this.isShiftKeyDown=!1,t(this,ve)&&(P(this,ve,!1),S(this,ft,un).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:O}=document;for(const dt of t(this,n))if(dt.div.contains(O)){P(this,Ee,[dt,O]),dt._focusEventsAllowed=!1;break}}focus(){if(!t(this,Ee))return;const[O,dt]=t(this,Ee);P(this,Ee,null),dt.addEventListener("focusin",()=>{O._focusEventsAllowed=!0},{once:!0}),dt.focus()}addEditListeners(){S(this,Pe,dr).call(this),S(this,J,pr).call(this)}removeEditListeners(){S(this,F,ur).call(this),S(this,ct,gr).call(this)}copy(O){var Ht;if(O.preventDefault(),(Ht=t(this,Nt))==null||Ht.commitOrRemove(),!this.hasSelection)return;const dt=[];for(const $t of t(this,n)){const Jt=$t.serialize(!0);Jt&&dt.push(Jt)}dt.length!==0&&O.clipboardData.setData("application/pdfjs",JSON.stringify(dt))}cut(O){this.copy(O),this.delete()}paste(O){O.preventDefault();const{clipboardData:dt}=O;for(const Jt of dt.items)for(const Zt of t(this,qt))if(Zt.isHandlingMimeForPasting(Jt.type)){Zt.paste(Jt,this.currentLayer);return}let Ht=dt.getData("application/pdfjs");if(!Ht)return;try{Ht=JSON.parse(Ht)}catch(Jt){(0,e.warn)(`paste: "${Jt.message}".`);return}if(!Array.isArray(Ht))return;this.unselectAll();const $t=this.currentLayer;try{const Jt=[];for(const be of Ht){const ke=$t.deserialize(be);if(!ke)return;Jt.push(ke)}const Zt=()=>{for(const be of Jt)S(this,Qt,fr).call(this,be);S(this,We,mr).call(this,Jt)},oe=()=>{for(const be of Jt)be.remove()};this.addCommands({cmd:Zt,undo:oe,mustExec:!0})}catch(Jt){(0,e.warn)(`paste: "${Jt.message}".`)}}keydown(O){!this.isShiftKeyDown&&O.key==="Shift"&&(this.isShiftKeyDown=!0),t(this,i)!==e.AnnotationEditorType.NONE&&!this.isEditorHandlingKeyboard&&ns._keyboardManager.exec(this,O)}keyup(O){this.isShiftKeyDown&&O.key==="Shift"&&(this.isShiftKeyDown=!1,t(this,ve)&&(P(this,ve,!1),S(this,ft,un).call(this,"main_toolbar")))}onEditingAction({name:O}){switch(O){case"undo":case"redo":case"delete":case"selectAll":this[O]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(O){O?(S(this,Me,Ka).call(this),S(this,J,pr).call(this),S(this,bt,Je).call(this,{isEditing:t(this,i)!==e.AnnotationEditorType.NONE,isEmpty:S(this,Te,Li).call(this),hasSomethingToUndo:t(this,Z).hasSomethingToUndo(),hasSomethingToRedo:t(this,Z).hasSomethingToRedo(),hasSelectedEditor:!1})):(S(this,Fe,cr).call(this),S(this,ct,gr).call(this),S(this,bt,Je).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(O){if(!t(this,qt)){P(this,qt,O);for(const dt of t(this,qt))S(this,jt,Ss).call(this,dt.defaultPropertiesToUpdate)}}getId(){return t(this,ae).id}get currentLayer(){return t(this,Tt).get(t(this,gt))}getLayer(O){return t(this,Tt).get(O)}get currentPageIndex(){return t(this,gt)}addLayer(O){t(this,Tt).set(O.pageIndex,O),t(this,Ce)?O.enable():O.disable()}removeLayer(O){t(this,Tt).delete(O.pageIndex)}updateMode(O,dt=null,Ht=!1){if(t(this,i)!==O){if(P(this,i,O),O===e.AnnotationEditorType.NONE){this.setEditingState(!1),S(this,St,Ja).call(this);return}this.setEditingState(!0),S(this,Yt,Ya).call(this),this.unselectAll();for(const $t of t(this,Tt).values())$t.updateMode(O);if(!dt&&Ht){this.addNewEditorFromKeyboard();return}if(dt){for(const $t of t(this,_t).values())if($t.annotationElementId===dt){this.setSelected($t),$t.enterInEditMode();break}}}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(O){O!==t(this,i)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:O})}updateParams(O,dt){var Ht;if(t(this,qt)){switch(O){case e.AnnotationEditorParamsType.CREATE:this.currentLayer.addNewEditor();return;case e.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:(Ht=t(this,ne))==null||Ht.updateColor(dt);break;case e.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(t(this,a)||P(this,a,new Map)).set(O,dt),this.showAllEditors("highlight",dt);break}for(const $t of t(this,n))$t.updateParams(O,dt);for(const $t of t(this,qt))$t.updateDefaultParams(O,dt)}}showAllEditors(O,dt,Ht=!1){var $t;for(const Jt of t(this,_t).values())Jt.editorType===O&&Jt.show(dt);((($t=t(this,a))==null?void 0:$t.get(e.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL))??!0)!==dt&&S(this,jt,Ss).call(this,[[e.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL,dt]])}enableWaiting(O=!1){if(t(this,ee)!==O){P(this,ee,O);for(const dt of t(this,Tt).values())O?dt.disableClick():dt.enableClick(),dt.div.classList.toggle("waiting",O)}}getEditors(O){const dt=[];for(const Ht of t(this,_t).values())Ht.pageIndex===O&&dt.push(Ht);return dt}getEditor(O){return t(this,_t).get(O)}addEditor(O){t(this,_t).set(O.id,O)}removeEditor(O){var dt;O.div.contains(document.activeElement)&&(t(this,de)&&clearTimeout(t(this,de)),P(this,de,setTimeout(()=>{this.focusMainContainer(),P(this,de,null)},0))),t(this,_t).delete(O.id),this.unselect(O),(!O.annotationElementId||!t(this,kt).has(O.annotationElementId))&&((dt=t(this,Et))==null||dt.remove(O.id))}addDeletedAnnotationElement(O){t(this,kt).add(O.annotationElementId),O.deleted=!0}isDeletedAnnotationElement(O){return t(this,kt).has(O)}removeDeletedAnnotationElement(O){t(this,kt).delete(O.annotationElementId),O.deleted=!1}setActiveEditor(O){t(this,Nt)!==O&&(P(this,Nt,O),O&&S(this,jt,Ss).call(this,O.propertiesToUpdate))}updateUI(O){t(this,ce,Qa)===O&&S(this,jt,Ss).call(this,O.propertiesToUpdate)}toggleSelected(O){if(t(this,n).has(O)){t(this,n).delete(O),O.unselect(),S(this,bt,Je).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,n).add(O),O.select(),S(this,jt,Ss).call(this,O.propertiesToUpdate),S(this,bt,Je).call(this,{hasSelectedEditor:!0})}setSelected(O){for(const dt of t(this,n))dt!==O&&dt.unselect();t(this,n).clear(),t(this,n).add(O),O.select(),S(this,jt,Ss).call(this,O.propertiesToUpdate),S(this,bt,Je).call(this,{hasSelectedEditor:!0})}isSelected(O){return t(this,n).has(O)}get firstSelectedEditor(){return t(this,n).values().next().value}unselect(O){O.unselect(),t(this,n).delete(O),S(this,bt,Je).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,n).size!==0}get isEnterHandled(){return t(this,n).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){t(this,Z).undo(),S(this,bt,Je).call(this,{hasSomethingToUndo:t(this,Z).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:S(this,Te,Li).call(this)})}redo(){t(this,Z).redo(),S(this,bt,Je).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,Z).hasSomethingToRedo(),isEmpty:S(this,Te,Li).call(this)})}addCommands(O){t(this,Z).add(O),S(this,bt,Je).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:S(this,Te,Li).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const O=[...t(this,n)],dt=()=>{for(const $t of O)$t.remove()},Ht=()=>{for(const $t of O)S(this,Qt,fr).call(this,$t)};this.addCommands({cmd:dt,undo:Ht,mustExec:!0})}commitOrRemove(){var O;(O=t(this,Nt))==null||O.commitOrRemove()}hasSomethingToControl(){return t(this,Nt)||this.hasSelection}selectAll(){for(const O of t(this,n))O.commit();S(this,We,mr).call(this,t(this,_t).values())}unselectAll(){if(!(t(this,Nt)&&(t(this,Nt).commitOrRemove(),t(this,i)!==e.AnnotationEditorType.NONE))&&this.hasSelection){for(const O of t(this,n))O.unselect();t(this,n).clear(),S(this,bt,Je).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(O,dt,Ht=!1){if(Ht||this.commitOrRemove(),!this.hasSelection)return;t(this,ut)[0]+=O,t(this,ut)[1]+=dt;const[$t,Jt]=t(this,ut),Zt=[...t(this,n)];t(this,xt)&&clearTimeout(t(this,xt)),P(this,xt,setTimeout(()=>{P(this,xt,null),t(this,ut)[0]=t(this,ut)[1]=0,this.addCommands({cmd:()=>{for(const be of Zt)t(this,_t).has(be.id)&&be.translateInPage($t,Jt)},undo:()=>{for(const be of Zt)t(this,_t).has(be.id)&&be.translateInPage(-$t,-Jt)},mustExec:!1})},1e3));for(const be of Zt)be.translateInPage(O,dt)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),P(this,Rt,new Map);for(const O of t(this,n))t(this,Rt).set(O,{savedX:O.x,savedY:O.y,savedPageIndex:O.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,Rt))return!1;this.disableUserSelect(!1);const O=t(this,Rt);P(this,Rt,null);let dt=!1;for(const[{x:$t,y:Jt,pageIndex:Zt},oe]of O)oe.newX=$t,oe.newY=Jt,oe.newPageIndex=Zt,dt||(dt=$t!==oe.savedX||Jt!==oe.savedY||Zt!==oe.savedPageIndex);if(!dt)return!1;const Ht=($t,Jt,Zt,oe)=>{if(t(this,_t).has($t.id)){const be=t(this,Tt).get(oe);be?$t._setParentAndPosition(be,Jt,Zt):($t.pageIndex=oe,$t.x=Jt,$t.y=Zt)}};return this.addCommands({cmd:()=>{for(const[$t,{newX:Jt,newY:Zt,newPageIndex:oe}]of O)Ht($t,Jt,Zt,oe)},undo:()=>{for(const[$t,{savedX:Jt,savedY:Zt,savedPageIndex:oe}]of O)Ht($t,Jt,Zt,oe)},mustExec:!0}),!0}dragSelectedEditors(O,dt){if(t(this,Rt))for(const Ht of t(this,Rt).keys())Ht.drag(O,dt)}rebuild(O){if(O.parent===null){const dt=this.getLayer(O.pageIndex);dt?(dt.changeParent(O),dt.addOrRebuild(O)):(this.addEditor(O),this.addToAnnotationStorage(O),O.rebuild())}else O.parent.addOrRebuild(O)}get isEditorHandlingKeyboard(){var O;return((O=this.getActive())==null?void 0:O.shouldGetKeyboardEvents())||t(this,n).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(O){return t(this,Nt)===O}getActive(){return t(this,Nt)}getMode(){return t(this,i)}get imageManager(){return(0,e.shadow)(this,"imageManager",new y)}getSelectionBoxes(O){if(!O)return null;const dt=document.getSelection();for(let ke=0,He=dt.rangeCount;ke<He;ke++)if(!O.contains(dt.getRangeAt(ke).commonAncestorContainer))return null;const{x:Ht,y:$t,width:Jt,height:Zt}=O.getBoundingClientRect();let oe;switch(O.getAttribute("data-main-rotation")){case"90":oe=(ke,He,Ke,qe)=>({x:(He-$t)/Zt,y:1-(ke+Ke-Ht)/Jt,width:qe/Zt,height:Ke/Jt});break;case"180":oe=(ke,He,Ke,qe)=>({x:1-(ke+Ke-Ht)/Jt,y:1-(He+qe-$t)/Zt,width:Ke/Jt,height:qe/Zt});break;case"270":oe=(ke,He,Ke,qe)=>({x:1-(He+qe-$t)/Zt,y:(ke-Ht)/Jt,width:qe/Zt,height:Ke/Jt});break;default:oe=(ke,He,Ke,qe)=>({x:(ke-Ht)/Jt,y:(He-$t)/Zt,width:Ke/Jt,height:qe/Zt});break}const be=[];for(let ke=0,He=dt.rangeCount;ke<He;ke++){const Ke=dt.getRangeAt(ke);if(!Ke.collapsed)for(const{x:qe,y:Jo,width:Ts,height:Ur}of Ke.getClientRects())Ts===0||Ur===0||be.push(oe(qe,Jo,Ts,Ur))}return be.length===0?null:be}};Nt=new WeakMap,_t=new WeakMap,Tt=new WeakMap,Pt=new WeakMap,Et=new WeakMap,Z=new WeakMap,gt=new WeakMap,kt=new WeakMap,Rt=new WeakMap,qt=new WeakMap,Kt=new WeakMap,ie=new WeakMap,Se=new WeakMap,de=new WeakMap,le=new WeakMap,ve=new WeakMap,Vt=new WeakMap,ae=new WeakMap,Ce=new WeakMap,ee=new WeakMap,Ee=new WeakMap,ne=new WeakMap,et=new WeakMap,i=new WeakMap,n=new WeakMap,c=new WeakMap,p=new WeakMap,a=new WeakMap,A=new WeakMap,m=new WeakMap,_=new WeakMap,u=new WeakMap,r=new WeakMap,h=new WeakMap,T=new WeakMap,V=new WeakMap,j=new WeakMap,rt=new WeakMap,ot=new WeakMap,yt=new WeakMap,At=new WeakMap,ut=new WeakMap,xt=new WeakMap,L=new WeakMap,X=new WeakMap,nt=new WeakSet,dn=function({anchorNode:O}){return O.nodeType===Node.TEXT_NODE?O.parentElement:O},f=new WeakSet,qa=function(){const O=document.getSelection();if(!O||O.isCollapsed)return;const dt=S(this,nt,dn).call(this,O).closest(".textLayer"),Ht=this.getSelectionBoxes(dt);Ht&&(t(this,Vt)||P(this,Vt,new v.HighlightToolbar(this)),t(this,Vt).show(dt,Ht,this.direction==="ltr"))},W=new WeakSet,za=function(){var Ht,$t,Jt;const O=document.getSelection();if(!O||O.isCollapsed){t(this,c)&&((Ht=t(this,Vt))==null||Ht.hide(),P(this,c,null),S(this,bt,Je).call(this,{hasSelectedText:!1}));return}const{anchorNode:dt}=O;if(dt!==t(this,c)){if(!S(this,nt,dn).call(this,O).closest(".textLayer")){t(this,c)&&(($t=t(this,Vt))==null||$t.hide(),P(this,c,null),S(this,bt,Je).call(this,{hasSelectedText:!1}));return}if((Jt=t(this,Vt))==null||Jt.hide(),P(this,c,dt),S(this,bt,Je).call(this,{hasSelectedText:!0}),!(t(this,i)!==e.AnnotationEditorType.HIGHLIGHT&&t(this,i)!==e.AnnotationEditorType.NONE)&&(t(this,i)===e.AnnotationEditorType.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),P(this,ve,this.isShiftKeyDown),!this.isShiftKeyDown)){const Zt=oe=>{oe.type==="pointerup"&&oe.button!==0||(window.removeEventListener("pointerup",Zt),window.removeEventListener("blur",Zt),oe.type==="pointerup"&&S(this,ft,un).call(this,"main_toolbar"))};window.addEventListener("pointerup",Zt),window.addEventListener("blur",Zt)}}},ft=new WeakSet,un=function(O=""){t(this,i)===e.AnnotationEditorType.HIGHLIGHT?this.highlightSelection(O):t(this,ie)&&S(this,f,qa).call(this)},Dt=new WeakSet,Wa=function(){document.addEventListener("selectionchange",t(this,ot))},re=new WeakSet,Xa=function(){document.removeEventListener("selectionchange",t(this,ot))},Me=new WeakSet,Ka=function(){window.addEventListener("focus",t(this,m)),window.addEventListener("blur",t(this,A))},Fe=new WeakSet,cr=function(){window.removeEventListener("focus",t(this,m)),window.removeEventListener("blur",t(this,A))},Pe=new WeakSet,dr=function(){window.addEventListener("keydown",t(this,h)),window.addEventListener("keyup",t(this,T))},F=new WeakSet,ur=function(){window.removeEventListener("keydown",t(this,h)),window.removeEventListener("keyup",t(this,T))},J=new WeakSet,pr=function(){document.addEventListener("copy",t(this,_)),document.addEventListener("cut",t(this,u)),document.addEventListener("paste",t(this,r))},ct=new WeakSet,gr=function(){document.removeEventListener("copy",t(this,_)),document.removeEventListener("cut",t(this,u)),document.removeEventListener("paste",t(this,r))},bt=new WeakSet,Je=function(O){Object.entries(O).some(([dt,Ht])=>t(this,At)[dt]!==Ht)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,At),O)}),t(this,i)===e.AnnotationEditorType.HIGHLIGHT&&O.hasSelectedEditor===!1&&S(this,jt,Ss).call(this,[[e.AnnotationEditorParamsType.HIGHLIGHT_FREE,!0]]))},jt=new WeakSet,Ss=function(O){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:O})},Yt=new WeakSet,Ya=function(){if(!t(this,Ce)){P(this,Ce,!0);for(const O of t(this,Tt).values())O.enable();for(const O of t(this,_t).values())O.enable()}},St=new WeakSet,Ja=function(){if(this.unselectAll(),t(this,Ce)){P(this,Ce,!1);for(const O of t(this,Tt).values())O.disable();for(const O of t(this,_t).values())O.disable()}},Qt=new WeakSet,fr=function(O){const dt=t(this,Tt).get(O.pageIndex);dt?dt.addOrRebuild(O):(this.addEditor(O),this.addToAnnotationStorage(O))},ce=new WeakSet,Qa=function(){let O=null;for(O of t(this,n));return O},Te=new WeakSet,Li=function(){if(t(this,_t).size===0)return!0;if(t(this,_t).size===1)for(const O of t(this,_t).values())return O.isEmpty();return!1},We=new WeakSet,mr=function(O){for(const dt of t(this,n))dt.unselect();t(this,n).clear();for(const dt of O)dt.isEmpty()||(t(this,n).add(dt),dt.select());S(this,bt,Je).call(this,{hasSelectedEditor:this.hasSelection})},me(ns,"TRANSLATE_SMALL",1),me(ns,"TRANSLATE_BIG",10);let E=ns},94:(o,b,d)=>{d.d(b,{PDFFetchStream:()=>k});var e=d(292),w=d(490);function v(G,I,E){return{method:"GET",headers:G,signal:E.signal,mode:"cors",credentials:I?"include":"same-origin",redirect:"follow"}}function R(G){const I=new Headers;for(const E in G){const H=G[E];H!==void 0&&I.append(E,H)}return I}function K(G){return G instanceof Uint8Array?G.buffer:G instanceof ArrayBuffer?G:((0,e.warn)(`getArrayBuffer - unexpected data format: ${G}`),new Uint8Array(G).buffer)}class k{constructor(I){this.source=I,this.isHttp=/^https?:/i.test(I.url),this.httpHeaders=this.isHttp&&I.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var I;return((I=this._fullRequestReader)==null?void 0:I._loaded)??0}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new y(this),this._fullRequestReader}getRangeReader(I,E){if(E<=this._progressiveDataLength)return null;const H=new g(this,I,E);return this._rangeRequestReaders.push(H),H}cancelAllRequests(I){var E;(E=this._fullRequestReader)==null||E.cancel(I);for(const H of this._rangeRequestReaders.slice(0))H.cancel(I)}}class y{constructor(I){this._stream=I,this._reader=null,this._loaded=0,this._filename=null;const E=I.source;this._withCredentials=E.withCredentials||!1,this._contentLength=E.length,this._headersCapability=Promise.withResolvers(),this._disableRange=E.disableRange||!1,this._rangeChunkSize=E.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!E.disableStream,this._isRangeSupported=!E.disableRange,this._headers=R(this._stream.httpHeaders);const H=E.url;fetch(H,v(this._headers,this._withCredentials,this._abortController)).then($=>{if(!(0,w.validateResponseStatus)($.status))throw(0,w.createResponseStatusError)($.status,H);this._reader=$.body.getReader(),this._headersCapability.resolve();const Y=M=>$.headers.get(M),{allowRangeRequests:at,suggestedLength:Q}=(0,w.validateRangeRequestCapabilities)({getResponseHeader:Y,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=at,this._contentLength=Q||this._contentLength,this._filename=(0,w.extractFilenameFromHeader)(Y),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new e.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var H;await this._headersCapability.promise;const{value:I,done:E}=await this._reader.read();return E?{value:I,done:E}:(this._loaded+=I.byteLength,(H=this.onProgress)==null||H.call(this,{loaded:this._loaded,total:this._contentLength}),{value:K(I),done:!1})}cancel(I){var E;(E=this._reader)==null||E.cancel(I),this._abortController.abort()}}class g{constructor(I,E,H){this._stream=I,this._reader=null,this._loaded=0;const $=I.source;this._withCredentials=$.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!$.disableStream,this._abortController=new AbortController,this._headers=R(this._stream.httpHeaders),this._headers.append("Range",`bytes=${E}-${H-1}`);const Y=$.url;fetch(Y,v(this._headers,this._withCredentials,this._abortController)).then(at=>{if(!(0,w.validateResponseStatus)(at.status))throw(0,w.createResponseStatusError)(at.status,Y);this._readCapability.resolve(),this._reader=at.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var H;await this._readCapability.promise;const{value:I,done:E}=await this._reader.read();return E?{value:I,done:E}:(this._loaded+=I.byteLength,(H=this.onProgress)==null||H.call(this,{loaded:this._loaded}),{value:K(I),done:!1})}cancel(I){var E;(E=this._reader)==null||E.cancel(I),this._abortController.abort()}}},10:(o,b,d)=>{var R;d.d(b,{FontFaceObject:()=>v,FontLoader:()=>w});var e=d(292);class w{constructor({ownerDocument:k=globalThis.document,styleElement:y=null}){l(this,R,new Set);this._document=k,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(k){this.nativeFontFaces.add(k),this._document.fonts.add(k)}removeNativeFontFace(k){this.nativeFontFaces.delete(k),this._document.fonts.delete(k)}insertRule(k){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const y=this.styleElement.sheet;y.insertRule(k,y.cssRules.length)}clear(){for(const k of this.nativeFontFaces)this._document.fonts.delete(k);this.nativeFontFaces.clear(),t(this,R).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:k,_inspectFont:y}){if(!(!k||t(this,R).has(k.loadedName))){if((0,e.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:g,src:G,style:I}=k,E=new FontFace(g,G,I);this.addNativeFontFace(E);try{await E.load(),t(this,R).add(g),y==null||y(k)}catch{(0,e.warn)(`Cannot load system font: ${k.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(E)}return}(0,e.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(k){if(k.attached||k.missingFile&&!k.systemFontInfo)return;if(k.attached=!0,k.systemFontInfo){await this.loadSystemFont(k);return}if(this.isFontLoadingAPISupported){const g=k.createNativeFontFace();if(g){this.addNativeFontFace(g);try{await g.loaded}catch(G){throw(0,e.warn)(`Failed to load font '${g.family}': '${G}'.`),k.disableFontFace=!0,G}}return}const y=k.createFontFaceRule();if(y){if(this.insertRule(y),this.isSyncFontLoadingSupported)return;await new Promise(g=>{const G=this._queueLoadingCallback(g);this._prepareFontLoadEvent(k,G)})}}get isFontLoadingAPISupported(){var y;const k=!!((y=this._document)!=null&&y.fonts);return(0,e.shadow)(this,"isFontLoadingAPISupported",k)}get isSyncFontLoadingSupported(){let k=!1;return(e.isNodeJS||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(k=!0),(0,e.shadow)(this,"isSyncFontLoadingSupported",k)}_queueLoadingCallback(k){function y(){for((0,e.assert)(!G.done,"completeRequest() cannot be called twice."),G.done=!0;g.length>0&&g[0].done;){const I=g.shift();setTimeout(I.callback,0)}}const{loadingRequests:g}=this,G={done:!1,complete:y,callback:k};return g.push(G),G}get _loadTestFont(){const k=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,e.shadow)(this,"_loadTestFont",k)}_prepareFontLoadEvent(k,y){function g(Ft,Ct){return Ft.charCodeAt(Ct)<<24|Ft.charCodeAt(Ct+1)<<16|Ft.charCodeAt(Ct+2)<<8|Ft.charCodeAt(Ct+3)&255}function G(Ft,Ct,Nt,_t){const Tt=Ft.substring(0,Ct),Pt=Ft.substring(Ct+Nt);return Tt+_t+Pt}let I,E;const H=this._document.createElement("canvas");H.width=1,H.height=1;const $=H.getContext("2d");let Y=0;function at(Ft,Ct){if(++Y>30){(0,e.warn)("Load test font never loaded."),Ct();return}if($.font="30px "+Ft,$.fillText(".",0,20),$.getImageData(0,0,1,1).data[3]>0){Ct();return}setTimeout(at.bind(null,Ft,Ct))}const Q=`lt${Date.now()}${this.loadTestFontId++}`;let M=this._loadTestFont;M=G(M,976,Q.length,Q);const U=16,B=1482184792;let D=g(M,U);for(I=0,E=Q.length-3;I<E;I+=4)D=D-B+g(Q,I)|0;I<Q.length&&(D=D-B+g(Q+"XXX",I)|0),M=G(M,U,4,(0,e.string32)(D));const q=`url(data:font/opentype;base64,${btoa(M)});`,tt=`@font-face {font-family:"${Q}";src:${q}}`;this.insertRule(tt);const vt=this._document.createElement("div");vt.style.visibility="hidden",vt.style.width=vt.style.height="10px",vt.style.position="absolute",vt.style.top=vt.style.left="0px";for(const Ft of[k.loadedName,Q]){const Ct=this._document.createElement("span");Ct.textContent="Hi",Ct.style.fontFamily=Ft,vt.append(Ct)}this._document.body.append(vt),at(Q,()=>{vt.remove(),y.complete()})}}R=new WeakMap;class v{constructor(k,{isEvalSupported:y=!0,disableFontFace:g=!1,ignoreErrors:G=!1,inspectFont:I=null}){this.compiledGlyphs=Object.create(null);for(const E in k)this[E]=k[E];this.isEvalSupported=y!==!1,this.disableFontFace=g===!0,this.ignoreErrors=G===!0,this._inspectFont=I}createNativeFontFace(){var y;if(!this.data||this.disableFontFace)return null;let k;if(!this.cssFontInfo)k=new FontFace(this.loadedName,this.data,{});else{const g={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(g.style=`oblique ${this.cssFontInfo.italicAngle}deg`),k=new FontFace(this.cssFontInfo.fontFamily,this.data,g)}return(y=this._inspectFont)==null||y.call(this,this),k}createFontFaceRule(){var G;if(!this.data||this.disableFontFace)return null;const k=(0,e.bytesToString)(this.data),y=`url(data:${this.mimetype};base64,${btoa(k)});`;let g;if(!this.cssFontInfo)g=`@font-face {font-family:"${this.loadedName}";src:${y}}`;else{let I=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(I+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),g=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${I}src:${y}}`}return(G=this._inspectFont)==null||G.call(this,this,y),g}getPathGenerator(k,y){if(this.compiledGlyphs[y]!==void 0)return this.compiledGlyphs[y];let g;try{g=k.get(this.loadedName+"_path_"+y)}catch(G){if(!this.ignoreErrors)throw G;return(0,e.warn)(`getPathGenerator - ignoring character: "${G}".`),this.compiledGlyphs[y]=function(I,E){}}if(this.isEvalSupported&&e.FeatureTest.isEvalSupported){const G=[];for(const I of g){const E=I.args!==void 0?I.args.join(","):"";G.push("c.",I.cmd,"(",E,`);
`)}return this.compiledGlyphs[y]=new Function("c","size",G.join(""))}return this.compiledGlyphs[y]=function(G,I){for(const E of g)E.cmd==="scale"&&(E.args=[I,-I]),G[E.cmd].apply(G,E.args)}}}},62:(o,b,d)=>{var v,R;d.d(b,{Metadata:()=>w});var e=d(292);class w{constructor({parsedData:k,rawData:y}){l(this,v,void 0);l(this,R,void 0);P(this,v,k),P(this,R,y)}getRaw(){return t(this,R)}get(k){return t(this,v).get(k)??null}getAll(){return(0,e.objectFromMap)(t(this,v))}has(k){return t(this,v).has(k)}}v=new WeakMap,R=new WeakMap},457:(o,b,d)=>{d.d(b,{PDFNetworkStream:()=>y});var e=d(292),w=d(490);const v=200,R=206;function K(I){const E=I.response;return typeof E!="string"?E:(0,e.stringToBytes)(E).buffer}class k{constructor(E,H={}){this.url=E,this.isHttp=/^https?:/i.test(E),this.httpHeaders=this.isHttp&&H.httpHeaders||Object.create(null),this.withCredentials=H.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(E,H,$){const Y={begin:E,end:H};for(const at in $)Y[at]=$[at];return this.request(Y)}requestFull(E){return this.request(E)}request(E){const H=new XMLHttpRequest,$=this.currXhrId++,Y=this.pendingRequests[$]={xhr:H};H.open("GET",this.url),H.withCredentials=this.withCredentials;for(const at in this.httpHeaders){const Q=this.httpHeaders[at];Q!==void 0&&H.setRequestHeader(at,Q)}return this.isHttp&&"begin"in E&&"end"in E?(H.setRequestHeader("Range",`bytes=${E.begin}-${E.end-1}`),Y.expectedStatus=R):Y.expectedStatus=v,H.responseType="arraybuffer",E.onError&&(H.onerror=function(at){E.onError(H.status)}),H.onreadystatechange=this.onStateChange.bind(this,$),H.onprogress=this.onProgress.bind(this,$),Y.onHeadersReceived=E.onHeadersReceived,Y.onDone=E.onDone,Y.onError=E.onError,Y.onProgress=E.onProgress,H.send(null),$}onProgress(E,H){var Y;const $=this.pendingRequests[E];$&&((Y=$.onProgress)==null||Y.call($,H))}onStateChange(E,H){var M,U,B;const $=this.pendingRequests[E];if(!$)return;const Y=$.xhr;if(Y.readyState>=2&&$.onHeadersReceived&&($.onHeadersReceived(),delete $.onHeadersReceived),Y.readyState!==4||!(E in this.pendingRequests))return;if(delete this.pendingRequests[E],Y.status===0&&this.isHttp){(M=$.onError)==null||M.call($,Y.status);return}const at=Y.status||v;if(!(at===v&&$.expectedStatus===R)&&at!==$.expectedStatus){(U=$.onError)==null||U.call($,Y.status);return}const Q=K(Y);if(at===R){const D=Y.getResponseHeader("Content-Range"),q=/bytes (\d+)-(\d+)\/(\d+)/.exec(D);$.onDone({begin:parseInt(q[1],10),chunk:Q})}else Q?$.onDone({begin:0,chunk:Q}):(B=$.onError)==null||B.call($,Y.status)}getRequestXhr(E){return this.pendingRequests[E].xhr}isPendingRequest(E){return E in this.pendingRequests}abortRequest(E){const H=this.pendingRequests[E].xhr;delete this.pendingRequests[E],H.abort()}}class y{constructor(E){this._source=E,this._manager=new k(E.url,{httpHeaders:E.httpHeaders,withCredentials:E.withCredentials}),this._rangeChunkSize=E.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(E){const H=this._rangeRequestReaders.indexOf(E);H>=0&&this._rangeRequestReaders.splice(H,1)}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new g(this._manager,this._source),this._fullRequestReader}getRangeReader(E,H){const $=new G(this._manager,E,H);return $.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push($),$}cancelAllRequests(E){var H;(H=this._fullRequestReader)==null||H.cancel(E);for(const $ of this._rangeRequestReaders.slice(0))$.cancel(E)}}class g{constructor(E,H){this._manager=E;const $={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=H.url,this._fullRequestId=E.requestFull($),this._headersReceivedCapability=Promise.withResolvers(),this._disableRange=H.disableRange||!1,this._contentLength=H.length,this._rangeChunkSize=H.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const E=this._fullRequestId,H=this._manager.getRequestXhr(E),$=Q=>H.getResponseHeader(Q),{allowRangeRequests:Y,suggestedLength:at}=(0,w.validateRangeRequestCapabilities)({getResponseHeader:$,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});Y&&(this._isRangeSupported=!0),this._contentLength=at||this._contentLength,this._filename=(0,w.extractFilenameFromHeader)($),this._isRangeSupported&&this._manager.abortRequest(E),this._headersReceivedCapability.resolve()}_onDone(E){if(E&&(this._requests.length>0?this._requests.shift().resolve({value:E.chunk,done:!1}):this._cachedChunks.push(E.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const H of this._requests)H.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(E){this._storedError=(0,w.createResponseStatusError)(E,this._url),this._headersReceivedCapability.reject(this._storedError);for(const H of this._requests)H.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(E){var H;(H=this.onProgress)==null||H.call(this,{loaded:E.loaded,total:E.lengthComputable?E.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const E=Promise.withResolvers();return this._requests.push(E),E.promise}cancel(E){this._done=!0,this._headersReceivedCapability.reject(E);for(const H of this._requests)H.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class G{constructor(E,H,$){this._manager=E;const Y={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=E.url,this._requestId=E.requestRange(H,$,Y),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var E;(E=this.onClosed)==null||E.call(this,this)}_onDone(E){const H=E.chunk;this._requests.length>0?this._requests.shift().resolve({value:H,done:!1}):this._queuedChunk=H,this._done=!0;for(const $ of this._requests)$.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(E){this._storedError=(0,w.createResponseStatusError)(E,this._url);for(const H of this._requests)H.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(E){var H;this.isStreamingSupported||((H=this.onProgress)==null||H.call(this,{loaded:E.loaded}))}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const H=this._queuedChunk;return this._queuedChunk=null,{value:H,done:!1}}if(this._done)return{value:void 0,done:!0};const E=Promise.withResolvers();return this._requests.push(E),E.promise}cancel(E){this._done=!0;for(const H of this._requests)H.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},490:(o,b,d)=>{d.d(b,{createResponseStatusError:()=>k,extractFilenameFromHeader:()=>K,validateRangeRequestCapabilities:()=>R,validateResponseStatus:()=>y});var e=d(292);function w(g){let G=!0,I=E("filename\\*","i").exec(g);if(I){I=I[1];let U=at(I);return U=unescape(U),U=Q(U),U=M(U),$(U)}if(I=Y(g),I){const U=M(I);return $(U)}if(I=E("filename","i").exec(g),I){I=I[1];let U=at(I);return U=M(U),$(U)}function E(U,B){return new RegExp("(?:^|;)\\s*"+U+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',B)}function H(U,B){if(U){if(!/^[\x00-\xFF]+$/.test(B))return B;try{const D=new TextDecoder(U,{fatal:!0}),q=(0,e.stringToBytes)(B);B=D.decode(q),G=!1}catch{}}return B}function $(U){return G&&/[\x80-\xff]/.test(U)&&(U=H("utf-8",U),G&&(U=H("iso-8859-1",U))),U}function Y(U){const B=[];let D;const q=E("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(D=q.exec(U))!==null;){let[,vt,Ft,Ct]=D;if(vt=parseInt(vt,10),vt in B){if(vt===0)break;continue}B[vt]=[Ft,Ct]}const tt=[];for(let vt=0;vt<B.length&&vt in B;++vt){let[Ft,Ct]=B[vt];Ct=at(Ct),Ft&&(Ct=unescape(Ct),vt===0&&(Ct=Q(Ct))),tt.push(Ct)}return tt.join("")}function at(U){if(U.startsWith('"')){const B=U.slice(1).split('\\"');for(let D=0;D<B.length;++D){const q=B[D].indexOf('"');q!==-1&&(B[D]=B[D].slice(0,q),B.length=D+1),B[D]=B[D].replaceAll(/\\(.)/g,"$1")}U=B.join('"')}return U}function Q(U){const B=U.indexOf("'");if(B===-1)return U;const D=U.slice(0,B),q=U.slice(B+1).replace(/^[^']*'/,"");return H(D,q)}function M(U){return!U.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(U)?U:U.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(B,D,q,tt){if(q==="q"||q==="Q")return tt=tt.replaceAll("_"," "),tt=tt.replaceAll(/=([0-9a-fA-F]{2})/g,function(vt,Ft){return String.fromCharCode(parseInt(Ft,16))}),H(D,tt);try{tt=atob(tt)}catch{}return H(D,tt)})}return""}var v=d(419);function R({getResponseHeader:g,isHttp:G,rangeChunkSize:I,disableRange:E}){const H={allowRangeRequests:!1,suggestedLength:void 0},$=parseInt(g("Content-Length"),10);return!Number.isInteger($)||(H.suggestedLength=$,$<=2*I)||E||!G||g("Accept-Ranges")!=="bytes"||(g("Content-Encoding")||"identity")!=="identity"||(H.allowRangeRequests=!0),H}function K(g){const G=g("Content-Disposition");if(G){let I=w(G);if(I.includes("%"))try{I=decodeURIComponent(I)}catch{}if((0,v.isPdfFile)(I))return I}return null}function k(g,G){return g===404||g===0&&G.startsWith("file:")?new e.MissingPDFException('Missing PDF "'+G+'".'):new e.UnexpectedResponseException(`Unexpected server response (${g}) while retrieving PDF "${G}".`,g)}function y(g){return g===200||g===206}},786:(o,b,d)=>{d.a(o,async(e,w)=>{try{let K=function(B){const D=I.parse(B);return D.protocol==="file:"||D.host?D:/^[a-z]:[/\\]/i.test(B)?I.parse(`file:///${B}`):(D.host||(D.protocol="file:"),D)},k=function(B,D){return{protocol:B.protocol,auth:B.auth,host:B.hostname,port:B.port,path:B.path,method:"GET",headers:D}};d.d(b,{PDFNodeStream:()=>H});var v=d(292),R=d(490);let y,g,G,I;v.isNodeJS&&(y=await bs(()=>import("./chunk.js"),[]),g=await bs(()=>import("./chunk.js"),[]),G=await bs(()=>import("./chunk.js"),[]),I=await bs(()=>import("./chunk.js"),[]));const E=/^file:\/\/\/[a-zA-Z]:\//;class H{constructor(D){this.source=D,this.url=K(D.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&D.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var D;return((D=this._fullRequestReader)==null?void 0:D._loaded)??0}getFullReader(){return(0,v.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new M(this):new at(this),this._fullRequestReader}getRangeReader(D,q){if(q<=this._progressiveDataLength)return null;const tt=this.isFsUrl?new U(this,D,q):new Q(this,D,q);return this._rangeRequestReaders.push(tt),tt}cancelAllRequests(D){var q;(q=this._fullRequestReader)==null||q.cancel(D);for(const tt of this._rangeRequestReaders.slice(0))tt.cancel(D)}}class ${constructor(D){this._url=D.url,this._done=!1,this._storedError=null,this.onProgress=null;const q=D.source;this._contentLength=q.length,this._loaded=0,this._filename=null,this._disableRange=q.disableRange||!1,this._rangeChunkSize=q.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!q.disableStream,this._isRangeSupported=!q.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var q;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const D=this._readableStream.read();return D===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=D.length,(q=this.onProgress)==null||q.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(D).buffer,done:!1})}cancel(D){if(!this._readableStream){this._error(D);return}this._readableStream.destroy(D)}_error(D){this._storedError=D,this._readCapability.resolve()}_setReadableStream(D){this._readableStream=D,D.on("readable",()=>{this._readCapability.resolve()}),D.on("end",()=>{D.destroy(),this._done=!0,this._readCapability.resolve()}),D.on("error",q=>{this._error(q)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new v.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Y{constructor(D){this._url=D.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const q=D.source;this._isStreamingSupported=!q.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var q;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const D=this._readableStream.read();return D===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=D.length,(q=this.onProgress)==null||q.call(this,{loaded:this._loaded}),{value:new Uint8Array(D).buffer,done:!1})}cancel(D){if(!this._readableStream){this._error(D);return}this._readableStream.destroy(D)}_error(D){this._storedError=D,this._readCapability.resolve()}_setReadableStream(D){this._readableStream=D,D.on("readable",()=>{this._readCapability.resolve()}),D.on("end",()=>{D.destroy(),this._done=!0,this._readCapability.resolve()}),D.on("error",q=>{this._error(q)}),this._storedError&&this._readableStream.destroy(this._storedError)}}class at extends ${constructor(D){super(D);const q=tt=>{if(tt.statusCode===404){const Nt=new v.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Nt,this._headersCapability.reject(Nt);return}this._headersCapability.resolve(),this._setReadableStream(tt);const vt=Nt=>this._readableStream.headers[Nt.toLowerCase()],{allowRangeRequests:Ft,suggestedLength:Ct}=(0,R.validateRangeRequestCapabilities)({getResponseHeader:vt,isHttp:D.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=Ft,this._contentLength=Ct||this._contentLength,this._filename=(0,R.extractFilenameFromHeader)(vt)};this._request=null,this._url.protocol==="http:"?this._request=g.request(k(this._url,D.httpHeaders),q):this._request=G.request(k(this._url,D.httpHeaders),q),this._request.on("error",tt=>{this._storedError=tt,this._headersCapability.reject(tt)}),this._request.end()}}class Q extends Y{constructor(D,q,tt){super(D),this._httpHeaders={};for(const Ft in D.httpHeaders){const Ct=D.httpHeaders[Ft];Ct!==void 0&&(this._httpHeaders[Ft]=Ct)}this._httpHeaders.Range=`bytes=${q}-${tt-1}`;const vt=Ft=>{if(Ft.statusCode===404){const Ct=new v.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Ct;return}this._setReadableStream(Ft)};this._request=null,this._url.protocol==="http:"?this._request=g.request(k(this._url,this._httpHeaders),vt):this._request=G.request(k(this._url,this._httpHeaders),vt),this._request.on("error",Ft=>{this._storedError=Ft}),this._request.end()}}class M extends ${constructor(D){super(D);let q=decodeURIComponent(this._url.path);E.test(this._url.href)&&(q=q.replace(/^\//,"")),y.promises.lstat(q).then(tt=>{this._contentLength=tt.size,this._setReadableStream(y.createReadStream(q)),this._headersCapability.resolve()},tt=>{tt.code==="ENOENT"&&(tt=new v.MissingPDFException(`Missing PDF "${q}".`)),this._storedError=tt,this._headersCapability.reject(tt)})}}class U extends Y{constructor(D,q,tt){super(D);let vt=decodeURIComponent(this._url.path);E.test(this._url.href)&&(vt=vt.replace(/^\//,"")),this._setReadableStream(y.createReadStream(vt,{start:q,end:tt-1}))}}w()}catch(K){w(K)}},1)},573:(o,b,d)=>{d.a(o,async(e,w)=>{try{d.d(b,{NodeCMapReaderFactory:()=>E,NodeCanvasFactory:()=>I,NodeFilterFactory:()=>G,NodeStandardFontDataFactory:()=>H});var v=d(583),R=d(292);let K,k,y;if(R.isNodeJS){K=await bs(()=>import("./chunk.js"),[]);try{k=await bs(()=>import("./chunk.js"),[])}catch{}try{y=await bs(()=>import("./chunk2.js"),[])}catch{}}const g=function($){return K.promises.readFile($).then(Y=>new Uint8Array(Y))};class G extends v.BaseFilterFactory{}class I extends v.BaseCanvasFactory{_createCanvas(Y,at){return k.createCanvas(Y,at)}}class E extends v.BaseCMapReaderFactory{_fetchData(Y,at){return g(Y).then(Q=>({cMapData:Q,compressionType:at}))}}class H extends v.BaseStandardFontDataFactory{_fetchData(Y){return g(Y)}}w()}catch(K){w(K)}},1)},626:(o,b,d)=>{var k,y,g,G,I,E,H,$,Y,vr;d.d(b,{OptionalContentConfig:()=>K});var e=d(292),w=d(651);const v=Symbol("INTERNAL");class R{constructor(M,{name:U,intent:B,usage:D}){l(this,k,!1);l(this,y,!1);l(this,g,!1);l(this,G,!0);P(this,k,!!(M&e.RenderingIntentFlag.DISPLAY)),P(this,y,!!(M&e.RenderingIntentFlag.PRINT)),this.name=U,this.intent=B,this.usage=D}get visible(){if(t(this,g))return t(this,G);if(!t(this,G))return!1;const{print:M,view:U}=this.usage;return t(this,k)?(U==null?void 0:U.viewState)!=="OFF":t(this,y)?(M==null?void 0:M.printState)!=="OFF":!0}_setVisible(M,U,B=!1){M!==v&&(0,e.unreachable)("Internal method `_setVisible` called."),P(this,g,B),P(this,G,U)}}k=new WeakMap,y=new WeakMap,g=new WeakMap,G=new WeakMap;class K{constructor(M,U=e.RenderingIntentFlag.DISPLAY){l(this,Y);l(this,I,null);l(this,E,new Map);l(this,H,null);l(this,$,null);if(this.renderingIntent=U,this.name=null,this.creator=null,M!==null){this.name=M.name,this.creator=M.creator,P(this,$,M.order);for(const B of M.groups)t(this,E).set(B.id,new R(U,B));if(M.baseState==="OFF")for(const B of t(this,E).values())B._setVisible(v,!1);for(const B of M.on)t(this,E).get(B)._setVisible(v,!0);for(const B of M.off)t(this,E).get(B)._setVisible(v,!1);P(this,H,this.getHash())}}isVisible(M){if(t(this,E).size===0)return!0;if(!M)return(0,e.info)("Optional content group not defined."),!0;if(M.type==="OCG")return t(this,E).has(M.id)?t(this,E).get(M.id).visible:((0,e.warn)(`Optional content group not found: ${M.id}`),!0);if(M.type==="OCMD"){if(M.expression)return S(this,Y,vr).call(this,M.expression);if(!M.policy||M.policy==="AnyOn"){for(const U of M.ids){if(!t(this,E).has(U))return(0,e.warn)(`Optional content group not found: ${U}`),!0;if(t(this,E).get(U).visible)return!0}return!1}else if(M.policy==="AllOn"){for(const U of M.ids){if(!t(this,E).has(U))return(0,e.warn)(`Optional content group not found: ${U}`),!0;if(!t(this,E).get(U).visible)return!1}return!0}else if(M.policy==="AnyOff"){for(const U of M.ids){if(!t(this,E).has(U))return(0,e.warn)(`Optional content group not found: ${U}`),!0;if(!t(this,E).get(U).visible)return!0}return!1}else if(M.policy==="AllOff"){for(const U of M.ids){if(!t(this,E).has(U))return(0,e.warn)(`Optional content group not found: ${U}`),!0;if(t(this,E).get(U).visible)return!1}return!0}return(0,e.warn)(`Unknown optional content policy ${M.policy}.`),!0}return(0,e.warn)(`Unknown group type ${M.type}.`),!0}setVisibility(M,U=!0){const B=t(this,E).get(M);if(!B){(0,e.warn)(`Optional content group not found: ${M}`);return}B._setVisible(v,!!U,!0),P(this,I,null)}setOCGState({state:M,preserveRB:U}){let B;for(const D of M){switch(D){case"ON":case"OFF":case"Toggle":B=D;continue}const q=t(this,E).get(D);if(q)switch(B){case"ON":q._setVisible(v,!0);break;case"OFF":q._setVisible(v,!1);break;case"Toggle":q._setVisible(v,!q.visible);break}}P(this,I,null)}get hasInitialVisibility(){return t(this,H)===null||this.getHash()===t(this,H)}getOrder(){return t(this,E).size?t(this,$)?t(this,$).slice():[...t(this,E).keys()]:null}getGroups(){return t(this,E).size>0?(0,e.objectFromMap)(t(this,E)):null}getGroup(M){return t(this,E).get(M)||null}getHash(){if(t(this,I)!==null)return t(this,I);const M=new w.MurmurHash3_64;for(const[U,B]of t(this,E))M.update(`${U}:${B.visible}`);return P(this,I,M.hexdigest())}}I=new WeakMap,E=new WeakMap,H=new WeakMap,$=new WeakMap,Y=new WeakSet,vr=function(M){const U=M.length;if(U<2)return!0;const B=M[0];for(let D=1;D<U;D++){const q=M[D];let tt;if(Array.isArray(q))tt=S(this,Y,vr).call(this,q);else if(t(this,E).has(q))tt=t(this,E).get(q).visible;else return(0,e.warn)(`Optional content group not found: ${q}`),!0;switch(B){case"And":if(!tt)return!1;break;case"Or":if(tt)return!0;break;case"Not":return!tt;default:return!0}}return B==="And"}},814:(o,b,d)=>{d.d(b,{cleanupTextLayer:()=>G,renderTextLayer:()=>at,updateTextLayer:()=>Q});var e=d(292),w=d(419);const v=1e5,R=30,K=.8,k=new Map;let y=null;function g(){if(!y){const M=document.createElement("canvas");M.className="hiddenCanvasElement",document.body.append(M),y=M.getContext("2d",{alpha:!1})}return y}function G(){y==null||y.canvas.remove(),y=null}function I(M){const U=k.get(M);if(U)return U;const B=g(),D=B.font;B.canvas.width=B.canvas.height=R,B.font=`${R}px ${M}`;const q=B.measureText("");let tt=q.fontBoundingBoxAscent,vt=Math.abs(q.fontBoundingBoxDescent);if(tt){const Ct=tt/(tt+vt);return k.set(M,Ct),B.canvas.width=B.canvas.height=0,B.font=D,Ct}B.strokeStyle="red",B.clearRect(0,0,R,R),B.strokeText("g",0,0);let Ft=B.getImageData(0,0,R,R).data;vt=0;for(let Ct=Ft.length-1-3;Ct>=0;Ct-=4)if(Ft[Ct]>0){vt=Math.ceil(Ct/4/R);break}B.clearRect(0,0,R,R),B.strokeText("A",0,R),Ft=B.getImageData(0,0,R,R).data,tt=0;for(let Ct=0,Nt=Ft.length;Ct<Nt;Ct+=4)if(Ft[Ct]>0){tt=R-Math.floor(Ct/4/R);break}if(B.canvas.width=B.canvas.height=0,B.font=D,tt){const Ct=tt/(tt+vt);return k.set(M,Ct),Ct}return k.set(M,K),K}function E(M,U,B){const D=document.createElement("span"),q={angle:0,canvasWidth:0,hasText:U.str!=="",hasEOL:U.hasEOL,fontSize:0};M._textDivs.push(D);const tt=e.Util.transform(M._transform,U.transform);let vt=Math.atan2(tt[1],tt[0]);const Ft=B[U.fontName];Ft.vertical&&(vt+=Math.PI/2);const Ct=M._fontInspectorEnabled&&Ft.fontSubstitution||Ft.fontFamily,Nt=Math.hypot(tt[2],tt[3]),_t=Nt*I(Ct);let Tt,Pt;vt===0?(Tt=tt[4],Pt=tt[5]-_t):(Tt=tt[4]+_t*Math.sin(vt),Pt=tt[5]-_t*Math.cos(vt));const Et="calc(var(--scale-factor)*",Z=D.style;M._container===M._rootContainer?(Z.left=`${(100*Tt/M._pageWidth).toFixed(2)}%`,Z.top=`${(100*Pt/M._pageHeight).toFixed(2)}%`):(Z.left=`${Et}${Tt.toFixed(2)}px)`,Z.top=`${Et}${Pt.toFixed(2)}px)`),Z.fontSize=`${Et}${Nt.toFixed(2)}px)`,Z.fontFamily=Ct,q.fontSize=Nt,D.setAttribute("role","presentation"),D.textContent=U.str,D.dir=U.dir,M._fontInspectorEnabled&&(D.dataset.fontName=Ft.fontSubstitutionLoadedName||U.fontName),vt!==0&&(q.angle=vt*(180/Math.PI));let gt=!1;if(U.str.length>1)gt=!0;else if(U.str!==" "&&U.transform[0]!==U.transform[3]){const kt=Math.abs(U.transform[0]),Rt=Math.abs(U.transform[3]);kt!==Rt&&Math.max(kt,Rt)/Math.min(kt,Rt)>1.5&&(gt=!0)}gt&&(q.canvasWidth=Ft.vertical?U.height:U.width),M._textDivProperties.set(D,q),M._isReadableStream&&M._layoutText(D)}function H(M){const{div:U,scale:B,properties:D,ctx:q,prevFontSize:tt,prevFontFamily:vt}=M,{style:Ft}=U;let Ct="";if(D.canvasWidth!==0&&D.hasText){const{fontFamily:Nt}=Ft,{canvasWidth:_t,fontSize:Tt}=D;(tt!==Tt||vt!==Nt)&&(q.font=`${Tt*B}px ${Nt}`,M.prevFontSize=Tt,M.prevFontFamily=Nt);const{width:Pt}=q.measureText(U.textContent);Pt>0&&(Ct=`scaleX(${_t*B/Pt})`)}D.angle!==0&&(Ct=`rotate(${D.angle}deg) ${Ct}`),Ct.length>0&&(Ft.transform=Ct)}function $(M){if(M._canceled)return;const U=M._textDivs,B=M._capability;if(U.length>v){B.resolve();return}if(!M._isReadableStream)for(const D of U)M._layoutText(D);B.resolve()}class Y{constructor({textContentSource:U,container:B,viewport:D,textDivs:q,textDivProperties:tt,textContentItemsStr:vt}){var Tt;this._textContentSource=U,this._isReadableStream=U instanceof ReadableStream,this._container=this._rootContainer=B,this._textDivs=q||[],this._textContentItemsStr=vt||[],this._fontInspectorEnabled=!!((Tt=globalThis.FontInspector)!=null&&Tt.enabled),this._reader=null,this._textDivProperties=tt||new WeakMap,this._canceled=!1,this._capability=Promise.withResolvers(),this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:D.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:g()};const{pageWidth:Ft,pageHeight:Ct,pageX:Nt,pageY:_t}=D.rawDims;this._transform=[1,0,0,-1,-Nt,_t+Ct],this._pageWidth=Ft,this._pageHeight=Ct,(0,w.setLayerDimensions)(B,D),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new e.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new e.AbortException("TextLayer task cancelled."))}_processItems(U,B){for(const D of U){if(D.str===void 0){if(D.type==="beginMarkedContentProps"||D.type==="beginMarkedContent"){const q=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),D.id!==null&&this._container.setAttribute("id",`${D.id}`),q.append(this._container)}else D.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(D.str),E(this,D,B)}}_layoutText(U){const B=this._layoutTextParams.properties=this._textDivProperties.get(U);if(this._layoutTextParams.div=U,H(this._layoutTextParams),B.hasText&&this._container.append(U),B.hasEOL){const D=document.createElement("br");D.setAttribute("role","presentation"),this._container.append(D)}}_render(){const{promise:U,resolve:B,reject:D}=Promise.withResolvers();let q=Object.create(null);if(this._isReadableStream){const tt=()=>{this._reader.read().then(({value:vt,done:Ft})=>{if(Ft){B();return}Object.assign(q,vt.styles),this._processItems(vt.items,q),tt()},D)};this._reader=this._textContentSource.getReader(),tt()}else if(this._textContentSource){const{items:tt,styles:vt}=this._textContentSource;this._processItems(tt,vt),B()}else throw new Error('No "textContentSource" parameter specified.');U.then(()=>{q=null,$(this)},this._capability.reject)}}function at(M){const U=new Y(M);return U._render(),U}function Q({container:M,viewport:U,textDivs:B,textDivProperties:D,mustRotate:q=!0,mustRescale:tt=!0}){if(q&&(0,w.setLayerDimensions)(M,{rotation:U.rotation}),tt){const vt=g(),Ft={prevFontSize:null,prevFontFamily:null,div:null,scale:U.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:vt};for(const Ct of B)Ft.properties=D.get(Ct),Ft.div=Ct,H(Ft)}}},585:(o,b,d)=>{d.d(b,{PDFDataTransportStream:()=>v});var e=d(292),w=d(419);class v{constructor(y,{disableRange:g=!1,disableStream:G=!1}){(0,e.assert)(y,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:I,initialData:E,progressiveDone:H,contentDispositionFilename:$}=y;if(this._queuedChunks=[],this._progressiveDone=H,this._contentDispositionFilename=$,(E==null?void 0:E.length)>0){const Y=E instanceof Uint8Array&&E.byteLength===E.buffer.byteLength?E.buffer:new Uint8Array(E).buffer;this._queuedChunks.push(Y)}this._pdfDataRangeTransport=y,this._isStreamingSupported=!G,this._isRangeSupported=!g,this._contentLength=I,this._fullRequestReader=null,this._rangeReaders=[],y.addRangeListener((Y,at)=>{this._onReceiveData({begin:Y,chunk:at})}),y.addProgressListener((Y,at)=>{this._onProgress({loaded:Y,total:at})}),y.addProgressiveReadListener(Y=>{this._onReceiveData({chunk:Y})}),y.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),y.transportReady()}_onReceiveData({begin:y,chunk:g}){const G=g instanceof Uint8Array&&g.byteLength===g.buffer.byteLength?g.buffer:new Uint8Array(g).buffer;if(y===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(G):this._queuedChunks.push(G);else{const I=this._rangeReaders.some(function(E){return E._begin!==y?!1:(E._enqueue(G),!0)});(0,e.assert)(I,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var y;return((y=this._fullRequestReader)==null?void 0:y._loaded)??0}_onProgress(y){var g,G,I,E;y.total===void 0?(G=(g=this._rangeReaders[0])==null?void 0:g.onProgress)==null||G.call(g,{loaded:y.loaded}):(E=(I=this._fullRequestReader)==null?void 0:I.onProgress)==null||E.call(I,{loaded:y.loaded,total:y.total})}_onProgressiveDone(){var y;(y=this._fullRequestReader)==null||y.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(y){const g=this._rangeReaders.indexOf(y);g>=0&&this._rangeReaders.splice(g,1)}getFullReader(){(0,e.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const y=this._queuedChunks;return this._queuedChunks=null,new R(this,y,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(y,g){if(g<=this._progressiveDataLength)return null;const G=new K(this,y,g);return this._pdfDataRangeTransport.requestDataRange(y,g),this._rangeReaders.push(G),G}cancelAllRequests(y){var g;(g=this._fullRequestReader)==null||g.cancel(y);for(const G of this._rangeReaders.slice(0))G.cancel(y);this._pdfDataRangeTransport.abort()}}class R{constructor(y,g,G=!1,I=null){this._stream=y,this._done=G||!1,this._filename=(0,w.isPdfFile)(I)?I:null,this._queuedChunks=g||[],this._loaded=0;for(const E of this._queuedChunks)this._loaded+=E.byteLength;this._requests=[],this._headersReady=Promise.resolve(),y._fullRequestReader=this,this.onProgress=null}_enqueue(y){this._done||(this._requests.length>0?this._requests.shift().resolve({value:y,done:!1}):this._queuedChunks.push(y),this._loaded+=y.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const y=Promise.withResolvers();return this._requests.push(y),y.promise}cancel(y){this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class K{constructor(y,g,G){this._stream=y,this._begin=g,this._end=G,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(y){if(!this._done){if(this._requests.length===0)this._queuedChunk=y;else{this._requests.shift().resolve({value:y,done:!1});for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const g=this._queuedChunk;return this._queuedChunk=null,{value:g,done:!1}}if(this._done)return{value:void 0,done:!0};const y=Promise.withResolvers();return this._requests.push(y),y.promise}cancel(y){this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},164:(o,b,d)=>{var w,v;d.d(b,{GlobalWorkerOptions:()=>e});class e{static get workerPort(){return t(this,w)}static set workerPort(K){if(!(typeof Worker<"u"&&K instanceof Worker)&&K!==null)throw new Error("Invalid `workerPort` type.");P(this,w,K)}static get workerSrc(){return t(this,v)}static set workerSrc(K){if(typeof K!="string")throw new Error("Invalid `workerSrc` type.");P(this,v,K)}}w=new WeakMap,v=new WeakMap,l(e,w,null),l(e,v,"")},284:(o,b,d)=>{d.d(b,{XfaLayer:()=>w});var e=d(50);class w{static setupStorage(R,K,k,y,g){const G=y.getValue(K,{value:null});switch(k.name){case"textarea":if(G.value!==null&&(R.textContent=G.value),g==="print")break;R.addEventListener("input",I=>{y.setValue(K,{value:I.target.value})});break;case"input":if(k.attributes.type==="radio"||k.attributes.type==="checkbox"){if(G.value===k.attributes.xfaOn?R.setAttribute("checked",!0):G.value===k.attributes.xfaOff&&R.removeAttribute("checked"),g==="print")break;R.addEventListener("change",I=>{y.setValue(K,{value:I.target.checked?I.target.getAttribute("xfaOn"):I.target.getAttribute("xfaOff")})})}else{if(G.value!==null&&R.setAttribute("value",G.value),g==="print")break;R.addEventListener("input",I=>{y.setValue(K,{value:I.target.value})})}break;case"select":if(G.value!==null){R.setAttribute("value",G.value);for(const I of k.children)I.attributes.value===G.value?I.attributes.selected=!0:I.attributes.hasOwnProperty("selected")&&delete I.attributes.selected}R.addEventListener("input",I=>{const E=I.target.options,H=E.selectedIndex===-1?"":E[E.selectedIndex].value;y.setValue(K,{value:H})});break}}static setAttributes({html:R,element:K,storage:k=null,intent:y,linkService:g}){const{attributes:G}=K,I=R instanceof HTMLAnchorElement;G.type==="radio"&&(G.name=`${G.name}-${y}`);for(const[E,H]of Object.entries(G))if(H!=null)switch(E){case"class":H.length&&R.setAttribute(E,H.join(" "));break;case"dataId":break;case"id":R.setAttribute("data-element-id",H);break;case"style":Object.assign(R.style,H);break;case"textContent":R.textContent=H;break;default:(!I||E!=="href"&&E!=="newWindow")&&R.setAttribute(E,H)}I&&g.addLinkAttributes(R,G.href,G.newWindow),k&&G.dataId&&this.setupStorage(R,G.dataId,K,k)}static render(R){var Y,at;const K=R.annotationStorage,k=R.linkService,y=R.xfaHtml,g=R.intent||"display",G=document.createElement(y.name);y.attributes&&this.setAttributes({html:G,element:y,intent:g,linkService:k});const I=g!=="richText",E=R.div;if(E.append(G),R.viewport){const Q=`matrix(${R.viewport.transform.join(",")})`;E.style.transform=Q}I&&E.setAttribute("class","xfaLayer xfaFont");const H=[];if(y.children.length===0){if(y.value){const Q=document.createTextNode(y.value);G.append(Q),I&&e.XfaText.shouldBuildText(y.name)&&H.push(Q)}return{textDivs:H}}const $=[[y,-1,G]];for(;$.length>0;){const[Q,M,U]=$.at(-1);if(M+1===Q.children.length){$.pop();continue}const B=Q.children[++$.at(-1)[1]];if(B===null)continue;const{name:D}=B;if(D==="#text"){const tt=document.createTextNode(B.value);H.push(tt),U.append(tt);continue}const q=(Y=B==null?void 0:B.attributes)!=null&&Y.xmlns?document.createElementNS(B.attributes.xmlns,D):document.createElement(D);if(U.append(q),B.attributes&&this.setAttributes({html:q,element:B,storage:K,intent:g,linkService:k}),((at=B.children)==null?void 0:at.length)>0)$.push([B,-1,q]);else if(B.value){const tt=document.createTextNode(B.value);I&&e.XfaText.shouldBuildText(D)&&H.push(tt),q.append(tt)}}for(const Q of E.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))Q.setAttribute("readOnly",!0);return{textDivs:H}}static update(R){const K=`matrix(${R.viewport.transform.join(",")})`;R.div.style.transform=K,R.div.hidden=!1}}},50:(o,b,d)=>{d.d(b,{XfaText:()=>e});class e{static textContent(v){const R=[],K={items:R,styles:Object.create(null)};function k(y){var I;if(!y)return;let g=null;const G=y.name;if(G==="#text")g=y.value;else if(e.shouldBuildText(G))(I=y==null?void 0:y.attributes)!=null&&I.textContent?g=y.attributes.textContent:y.value&&(g=y.value);else return;if(g!==null&&R.push({str:g}),!!y.children)for(const E of y.children)k(E)}return k(v),K}static shouldBuildText(v){return!(v==="textarea"||v==="input"||v==="option"||v==="select")}}},228:(o,b,d)=>{d.a(o,async(e,w)=>{try{d.d(b,{AbortException:()=>v.AbortException,AnnotationEditorLayer:()=>y.AnnotationEditorLayer,AnnotationEditorParamsType:()=>v.AnnotationEditorParamsType,AnnotationEditorType:()=>v.AnnotationEditorType,AnnotationEditorUIManager:()=>g.AnnotationEditorUIManager,AnnotationLayer:()=>G.AnnotationLayer,AnnotationMode:()=>v.AnnotationMode,CMapCompressionType:()=>v.CMapCompressionType,ColorPicker:()=>I.ColorPicker,DOMSVGFactory:()=>K.DOMSVGFactory,DrawLayer:()=>E.DrawLayer,FeatureTest:()=>v.FeatureTest,GlobalWorkerOptions:()=>H.GlobalWorkerOptions,ImageKind:()=>v.ImageKind,InvalidPDFException:()=>v.InvalidPDFException,MissingPDFException:()=>v.MissingPDFException,OPS:()=>v.OPS,Outliner:()=>$.Outliner,PDFDataRangeTransport:()=>R.PDFDataRangeTransport,PDFDateString:()=>K.PDFDateString,PDFWorker:()=>R.PDFWorker,PasswordResponses:()=>v.PasswordResponses,PermissionFlag:()=>v.PermissionFlag,PixelsPerInch:()=>K.PixelsPerInch,RenderingCancelledException:()=>K.RenderingCancelledException,UnexpectedResponseException:()=>v.UnexpectedResponseException,Util:()=>v.Util,VerbosityLevel:()=>v.VerbosityLevel,XfaLayer:()=>Y.XfaLayer,build:()=>R.build,createValidAbsoluteUrl:()=>v.createValidAbsoluteUrl,fetchData:()=>K.fetchData,getDocument:()=>R.getDocument,getFilenameFromUrl:()=>K.getFilenameFromUrl,getPdfFilenameFromUrl:()=>K.getPdfFilenameFromUrl,getXfaPageViewport:()=>K.getXfaPageViewport,isDataScheme:()=>K.isDataScheme,isPdfFile:()=>K.isPdfFile,noContextMenu:()=>K.noContextMenu,normalizeUnicode:()=>v.normalizeUnicode,renderTextLayer:()=>k.renderTextLayer,setLayerDimensions:()=>K.setLayerDimensions,shadow:()=>v.shadow,updateTextLayer:()=>k.updateTextLayer,version:()=>R.version});var v=d(292),R=d(831),K=d(419),k=d(814),y=d(731),g=d(830),G=d(976),I=d(259),E=d(47),H=d(164),$=d(61),Y=d(284),at=e([R]);R=(at.then?(await at)():at)[0];const Q="4.1.392",M="fcb76a78d";w()}catch(Q){w(Q)}})},178:(o,b,d)=>{var k,Za,g,to,I,pn;d.d(b,{MessageHandler:()=>K});var e=d(292);const w={UNKNOWN:0,DATA:1,ERROR:2},v={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function R(H){switch(H instanceof Error||typeof H=="object"&&H!==null||(0,e.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),H.name){case"AbortException":return new e.AbortException(H.message);case"MissingPDFException":return new e.MissingPDFException(H.message);case"PasswordException":return new e.PasswordException(H.message,H.code);case"UnexpectedResponseException":return new e.UnexpectedResponseException(H.message,H.status);case"UnknownErrorException":return new e.UnknownErrorException(H.message,H.details);default:return new e.UnknownErrorException(H.message,H.toString())}}class K{constructor($,Y,at){l(this,k);l(this,g);l(this,I);this.sourceName=$,this.targetName=Y,this.comObj=at,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=Q=>{const M=Q.data;if(M.targetName!==this.sourceName)return;if(M.stream){S(this,g,to).call(this,M);return}if(M.callback){const B=M.callbackId,D=this.callbackCapabilities[B];if(!D)throw new Error(`Cannot resolve callback ${B}`);if(delete this.callbackCapabilities[B],M.callback===w.DATA)D.resolve(M.data);else if(M.callback===w.ERROR)D.reject(R(M.reason));else throw new Error("Unexpected callback case");return}const U=this.actionHandler[M.action];if(!U)throw new Error(`Unknown action from worker: ${M.action}`);if(M.callbackId){const B=this.sourceName,D=M.sourceName;new Promise(function(q){q(U(M.data))}).then(function(q){at.postMessage({sourceName:B,targetName:D,callback:w.DATA,callbackId:M.callbackId,data:q})},function(q){at.postMessage({sourceName:B,targetName:D,callback:w.ERROR,callbackId:M.callbackId,reason:R(q)})});return}if(M.streamId){S(this,k,Za).call(this,M);return}U(M.data)},at.addEventListener("message",this._onComObjOnMessage)}on($,Y){const at=this.actionHandler;if(at[$])throw new Error(`There is already an actionName called "${$}"`);at[$]=Y}send($,Y,at){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:$,data:Y},at)}sendWithPromise($,Y,at){const Q=this.callbackId++,M=Promise.withResolvers();this.callbackCapabilities[Q]=M;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:$,callbackId:Q,data:Y},at)}catch(U){M.reject(U)}return M.promise}sendWithStream($,Y,at,Q){const M=this.streamId++,U=this.sourceName,B=this.targetName,D=this.comObj;return new ReadableStream({start:q=>{const tt=Promise.withResolvers();return this.streamControllers[M]={controller:q,startCall:tt,pullCall:null,cancelCall:null,isClosed:!1},D.postMessage({sourceName:U,targetName:B,action:$,streamId:M,data:Y,desiredSize:q.desiredSize},Q),tt.promise},pull:q=>{const tt=Promise.withResolvers();return this.streamControllers[M].pullCall=tt,D.postMessage({sourceName:U,targetName:B,stream:v.PULL,streamId:M,desiredSize:q.desiredSize}),tt.promise},cancel:q=>{(0,e.assert)(q instanceof Error,"cancel must have a valid reason");const tt=Promise.withResolvers();return this.streamControllers[M].cancelCall=tt,this.streamControllers[M].isClosed=!0,D.postMessage({sourceName:U,targetName:B,stream:v.CANCEL,streamId:M,reason:R(q)}),tt.promise}},at)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}k=new WeakSet,Za=function($){const Y=$.streamId,at=this.sourceName,Q=$.sourceName,M=this.comObj,U=this,B=this.actionHandler[$.action],D={enqueue(q,tt=1,vt){if(this.isCancelled)return;const Ft=this.desiredSize;this.desiredSize-=tt,Ft>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),M.postMessage({sourceName:at,targetName:Q,stream:v.ENQUEUE,streamId:Y,chunk:q},vt)},close(){this.isCancelled||(this.isCancelled=!0,M.postMessage({sourceName:at,targetName:Q,stream:v.CLOSE,streamId:Y}),delete U.streamSinks[Y])},error(q){(0,e.assert)(q instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,M.postMessage({sourceName:at,targetName:Q,stream:v.ERROR,streamId:Y,reason:R(q)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:$.desiredSize,ready:null};D.sinkCapability.resolve(),D.ready=D.sinkCapability.promise,this.streamSinks[Y]=D,new Promise(function(q){q(B($.data,D))}).then(function(){M.postMessage({sourceName:at,targetName:Q,stream:v.START_COMPLETE,streamId:Y,success:!0})},function(q){M.postMessage({sourceName:at,targetName:Q,stream:v.START_COMPLETE,streamId:Y,reason:R(q)})})},g=new WeakSet,to=function($){const Y=$.streamId,at=this.sourceName,Q=$.sourceName,M=this.comObj,U=this.streamControllers[Y],B=this.streamSinks[Y];switch($.stream){case v.START_COMPLETE:$.success?U.startCall.resolve():U.startCall.reject(R($.reason));break;case v.PULL_COMPLETE:$.success?U.pullCall.resolve():U.pullCall.reject(R($.reason));break;case v.PULL:if(!B){M.postMessage({sourceName:at,targetName:Q,stream:v.PULL_COMPLETE,streamId:Y,success:!0});break}B.desiredSize<=0&&$.desiredSize>0&&B.sinkCapability.resolve(),B.desiredSize=$.desiredSize,new Promise(function(D){var q;D((q=B.onPull)==null?void 0:q.call(B))}).then(function(){M.postMessage({sourceName:at,targetName:Q,stream:v.PULL_COMPLETE,streamId:Y,success:!0})},function(D){M.postMessage({sourceName:at,targetName:Q,stream:v.PULL_COMPLETE,streamId:Y,reason:R(D)})});break;case v.ENQUEUE:if((0,e.assert)(U,"enqueue should have stream controller"),U.isClosed)break;U.controller.enqueue($.chunk);break;case v.CLOSE:if((0,e.assert)(U,"close should have stream controller"),U.isClosed)break;U.isClosed=!0,U.controller.close(),S(this,I,pn).call(this,U,Y);break;case v.ERROR:(0,e.assert)(U,"error should have stream controller"),U.controller.error(R($.reason)),S(this,I,pn).call(this,U,Y);break;case v.CANCEL_COMPLETE:$.success?U.cancelCall.resolve():U.cancelCall.reject(R($.reason)),S(this,I,pn).call(this,U,Y);break;case v.CANCEL:if(!B)break;new Promise(function(D){var q;D((q=B.onCancel)==null?void 0:q.call(B,R($.reason)))}).then(function(){M.postMessage({sourceName:at,targetName:Q,stream:v.CANCEL_COMPLETE,streamId:Y,success:!0})},function(D){M.postMessage({sourceName:at,targetName:Q,stream:v.CANCEL_COMPLETE,streamId:Y,reason:R(D)})}),B.sinkCapability.reject(R($.reason)),B.isCancelled=!0,delete this.streamSinks[Y];break;default:throw new Error("Unexpected stream case")}},I=new WeakSet,pn=async function($,Y){var at,Q,M;await Promise.allSettled([(at=$.startCall)==null?void 0:at.promise,(Q=$.pullCall)==null?void 0:Q.promise,(M=$.cancelCall)==null?void 0:M.promise]),delete this.streamControllers[Y]}},651:(o,b,d)=>{d.d(b,{MurmurHash3_64:()=>R});const e=3285377520,w=4294901760,v=65535;class R{constructor(k){this.h1=k?k&4294967295:e,this.h2=k?k&4294967295:e}update(k){let y,g;if(typeof k=="string"){y=new Uint8Array(k.length*2),g=0;for(let D=0,q=k.length;D<q;D++){const tt=k.charCodeAt(D);tt<=255?y[g++]=tt:(y[g++]=tt>>>8,y[g++]=tt&255)}}else if(ArrayBuffer.isView(k))y=k.slice(),g=y.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const G=g>>2,I=g-G*4,E=new Uint32Array(y.buffer,0,G);let H=0,$=0,Y=this.h1,at=this.h2;const Q=3432918353,M=461845907,U=Q&v,B=M&v;for(let D=0;D<G;D++)D&1?(H=E[D],H=H*Q&w|H*U&v,H=H<<15|H>>>17,H=H*M&w|H*B&v,Y^=H,Y=Y<<13|Y>>>19,Y=Y*5+3864292196):($=E[D],$=$*Q&w|$*U&v,$=$<<15|$>>>17,$=$*M&w|$*B&v,at^=$,at=at<<13|at>>>19,at=at*5+3864292196);switch(H=0,I){case 3:H^=y[G*4+2]<<16;case 2:H^=y[G*4+1]<<8;case 1:H^=y[G*4],H=H*Q&w|H*U&v,H=H<<15|H>>>17,H=H*M&w|H*B&v,G&1?Y^=H:at^=H}this.h1=Y,this.h2=at}hexdigest(){let k=this.h1,y=this.h2;return k^=y>>>1,k=k*3981806797&w|k*36045&v,y=y*4283543511&w|((y<<16|k>>>16)*2950163797&w)>>>16,k^=y>>>1,k=k*444984403&w|k*60499&v,y=y*3301882366&w|((y<<16|k>>>16)*3120437893&w)>>>16,k^=y>>>1,(k>>>0).toString(16).padStart(8,"0")+(y>>>0).toString(16).padStart(8,"0")}}},292:(o,b,d)=>{var a,gn,m,br;d.d(b,{AbortException:()=>ie,AnnotationBorderStyleType:()=>at,AnnotationEditorParamsType:()=>I,AnnotationEditorPrefix:()=>g,AnnotationEditorType:()=>G,AnnotationMode:()=>y,AnnotationPrefix:()=>p,AnnotationType:()=>Y,BaseException:()=>Et,CMapCompressionType:()=>M,FONT_IDENTITY_MATRIX:()=>v,FeatureTest:()=>Ce,FormatError:()=>Kt,IDENTITY_MATRIX:()=>w,ImageKind:()=>$,InvalidPDFException:()=>kt,LINE_FACTOR:()=>K,MAX_IMAGE_SIZE_TO_CACHE:()=>R,MissingPDFException:()=>Rt,OPS:()=>U,PasswordException:()=>Z,PasswordResponses:()=>B,PermissionFlag:()=>E,RenderingIntentFlag:()=>k,TextRenderingMode:()=>H,UnexpectedResponseException:()=>qt,UnknownErrorException:()=>gt,Util:()=>Ee,VerbosityLevel:()=>Q,assert:()=>Nt,bytesToString:()=>Se,createValidAbsoluteUrl:()=>Tt,getUuid:()=>c,getVerbosityLevel:()=>tt,info:()=>vt,isNodeJS:()=>e,normalizeUnicode:()=>n,objectFromMap:()=>ve,setVerbosityLevel:()=>q,shadow:()=>Pt,string32:()=>le,stringToBytes:()=>de,unreachable:()=>Ct,warn:()=>Ft});const e=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),w=[1,0,0,1,0,0],v=[.001,0,0,.001,0,0],R=1e7,K=1.35,k={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},y={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},g="pdfjs_internal_editor_",G={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},I={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},E={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},H={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},$={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Y={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},at={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Q={ERRORS:0,WARNINGS:1,INFOS:5},M={NONE:0,BINARY:1},U={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},B={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let D=Q.WARNINGS;function q(u){Number.isInteger(u)&&(D=u)}function tt(){return D}function vt(u){D>=Q.INFOS&&console.log(`Info: ${u}`)}function Ft(u){D>=Q.WARNINGS&&console.log(`Warning: ${u}`)}function Ct(u){throw new Error(u)}function Nt(u,r){u||Ct(r)}function _t(u){switch(u==null?void 0:u.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Tt(u,r=null,h=null){var T;if(!u)return null;try{if(h&&typeof u=="string"&&(h.addDefaultProtocol&&u.startsWith("www.")&&((T=u.match(/\./g))==null?void 0:T.length)>=2&&(u=`http://${u}`),h.tryConvertEncoding))try{u=ne(u)}catch{}const V=r?new URL(u,r):new URL(u);if(_t(V))return V}catch{}return null}function Pt(u,r,h,T=!1){return Object.defineProperty(u,r,{value:h,enumerable:!T,configurable:!0,writable:!1}),h}const Et=function(){function u(r,h){this.constructor===u&&Ct("Cannot initialize BaseException."),this.message=r,this.name=h}return u.prototype=new Error,u.constructor=u,u}();class Z extends Et{constructor(r,h){super(r,"PasswordException"),this.code=h}}class gt extends Et{constructor(r,h){super(r,"UnknownErrorException"),this.details=h}}class kt extends Et{constructor(r){super(r,"InvalidPDFException")}}class Rt extends Et{constructor(r){super(r,"MissingPDFException")}}class qt extends Et{constructor(r,h){super(r,"UnexpectedResponseException"),this.status=h}}class Kt extends Et{constructor(r){super(r,"FormatError")}}class ie extends Et{constructor(r){super(r,"AbortException")}}function Se(u){(typeof u!="object"||(u==null?void 0:u.length)===void 0)&&Ct("Invalid argument for bytesToString");const r=u.length,h=8192;if(r<h)return String.fromCharCode.apply(null,u);const T=[];for(let V=0;V<r;V+=h){const j=Math.min(V+h,r),rt=u.subarray(V,j);T.push(String.fromCharCode.apply(null,rt))}return T.join("")}function de(u){typeof u!="string"&&Ct("Invalid argument for stringToBytes");const r=u.length,h=new Uint8Array(r);for(let T=0;T<r;++T)h[T]=u.charCodeAt(T)&255;return h}function le(u){return String.fromCharCode(u>>24&255,u>>16&255,u>>8&255,u&255)}function ve(u){const r=Object.create(null);for(const[h,T]of u)r[h]=T;return r}function Vt(){const u=new Uint8Array(4);return u[0]=1,new Uint32Array(u.buffer,0,1)[0]===1}function ae(){try{return new Function(""),!0}catch{return!1}}class Ce{static get isLittleEndian(){return Pt(this,"isLittleEndian",Vt())}static get isEvalSupported(){return Pt(this,"isEvalSupported",ae())}static get isOffscreenCanvasSupported(){return Pt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?Pt(this,"platform",{isMac:navigator.platform.includes("Mac")}):Pt(this,"platform",{isMac:!1})}static get isCSSRoundSupported(){var r,h;return Pt(this,"isCSSRoundSupported",(h=(r=globalThis.CSS)==null?void 0:r.supports)==null?void 0:h.call(r,"width: round(1.5px, 1px)"))}}const ee=Array.from(Array(256).keys(),u=>u.toString(16).padStart(2,"0"));class Ee{static makeHexColor(r,h,T){return`#${ee[r]}${ee[h]}${ee[T]}`}static scaleMinMax(r,h){let T;r[0]?(r[0]<0&&(T=h[0],h[0]=h[2],h[2]=T),h[0]*=r[0],h[2]*=r[0],r[3]<0&&(T=h[1],h[1]=h[3],h[3]=T),h[1]*=r[3],h[3]*=r[3]):(T=h[0],h[0]=h[1],h[1]=T,T=h[2],h[2]=h[3],h[3]=T,r[1]<0&&(T=h[1],h[1]=h[3],h[3]=T),h[1]*=r[1],h[3]*=r[1],r[2]<0&&(T=h[0],h[0]=h[2],h[2]=T),h[0]*=r[2],h[2]*=r[2]),h[0]+=r[4],h[1]+=r[5],h[2]+=r[4],h[3]+=r[5]}static transform(r,h){return[r[0]*h[0]+r[2]*h[1],r[1]*h[0]+r[3]*h[1],r[0]*h[2]+r[2]*h[3],r[1]*h[2]+r[3]*h[3],r[0]*h[4]+r[2]*h[5]+r[4],r[1]*h[4]+r[3]*h[5]+r[5]]}static applyTransform(r,h){const T=r[0]*h[0]+r[1]*h[2]+h[4],V=r[0]*h[1]+r[1]*h[3]+h[5];return[T,V]}static applyInverseTransform(r,h){const T=h[0]*h[3]-h[1]*h[2],V=(r[0]*h[3]-r[1]*h[2]+h[2]*h[5]-h[4]*h[3])/T,j=(-r[0]*h[1]+r[1]*h[0]+h[4]*h[1]-h[5]*h[0])/T;return[V,j]}static getAxialAlignedBoundingBox(r,h){const T=this.applyTransform(r,h),V=this.applyTransform(r.slice(2,4),h),j=this.applyTransform([r[0],r[3]],h),rt=this.applyTransform([r[2],r[1]],h);return[Math.min(T[0],V[0],j[0],rt[0]),Math.min(T[1],V[1],j[1],rt[1]),Math.max(T[0],V[0],j[0],rt[0]),Math.max(T[1],V[1],j[1],rt[1])]}static inverseTransform(r){const h=r[0]*r[3]-r[1]*r[2];return[r[3]/h,-r[1]/h,-r[2]/h,r[0]/h,(r[2]*r[5]-r[4]*r[3])/h,(r[4]*r[1]-r[5]*r[0])/h]}static singularValueDecompose2dScale(r){const h=[r[0],r[2],r[1],r[3]],T=r[0]*h[0]+r[1]*h[2],V=r[0]*h[1]+r[1]*h[3],j=r[2]*h[0]+r[3]*h[2],rt=r[2]*h[1]+r[3]*h[3],ot=(T+rt)/2,yt=Math.sqrt((T+rt)**2-4*(T*rt-j*V))/2,At=ot+yt||1,ut=ot-yt||1;return[Math.sqrt(At),Math.sqrt(ut)]}static normalizeRect(r){const h=r.slice(0);return r[0]>r[2]&&(h[0]=r[2],h[2]=r[0]),r[1]>r[3]&&(h[1]=r[3],h[3]=r[1]),h}static intersect(r,h){const T=Math.max(Math.min(r[0],r[2]),Math.min(h[0],h[2])),V=Math.min(Math.max(r[0],r[2]),Math.max(h[0],h[2]));if(T>V)return null;const j=Math.max(Math.min(r[1],r[3]),Math.min(h[1],h[3])),rt=Math.min(Math.max(r[1],r[3]),Math.max(h[1],h[3]));return j>rt?null:[T,j,V,rt]}static bezierBoundingBox(r,h,T,V,j,rt,ot,yt,At){return At?(At[0]=Math.min(At[0],r,ot),At[1]=Math.min(At[1],h,yt),At[2]=Math.max(At[2],r,ot),At[3]=Math.max(At[3],h,yt)):At=[Math.min(r,ot),Math.min(h,yt),Math.max(r,ot),Math.max(h,yt)],S(this,m,br).call(this,r,T,j,ot,h,V,rt,yt,3*(-r+3*(T-j)+ot),6*(r-2*T+j),3*(T-r),At),S(this,m,br).call(this,r,T,j,ot,h,V,rt,yt,3*(-h+3*(V-rt)+yt),6*(h-2*V+rt),3*(V-h),At),At}}a=new WeakSet,gn=function(r,h,T,V,j,rt,ot,yt,At,ut){if(At<=0||At>=1)return;const xt=1-At,L=At*At,X=L*At,nt=xt*(xt*(xt*r+3*At*h)+3*L*T)+X*V,N=xt*(xt*(xt*j+3*At*rt)+3*L*ot)+X*yt;ut[0]=Math.min(ut[0],nt),ut[1]=Math.min(ut[1],N),ut[2]=Math.max(ut[2],nt),ut[3]=Math.max(ut[3],N)},m=new WeakSet,br=function(r,h,T,V,j,rt,ot,yt,At,ut,xt,L){if(Math.abs(At)<1e-12){Math.abs(ut)>=1e-12&&S(this,a,gn).call(this,r,h,T,V,j,rt,ot,yt,-xt/ut,L);return}const X=ut**2-4*xt*At;if(X<0)return;const nt=Math.sqrt(X),N=2*At;S(this,a,gn).call(this,r,h,T,V,j,rt,ot,yt,(-ut+nt)/N,L),S(this,a,gn).call(this,r,h,T,V,j,rt,ot,yt,(-ut-nt)/N,L)},l(Ee,a),l(Ee,m);function ne(u){return decodeURIComponent(escape(u))}let et=null,i=null;function n(u){return et||(et=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,i=new Map([["\uFB05","\u017Ft"]])),u.replaceAll(et,(r,h,T)=>h?h.normalize("NFKC"):i.get(T))}function c(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const u=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(u);else for(let r=0;r<32;r++)u[r]=Math.floor(Math.random()*255);return Se(u)}const p="pdfjs_internal_id_"}},Rr={};function Ms(o){var b=Rr[o];if(b!==void 0)return b.exports;var d=Rr[o]={exports:{}};return $o[o](d,d.exports,Ms),d.exports}(()=>{var o=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",b=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",d=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",e=v=>{v&&v.d<1&&(v.d=1,v.forEach(R=>R.r--),v.forEach(R=>R.r--?R.r++:R()))},w=v=>v.map(R=>{if(R!==null&&typeof R=="object"){if(R[o])return R;if(R.then){var K=[];K.d=0,R.then(g=>{k[b]=g,e(K)},g=>{k[d]=g,e(K)});var k={};return k[o]=g=>g(K),k}}var y={};return y[o]=g=>{},y[b]=R,y});Ms.a=(v,R,K)=>{var k;K&&((k=[]).d=-1);var y=new Set,g=v.exports,G,I,E,H=new Promise(($,Y)=>{E=Y,I=$});H[b]=g,H[o]=$=>(k&&$(k),y.forEach($),H.catch(Y=>{})),v.exports=H,R($=>{G=w($);var Y,at=()=>G.map(M=>{if(M[d])throw M[d];return M[b]}),Q=new Promise(M=>{Y=()=>M(at),Y.r=0;var U=B=>B!==k&&!y.has(B)&&(y.add(B),B&&!B.d&&(Y.r++,B.push(Y)));G.map(B=>B[o](U))});return Y.r?Q:at()},$=>($?E(H[d]=$):I(g),e(k))),k&&k.d<0&&(k.d=0)}})(),Ms.d=(o,b)=>{for(var d in b)Ms.o(b,d)&&!Ms.o(o,d)&&Object.defineProperty(o,d,{enumerable:!0,get:b[d]})},Ms.o=(o,b)=>Object.prototype.hasOwnProperty.call(o,b);var ge=Ms(228);ge=globalThis.pdfjsLib=await(globalThis.pdfjsLibPromise=ge),ge.AbortException,ge.AnnotationEditorLayer,ge.AnnotationEditorParamsType,ge.AnnotationEditorType,ge.AnnotationEditorUIManager,ge.AnnotationLayer,ge.AnnotationMode,ge.CMapCompressionType,ge.ColorPicker,ge.DOMSVGFactory,ge.DrawLayer,ge.FeatureTest;var Ir=ge.GlobalWorkerOptions;ge.ImageKind,ge.InvalidPDFException,ge.MissingPDFException,ge.OPS,ge.Outliner,ge.PDFDataRangeTransport,ge.PDFDateString,ge.PDFWorker,ge.PasswordResponses,ge.PermissionFlag,ge.PixelsPerInch,ge.RenderingCancelledException,ge.UnexpectedResponseException,ge.Util,ge.VerbosityLevel,ge.XfaLayer,ge.build,ge.createValidAbsoluteUrl,ge.fetchData;var Fr=ge.getDocument;ge.getFilenameFromUrl,ge.getPdfFilenameFromUrl,ge.getXfaPageViewport,ge.isDataScheme,ge.isPdfFile,ge.noContextMenu,ge.normalizeUnicode,ge.renderTextLayer,ge.setLayerDimensions,ge.shadow,ge.updateTextLayer,ge.version;var Dr={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const Or=Dr.VITE_PDF_CMAPS,Nr=Dr.VITE_PDF_WORKER;class Uo{constructor(b,d=2){if(!b||!b.dataset.url)throw new Error("invalid element!");this.element=b,this.url=b.dataset.url,this.scale=d,this.data=[]}loading(b){b?this.element.classList.add("pdf-preview__loading"):this.element.classList.remove("pdf-preview__loading")}blobtoDataUrl(b){return new Promise(d=>{const e=new FileReader;e.readAsDataURL(b),e.onload=()=>{d(e.result.replace("data:application/pdf;base64,",""))}})}draw(b){Ir.workerSrc=Nr,Fr({data:atob(b),cMapUrl:Or,cMapPacked:!0}).promise.then(async d=>{for(let e=1;e<=d.numPages;e++)await this.getPage(e,d)},d=>{console.error(d)}).then(()=>{const d=document.createElement("img");d.setAttribute("class","pdf-preview__image"),d.onload=()=>{this.element.addEventListener("click",this.display(this.data)),this.element.appendChild(d),this.loading(!1)},d.src=this.data[0]})}display(b){}async getPage(b,d){const e=this.scale,w=this.data;return new Promise(v=>{d.getPage(b).then(function(R){var K=R.getViewport({scale:e});let k=200/72;var y=document.createElement("canvas"),g=y.getContext("2d");y.height=K.height*k,y.width=K.width*k;var G={canvasContext:g,viewport:K,transform:[k,0,0,k,0,0]},I=R.render(G);I.promise.then(async()=>{w.push(y.toDataURL("image/png")),v()})})})}async fetchFile(){return this.loading(!0),fetch(this.url,{headers:{"Content-Type":"application/pdf"}}).then(b=>b.blob()).then(b=>{var d=new Blob([b],{type:"application/pdf"});return An(d)}).then(b=>this.draw(b))}}class Hr{constructor(b,d=2,e=(w,v)=>{}){if(!b||!b.dataset.url)throw new Error("PdfConvert: failed to instanciate");this.element=b,this.url=b.dataset.url,this.scale=d,this.data=[],this.callback=e}async init(){fetch(this.url,{headers:{"Content-Type":"application/pdf"}}).then(b=>b.blob()).then(b=>{var d=new Blob([b],{type:"application/pdf"});return An(d)}).then(b=>this.convertFiles(b)).catch(b=>{this.loading=!1,this.error=b})}async blobInit(){var b=Ze(this.url,"application/pdf");An(b).then(d=>this.convertFiles(d)).catch(d=>{this.loading=!1,this.error=d})}convertFiles(b){Ir.workerSrc=Nr,Fr({data:atob(b),cMapUrl:Or,cMapPacked:!0}).promise.then(async d=>{for(let e=1;e<=d.numPages;e++)await this.pdf2png(e,d)},d=>{console.error(d)}).then(()=>{this.callback(this.data,this.element)})}async pdf2png(b,d){const e=this.scale,w=this.data;return new Promise(v=>{d.getPage(b).then(function(R){var K=R.getViewport({scale:e});let k=200/72;var y=document.createElement("canvas"),g=y.getContext("2d");y.height=K.height*k,y.width=K.width*k;var G={canvasContext:g,viewport:K,transform:[k,0,0,k,0,0]},I=R.render(G);I.promise.then(async()=>{w.push(y.toDataURL("image/png")),v()})})})}}function Vo(o,b){var d="application/"+b;if(b=="pdf")var e=Ze(o,d);else if(b=="zip")var e=Ze(o,"application/"+b);else if(b=="jpg"||b=="png"||b=="pptx")var e=Ze("data:image/"+b+";base64,"+o,d);else if(b=="doc")var e=Ze("data:application/msword;base64,"+o,d);else if(b=="xls")var e=Ze("data:application/vnd.ms-excel;base64,"+o,d);else if(b=="docx")var e=Ze("data:application/vnd.openxmlformats-officedocument.wordprocessingml.document;base64,"+o,d);else if(b=="xlsx")var e=Ze("data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"+o,d);else if(b=="ppt")var e=Ze("data:application/vnd.ms-powerpoint;base64,"+o,d);else if(b=="txt"||b=="TXT")var e=Ze("data:text/plain;base64,"+o,d);else if(b=="csv"||b=="CSV")var e=Ze("data:text/csv;base64,"+o,d);else if(b=="tsv"||b=="TSV")var e=Ze("data:text/tab-separated-values;base64,"+o,d);else if(b=="svg"||b=="SVG")var e=Ze("data:image/svg+xml;base64,"+o,d);else return;var w=(window.URL||window.webkitURL).createObjectURL(e);return w}function Ze(o,b){const d=atob(o),e=new Uint8Array(d.length);for(let w=0;w<d.length;w++)e[w]=d.charCodeAt(w);return new Blob([e.buffer],{type:b})}function An(o){return new Promise(b=>{const d=new FileReader;d.readAsDataURL(o),d.onload=()=>{b(d.result.replace("data:application/pdf;base64,",""))}})}document.querySelectorAll('[data-role="additionalFiles"]').forEach(o=>{const b=o.dataset.fileData,d=o.dataset.extension,e=Vo(b,d);o.download="test",o.href=e}),document.querySelectorAll('[data-role="pdf-preview"]').forEach(o=>{new Uo(o).fetchFile()}),document.querySelectorAll('[data-role="pdf-preview-dl"]').forEach(o=>{const b=e=>function w(){w.read||(w.read=Math.abs(this.scrollHeight-this.clientHeight-this.scrollTop)<1,w.read&&window.dispatchEvent(new CustomEvent("readend",{detail:e})))},d=(e,w)=>{const v=document.createElement("div");v.classList.add("pdf-preview__container"),e.forEach((R,K)=>{const k=document.createElement("img");k.classList.add("pdf-popup__img"),k.onload=()=>{if(v.appendChild(k),K===e.length-1){w.innerHTML=null,w.appendChild(v);const y=document.querySelectorAll('[data-role="scroll-check"]');window.addEventListener("readend",g=>{const G=document.querySelector(g.detail);G&&(G.disabled=!1)}),y.forEach(g=>{document.querySelector(g.dataset.target).addEventListener("scroll",b(`#${g.id}`))})}},k.src=R})};new Hr(o,2,d).init()}),document.querySelectorAll('[data-role="pdf-preview-dl-blob"]').forEach(o=>{const b=e=>function w(){w.read||(w.read=Math.abs(this.scrollHeight-this.clientHeight-this.scrollTop)<1,w.read&&window.dispatchEvent(new CustomEvent("readend",{detail:e})))},d=(e,w)=>{const v=document.createElement("div");v.classList.add("pdf-preview__container"),e.forEach((R,K)=>{const k=document.createElement("img");k.classList.add("pdf-popup__img"),k.onload=()=>{if(v.appendChild(k),K===e.length-1){w.innerHTML=null,w.appendChild(v);const y=document.querySelectorAll('[data-role="scroll-check"]');window.addEventListener("readend",g=>{const G=document.querySelector(g.detail);G&&(G.disabled=!1)}),y.forEach(g=>{document.querySelector(g.dataset.target).addEventListener("scroll",b(`#${g.id}`))})}},k.src=R})};new Hr(o,2,d).blobInit()}),document.querySelectorAll('[data-role="pdf-popup-btn"]').forEach(o=>{o.addEventListener("click",()=>{document.querySelector(o.dataset.target).classList.toggle("pdf-popup__hidden")})}),document.querySelectorAll('[data-role="scroll-check-btn"]').forEach(o=>{document.querySelector(o.dataset.target).addEventListener("change",b=>{o.disabled=!b.target.checked}),o.addEventListener("click",()=>{document.querySelector(o.dataset.download).click();const b=document.querySelector(`[name="${o.dataset.result}"]`);b.value=new Date().toISOString(),b.dispatchEvent(new Event("change")),document.querySelector(o.dataset.modal).classList.toggle("pdf-popup__hidden")})}),document.querySelectorAll('[data-role="download-result-display"]').forEach(o=>{document.querySelector(`[name="${o.dataset.target}"]`).addEventListener("change",b=>{o.textContent=b.target.value.length===0?"\u672A\u627F\u8AFE":`\u627F\u8AFE\u6E08\u307F ${b.target.value.slice(0,10)}`})}),document.querySelectorAll('[data-role="file-display"]').forEach(o=>{const b=o.dataset.fileData,d="data:image/"+o.dataset.extension+";base64,"+b;o.src=d});const Br=document.querySelector('[data-role="zip-search_input"]'),ki=document.querySelector('[data-role="zip-search_btn"'),jo=document.querySelector("#prefecture"),Go=document.querySelector("#city"),qo=document.querySelector("#street"),zo=document.querySelector("#js-zip_error"),Wo="https://api.zipaddress.net/";var yn="",Ri="";Br&&ki&&(Br.addEventListener("input",Ko),ki.addEventListener("click",Yo));async function Xo(){const o=`${Wo}?zipcode=${yn}`;return fetch(o).then(b=>b.json()).then(b=>b.code!==200?{data:b.message,error:!0}:{data:b.data,error:!1})}function Ko(o){const b=o.target.value;ki.disabled=!0,Ri="",b.length===7?(yn=b,ki.disabled=!1):b.length!=0&&(Ri="7\u6841\u306E\u6570\u5B57\u3092\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044\u3002"),$r()}async function Yo(){var o;if(yn.length===7){const b=await Xo();if(b.error){Ri=b.data,$r();return}jo.value=_n[o=b.data.pref]??(_n[o]=""),Go.value=b.data.city,qo.value=b.data.town}}function $r(){zo.textContent=Ri}const _n={\u5317\u6D77\u9053:1,\u9752\u68EE\u770C:2,\u5CA9\u624B\u770C:3,\u5BAE\u57CE\u770C:4,\u79CB\u7530\u770C:5,\u5C71\u5F62\u770C:6,\u798F\u5CF6\u770C:7,\u8328\u57CE\u770C:8,\u6803\u6728\u770C:9,\u7FA4\u99AC\u770C:10,\u57FC\u7389\u770C:11,\u5343\u8449\u770C:12,\u6771\u4EAC\u90FD:13,\u795E\u5948\u5DDD\u770C:14,\u65B0\u6F5F\u770C:15,\u5BCC\u5C71\u770C:16,\u77F3\u5DDD\u770C:17,\u798F\u4E95\u770C:18,\u5C71\u68A8\u770C:19,\u9577\u91CE\u770C:20,\u5C90\u961C\u770C:21,\u9759\u5CA1\u770C:22,\u611B\u77E5\u770C:23,\u4E09\u91CD\u770C:24,\u6ECB\u8CC0\u770C:25,\u4EAC\u90FD\u5E9C:26,\u5927\u962A\u5E9C:27,\u5175\u5EAB\u770C:28,\u5948\u826F\u770C:29,\u548C\u6B4C\u5C71\u770C:30,\u9CE5\u53D6\u770C:31,\u5CF6\u6839\u770C:32,\u5CA1\u5C71\u770C:33,\u5E83\u5CF6\u770C:34,\u5C71\u53E3\u770C:35,\u5FB3\u5CF6\u770C:36,\u9999\u5DDD\u770C:37,\u611B\u5A9B\u770C:38,\u9AD8\u77E5\u770C:39,\u798F\u5CA1\u770C:40,\u4F50\u8CC0\u770C:41,\u9577\u5D0E\u770C:42,\u718A\u672C\u770C:43,\u5927\u5206\u770C:44,\u5BAE\u5D0E\u770C:45,\u9E7F\u5150\u5CF6\u770C:46,\u6C96\u7E04\u770C:47};document.querySelectorAll(".searh-dropdown").forEach(o=>{const b=o.querySelector("button"),d=o.querySelector(".search-dropdown__list"),e=o.querySelector(".search-dropdown__input"),w=o.querySelector(".search-dropdown__items"),v=o.querySelectorAll(".search-dropdown__items>li"),R=o.querySelector(".search-dropdown__back"),K=Array.from(v).map(g=>g);b.addEventListener("click",()=>{const{bottom:g,left:G}=o.getBoundingClientRect();d.style.left=`${G}px`,d.style.top=`${g+4}px`,k()}),R.addEventListener("click",()=>{k()}),d.addEventListener("click",g=>{g.stopPropagation()}),e.addEventListener("input",g=>{let G=K;if(w.replaceChildren(),g.target.value.length>0&&(G=G.filter(I=>new RegExp(g.target.value).test(I.textContent)).map(I=>I)),G.length===0){const I=document.createElement("li");I.textContent="items not found",w.appendChild(I)}G.forEach(I=>{const E=document.createElement("li");E.innerHTML=I.innerHTML,E.addEventListener("click",y),w.appendChild(E)})}),v.forEach(g=>g.addEventListener("click",y));function k(){d.classList.toggle("search-dropdown__list_show"),b.classList.toggle("searh-dropdown__btn_active")}function y(g){b.textContent=g.target.textContent,k()}})})();
