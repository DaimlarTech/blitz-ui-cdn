var ih=Object.defineProperty;var nh=(Pe,Ie,Oe)=>Ie in Pe?ih(Pe,Ie,{enumerable:!0,configurable:!0,writable:!0,value:Oe}):Pe[Ie]=Oe;var me=(Pe,Ie,Oe)=>(nh(Pe,typeof Ie!="symbol"?Ie+"":Ie,Oe),Oe),Tn=(Pe,Ie,Oe)=>{if(!Ie.has(Pe))throw TypeError("Cannot "+Oe)};var t=(Pe,Ie,Oe)=>(Tn(Pe,Ie,"read from private field"),Oe?Oe.call(Pe):Ie.get(Pe)),l=(Pe,Ie,Oe)=>{if(Ie.has(Pe))throw TypeError("Cannot add the same private member more than once");Ie instanceof WeakSet?Ie.add(Pe):Ie.set(Pe,Oe)},I=(Pe,Ie,Oe,Cs)=>(Tn(Pe,Ie,"write to private field"),Cs?Cs.call(Pe,Oe):Ie.set(Pe,Oe),Oe);var bs=(Pe,Ie,Oe,Cs)=>({set _(wr){I(Pe,Ie,wr,Oe)},get _(){return t(Pe,Ie,Cs)}}),T=(Pe,Ie,Oe)=>(Tn(Pe,Ie,"access private method"),Oe);(async()=>{(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))c(e);new MutationObserver(e=>{for(const w of e)if(w.type==="childList")for(const m of w.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&c(m)}).observe(document,{childList:!0,subtree:!0});function p(e){const w={};return e.integrity&&(w.integrity=e.integrity),e.referrerPolicy&&(w.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?w.credentials="include":e.crossOrigin==="anonymous"?w.credentials="omit":w.credentials="same-origin",w}function c(e){if(e.ep)return;e.ep=!0;const w=p(e);fetch(e.href,w)}})();const Pe=document.querySelectorAll(".navigation-drawer"),Ie=document.querySelectorAll(".navigation-drawer__dialog"),Oe=document.querySelectorAll('[data-role="drawer"]');Oe.forEach(r=>r.addEventListener("click",Cs)),Pe.forEach(r=>r.addEventListener("click",Cs)),Ie.forEach(r=>r.addEventListener("click",p=>{p.stopPropagation()}));function Cs(){Pe.forEach(r=>r.classList.toggle("drawer_show")),Oe.forEach(r=>r.classList.toggle("toggler_show"))}document.addEventListener("DOMContentLoaded",function(){const r=document.getElementById("agreement-box"),p=document.getElementById("agreement-check"),c=document.getElementById("agree_chk_id");if(c&&r){let e=function(m,x){let W;return function(...k){const y=()=>{clearTimeout(W),m(...k)};clearTimeout(W),W=setTimeout(y,x)}},w=function(){Math.abs(r.scrollHeight-r.clientHeight-r.scrollTop)<=1&&c.disabled&&(c.disabled=!1,p.classList.remove("check-disabled"),p.classList.add("check-enabled"),c.classList.add("check-enabled"))};c.disabled=!0,r.addEventListener("scroll",e(w,100)),window.addEventListener("load",w)}}),document.addEventListener("DOMContentLoaded",function(){const r="noantisocial",p="edelivery",c=document.getElementById("confirmButton");if(c){let e=function(){const m=document.getElementById(r).checked,x=document.getElementById(p).checked;c.disabled=!(m&&x)},w=function(m,x,W,k,y,f,O){const C=document.getElementById(m),_=document.getElementById(x),D=document.getElementById(W),U=document.getElementById(k),Y=document.getElementById(y),at=document.getElementById(f),Q=document.getElementById(O);U.disabled=!0,Y.disabled=!0;function L(){let V=!(_.clientHeight<D.scrollHeight)||_.scrollHeight-_.scrollTop<=_.clientHeight+1;U.disabled=!V}C.addEventListener("shown.bs.modal",function(){L(),_.addEventListener("scroll",L)}),U.addEventListener("click",function(){this.disabled||(at.style.display="none",Y.disabled=!1,Q.classList.remove("check-disabled"),Q.classList.add("check-enabled"),Y.classList.remove("check-disabled"),Y.classList.add("check-enabled"))}),Y.addEventListener("change",e)};c.disabled=!0,w("noantisocialModal","noantisocialBox","noantisocialItem","noantisocialButton",r,"noantisocialText","noantisocialLabel"),w("edeliveryModal","edeliveryBox","edeliveryItem","edeliveryButton",p,"edeliveryText","edeliveryLabel"),e()}}),document.querySelectorAll('[data-role="zengin-input"]').forEach(r=>{r.addEventListener("blur",so)});function so(r){let p=r.target.value;if(p){const c=io(p);r.target.value=c}}function io(r){const p=/[^0-9A-Zｱｲｳｴｵｶｷｸｹｺｻｼｽｾｿﾀﾁﾂﾃﾄﾅﾆﾇﾈﾉﾊﾋﾌﾍﾎﾏﾐﾑﾒﾓﾔﾕﾖﾗﾘﾙﾚﾛﾜﾝﾞﾟ\(\)｢｣\/\-\.\\ ]/g,c=["\uFF70","\uFF67","\uFF68","\uFF69","\uFF6A","\uFF6B","\uFF6F","\uFF6C","\uFF6D","\uFF6E","\uFF08","\uFF09"],e=["-","\uFF71","\uFF72","\uFF73","\uFF74","\uFF75","\uFF82","\uFF94","\uFF95","\uFF96","(",")"];let w;return w=r.toUpperCase(),w=no(w,"khsa"),c.forEach((m,x)=>{w=w.replaceAll(m,e[x])}),w=w.replace(p,""),w}function no(r,p){var c,e,w,m,x,W;if(c=["\uFF76\uFF9E","\uFF77\uFF9E","\uFF78\uFF9E","\uFF79\uFF9E","\uFF7A\uFF9E","\uFF7B\uFF9E","\uFF7C\uFF9E","\uFF7D\uFF9E","\uFF7E\uFF9E","\uFF7F\uFF9E","\uFF80\uFF9E","\uFF81\uFF9E","\uFF82\uFF9E","\uFF83\uFF9E","\uFF84\uFF9E","\uFF8A\uFF9E","\uFF8A\uFF9F","\uFF8B\uFF9E","\uFF8B\uFF9F","\uFF8C\uFF9E","\uFF8C\uFF9F","\uFF8D\uFF9E","\uFF8D\uFF9F","\uFF8E\uFF9E","\uFF8E\uFF9F","\uFF73\uFF9E","\uFF70","\uFF67","\uFF71","\uFF68","\uFF72","\uFF69","\uFF73","\uFF6A","\uFF74","\uFF6B","\uFF75","\uFF76","\uFF77","\uFF78","\uFF79","\uFF7A","\uFF7B","\uFF7C","\uFF7D","\uFF7E","\uFF7F","\uFF80","\uFF81","\uFF6F","\uFF82","\uFF83","\uFF84","\uFF85","\uFF86","\uFF87","\uFF88","\uFF89","\uFF8A","\uFF8B","\uFF8C","\uFF8D","\uFF8E","\uFF8F","\uFF90","\uFF91","\uFF92","\uFF93","\uFF6C","\uFF94","\uFF6D","\uFF95","\uFF6E","\uFF96","\uFF97","\uFF98","\uFF99","\uFF9A","\uFF9B","\uFF9C","\uFF66","\uFF9D","\uFF76","\uFF79","\uFF9C","\uFF72","\uFF74","\uFF9E","\uFF9F"],e=["\u30AC","\u30AE","\u30B0","\u30B2","\u30B4","\u30B6","\u30B8","\u30BA","\u30BC","\u30BE","\u30C0","\u30C2","\u30C5","\u30C7","\u30C9","\u30D0","\u30D1","\u30D3","\u30D4","\u30D6","\u30D7","\u30D9","\u30DA","\u30DC","\u30DD","\u30F4","\u30FC","\u30A1","\u30A2","\u30A3","\u30A4","\u30A5","\u30A6","\u30A7","\u30A8","\u30A9","\u30AA","\u30AB","\u30AD","\u30AF","\u30B1","\u30B3","\u30B5","\u30B7","\u30B9","\u30BB","\u30BD","\u30BF","\u30C1","\u30C3","\u30C4","\u30C6","\u30C8","\u30CA","\u30CB","\u30CC","\u30CD","\u30CE","\u30CF","\u30D2","\u30D5","\u30D8","\u30DB","\u30DE","\u30DF","\u30E0","\u30E1","\u30E2","\u30E3","\u30E4","\u30E5","\u30E6","\u30E7","\u30E8","\u30E9","\u30EA","\u30EB","\u30EC","\u30ED","\u30EF","\u30F2","\u30F3","\u30F5","\u30F6","\u30EE","\u30F0","\u30F1","\u309B","\u309C"],w=["\u304C","\u304E","\u3050","\u3052","\u3054","\u3056","\u3058","\u305A","\u305C","\u305E","\u3060","\u3062","\u3065","\u3067","\u3069","\u3070","\u3071","\u3073","\u3074","\u3076","\u3077","\u3079","\u307A","\u307C","\u307D","\u30F4","\u30FC","\u3041","\u3042","\u3043","\u3044","\u3045","\u3046","\u3047","\u3048","\u3049","\u304A","\u304B","\u304D","\u304F","\u3051","\u3053","\u3055","\u3057","\u3059","\u305B","\u305D","\u305F","\u3061","\u3063","\u3064","\u3066","\u3068","\u306A","\u306B","\u306C","\u306D","\u306E","\u306F","\u3072","\u3075","\u3078","\u307B","\u307E","\u307F","\u3080","\u3081","\u3082","\u3083","\u3084","\u3085","\u3086","\u3087","\u3088","\u3089","\u308A","\u308B","\u308C","\u308D","\u308F","\u3092","\u3093","\u304B","\u3051","\u308E","\u3090","\u3091","\u309B","\u309C"],m=c.length,p.match(/[ra]/)&&(r=r.replace(/[Ａ-ｚ]/g,function(k){return String.fromCharCode(parseInt(k.charCodeAt(0))-65248)})),p.match(/[RA]/)&&(r=r.replace(/[A-z]/g,function(k){return String.fromCharCode(parseInt(k.charCodeAt(0))+65248)})),p.match(/[na]/)&&(r=r.replace(/[０-９]/g,function(k){return String.fromCharCode(parseInt(k.charCodeAt(0))-65248)})),p.match(/[NA]/)&&(r=r.replace(/[0-9]/g,function(k){return String.fromCharCode(parseInt(k.charCodeAt(0))+65248)})),p.match(/s/)&&(r=r.replace(/　/g," ")),p.match(/S/)&&(r=r.replace(/ /g,"\u3000")),p.match(/k/))for(x=0;x<m;x++)W=new RegExp(e[x],"g"),r=r.replace(W,c[x]);if(p.match(/K/))for(p.match(/V/)||(r=r.replace(/ﾞ/g,"\u309B"),r=r.replace(/ﾟ/g,"\u309C")),x=0;x<m;x++)W=new RegExp(c[x],"g"),r=r.replace(W,e[x]);if(p.match(/h/))for(x=0;x<m;x++)W=new RegExp(w[x],"g"),r=r.replace(W,c[x]);if(p.match(/H/))for(p.match(/V/)||(r=r.replace(/ﾞ/g,"\u309B"),r=r.replace(/ﾟ/g,"\u309C")),x=0;x<m;x++)W=new RegExp(c[x],"g"),r=r.replace(W,w[x]);if(p.match(/c/))for(x=0;x<m;x++)W=new RegExp(e[x],"g"),r=r.replace(W,w[x]);if(p.match(/C/))for(x=0;x<m;x++)W=new RegExp(w[x],"g"),r=r.replace(W,e[x]);return r}document.querySelectorAll('[data-role="toggle-input--btn"]').forEach(r=>{r.addEventListener("click",p=>{const c=p.target.dataset.group;document.querySelectorAll(`[data-group="${c}"][data-role="toggle-input--value"], [data-group="${c}"][data-role="toggle-input--input"]`).forEach(e=>{e.classList.toggle("toggle-input_show")})})});const ro=document.querySelectorAll('[data-role="resize"]');window.addEventListener("load",()=>{ro.forEach(r=>{const p=r.dataset.field,c=document.querySelector(`[name="uploadFilesBlock${p}"]`),e=document.querySelector(`input[name='selectFiles${p}']`),w=document.createElement("div"),m=document.createElement("div"),x=document.createElement("div"),W=document.createElement("input"),k=document.createElement("p"),y=document.createElement("button");W.setAttribute("type","file"),W.style.display="none",W.addEventListener("change",f=>{const O=f.target.files[0];Er(O,e)}),m.appendChild(w),m.classList.add("coverDiv"),m.addEventListener("dragstart",f=>{f.dataTransfer.clearData(),bn(f)}),m.addEventListener("dragover",f=>{bn(f)}),m.addEventListener("dragleave",f=>{}),m.addEventListener("drop",f=>{bn(f);const O=f.target.files||f.dataTransfer.files;O.length>0&&Er(O[0],e)}),w.appendChild(x),w.classList.add("sp-flex-align-center","sp-flex-content-center","sp-flex","sp-from-file-default-drag-drop-area"),w.addEventListener("dragover",f=>{w.classList.remove("sp-from-file-ondragleave-drag-drop-area"),w.classList.remove("sp-from-file-ondrop-drag-drop-area"),w.classList.add("sp-from-file-ondraghover-drag-drop-area")}),w.addEventListener("dragleave",f=>{w.classList.add("sp-from-file-ondragleave-drag-drop-area"),w.classList.remove("sp-from-file-ondrop-drag-drop-area"),w.classList.remove("sp-from-file-ondraghover-drag-drop-area")}),w.addEventListener("drop",f=>{w.classList.remove("sp-from-file-ondragleave-drag-drop-area"),w.classList.add("sp-from-file-ondrop-drag-drop-area"),w.classList.remove("sp-from-file-ondraghover-drag-drop-area")}),x.appendChild(k),x.appendChild(y),x.appendChild(W),k.textContent="\u3053\u3053\u306B\u30D5\u30A1\u30A4\u30EB\u3092\u30C9\u30ED\u30C3\u30D7\u3057\u3066\u304F\u3060\u3055\u3044",k.classList.add("small"),y.type="button",y.textContent="\u30D5\u30A1\u30A4\u30EB\u53C2\u7167",y.classList.add("sp-form-file-button"),y.addEventListener("click",()=>W.click()),W.accept=".jpg,.png,.jpeg,.webp",c.style.position="relative",c.appendChild(m)})});const ao=/^(image\/jpg|image\/jpeg|image\/png|image\/webp)$/,oo=256;async function Er(r,p){if(!p)throw new Error("spiral input not found");const c=ho(r)?await lo(r):r,e=new DataTransfer;e.items.add(c),p.files=e.files,p.dispatchEvent(new Event("change"))}function ho(r){return!(!r.type.match(ao)||r.name>oo)}function lo(r){const p=r.name.split(".").slice(0,-1).join(".");let c=new FileReader;return new Promise((e,w)=>{c.onload=async()=>{const m=c.result,x=await co(m),W=await(await fetch(x)).blob();e(new File([W],`${p}.jpeg`,{type:"image/jpeg"}))},c.readAsDataURL(r)})}async function co(r){const p=await new Promise((m,x)=>{const W=new Image;W.onload=()=>{m(W)},W.onerror=()=>{x()},W.src=r}),c=document.createElement("canvas");let e=p.naturalWidth,w=p.naturalHeight;for(;e*w>5e5;)e/=10,w/=10;return c.width=e,c.height=w,c.getContext("2d").drawImage(p,0,0,e,w),c.toDataURL("image/jpeg")}function bn(r){r.stopPropagation(),r.preventDefault()}const Sr=document.querySelector('[data-role="zip-search_input"]'),Pi=document.querySelector('[data-role="zip-search_btn"'),uo=document.querySelector("#prefecture"),po=document.querySelector("#city"),go=document.querySelector("#street"),fo=document.querySelector("#js-zip_error"),mo="https://api.zipaddress.net/";var vn="",Ii="";Sr&&Pi&&(Sr.addEventListener("input",vo),Pi.addEventListener("click",Ao));async function bo(){const r=`${mo}?zipcode=${vn}`;return fetch(r).then(p=>p.json()).then(p=>p.code!==200?{data:p.message,error:!0}:{data:p.data,error:!1})}function vo(r){const p=r.target.value;Pi.disabled=!0,Ii="",p.length===7?(vn=p,Pi.disabled=!1):p.length!=0&&(Ii="7\u6841\u306E\u6570\u5B57\u3092\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044\u3002"),xr()}async function Ao(){var r;if(vn.length===7){const p=await bo();if(p.error){Ii=p.data,xr();return}uo.value=An[r=p.data.pref]??(An[r]=""),po.value=p.data.city,go.value=p.data.town}}function xr(){fo.textContent=Ii}const An={\u5317\u6D77\u9053:1,\u9752\u68EE\u770C:2,\u5CA9\u624B\u770C:3,\u5BAE\u57CE\u770C:4,\u79CB\u7530\u770C:5,\u5C71\u5F62\u770C:6,\u798F\u5CF6\u770C:7,\u8328\u57CE\u770C:8,\u6803\u6728\u770C:9,\u7FA4\u99AC\u770C:10,\u57FC\u7389\u770C:11,\u5343\u8449\u770C:12,\u6771\u4EAC\u90FD:13,\u795E\u5948\u5DDD\u770C:14,\u65B0\u6F5F\u770C:15,\u5BCC\u5C71\u770C:16,\u77F3\u5DDD\u770C:17,\u798F\u4E95\u770C:18,\u5C71\u68A8\u770C:19,\u9577\u91CE\u770C:20,\u5C90\u961C\u770C:21,\u9759\u5CA1\u770C:22,\u611B\u77E5\u770C:23,\u4E09\u91CD\u770C:24,\u6ECB\u8CC0\u770C:25,\u4EAC\u90FD\u5E9C:26,\u5927\u962A\u5E9C:27,\u5175\u5EAB\u770C:28,\u5948\u826F\u770C:29,\u548C\u6B4C\u5C71\u770C:30,\u9CE5\u53D6\u770C:31,\u5CF6\u6839\u770C:32,\u5CA1\u5C71\u770C:33,\u5E83\u5CF6\u770C:34,\u5C71\u53E3\u770C:35,\u5FB3\u5CF6\u770C:36,\u9999\u5DDD\u770C:37,\u611B\u5A9B\u770C:38,\u9AD8\u77E5\u770C:39,\u798F\u5CA1\u770C:40,\u4F50\u8CC0\u770C:41,\u9577\u5D0E\u770C:42,\u718A\u672C\u770C:43,\u5927\u5206\u770C:44,\u5BAE\u5D0E\u770C:45,\u9E7F\u5150\u5CF6\u770C:46,\u6C96\u7E04\u770C:47};document.querySelectorAll(".searh-dropdown").forEach(r=>{const p=r.querySelector("button"),c=r.querySelector(".search-dropdown__list"),e=r.querySelector(".search-dropdown__input"),w=r.querySelector(".search-dropdown__items"),m=r.querySelectorAll(".search-dropdown__items>li"),x=r.querySelector(".search-dropdown__back"),W=Array.from(m).map(f=>f);p.addEventListener("click",()=>{const{bottom:f,left:O}=r.getBoundingClientRect();c.style.left=`${O}px`,c.style.top=`${f+4}px`,k()}),x.addEventListener("click",()=>{k()}),c.addEventListener("click",f=>{f.stopPropagation()}),e.addEventListener("input",f=>{let O=W;if(w.replaceChildren(),f.target.value.length>0&&(O=O.filter(C=>new RegExp(f.target.value).test(C.textContent)).map(C=>C)),O.length===0){const C=document.createElement("li");C.textContent="items not found",w.appendChild(C)}O.forEach(C=>{const _=document.createElement("li");_.innerHTML=C.innerHTML,_.addEventListener("click",y),w.appendChild(_)})}),m.forEach(f=>f.addEventListener("click",y));function k(){c.classList.toggle("search-dropdown__list_show"),p.classList.toggle("searh-dropdown__btn_active")}function y(f){p.textContent=f.target.textContent,k()}});const yo=document.querySelectorAll('[data-role="open-menus"]'),Cr=document.querySelectorAll('[data-role="menus"]');yo.forEach(r=>{r.addEventListener("mouseenter",()=>{Cr.forEach(p=>{p.classList.add("is-visible")})}),r.addEventListener("mouseleave",()=>{Cr.forEach(p=>{p.classList.remove("is-visible")})})});const _o=document.getElementById("js-dialog-area"),wo=document.querySelectorAll('[data-role="dialog-dismiss"]'),Eo=document.querySelectorAll('[data-role="dialog-toggler"]'),Tr=document.querySelectorAll(".dialog"),So=document.querySelectorAll(".dialog__container"),ii="dialog_is_open",Mr="dialog_close_hard";To(),Tr.forEach(r=>{document.getElementById("js-dialog-area").appendChild(r),r.classList.contains(Mr)||r.addEventListener("click",kr)}),Eo.forEach(r=>{r.addEventListener("click",xo)}),wo.forEach(r=>{r.addEventListener("click",kr)}),So.forEach(r=>r.addEventListener("click",Co)),window.addEventListener("keydown",r=>{r.key==="Escape"&&document.querySelectorAll(`.${ii}:not(.${Mr})`).forEach(p=>p.classList.remove(ii))});function xo(){document.querySelector(this.dataset.target).classList.toggle(ii)}function kr(){document.querySelectorAll(`.${ii}`).forEach(r=>r.classList.remove(ii))}function Co(r){r.stopPropagation()}function To(){if(!_o&&Tr.length>0){const r=document.createElement("div");r.setAttribute("id","js-dialog-area"),r.style.zIndex="100",r.style.position="relative",document.body.appendChild(r)}}const Mo=document.querySelectorAll(".format_num"),ko=document.querySelectorAll(".format_date"),Lo=document.querySelectorAll(".format_datetime"),Ro=document.querySelectorAll(".format_datetime_second"),Po=document.querySelectorAll(".format_month_date"),Io="format_area",Fo="format_rate",Qe="--";Mo.forEach(r=>{if(r.textContent){let p;(r.classList.contains(Io)||r.classList.contains(Fo))&&(p={minimumFractionDigits:2});const c=Number(r.textContent).toLocaleString(void 0,p);r.innerHTML=isNaN(parseFloat(r.textContent))?r.textContent:c}}),ko.forEach(r=>{if(r.textContent){let p=r.textContent.replaceAll(`
`,"").replaceAll(" ","").split("/");r.innerHTML=`<span class="format format_unit" data-format="\u5E74">${p[0]??(p[0]=Qe)}</span> `,r.innerHTML+=`<span class="format format_unit" data-format="\u6708">${p[1]??(p[1]=Qe)}</span> `,r.innerHTML+=`<span class="format format_unit" data-format="\u65E5">${p[2]??(p[2]=Qe)}</span>`}}),Lo.forEach(r=>{if(r.textContent){let p=new Date(r.textContent);p!="Invalid Date"?(r.innerHTML=`<span class="format format_unit" data-format="\u5E74">${p.getFullYear()}</span> `,r.innerHTML+=`<span class="format format_unit" data-format="\u6708">${p.getMonth()+1}</span> `,r.innerHTML+=`<span class="format format_unit" data-format="\u65E5">${p.getDate()}</span> `,r.innerHTML+=` ${p.getHours()}:${p.getMinutes()<10?"0":""}${p.getMinutes()}`):(r.innerHTML=`<span class="format format_unit" data-format="\u5E74">${Qe}</span> `,r.innerHTML+=`<span class="format format_unit" data-format="\u6708">${Qe}</span> `,r.innerHTML+=`<span class="format format_unit" data-format="\u65E5">${Qe}</span>`,r.innerHTML+=`${Qe}`)}}),Ro.forEach(r=>{if(r.textContent){let[p,c]=r.textContent.replaceAll(`
`,"").split(" ");p=p.split("/"),r.innerHTML=`<span class="format format_unit" data-format="\u5E74">${p[0]??(p[0]=Qe)}</span> `,r.innerHTML+=`<span class="format format_unit" data-format="\u6708">${p[1]??(p[1]=Qe)}</span> `,r.innerHTML+=`<span class="format format_unit" data-format="\u65E5">${p[2]??(p[2]=Qe)}</span>`,c=c.split(":"),r.innerHTML+=` <span class="format format_unit" data-format="\u6642">${c[0]??(c[0]=Qe)}</span> `,r.innerHTML+=`<span class="format format_unit" data-format="\u5206">${c[1]??(c[1]=Qe)}</span>`}}),Po.forEach(r=>{if(r.textContent){let p=r.textContent.replaceAll(`
`,"").replaceAll(" ","").split("/");r.innerHTML=`<span class="format format_unit" data-format="\u6708">${p[0]??(p[0]=Qe)}</span> `,r.innerHTML+=`<span class="format format_unit" data-format="\u65E5">${p[1]??(p[1]=Qe)}</span>`}}),document.querySelectorAll(".password__toggler").forEach(r=>r.addEventListener("click",Do));function Do(){const r=document.querySelector(this.dataset.target);r.type=r.type==="password"?"text":"password"}document.querySelectorAll('[data-role="dropdown"]').forEach(r=>{const p=r.querySelector("button"),c=r.querySelector(".dropdown__content"),e=r.querySelector(".dropdown__list-wrapper"),w=r.querySelector(".dropdown__list"),m=r.querySelector(".dropdown__input"),x=r.querySelectorAll(".dropdown__list-item"),W=Array.from(x).map(C=>C),k=r.classList.contains("dropdown_type_right");c.addEventListener("click",y),p.addEventListener("click",()=>{const{bottom:C,left:_,right:D}=p.getBoundingClientRect();console.log(C,_,D),k?e.style.left=`${D-e.offsetWidth}px`:e.style.left=`${_}px`,e.style.top=`${C+4}px`,f()}),e.addEventListener("click",C=>{C.stopPropagation()}),m&&r.classList.contains("dropdown_search")&&(p.dataset.value,m.addEventListener("input",C=>{let _=W;if(w.replaceChildren(),C.target.value.length>0&&(_=_.filter(D=>new RegExp(C.target.value).test(D.textContent)).map(D=>D)),_.length===0){const D=document.createElement("li");D.classList.add("dropdown__list-item","dropdown__list-item_no-item"),D.textContent="items not found",w.appendChild(D)}_.forEach(D=>{const U=document.createElement("li");U.innerHTML=D.innerHTML,U.classList.add("dropdown__list-item"),U.addEventListener("click",O),w.appendChild(U)})}),x.forEach(C=>C.addEventListener("click",O)));function y(){r.classList.remove("dropdown_is_open"),p.classList.remove("dropdown__btn_is_active")}function f(){r.classList.toggle("dropdown_is_open"),p.classList.toggle("dropdown__btn_is_active")}function O(C){p.textContent=C.target.textContent,p.dataset.value=C.target.textContent,f()}});const yn="toggle-section__button_is_active",_n="toggle-section__item_is_show";document.querySelectorAll('[data-role="toggle-section"]').forEach(r=>{r.querySelectorAll("button").forEach(p=>p.addEventListener("click",()=>{document.querySelector(`button.${yn}`).classList.remove(yn),p.classList.add(yn);const c=document.querySelector(p.dataset.target),e=document.querySelector(`.${_n}`);c&&e&&(e.classList.remove(_n),c.classList.add(_n))}))});var Bs=function(){return Bs=Object.assign||function(r){for(var p,c=1,e=arguments.length;c<e;c++)for(var w in p=arguments[c])Object.prototype.hasOwnProperty.call(p,w)&&(r[w]=p[w]);return r},Bs.apply(this,arguments)};function Lr(r,p,c){if(c||arguments.length===2)for(var e,w=0,m=p.length;w<m;w++)!e&&w in p||(e||(e=Array.prototype.slice.call(p,0,w)),e[w]=p[w]);return r.concat(e||Array.prototype.slice.call(p))}function Rr(r){return Array.prototype.slice.call(r)}function Pr(r,p){var c=Math.floor(r);return c===p||c+1===p?r:p}function Ir(){return Date.now()}function wn(r,p,c){if(p="data-keen-slider-"+p,c===null)return r.removeAttribute(p);r.setAttribute(p,c||"")}function Fi(r,p){return p=p||document,typeof r=="function"&&(r=r(p)),Array.isArray(r)?r:typeof r=="string"?Rr(p.querySelectorAll(r)):r instanceof HTMLElement?[r]:r instanceof NodeList?Rr(r):[]}function ni(r){r.raw&&(r=r.raw),r.cancelable&&!r.defaultPrevented&&r.preventDefault()}function ri(r){r.raw&&(r=r.raw),r.stopPropagation&&r.stopPropagation()}function Fr(){var r=[];return{add:function(p,c,e,w){p.addListener?p.addListener(e):p.addEventListener(c,e,w),r.push([p,c,e,w])},input:function(p,c,e,w){this.add(p,c,function(m){return function(x){x.nativeEvent&&(x=x.nativeEvent);var W=x.changedTouches||[],k=x.targetTouches||[],y=x.detail&&x.detail.x?x.detail:null;return m({id:y?y.identifier?y.identifier:"i":k[0]?k[0]?k[0].identifier:"e":"d",idChanged:y?y.identifier?y.identifier:"i":W[0]?W[0]?W[0].identifier:"e":"d",raw:x,x:y&&y.x?y.x:k[0]?k[0].screenX:y?y.x:x.pageX,y:y&&y.y?y.y:k[0]?k[0].screenY:y?y.y:x.pageY})}}(e),w)},purge:function(){r.forEach(function(p){p[0].removeListener?p[0].removeListener(p[2]):p[0].removeEventListener(p[1],p[2],p[3])}),r=[]}}}function En(r,p,c){return Math.min(Math.max(r,p),c)}function is(r){return(r>0?1:0)-(r<0?1:0)||+r}function Dr(r){var p=r.getBoundingClientRect();return{height:Pr(p.height,r.offsetHeight),width:Pr(p.width,r.offsetWidth)}}function ze(r,p,c,e){var w=r&&r[p];return w==null?c:e&&typeof w=="function"?w():w}function ss(r){return Math.round(1e6*r)/1e6}function No(r){var p,c,e,w,m,x;function W(C){x||(x=C),k(!0);var _=C-x;_>e&&(_=e);var D=w[c];if(D[3]<_)return c++,W(C);var U=D[2],Y=D[4],at=D[0],Q=D[1]*(0,D[5])(Y===0?1:(_-U)/Y);if(Q&&r.track.to(at+Q),_<e)return f();x=null,k(!1),y(null),r.emit("animationEnded")}function k(C){p.active=C}function y(C){p.targetIdx=C}function f(){var C;C=W,m=window.requestAnimationFrame(C)}function O(){var C;C=m,window.cancelAnimationFrame(C),k(!1),y(null),x&&r.emit("animationStopped"),x=null}return p={active:!1,start:function(C){if(O(),r.track.details){var _=0,D=r.track.details.position;c=0,e=0,w=C.map(function(U){var Y,at=Number(D),Q=(Y=U.earlyExit)!==null&&Y!==void 0?Y:U.duration,L=U.easing,V=U.distance*L(Q/U.duration)||0;D+=V;var $=e;return e+=Q,_+=V,[at,U.distance,$,e,U.duration,L]}),y(r.track.distToIdx(_)),f(),r.emit("animationStarted")}},stop:O,targetIdx:null}}function Oo(r){var p,c,e,w,m,x,W,k,y,f,O,C,_,D,U=1/0,Y=[],at=null,Q=0;function L(Mt){Ot(Q+Mt)}function V(Mt){var Lt=$(Q+Mt).abs;return tt(Lt)?Lt:null}function $(Mt){var Lt=Math.floor(Math.abs(ss(Mt/c))),Et=ss((Mt%c+c)%c);Et===c&&(Et=0);var Z=is(Mt),gt=W.indexOf(Lr([],W,!0).reduce(function(Pt,qt){return Math.abs(qt-Et)<Math.abs(Pt-Et)?qt:Pt})),Rt=gt;return Z<0&&Lt++,gt===x&&(Rt=0,Lt+=Z>0?1:-1),{abs:Rt+Lt*x*Z,origin:gt,rel:Rt}}function N(Mt,Lt,Et){var Z;if(Lt||!Ft())return q(Mt,Et);if(!tt(Mt))return null;var gt=$(Et??Q),Rt=gt.abs,Pt=Mt-gt.rel,qt=Rt+Pt;Z=q(qt);var Kt=q(qt-x*is(Pt));return(Kt!==null&&Math.abs(Kt)<Math.abs(Z)||Z===null)&&(Z=Kt),ss(Z)}function q(Mt,Lt){if(Lt==null&&(Lt=ss(Q)),!tt(Mt)||Mt===null)return null;Mt=Math.round(Mt);var Et=$(Lt),Z=Et.abs,gt=Et.rel,Rt=Et.origin,Pt=Ct(Mt),qt=(Lt%c+c)%c,Kt=W[Rt],ie=Math.floor((Mt-(Z-gt))/x)*c;return ss(Kt-qt-Kt+W[Pt]+ie+(Rt===x?c:0))}function tt(Mt){return bt(Mt)===Mt}function bt(Mt){return En(Mt,y,f)}function Ft(){return w.loop}function Ct(Mt){return(Mt%x+x)%x}function Ot(Mt){var Lt;Lt=Mt-Q,Y.push({distance:Lt,timestamp:Ir()}),Y.length>6&&(Y=Y.slice(-6)),Q=ss(Mt);var Et=_t().abs;if(Et!==at){var Z=at!==null;at=Et,Z&&r.emit("slideChanged")}}function _t(Mt){var Lt=Mt?null:function(){if(x){var Et=Ft(),Z=Et?(Q%c+c)%c:Q,gt=(Et?Q%c:Q)-m[0][2],Rt=0-(gt<0&&Et?c-Math.abs(gt):gt),Pt=0,qt=$(Q),Kt=qt.abs,ie=qt.rel,xe=m[ie][2],de=m.map(function(le,be){var Vt=Rt+Pt;(Vt<0-le[0]||Vt>1)&&(Vt+=(Math.abs(Vt)>c-1&&Et?c:0)*is(-Vt));var ae=be-ie,Ce=is(ae),ee=ae+Kt;Et&&(Ce===-1&&Vt>xe&&(ee+=x),Ce===1&&Vt<xe&&(ee-=x),O!==null&&ee<O&&(Vt+=c),C!==null&&ee>C&&(Vt-=c));var Ee=Vt+le[0]+le[1],ne=Math.max(Vt>=0&&Ee<=1?1:Ee<0||Vt>1?0:Vt<0?Math.min(1,(le[0]+Vt)/le[0]):(1-Vt)/le[0],0);return Pt+=le[0]+le[1],{abs:ee,distance:w.rtl?-1*Vt+1-le[0]:Vt,portion:ne,size:le[0]}});return Kt=bt(Kt),ie=Ct(Kt),{abs:bt(Kt),length:e,max:D,maxIdx:f,min:_,minIdx:y,position:Q,progress:Et?Z/c:Q/e,rel:ie,slides:de,slidesLength:c}}}();return p.details=Lt,r.emit("detailsChanged"),Lt}return p={absToRel:Ct,add:L,details:null,distToIdx:V,idxToDist:N,init:function(Mt){if(function(){if(w=r.options,m=(w.trackConfig||[]).map(function(gt){return[ze(gt,"size",1),ze(gt,"spacing",0),ze(gt,"origin",0)]}),x=m.length){c=ss(m.reduce(function(gt,Rt){return gt+Rt[0]+Rt[1]},0));var Et,Z=x-1;e=ss(c+m[0][2]-m[Z][0]-m[Z][2]-m[Z][1]),W=m.reduce(function(gt,Rt){if(!gt)return[0];var Pt=m[gt.length-1],qt=gt[gt.length-1]+(Pt[0]+Pt[2])+Pt[1];return qt-=Rt[2],gt[gt.length-1]>qt&&(qt=gt[gt.length-1]),qt=ss(qt),gt.push(qt),(!Et||Et<qt)&&(k=gt.length-1),Et=qt,gt},null),e===0&&(k=0),W.push(ss(c))}}(),!x)return _t(!0);var Lt;(function(){var Et=r.options.range,Z=r.options.loop;O=y=Z?ze(Z,"min",-1/0):0,C=f=Z?ze(Z,"max",U):k;var gt=ze(Et,"min",null),Rt=ze(Et,"max",null);gt!==null&&(y=gt),Rt!==null&&(f=Rt),_=y===-1/0?y:r.track.idxToDist(y||0,!0,0),D=f===U?f:N(f,!0,0),Rt===null&&(C=f),ze(Et,"align",!1)&&f!==U&&m[Ct(f)][2]===0&&(D-=1-m[Ct(f)][0],f=V(D-Q)),_=ss(_),D=ss(D)})(),Lt=Mt,Number(Lt)===Lt?L(q(bt(Mt))):_t()},to:Ot,velocity:function(){var Mt=Ir(),Lt=Y.reduce(function(Et,Z){var gt=Z.distance,Rt=Z.timestamp;return Mt-Rt>200||(is(gt)!==is(Et.distance)&&Et.distance&&(Et={distance:0,lastTimestamp:0,time:0}),Et.time&&(Et.distance+=gt),Et.lastTimestamp&&(Et.time+=Rt-Et.lastTimestamp),Et.lastTimestamp=Rt),Et},{distance:0,lastTimestamp:0,time:0});return Lt.distance/Lt.time||0}}}function Ho(r){var p,c,e,w,m,x,W,k;function y(at){return 2*at}function f(at){return En(at,W,k)}function O(at){return 1-Math.pow(1-at,3)}function C(){return e?r.track.velocity():0}function _(){Y();var at=r.options.mode==="free-snap",Q=r.track,L=C();w=is(L);var V=r.track.details,$=[];if(L||!at){var N=D(L),q=N.dist,tt=N.dur;if(tt=y(tt),q*=w,at){var bt=Q.idxToDist(Q.distToIdx(q),!0);bt&&(q=bt)}$.push({distance:q,duration:tt,easing:O});var Ft=V.position,Ct=Ft+q;if(Ct<m||Ct>x){var Ot=Ct<m?m-Ft:x-Ft,_t=0,Mt=L;if(is(Ot)===w){var Lt=Math.min(Math.abs(Ot)/Math.abs(q),1),Et=function(Rt){return 1-Math.pow(1-Rt,1/3)}(Lt)*tt;$[0].earlyExit=Et,Mt=L*(1-Lt)}else $[0].earlyExit=0,_t+=Ot;var Z=D(Mt,100),gt=Z.dist*w;r.options.rubberband&&($.push({distance:gt,duration:y(Z.dur),easing:O}),$.push({distance:-gt+_t,duration:500,easing:O}))}r.animator.start($)}else r.moveToIdx(f(V.abs),!0,{duration:500,easing:function(Rt){return 1+--Rt*Rt*Rt*Rt*Rt}})}function D(at,Q){Q===void 0&&(Q=1e3);var L=147e-9+(at=Math.abs(at))/Q;return{dist:Math.pow(at,2)/L,dur:at/L}}function U(){var at=r.track.details;at&&(m=at.min,x=at.max,W=at.minIdx,k=at.maxIdx)}function Y(){r.animator.stop()}r.on("updated",U),r.on("optionsChanged",U),r.on("created",U),r.on("dragStarted",function(){e=!1,Y(),p=c=r.track.details.abs}),r.on("dragChecked",function(){e=!0}),r.on("dragEnded",function(){var at=r.options.mode;at==="snap"&&function(){var Q=r.track,L=r.track.details,V=L.position,$=is(C());(V>x||V<m)&&($=0);var N=p+$;L.slides[Q.absToRel(N)].portion===0&&(N-=$),p!==c&&(N=c),is(Q.idxToDist(N,!0))!==$&&(N+=$),N=f(N);var q=Q.idxToDist(N,!0);r.animator.start([{distance:q,duration:500,easing:function(tt){return 1+--tt*tt*tt*tt*tt}}])}(),at!=="free"&&at!=="free-snap"||_()}),r.on("dragged",function(){c=r.track.details.abs})}function Bo(r){var p,c,e,w,m,x,W,k,y,f,O,C,_,D,U,Y,at,Q,L=Fr();function V(_t){if(x&&k===_t.id){var Mt=tt(_t);if(y){if(!q(_t))return N(_t);f=Mt,y=!1,r.emit("dragChecked")}if(Y)return f=Mt;ni(_t);var Lt=function(Z){if(at===-1/0&&Q===1/0)return Z;var gt=r.track.details,Rt=gt.length,Pt=gt.position,qt=En(Z,at-Pt,Q-Pt);if(Rt===0)return 0;if(!r.options.rubberband)return qt;if(Pt<=Q&&Pt>=at||Pt<at&&c>0||Pt>Q&&c<0)return Z;var Kt=(Pt<at?Pt-at:Pt-Q)/Rt,ie=w*Rt,xe=Math.abs(Kt*ie),de=Math.max(0,1-xe/m*2);return de*de*Z}(W(f-Mt)/w*e);c=is(Lt);var Et=r.track.details.position;(Et>at&&Et<Q||Et===at&&c>0||Et===Q&&c<0)&&ri(_t),O+=Lt,!C&&Math.abs(O*w)>5&&(C=!0),r.track.add(Lt),f=Mt,r.emit("dragged")}}function $(_t){!x&&r.track.details&&r.track.details.length&&(O=0,x=!0,C=!1,y=!0,k=_t.id,q(_t),f=tt(_t),r.emit("dragStarted"))}function N(_t){x&&k===_t.idChanged&&(x=!1,r.emit("dragEnded"))}function q(_t){var Mt=bt(),Lt=Mt?_t.y:_t.x,Et=Mt?_t.x:_t.y,Z=_!==void 0&&D!==void 0&&Math.abs(D-Et)<=Math.abs(_-Lt);return _=Lt,D=Et,Z}function tt(_t){return bt()?_t.y:_t.x}function bt(){return r.options.vertical}function Ft(){w=r.size,m=bt()?window.innerHeight:window.innerWidth;var _t=r.track.details;_t&&(at=_t.min,Q=_t.max)}function Ct(_t){C&&(ri(_t),ni(_t))}function Ot(){if(L.purge(),r.options.drag&&!r.options.disabled){var _t;_t=r.options.dragSpeed||1,W=typeof _t=="function"?_t:function(Lt){return Lt*_t},e=r.options.rtl?-1:1,Ft(),p=r.container,function(){var Lt="data-keen-slider-clickable";Fi("[".concat(Lt,"]:not([").concat(Lt,"=false])"),p).map(function(Et){L.add(Et,"dragstart",ri),L.add(Et,"mousedown",ri),L.add(Et,"touchstart",ri)})}(),L.add(p,"dragstart",function(Lt){ni(Lt)}),L.add(p,"click",Ct,{capture:!0}),L.input(p,"ksDragStart",$),L.input(p,"ksDrag",V),L.input(p,"ksDragEnd",N),L.input(p,"mousedown",$),L.input(p,"mousemove",V),L.input(p,"mouseleave",N),L.input(p,"mouseup",N),L.input(p,"touchstart",$,{passive:!0}),L.input(p,"touchmove",V,{passive:!1}),L.input(p,"touchend",N),L.input(p,"touchcancel",N),L.add(window,"wheel",function(Lt){x&&ni(Lt)});var Mt="data-keen-slider-scrollable";Fi("[".concat(Mt,"]:not([").concat(Mt,"=false])"),r.container).map(function(Lt){return function(Et){var Z;L.input(Et,"touchstart",function(gt){Z=tt(gt),Y=!0,U=!0},{passive:!0}),L.input(Et,"touchmove",function(gt){var Rt=bt(),Pt=Rt?Et.scrollHeight-Et.clientHeight:Et.scrollWidth-Et.clientWidth,qt=Z-tt(gt),Kt=Rt?Et.scrollTop:Et.scrollLeft,ie=Rt&&Et.style.overflowY==="scroll"||!Rt&&Et.style.overflowX==="scroll";if(Z=tt(gt),(qt<0&&Kt>0||qt>0&&Kt<Pt)&&U&&ie)return Y=!0;U=!1,ni(gt),Y=!1}),L.input(Et,"touchend",function(){Y=!1})}(Lt)})}}r.on("updated",Ft),r.on("optionsChanged",Ot),r.on("created",Ot),r.on("destroyed",L.purge)}function Uo(r){var p,c,e=null;function w(_,D,U){r.animator.active?x(_,D,U):requestAnimationFrame(function(){return x(_,D,U)})}function m(){w(!1,!1,c)}function x(_,D,U){var Y=0,at=r.size,Q=r.track.details;if(Q&&p){var L=Q.slides;p.forEach(function(V,$){if(_)!e&&D&&k(V,null,U),y(V,null,U);else{if(!L[$])return;var N=L[$].size*at;!e&&D&&k(V,N,U),y(V,L[$].distance*at-Y,U),Y+=N}})}}function W(_){return r.options.renderMode==="performance"?Math.round(_):_}function k(_,D,U){var Y=U?"height":"width";D!==null&&(D=W(D)+"px"),_.style["min-"+Y]=D,_.style["max-"+Y]=D}function y(_,D,U){if(D!==null){D=W(D);var Y=U?D:0;D="translate3d(".concat(U?0:D,"px, ").concat(Y,"px, 0)")}_.style.transform=D,_.style["-webkit-transform"]=D}function f(){p&&(x(!0,!0,c),p=null),r.on("detailsChanged",m,!0)}function O(){w(!1,!0,c)}function C(){f(),c=r.options.vertical,r.options.disabled||r.options.renderMode==="custom"||(e=ze(r.options.slides,"perView",null)==="auto",r.on("detailsChanged",m),(p=r.slides).length&&O())}r.on("created",C),r.on("optionsChanged",C),r.on("beforeOptionsChanged",function(){f()}),r.on("updated",O),r.on("destroyed",f)}function $o(r,p){return function(c){var e,w,m,x,W,k=Fr();function y(q){var tt;wn(c.container,"reverse",(tt=c.container,window.getComputedStyle(tt,null).getPropertyValue("direction")!=="rtl"||q?null:"")),wn(c.container,"v",c.options.vertical&&!q?"":null),wn(c.container,"disabled",c.options.disabled&&!q?"":null)}function f(){O()&&Y()}function O(){var q=null;if(x.forEach(function(bt){bt.matches&&(q=bt.__media)}),q===e)return!1;e||c.emit("beforeOptionsChanged"),e=q;var tt=q?m.breakpoints[q]:m;return c.options=Bs(Bs({},m),tt),y(),$(),N(),Q(),!0}function C(q){var tt=Dr(q);return(c.options.vertical?tt.height:tt.width)/c.size||1}function _(){return c.options.trackConfig.length}function D(q){for(var tt in e=!1,m=Bs(Bs({},p),q),k.purge(),w=c.size,x=[],m.breakpoints||[]){var bt=window.matchMedia(tt);bt.__media=tt,x.push(bt),k.add(bt,"change",f)}k.add(window,"orientationchange",V),k.add(window,"resize",L),O()}function U(q){c.animator.stop();var tt=c.track.details;c.track.init(q??(tt?tt.abs:0))}function Y(q){U(q),c.emit("optionsChanged")}function at(q,tt){if(q)return D(q),void Y(tt);$(),N();var bt=_();Q(),_()!==bt?Y(tt):U(tt),c.emit("updated")}function Q(){var q=c.options.slides;if(typeof q=="function")return c.options.trackConfig=q(c.size,c.slides);for(var tt=c.slides,bt=tt.length,Ft=typeof q=="number"?q:ze(q,"number",bt,!0),Ct=[],Ot=ze(q,"perView",1,!0),_t=ze(q,"spacing",0,!0)/c.size||0,Mt=Ot==="auto"?_t:_t/Ot,Lt=ze(q,"origin","auto"),Et=0,Z=0;Z<Ft;Z++){var gt=Ot==="auto"?C(tt[Z]):1/Ot-_t+Mt,Rt=Lt==="center"?.5-gt/2:Lt==="auto"?0:Lt;Ct.push({origin:Rt,size:gt,spacing:_t}),Et+=gt}if(Et+=_t*(Ft-1),Lt==="auto"&&!c.options.loop&&Ot!==1){var Pt=0;Ct.map(function(qt){var Kt=Et-Pt;return Pt+=qt.size+_t,Kt>=1||(qt.origin=1-Kt-(Et>1?0:1-Et)),qt})}c.options.trackConfig=Ct}function L(){$();var q=c.size;c.options.disabled||q===w||(w=q,at())}function V(){L(),setTimeout(L,500),setTimeout(L,2e3)}function $(){var q=Dr(c.container);c.size=(c.options.vertical?q.height:q.width)||1}function N(){c.slides=Fi(c.options.selector,c.container)}c.container=(W=Fi(r,document)).length?W[0]:null,c.destroy=function(){k.purge(),c.emit("destroyed"),y(!0)},c.prev=function(){c.moveToIdx(c.track.details.abs-1,!0)},c.next=function(){c.moveToIdx(c.track.details.abs+1,!0)},c.update=at,D(c.options)}}var Nr=function(r,p,c){try{return function(e,w){var m,x={};return m={emit:function(W){x[W]&&x[W].forEach(function(y){y(m)});var k=m.options&&m.options[W];k&&k(m)},moveToIdx:function(W,k,y){var f=m.track.idxToDist(W,k);if(f){var O=m.options.defaultAnimation;m.animator.start([{distance:f,duration:ze(y||O,"duration",500),easing:ze(y||O,"easing",function(C){return 1+--C*C*C*C*C})}])}},on:function(W,k,y){y===void 0&&(y=!1),x[W]||(x[W]=[]);var f=x[W].indexOf(k);f>-1?y&&delete x[W][f]:y||x[W].push(k)},options:e},function(){if(m.track=Oo(m),m.animator=No(m),w)for(var W=0,k=w;W<k.length;W++)(0,k[W])(m);m.track.init(m.options.initial||0),m.emit("created")}(),m}(p,Lr([$o(r,{drag:!0,mode:"snap",renderMode:"precision",rubberband:!0,selector:".keen-slider__slide"}),Uo,Bo,Ho],c||[],!0))}catch(e){console.error(e)}};function Vo(r){let p,c,e,w;function m(O){y(O),k(O)}function x(O){O.parentNode.removeChild(O)}function W(O){var C=document.createElement("div"),_=O.split(" ");return _.forEach(D=>C.classList.add(D)),C}function k(O){if(O){x(e),x(w),x(c);return}c=W("arrow-wrapper"),e=W("arrow arrow__left"),e.addEventListener("click",()=>r.prev()),w=W("arrow arrow__right"),w.addEventListener("click",()=>r.next()),p.appendChild(c),c.appendChild(e),c.appendChild(w)}function y(O){if(O){for(var C=p.parentNode;p.firstChild;)C.insertBefore(p.firstChild,p);x(p);return}p=W("navigation-wrapper"),r.container.parentNode.appendChild(p),p.appendChild(r.container)}function f(){var O=r.track.details.rel;O===0?e.classList.add("arrow_disabled"):e.classList.remove("arrow_disabled"),O===r.track.details.slides.length-1?w.classList.add("arrow_disabled"):w.classList.remove("arrow_disabled")}r.on("created",()=>{m(),f()}),r.on("optionsChanged",()=>{m(!0),m(),f()}),r.on("slideChanged",()=>{f()}),r.on("destroyed",()=>{m(!0)})}function jo(r){return p=>{function c(){r.forEach(e=>{e.addEventListener("click",()=>{p.moveToIdx(Number(e.dataset.target)),r.forEach(w=>{w.dataset.target!=e.dataset.target?w.classList.remove("slider-thumbnail__img_active"):w.classList.add("slider-thumbnail__img_active")})})})}p.on("created",()=>{c()}),p.on("animationEnded",()=>{const e=p.track.details.rel;r.forEach(w=>{w.dataset.target==e?w.classList.add("slider-thumbnail__img_active"):w.classList.remove("slider-thumbnail__img_active")})})}}document.querySelectorAll('[data-role="slider"]').forEach(r=>{const p=r.querySelector(".slider"),c=r.querySelectorAll('[data-role="slider-thumbnail"]');new Nr(p,{slides:{perView:1},defaultAnimation:{duration:0}},[jo(c)])});const Ts=document.querySelector("#top-slider");Ts&&(console.log(Ts.off),new Nr(Ts,{slides:{perView:()=>(Ts.offsetWidth-32)/400,spacing:8},breakpoints:{"(max-width: 1200px)":{slides:{origin:"center",perView:()=>(Ts.offsetWidth-32)/400,spacing:8}},"(max-width: 992px)":{slides:{origin:"center",perView:()=>(Ts.offsetWidth-32)/400,spacing:8}},"(max-width: 576px)":{slides:{origin:"center",perView:()=>(Ts.offsetWidth-32)/400,spacing:16}}}},[Vo])),document.querySelectorAll(".schedule__status").forEach(r=>{if(r.dataset){const p=new Date,c=new Date(r.dataset.start),e=new Date(r.dataset.end);c!=="Invalid Date"&&e!=="Invalid Date"?p>e?(r.classList.remove("schedule__status_yet"),r.classList.add("schedule__status_complete")):c<=p&&p<=e&&(r.classList.remove("schedule__status_yet"),r.classList.add("schedule__status_current")):console.log("invalid date!",`
 start: ${c}`,`
end: ${e}`)}else console.log(r.dataset)}),document.querySelectorAll('[data-role="#####"]').forEach(r=>{const p=["\u62BD\u9078\u4E88\u5B9A\u65E5","\u30AD\u30E3\u30F3\u30BB\u30EB\u5F85\u3061\u62BD\u9078\u4E88\u5B9A\u65E5","\u632F\u8FBC\u671F\u9650\u65E5\u6642","\u904B\u7528\u958B\u59CB\u4E88\u5B9A\u65E5","\u904B\u7528\u7D42\u4E86\u4E88\u5B9A\u65E5","\u511F\u9084\u4E88\u5B9A\u65E5"],c=["\u632F\u8FBC\u671F\u9650\u65E5\u6642"],e=r.dataset.value.split(",");e.length===4&&p.splice(0,2);let w={},m="--",x;e.forEach((k,y)=>{const f=new Date(k),O=isNaN(f);O||(m=String(f.getFullYear()),x=Math.round((new Date().getTime()-f.getTime())/(24*36e5))),Object.keys(w).indexOf(m)===-1&&(w[m]=[]);const C={year:O?"--":f.getFullYear(),month:O?"--":f.getMonth()+1,date:O?"--":f.getDate(),hour:O?"--":("00"+f.getHours()).slice(-2),minute:O?"--":("00"+f.getMinutes()).slice(-2),status:x>1?"complete":x!==1?"yet":"current",lastRaw:y===p.length-1,hasTime:c.includes(p[y]),label:p[y]};w[m].push(C)});let W="";for(let[k,y]of Object.entries(w))W+=`            <div class="fund-shcedule-short__row">                 <div class="fund-schedule-short__year">                     ${k}                 </div>             <div class="fund-schedule-short__items">         `,y.forEach(f=>{W+=f.lastRaw?'<div class="fund-schedule-short__content fund-schedule-short__content_last">':'<div class="fund-schedule-short__content">',W+=`<span class="fund-schedule-short__values">                         <span class="fund-schedule-short__value format format_unit" data-format="\u6708">${f.month}</span>                        <span class="fund-schedule-short__value format format_unit" data-format="\u65E5">${f.date}</span>                    `,f.hasTime&&(W+=`<div class="fund-schedule-short__time">${f.hour}:${f.minute}</div>`),W+=`   </span>                     <div class="schedule__status schedule__status_${f.status}"></div>                     <span class="fund-schedule-short__label">${f.label}</span>                     </div>                     `}),W+="</div></div>";r.innerHTML=W}),document.querySelectorAll('[data-role="short-schedule"]').forEach(r=>{const p=["\u62BD\u9078\u4E88\u5B9A\u65E5","\u30AD\u30E3\u30F3\u30BB\u30EB\u5F85\u3061\u62BD\u9078\u4E88\u5B9A\u65E5","\u632F\u8FBC\u671F\u9650\u65E5\u6642","\u904B\u7528\u958B\u59CB\u4E88\u5B9A\u65E5","\u904B\u7528\u7D42\u4E86\u4E88\u5B9A\u65E5","\u511F\u9084\u4E88\u5B9A\u65E5"],c=["\u632F\u8FBC\u671F\u9650\u65E5\u6642"],e=r.dataset.value.split(",");e.length===4&&p.splice(0,2);let w=[],m;e.forEach((k,y)=>{const f=new Date(k),O=isNaN(f);O||(String(f.getFullYear()),m=Math.round((new Date().getTime()-f.getTime())/(24*36e5)));const C={year:O?"--":f.getFullYear(),month:O?"--":f.getMonth()+1,date:O?"--":f.getDate(),hour:O?"--":("00"+f.getHours()).slice(-2),minute:O?"--":("00"+f.getMinutes()).slice(-2),status:m>1?"complete":m!==1?"yet":"current",lastRaw:y===p.length-1,hasTime:c.includes(p[y]),label:p[y]};w.push(C)});let x="",W="";w.forEach((k,y,f)=>{const O=W!==k.year;y!==0&&O&&(x+="</div></div>"),O&&(W=k.year,x+=`                <div class="fund-shcedule-short__row">                     <div class="fund-schedule-short__year">                         ${W}                     </div>                 <div class="fund-schedule-short__items">             `),x+=k.lastRaw?'<div class="fund-schedule-short__content fund-schedule-short__content_last">':'<div class="fund-schedule-short__content">',x+=`<span class="fund-schedule-short__values">                     <span class="fund-schedule-short__value format format_unit" data-format="\u6708">${k.month}</span>                    <span class="fund-schedule-short__value format format_unit" data-format="\u65E5">${k.date}</span>                `,k.hasTime&&(x+=`<div class="fund-schedule-short__time">${k.hour}:${k.minute}</div>`),x+=`   </span>                 <div class="schedule__status schedule__status_${k.status}"></div>                 <span class="fund-schedule-short__label">${k.label}</span>                 </div>                 `,y===f.length-1&&(x+="</div></div>")}),r.innerHTML=x});const Go="modulepreload",qo=function(r){return"/"+r},Or={},vs=function(r,p,c){let e=Promise.resolve();if(p&&p.length>0){const w=document.getElementsByTagName("link"),m=document.querySelector("meta[property=csp-nonce]"),x=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));e=Promise.all(p.map(W=>{if(W=qo(W),W in Or)return;Or[W]=!0;const k=W.endsWith(".css"),y=k?'[rel="stylesheet"]':"";if(c)for(let O=w.length-1;O>=0;O--){const C=w[O];if(C.href===W&&(!k||C.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${W}"]${y}`))return;const f=document.createElement("link");if(f.rel=k?"stylesheet":Go,k||(f.as="script",f.crossOrigin=""),f.href=W,x&&f.setAttribute("nonce",x),document.head.appendChild(f),k)return new Promise((O,C)=>{f.addEventListener("load",O),f.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${W}`)))})}))}return e.then(()=>r()).catch(w=>{const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=w,window.dispatchEvent(m),!m.defaultPrevented)throw w})};var zo={976:(r,p,c)=>{var le,Vt,Ns,Ce,Gr,Ee,qr,et,i,n,d,g,o,A,v,E,u,a,h,R,j,G,rt,ot,yt,zr,ut,Xi,P,Mn,nt,kn,b,z,X,lt,ft,Tt,Dt,Ln,re,he,Te,_e,Wr,fe,Rn;c.d(p,{AnnotationLayer:()=>de,FreeTextAnnotationElement:()=>Ct,InkAnnotationElement:()=>gt,StampAnnotationElement:()=>ie});var e=c(292),w=c(419),m=c(792);function x(se){return Math.floor(Math.max(0,Math.min(1,se))*255).toString(16).padStart(2,"0")}function W(se){return Math.max(0,Math.min(255,255*se))}class k{static CMYK_G([F,S,J,it]){return["G",1-Math.min(1,.3*F+.59*J+.11*S+it)]}static G_CMYK([F]){return["CMYK",0,0,0,1-F]}static G_RGB([F]){return["RGB",F,F,F]}static G_rgb([F]){return F=W(F),[F,F,F]}static G_HTML([F]){const S=x(F);return`#${S}${S}${S}`}static RGB_G([F,S,J]){return["G",.3*F+.59*S+.11*J]}static RGB_rgb(F){return F.map(W)}static RGB_HTML(F){return`#${F.map(x).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([F,S,J,it]){return["RGB",1-Math.min(1,F+it),1-Math.min(1,J+it),1-Math.min(1,S+it)]}static CMYK_rgb([F,S,J,it]){return[W(1-Math.min(1,F+it)),W(1-Math.min(1,J+it)),W(1-Math.min(1,S+it))]}static CMYK_HTML(F){const S=this.CMYK_RGB(F).slice(1);return this.RGB_HTML(S)}static RGB_CMYK([F,S,J]){const it=1-F,ct=1-S,wt=1-J,vt=Math.min(it,ct,wt);return["CMYK",it,ct,wt,vt]}}var y=c(284);const f=1e3,O=9,C=new WeakSet;function _(se){return{width:se[2]-se[0],height:se[3]-se[1]}}class D{static create(F){switch(F.data.annotationType){case e.AnnotationType.LINK:return new Y(F);case e.AnnotationType.TEXT:return new at(F);case e.AnnotationType.WIDGET:switch(F.data.fieldType){case"Tx":return new L(F);case"Btn":return F.data.radioButton?new N(F):F.data.checkBox?new $(F):new q(F);case"Ch":return new tt(F);case"Sig":return new V(F)}return new Q(F);case e.AnnotationType.POPUP:return new bt(F);case e.AnnotationType.FREETEXT:return new Ct(F);case e.AnnotationType.LINE:return new Ot(F);case e.AnnotationType.SQUARE:return new _t(F);case e.AnnotationType.CIRCLE:return new Mt(F);case e.AnnotationType.POLYLINE:return new Lt(F);case e.AnnotationType.CARET:return new Z(F);case e.AnnotationType.INK:return new gt(F);case e.AnnotationType.POLYGON:return new Et(F);case e.AnnotationType.HIGHLIGHT:return new Rt(F);case e.AnnotationType.UNDERLINE:return new Pt(F);case e.AnnotationType.SQUIGGLY:return new qt(F);case e.AnnotationType.STRIKEOUT:return new Kt(F);case e.AnnotationType.STAMP:return new ie(F);case e.AnnotationType.FILEATTACHMENT:return new xe(F);default:return new U(F)}}}const be=class be{constructor(F,{isRenderable:S=!1,ignoreBorder:J=!1,createQuadrilaterals:it=!1}={}){l(this,le,!1);this.isRenderable=S,this.data=F.data,this.layer=F.layer,this.linkService=F.linkService,this.downloadManager=F.downloadManager,this.imageResourcesPath=F.imageResourcesPath,this.renderForms=F.renderForms,this.svgFactory=F.svgFactory,this.annotationStorage=F.annotationStorage,this.enableScripting=F.enableScripting,this.hasJSActions=F.hasJSActions,this._fieldObjects=F.fieldObjects,this.parent=F.parent,S&&(this.container=this._createContainer(J)),it&&this._createQuadrilaterals()}static _hasPopupData({titleObj:F,contentsObj:S,richText:J}){return!!(F!=null&&F.str||S!=null&&S.str||J!=null&&J.str)}get hasPopupData(){return be._hasPopupData(this.data)}_createContainer(F){const{data:S,parent:{page:J,viewport:it}}=this,ct=document.createElement("section");ct.setAttribute("data-annotation-id",S.id),this instanceof Q||(ct.tabIndex=f),ct.style.zIndex=this.parent.zIndex++,S.popupRef&&ct.setAttribute("aria-haspopup","dialog"),S.alternativeText&&(ct.title=S.alternativeText),S.noRotate&&ct.classList.add("norotate");const{pageWidth:wt,pageHeight:vt,pageX:zt,pageY:jt}=it.rawDims;if(!S.rect||this instanceof bt){const{rotation:Bt}=S;return!S.hasOwnCanvas&&Bt!==0&&this.setRotation(Bt,ct),ct}const{width:Nt,height:Yt}=_(S.rect),$t=e.Util.normalizeRect([S.rect[0],J.view[3]-S.rect[1]+J.view[1],S.rect[2],J.view[3]-S.rect[3]+J.view[1]]);if(!F&&S.borderStyle.width>0){ct.style.borderWidth=`${S.borderStyle.width}px`;const Bt=S.borderStyle.horizontalCornerRadius,Qt=S.borderStyle.verticalCornerRadius;if(Bt>0||Qt>0){const ce=`calc(${Bt}px * var(--scale-factor)) / calc(${Qt}px * var(--scale-factor))`;ct.style.borderRadius=ce}else if(this instanceof N){const ce=`calc(${Nt}px * var(--scale-factor)) / calc(${Yt}px * var(--scale-factor))`;ct.style.borderRadius=ce}switch(S.borderStyle.style){case e.AnnotationBorderStyleType.SOLID:ct.style.borderStyle="solid";break;case e.AnnotationBorderStyleType.DASHED:ct.style.borderStyle="dashed";break;case e.AnnotationBorderStyleType.BEVELED:(0,e.warn)("Unimplemented border style: beveled");break;case e.AnnotationBorderStyleType.INSET:(0,e.warn)("Unimplemented border style: inset");break;case e.AnnotationBorderStyleType.UNDERLINE:ct.style.borderBottomStyle="solid";break}const ue=S.borderColor||null;ue?(I(this,le,!0),ct.style.borderColor=e.Util.makeHexColor(ue[0]|0,ue[1]|0,ue[2]|0)):ct.style.borderWidth=0}ct.style.left=`${100*($t[0]-zt)/wt}%`,ct.style.top=`${100*($t[1]-jt)/vt}%`;const{rotation:xt}=S;return S.hasOwnCanvas||xt===0?(ct.style.width=`${100*Nt/wt}%`,ct.style.height=`${100*Yt/vt}%`):this.setRotation(xt,ct),ct}setRotation(F,S=this.container){if(!this.data.rect)return;const{pageWidth:J,pageHeight:it}=this.parent.viewport.rawDims,{width:ct,height:wt}=_(this.data.rect);let vt,zt;F%180===0?(vt=100*ct/J,zt=100*wt/it):(vt=100*wt/J,zt=100*ct/it),S.style.width=`${vt}%`,S.style.height=`${zt}%`,S.setAttribute("data-main-rotation",(360-F)%360)}get _commonActions(){const F=(S,J,it)=>{const ct=it.detail[S],wt=ct[0],vt=ct.slice(1);it.target.style[J]=k[`${wt}_HTML`](vt),this.annotationStorage.setValue(this.data.id,{[J]:k[`${wt}_rgb`](vt)})};return(0,e.shadow)(this,"_commonActions",{display:S=>{const{display:J}=S.detail,it=J%2===1;this.container.style.visibility=it?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:it,noPrint:J===1||J===2})},print:S=>{this.annotationStorage.setValue(this.data.id,{noPrint:!S.detail.print})},hidden:S=>{const{hidden:J}=S.detail;this.container.style.visibility=J?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:J,noView:J})},focus:S=>{setTimeout(()=>S.target.focus({preventScroll:!1}),0)},userName:S=>{S.target.title=S.detail.userName},readonly:S=>{S.target.disabled=S.detail.readonly},required:S=>{this._setRequired(S.target,S.detail.required)},bgColor:S=>{F("bgColor","backgroundColor",S)},fillColor:S=>{F("fillColor","backgroundColor",S)},fgColor:S=>{F("fgColor","color",S)},textColor:S=>{F("textColor","color",S)},borderColor:S=>{F("borderColor","borderColor",S)},strokeColor:S=>{F("strokeColor","borderColor",S)},rotation:S=>{const J=S.detail.rotation;this.setRotation(J),this.annotationStorage.setValue(this.data.id,{rotation:J})}})}_dispatchEventFromSandbox(F,S){var it;const J=this._commonActions;for(const ct of Object.keys(S.detail))(it=F[ct]||J[ct])==null||it(S)}_setDefaultPropertiesFromJS(F){if(!this.enableScripting)return;const S=this.annotationStorage.getRawValue(this.data.id);if(!S)return;const J=this._commonActions;for(const[it,ct]of Object.entries(S)){const wt=J[it];if(wt){const vt={detail:{[it]:ct},target:F};wt(vt),delete S[it]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:F}=this.data;if(!F)return;const[S,J,it,ct]=this.data.rect;if(F.length===1){const[,{x:Qt,y:ue},{x:ce,y:we}]=F[0];if(it===Qt&&ct===ue&&S===ce&&J===we)return}const{style:wt}=this.container;let vt;if(t(this,le)){const{borderColor:Qt,borderWidth:ue}=wt;wt.borderWidth=0,vt=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Qt}" stroke-width="${ue}">`],this.container.classList.add("hasBorder")}const zt=it-S,jt=ct-J,{svgFactory:Nt}=this,Yt=Nt.createElement("svg");Yt.classList.add("quadrilateralsContainer"),Yt.setAttribute("width",0),Yt.setAttribute("height",0);const $t=Nt.createElement("defs");Yt.append($t);const xt=Nt.createElement("clipPath"),Bt=`clippath_${this.data.id}`;xt.setAttribute("id",Bt),xt.setAttribute("clipPathUnits","objectBoundingBox"),$t.append(xt);for(const[,{x:Qt,y:ue},{x:ce,y:we}]of F){const Me=Nt.createElement("rect"),ts=(ce-S)/zt,We=(ct-ue)/jt,Xe=(Qt-ce)/zt,ns=(ue-we)/jt;Me.setAttribute("x",ts),Me.setAttribute("y",We),Me.setAttribute("width",Xe),Me.setAttribute("height",ns),xt.append(Me),vt==null||vt.push(`<rect vector-effect="non-scaling-stroke" x="${ts}" y="${We}" width="${Xe}" height="${ns}"/>`)}t(this,le)&&(vt.push("</g></svg>')"),wt.backgroundImage=vt.join("")),this.container.append(Yt),this.container.style.clipPath=`url(#${Bt})`}_createPopup(){const{container:F,data:S}=this;F.setAttribute("aria-haspopup","dialog");const J=new bt({data:{color:S.color,titleObj:S.titleObj,modificationDate:S.modificationDate,contentsObj:S.contentsObj,richText:S.richText,parentRect:S.rect,borderStyle:0,id:`popup_${S.id}`,rotation:S.rotation},parent:this.parent,elements:[this]});this.parent.div.append(J.render())}render(){(0,e.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(F,S=null){const J=[];if(this._fieldObjects){const it=this._fieldObjects[F];if(it)for(const{page:ct,id:wt,exportValues:vt}of it){if(ct===-1||wt===S)continue;const zt=typeof vt=="string"?vt:null,jt=document.querySelector(`[data-element-id="${wt}"]`);if(jt&&!C.has(jt)){(0,e.warn)(`_getElementsByName - element not allowed: ${wt}`);continue}J.push({id:wt,exportValue:zt,domElement:jt})}return J}for(const it of document.getElementsByName(F)){const{exportValue:ct}=it,wt=it.getAttribute("data-element-id");wt!==S&&C.has(it)&&J.push({id:wt,exportValue:ct,domElement:it})}return J}show(){var F;this.container&&(this.container.hidden=!1),(F=this.popup)==null||F.maybeShow()}hide(){var F;this.container&&(this.container.hidden=!0),(F=this.popup)==null||F.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const F=this.getElementsToTriggerPopup();if(Array.isArray(F))for(const S of F)S.classList.add("highlightArea");else F.classList.add("highlightArea")}get _isEditable(){return!1}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:F,data:{id:S}}=this;this.container.addEventListener("dblclick",()=>{var J;(J=this.linkService.eventBus)==null||J.dispatch("switchannotationeditormode",{source:this,mode:F,editId:S})})}};le=new WeakMap;let U=be;class Y extends U{constructor(S,J=null){super(S,{isRenderable:!0,ignoreBorder:!!(J!=null&&J.ignoreBorder),createQuadrilaterals:!0});l(this,Vt);l(this,Ce);l(this,Ee);this.isTooltipOnly=S.data.isTooltipOnly}render(){const{data:S,linkService:J}=this,it=document.createElement("a");it.setAttribute("data-element-id",S.id);let ct=!1;return S.url?(J.addLinkAttributes(it,S.url,S.newWindow),ct=!0):S.action?(this._bindNamedAction(it,S.action),ct=!0):S.attachment?(T(this,Ce,Gr).call(this,it,S.attachment,S.attachmentDest),ct=!0):S.setOCGState?(T(this,Ee,qr).call(this,it,S.setOCGState),ct=!0):S.dest?(this._bindLink(it,S.dest),ct=!0):(S.actions&&(S.actions.Action||S.actions["Mouse Up"]||S.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(it,S),ct=!0),S.resetForm?(this._bindResetFormAction(it,S.resetForm),ct=!0):this.isTooltipOnly&&!ct&&(this._bindLink(it,""),ct=!0)),this.container.classList.add("linkAnnotation"),ct&&this.container.append(it),this.container}_bindLink(S,J){S.href=this.linkService.getDestinationHash(J),S.onclick=()=>(J&&this.linkService.goToDestination(J),!1),(J||J==="")&&T(this,Vt,Ns).call(this)}_bindNamedAction(S,J){S.href=this.linkService.getAnchorUrl(""),S.onclick=()=>(this.linkService.executeNamedAction(J),!1),T(this,Vt,Ns).call(this)}_bindJSAction(S,J){S.href=this.linkService.getAnchorUrl("");const it=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const ct of Object.keys(J.actions)){const wt=it.get(ct);wt&&(S[wt]=()=>{var vt;return(vt=this.linkService.eventBus)==null||vt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:J.id,name:ct}}),!1})}S.onclick||(S.onclick=()=>!1),T(this,Vt,Ns).call(this)}_bindResetFormAction(S,J){const it=S.onclick;if(it||(S.href=this.linkService.getAnchorUrl("")),T(this,Vt,Ns).call(this),!this._fieldObjects){(0,e.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),it||(S.onclick=()=>!1);return}S.onclick=()=>{var Yt;it==null||it();const{fields:ct,refs:wt,include:vt}=J,zt=[];if(ct.length!==0||wt.length!==0){const $t=new Set(wt);for(const xt of ct){const Bt=this._fieldObjects[xt]||[];for(const{id:Qt}of Bt)$t.add(Qt)}for(const xt of Object.values(this._fieldObjects))for(const Bt of xt)$t.has(Bt.id)===vt&&zt.push(Bt)}else for(const $t of Object.values(this._fieldObjects))zt.push(...$t);const jt=this.annotationStorage,Nt=[];for(const $t of zt){const{id:xt}=$t;switch(Nt.push(xt),$t.type){case"text":{const Qt=$t.defaultValue||"";jt.setValue(xt,{value:Qt});break}case"checkbox":case"radiobutton":{const Qt=$t.defaultValue===$t.exportValues;jt.setValue(xt,{value:Qt});break}case"combobox":case"listbox":{const Qt=$t.defaultValue||"";jt.setValue(xt,{value:Qt});break}default:continue}const Bt=document.querySelector(`[data-element-id="${xt}"]`);if(Bt){if(!C.has(Bt)){(0,e.warn)(`_bindResetFormAction - element not allowed: ${xt}`);continue}}else continue;Bt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Yt=this.linkService.eventBus)==null||Yt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Nt,name:"ResetForm"}})),!1}}}Vt=new WeakSet,Ns=function(){this.container.setAttribute("data-internal-link","")},Ce=new WeakSet,Gr=function(S,J,it=null){S.href=this.linkService.getAnchorUrl(""),S.onclick=()=>{var ct;return(ct=this.downloadManager)==null||ct.openOrDownloadData(J.content,J.filename,it),!1},T(this,Vt,Ns).call(this)},Ee=new WeakSet,qr=function(S,J){S.href=this.linkService.getAnchorUrl(""),S.onclick=()=>(this.linkService.executeSetOCGState(J),!1),T(this,Vt,Ns).call(this)};class at extends U{constructor(F){super(F,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const F=document.createElement("img");return F.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",F.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),F.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(F),this.container}}class Q extends U{render(){return this.container}showElementAndHideCanvas(F){var S;this.data.hasOwnCanvas&&(((S=F.previousSibling)==null?void 0:S.nodeName)==="CANVAS"&&(F.previousSibling.hidden=!0),F.hidden=!1)}_getKeyModifier(F){return e.FeatureTest.platform.isMac?F.metaKey:F.ctrlKey}_setEventListener(F,S,J,it,ct){J.includes("mouse")?F.addEventListener(J,wt=>{var vt;(vt=this.linkService.eventBus)==null||vt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:it,value:ct(wt),shift:wt.shiftKey,modifier:this._getKeyModifier(wt)}})}):F.addEventListener(J,wt=>{var vt;if(J==="blur"){if(!S.focused||!wt.relatedTarget)return;S.focused=!1}else if(J==="focus"){if(S.focused)return;S.focused=!0}ct&&((vt=this.linkService.eventBus)==null||vt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:it,value:ct(wt)}}))})}_setEventListeners(F,S,J,it){var ct,wt,vt;for(const[zt,jt]of J)(jt==="Action"||(ct=this.data.actions)!=null&&ct[jt])&&((jt==="Focus"||jt==="Blur")&&(S||(S={focused:!1})),this._setEventListener(F,S,zt,jt,it),jt==="Focus"&&!((wt=this.data.actions)!=null&&wt.Blur)?this._setEventListener(F,S,"blur","Blur",null):jt==="Blur"&&!((vt=this.data.actions)!=null&&vt.Focus)&&this._setEventListener(F,S,"focus","Focus",null))}_setBackgroundColor(F){const S=this.data.backgroundColor||null;F.style.backgroundColor=S===null?"transparent":e.Util.makeHexColor(S[0],S[1],S[2])}_setTextStyle(F){const S=["left","center","right"],{fontColor:J}=this.data.defaultAppearanceData,it=this.data.defaultAppearanceData.fontSize||O,ct=F.style;let wt;const vt=2,zt=jt=>Math.round(10*jt)/10;if(this.data.multiLine){const jt=Math.abs(this.data.rect[3]-this.data.rect[1]-vt),Nt=Math.round(jt/(e.LINE_FACTOR*it))||1,Yt=jt/Nt;wt=Math.min(it,zt(Yt/e.LINE_FACTOR))}else{const jt=Math.abs(this.data.rect[3]-this.data.rect[1]-vt);wt=Math.min(it,zt(jt/e.LINE_FACTOR))}ct.fontSize=`calc(${wt}px * var(--scale-factor))`,ct.color=e.Util.makeHexColor(J[0],J[1],J[2]),this.data.textAlignment!==null&&(ct.textAlign=S[this.data.textAlignment])}_setRequired(F,S){S?F.setAttribute("required",!0):F.removeAttribute("required"),F.setAttribute("aria-required",S)}}class L extends Q{constructor(F){const S=F.renderForms||F.data.hasOwnCanvas||!F.data.hasAppearance&&!!F.data.fieldValue;super(F,{isRenderable:S})}setPropertyOnSiblings(F,S,J,it){const ct=this.annotationStorage;for(const wt of this._getElementsByName(F.name,F.id))wt.domElement&&(wt.domElement[S]=J),ct.setValue(wt.id,{[it]:J})}render(){var it,ct;const F=this.annotationStorage,S=this.data.id;this.container.classList.add("textWidgetAnnotation");let J=null;if(this.renderForms){const wt=F.getValue(S,{value:this.data.fieldValue});let vt=wt.value||"";const zt=F.getValue(S,{charLimit:this.data.maxLen}).charLimit;zt&&vt.length>zt&&(vt=vt.slice(0,zt));let jt=wt.formattedValue||((it=this.data.textContent)==null?void 0:it.join(`
`))||null;jt&&this.data.comb&&(jt=jt.replaceAll(/\s+/g,""));const Nt={userValue:vt,formattedValue:jt,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(J=document.createElement("textarea"),J.textContent=jt??vt,this.data.doNotScroll&&(J.style.overflowY="hidden")):(J=document.createElement("input"),J.type="text",J.setAttribute("value",jt??vt),this.data.doNotScroll&&(J.style.overflowX="hidden")),this.data.hasOwnCanvas&&(J.hidden=!0),C.add(J),J.setAttribute("data-element-id",S),J.disabled=this.data.readOnly,J.name=this.data.fieldName,J.tabIndex=f,this._setRequired(J,this.data.required),zt&&(J.maxLength=zt),J.addEventListener("input",$t=>{F.setValue(S,{value:$t.target.value}),this.setPropertyOnSiblings(J,"value",$t.target.value,"value"),Nt.formattedValue=null}),J.addEventListener("resetform",$t=>{const xt=this.data.defaultFieldValue??"";J.value=Nt.userValue=xt,Nt.formattedValue=null});let Yt=$t=>{const{formattedValue:xt}=Nt;xt!=null&&($t.target.value=xt),$t.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){J.addEventListener("focus",xt=>{var Qt;if(Nt.focused)return;const{target:Bt}=xt;Nt.userValue&&(Bt.value=Nt.userValue),Nt.lastCommittedValue=Bt.value,Nt.commitKey=1,(Qt=this.data.actions)!=null&&Qt.Focus||(Nt.focused=!0)}),J.addEventListener("updatefromsandbox",xt=>{this.showElementAndHideCanvas(xt.target);const Bt={value(Qt){Nt.userValue=Qt.detail.value??"",F.setValue(S,{value:Nt.userValue.toString()}),Qt.target.value=Nt.userValue},formattedValue(Qt){const{formattedValue:ue}=Qt.detail;Nt.formattedValue=ue,ue!=null&&Qt.target!==document.activeElement&&(Qt.target.value=ue),F.setValue(S,{formattedValue:ue})},selRange(Qt){Qt.target.setSelectionRange(...Qt.detail.selRange)},charLimit:Qt=>{var Me;const{charLimit:ue}=Qt.detail,{target:ce}=Qt;if(ue===0){ce.removeAttribute("maxLength");return}ce.setAttribute("maxLength",ue);let we=Nt.userValue;!we||we.length<=ue||(we=we.slice(0,ue),ce.value=Nt.userValue=we,F.setValue(S,{value:we}),(Me=this.linkService.eventBus)==null||Me.dispatch("dispatcheventinsandbox",{source:this,detail:{id:S,name:"Keystroke",value:we,willCommit:!0,commitKey:1,selStart:ce.selectionStart,selEnd:ce.selectionEnd}}))}};this._dispatchEventFromSandbox(Bt,xt)}),J.addEventListener("keydown",xt=>{var ue;Nt.commitKey=1;let Bt=-1;if(xt.key==="Escape"?Bt=0:xt.key==="Enter"&&!this.data.multiLine?Bt=2:xt.key==="Tab"&&(Nt.commitKey=3),Bt===-1)return;const{value:Qt}=xt.target;Nt.lastCommittedValue!==Qt&&(Nt.lastCommittedValue=Qt,Nt.userValue=Qt,(ue=this.linkService.eventBus)==null||ue.dispatch("dispatcheventinsandbox",{source:this,detail:{id:S,name:"Keystroke",value:Qt,willCommit:!0,commitKey:Bt,selStart:xt.target.selectionStart,selEnd:xt.target.selectionEnd}}))});const $t=Yt;Yt=null,J.addEventListener("blur",xt=>{var Qt,ue;if(!Nt.focused||!xt.relatedTarget)return;(Qt=this.data.actions)!=null&&Qt.Blur||(Nt.focused=!1);const{value:Bt}=xt.target;Nt.userValue=Bt,Nt.lastCommittedValue!==Bt&&((ue=this.linkService.eventBus)==null||ue.dispatch("dispatcheventinsandbox",{source:this,detail:{id:S,name:"Keystroke",value:Bt,willCommit:!0,commitKey:Nt.commitKey,selStart:xt.target.selectionStart,selEnd:xt.target.selectionEnd}})),$t(xt)}),(ct=this.data.actions)!=null&&ct.Keystroke&&J.addEventListener("beforeinput",xt=>{var We;Nt.lastCommittedValue=null;const{data:Bt,target:Qt}=xt,{value:ue,selectionStart:ce,selectionEnd:we}=Qt;let Me=ce,ts=we;switch(xt.inputType){case"deleteWordBackward":{const Xe=ue.substring(0,ce).match(/\w*[^\w]*$/);Xe&&(Me-=Xe[0].length);break}case"deleteWordForward":{const Xe=ue.substring(ce).match(/^[^\w]*\w*/);Xe&&(ts+=Xe[0].length);break}case"deleteContentBackward":ce===we&&(Me-=1);break;case"deleteContentForward":ce===we&&(ts+=1);break}xt.preventDefault(),(We=this.linkService.eventBus)==null||We.dispatch("dispatcheventinsandbox",{source:this,detail:{id:S,name:"Keystroke",value:ue,change:Bt||"",willCommit:!1,selStart:Me,selEnd:ts}})}),this._setEventListeners(J,Nt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],xt=>xt.target.value)}if(Yt&&J.addEventListener("blur",Yt),this.data.comb){const $t=(this.data.rect[2]-this.data.rect[0])/zt;J.classList.add("comb"),J.style.letterSpacing=`calc(${$t}px * var(--scale-factor) - 1ch)`}}else J=document.createElement("div"),J.textContent=this.data.fieldValue,J.style.verticalAlign="middle",J.style.display="table-cell",this.data.hasOwnCanvas&&(J.hidden=!0);return this._setTextStyle(J),this._setBackgroundColor(J),this._setDefaultPropertiesFromJS(J),this.container.append(J),this.container}}class V extends Q{constructor(F){super(F,{isRenderable:!!F.data.hasOwnCanvas})}}class $ extends Q{constructor(F){super(F,{isRenderable:F.renderForms})}render(){const F=this.annotationStorage,S=this.data,J=S.id;let it=F.getValue(J,{value:S.exportValue===S.fieldValue}).value;typeof it=="string"&&(it=it!=="Off",F.setValue(J,{value:it})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const ct=document.createElement("input");return C.add(ct),ct.setAttribute("data-element-id",J),ct.disabled=S.readOnly,this._setRequired(ct,this.data.required),ct.type="checkbox",ct.name=S.fieldName,it&&ct.setAttribute("checked",!0),ct.setAttribute("exportValue",S.exportValue),ct.tabIndex=f,ct.addEventListener("change",wt=>{const{name:vt,checked:zt}=wt.target;for(const jt of this._getElementsByName(vt,J)){const Nt=zt&&jt.exportValue===S.exportValue;jt.domElement&&(jt.domElement.checked=Nt),F.setValue(jt.id,{value:Nt})}F.setValue(J,{value:zt})}),ct.addEventListener("resetform",wt=>{const vt=S.defaultFieldValue||"Off";wt.target.checked=vt===S.exportValue}),this.enableScripting&&this.hasJSActions&&(ct.addEventListener("updatefromsandbox",wt=>{const vt={value(zt){zt.target.checked=zt.detail.value!=="Off",F.setValue(J,{value:zt.target.checked})}};this._dispatchEventFromSandbox(vt,wt)}),this._setEventListeners(ct,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],wt=>wt.target.checked)),this._setBackgroundColor(ct),this._setDefaultPropertiesFromJS(ct),this.container.append(ct),this.container}}class N extends Q{constructor(F){super(F,{isRenderable:F.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const F=this.annotationStorage,S=this.data,J=S.id;let it=F.getValue(J,{value:S.fieldValue===S.buttonValue}).value;if(typeof it=="string"&&(it=it!==S.buttonValue,F.setValue(J,{value:it})),it)for(const wt of this._getElementsByName(S.fieldName,J))F.setValue(wt.id,{value:!1});const ct=document.createElement("input");if(C.add(ct),ct.setAttribute("data-element-id",J),ct.disabled=S.readOnly,this._setRequired(ct,this.data.required),ct.type="radio",ct.name=S.fieldName,it&&ct.setAttribute("checked",!0),ct.tabIndex=f,ct.addEventListener("change",wt=>{const{name:vt,checked:zt}=wt.target;for(const jt of this._getElementsByName(vt,J))F.setValue(jt.id,{value:!1});F.setValue(J,{value:zt})}),ct.addEventListener("resetform",wt=>{const vt=S.defaultFieldValue;wt.target.checked=vt!=null&&vt===S.buttonValue}),this.enableScripting&&this.hasJSActions){const wt=S.buttonValue;ct.addEventListener("updatefromsandbox",vt=>{const zt={value:jt=>{const Nt=wt===jt.detail.value;for(const Yt of this._getElementsByName(jt.target.name)){const $t=Nt&&Yt.id===J;Yt.domElement&&(Yt.domElement.checked=$t),F.setValue(Yt.id,{value:$t})}}};this._dispatchEventFromSandbox(zt,vt)}),this._setEventListeners(ct,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],vt=>vt.target.checked)}return this._setBackgroundColor(ct),this._setDefaultPropertiesFromJS(ct),this.container.append(ct),this.container}}class q extends Y{constructor(F){super(F,{ignoreBorder:F.data.hasAppearance})}render(){const F=super.render();F.classList.add("buttonWidgetAnnotation","pushButton");const S=F.lastChild;return this.enableScripting&&this.hasJSActions&&S&&(this._setDefaultPropertiesFromJS(S),S.addEventListener("updatefromsandbox",J=>{this._dispatchEventFromSandbox({},J)})),F}}class tt extends Q{constructor(F){super(F,{isRenderable:F.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const F=this.annotationStorage,S=this.data.id,J=F.getValue(S,{value:this.data.fieldValue}),it=document.createElement("select");C.add(it),it.setAttribute("data-element-id",S),it.disabled=this.data.readOnly,this._setRequired(it,this.data.required),it.name=this.data.fieldName,it.tabIndex=f;let ct=this.data.combo&&this.data.options.length>0;this.data.combo||(it.size=this.data.options.length,this.data.multiSelect&&(it.multiple=!0)),it.addEventListener("resetform",Nt=>{const Yt=this.data.defaultFieldValue;for(const $t of it.options)$t.selected=$t.value===Yt});for(const Nt of this.data.options){const Yt=document.createElement("option");Yt.textContent=Nt.displayValue,Yt.value=Nt.exportValue,J.value.includes(Nt.exportValue)&&(Yt.setAttribute("selected",!0),ct=!1),it.append(Yt)}let wt=null;if(ct){const Nt=document.createElement("option");Nt.value=" ",Nt.setAttribute("hidden",!0),Nt.setAttribute("selected",!0),it.prepend(Nt),wt=()=>{Nt.remove(),it.removeEventListener("input",wt),wt=null},it.addEventListener("input",wt)}const vt=Nt=>{const Yt=Nt?"value":"textContent",{options:$t,multiple:xt}=it;return xt?Array.prototype.filter.call($t,Bt=>Bt.selected).map(Bt=>Bt[Yt]):$t.selectedIndex===-1?null:$t[$t.selectedIndex][Yt]};let zt=vt(!1);const jt=Nt=>{const Yt=Nt.target.options;return Array.prototype.map.call(Yt,$t=>({displayValue:$t.textContent,exportValue:$t.value}))};return this.enableScripting&&this.hasJSActions?(it.addEventListener("updatefromsandbox",Nt=>{const Yt={value($t){wt==null||wt();const xt=$t.detail.value,Bt=new Set(Array.isArray(xt)?xt:[xt]);for(const Qt of it.options)Qt.selected=Bt.has(Qt.value);F.setValue(S,{value:vt(!0)}),zt=vt(!1)},multipleSelection($t){it.multiple=!0},remove($t){const xt=it.options,Bt=$t.detail.remove;xt[Bt].selected=!1,it.remove(Bt),xt.length>0&&Array.prototype.findIndex.call(xt,Qt=>Qt.selected)===-1&&(xt[0].selected=!0),F.setValue(S,{value:vt(!0),items:jt($t)}),zt=vt(!1)},clear($t){for(;it.length!==0;)it.remove(0);F.setValue(S,{value:null,items:[]}),zt=vt(!1)},insert($t){const{index:xt,displayValue:Bt,exportValue:Qt}=$t.detail.insert,ue=it.children[xt],ce=document.createElement("option");ce.textContent=Bt,ce.value=Qt,ue?ue.before(ce):it.append(ce),F.setValue(S,{value:vt(!0),items:jt($t)}),zt=vt(!1)},items($t){const{items:xt}=$t.detail;for(;it.length!==0;)it.remove(0);for(const Bt of xt){const{displayValue:Qt,exportValue:ue}=Bt,ce=document.createElement("option");ce.textContent=Qt,ce.value=ue,it.append(ce)}it.options.length>0&&(it.options[0].selected=!0),F.setValue(S,{value:vt(!0),items:jt($t)}),zt=vt(!1)},indices($t){const xt=new Set($t.detail.indices);for(const Bt of $t.target.options)Bt.selected=xt.has(Bt.index);F.setValue(S,{value:vt(!0)}),zt=vt(!1)},editable($t){$t.target.disabled=!$t.detail.editable}};this._dispatchEventFromSandbox(Yt,Nt)}),it.addEventListener("input",Nt=>{var $t;const Yt=vt(!0);F.setValue(S,{value:Yt}),Nt.preventDefault(),($t=this.linkService.eventBus)==null||$t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:S,name:"Keystroke",value:zt,changeEx:Yt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(it,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Nt=>Nt.target.value)):it.addEventListener("input",function(Nt){F.setValue(S,{value:vt(!0)})}),this.data.combo&&this._setTextStyle(it),this._setBackgroundColor(it),this._setDefaultPropertiesFromJS(it),this.container.append(it),this.container}}class bt extends U{constructor(F){const{data:S,elements:J}=F;super(F,{isRenderable:U._hasPopupData(S)}),this.elements=J}render(){this.container.classList.add("popupAnnotation");const F=new Ft({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),S=[];for(const J of this.elements)J.popup=F,S.push(J.data.id),J.addHighlightArea();return this.container.setAttribute("aria-controls",S.map(J=>`${e.AnnotationPrefix}${J}`).join(",")),this.container}}class Ft{constructor({container:F,color:S,elements:J,titleObj:it,modificationDate:ct,contentsObj:wt,richText:vt,parent:zt,rect:jt,parentRect:Nt,open:Yt}){l(this,yt);l(this,ut);l(this,P);l(this,nt);l(this,et,T(this,yt,zr).bind(this));l(this,i,T(this,nt,kn).bind(this));l(this,n,T(this,P,Mn).bind(this));l(this,d,T(this,ut,Xi).bind(this));l(this,g,null);l(this,o,null);l(this,A,null);l(this,v,null);l(this,E,null);l(this,u,null);l(this,a,null);l(this,h,!1);l(this,R,null);l(this,j,null);l(this,G,null);l(this,rt,null);l(this,ot,!1);var $t;I(this,o,F),I(this,rt,it),I(this,A,wt),I(this,G,vt),I(this,u,zt),I(this,g,S),I(this,j,jt),I(this,a,Nt),I(this,E,J),I(this,v,w.PDFDateString.toDateObject(ct)),this.trigger=J.flatMap(xt=>xt.getElementsToTriggerPopup());for(const xt of this.trigger)xt.addEventListener("click",t(this,d)),xt.addEventListener("mouseenter",t(this,n)),xt.addEventListener("mouseleave",t(this,i)),xt.classList.add("popupTriggerArea");for(const xt of J)($t=xt.container)==null||$t.addEventListener("keydown",t(this,et));t(this,o).hidden=!0,Yt&&T(this,ut,Xi).call(this)}render(){if(t(this,R))return;const{page:{view:F},viewport:{rawDims:{pageWidth:S,pageHeight:J,pageX:it,pageY:ct}}}=t(this,u),wt=I(this,R,document.createElement("div"));if(wt.className="popup",t(this,g)){const we=wt.style.outlineColor=e.Util.makeHexColor(...t(this,g));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?wt.style.backgroundColor=`color-mix(in srgb, ${we} 30%, white)`:wt.style.backgroundColor=e.Util.makeHexColor(...t(this,g).map(Me=>Math.floor(.7*(255-Me)+Me)))}const vt=document.createElement("span");vt.className="header";const zt=document.createElement("h1");if(vt.append(zt),{dir:zt.dir,str:zt.textContent}=t(this,rt),wt.append(vt),t(this,v)){const we=document.createElement("span");we.classList.add("popupDate"),we.setAttribute("data-l10n-id","pdfjs-annotation-date-string"),we.setAttribute("data-l10n-args",JSON.stringify({date:t(this,v).toLocaleDateString(),time:t(this,v).toLocaleTimeString()})),vt.append(we)}const jt=t(this,A),Nt=t(this,G);if(Nt!=null&&Nt.str&&(!(jt!=null&&jt.str)||jt.str===Nt.str))y.XfaLayer.render({xfaHtml:Nt.html,intent:"richText",div:wt}),wt.lastChild.classList.add("richText","popupContent");else{const we=this._formatContents(jt);wt.append(we)}let Yt=!!t(this,a),$t=Yt?t(this,a):t(this,j);for(const we of t(this,E))if(!$t||e.Util.intersect(we.data.rect,$t)!==null){$t=we.data.rect,Yt=!0;break}const xt=e.Util.normalizeRect([$t[0],F[3]-$t[1]+F[1],$t[2],F[3]-$t[3]+F[1]]),Bt=Yt?$t[2]-$t[0]+5:0,Qt=xt[0]+Bt,ue=xt[1],{style:ce}=t(this,o);ce.left=`${100*(Qt-it)/S}%`,ce.top=`${100*(ue-ct)/J}%`,t(this,o).append(wt)}_formatContents({str:F,dir:S}){const J=document.createElement("p");J.classList.add("popupContent"),J.dir=S;const it=F.split(/(?:\r\n?|\n)/);for(let ct=0,wt=it.length;ct<wt;++ct){const vt=it[ct];J.append(document.createTextNode(vt)),ct<wt-1&&J.append(document.createElement("br"))}return J}forceHide(){I(this,ot,this.isVisible),t(this,ot)&&(t(this,o).hidden=!0)}maybeShow(){t(this,ot)&&(I(this,ot,!1),t(this,o).hidden=!1)}get isVisible(){return t(this,o).hidden===!1}}et=new WeakMap,i=new WeakMap,n=new WeakMap,d=new WeakMap,g=new WeakMap,o=new WeakMap,A=new WeakMap,v=new WeakMap,E=new WeakMap,u=new WeakMap,a=new WeakMap,h=new WeakMap,R=new WeakMap,j=new WeakMap,G=new WeakMap,rt=new WeakMap,ot=new WeakMap,yt=new WeakSet,zr=function(F){F.altKey||F.shiftKey||F.ctrlKey||F.metaKey||(F.key==="Enter"||F.key==="Escape"&&t(this,h))&&T(this,ut,Xi).call(this)},ut=new WeakSet,Xi=function(){I(this,h,!t(this,h)),t(this,h)?(T(this,P,Mn).call(this),t(this,o).addEventListener("click",t(this,d)),t(this,o).addEventListener("keydown",t(this,et))):(T(this,nt,kn).call(this),t(this,o).removeEventListener("click",t(this,d)),t(this,o).removeEventListener("keydown",t(this,et)))},P=new WeakSet,Mn=function(){t(this,R)||this.render(),this.isVisible?t(this,h)&&t(this,o).classList.add("focused"):(t(this,o).hidden=!1,t(this,o).style.zIndex=parseInt(t(this,o).style.zIndex)+1e3)},nt=new WeakSet,kn=function(){t(this,o).classList.remove("focused"),!(t(this,h)||!this.isVisible)&&(t(this,o).hidden=!0,t(this,o).style.zIndex=parseInt(t(this,o).style.zIndex)-1e3)};class Ct extends U{constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0}),this.textContent=F.data.textContent,this.textPosition=F.data.textPosition,this.annotationEditorType=e.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const F=document.createElement("div");F.classList.add("annotationTextContent"),F.setAttribute("role","comment");for(const S of this.textContent){const J=document.createElement("span");J.textContent=S,F.append(J)}this.container.append(F)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}get _isEditable(){return this.data.hasOwnCanvas}}class Ot extends U{constructor(S){super(S,{isRenderable:!0,ignoreBorder:!0});l(this,b,null)}render(){this.container.classList.add("lineAnnotation");const S=this.data,{width:J,height:it}=_(S.rect),ct=this.svgFactory.create(J,it,!0),wt=I(this,b,this.svgFactory.createElement("svg:line"));return wt.setAttribute("x1",S.rect[2]-S.lineCoordinates[0]),wt.setAttribute("y1",S.rect[3]-S.lineCoordinates[1]),wt.setAttribute("x2",S.rect[2]-S.lineCoordinates[2]),wt.setAttribute("y2",S.rect[3]-S.lineCoordinates[3]),wt.setAttribute("stroke-width",S.borderStyle.width||1),wt.setAttribute("stroke","transparent"),wt.setAttribute("fill","transparent"),ct.append(wt),this.container.append(ct),!S.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,b)}addHighlightArea(){this.container.classList.add("highlightArea")}}b=new WeakMap;class _t extends U{constructor(S){super(S,{isRenderable:!0,ignoreBorder:!0});l(this,z,null)}render(){this.container.classList.add("squareAnnotation");const S=this.data,{width:J,height:it}=_(S.rect),ct=this.svgFactory.create(J,it,!0),wt=S.borderStyle.width,vt=I(this,z,this.svgFactory.createElement("svg:rect"));return vt.setAttribute("x",wt/2),vt.setAttribute("y",wt/2),vt.setAttribute("width",J-wt),vt.setAttribute("height",it-wt),vt.setAttribute("stroke-width",wt||1),vt.setAttribute("stroke","transparent"),vt.setAttribute("fill","transparent"),ct.append(vt),this.container.append(ct),!S.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,z)}addHighlightArea(){this.container.classList.add("highlightArea")}}z=new WeakMap;class Mt extends U{constructor(S){super(S,{isRenderable:!0,ignoreBorder:!0});l(this,X,null)}render(){this.container.classList.add("circleAnnotation");const S=this.data,{width:J,height:it}=_(S.rect),ct=this.svgFactory.create(J,it,!0),wt=S.borderStyle.width,vt=I(this,X,this.svgFactory.createElement("svg:ellipse"));return vt.setAttribute("cx",J/2),vt.setAttribute("cy",it/2),vt.setAttribute("rx",J/2-wt/2),vt.setAttribute("ry",it/2-wt/2),vt.setAttribute("stroke-width",wt||1),vt.setAttribute("stroke","transparent"),vt.setAttribute("fill","transparent"),ct.append(vt),this.container.append(ct),!S.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,X)}addHighlightArea(){this.container.classList.add("highlightArea")}}X=new WeakMap;class Lt extends U{constructor(S){super(S,{isRenderable:!0,ignoreBorder:!0});l(this,lt,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const S=this.data,{width:J,height:it}=_(S.rect),ct=this.svgFactory.create(J,it,!0);let wt=[];for(const zt of S.vertices){const jt=zt.x-S.rect[0],Nt=S.rect[3]-zt.y;wt.push(jt+","+Nt)}wt=wt.join(" ");const vt=I(this,lt,this.svgFactory.createElement(this.svgElementName));return vt.setAttribute("points",wt),vt.setAttribute("stroke-width",S.borderStyle.width||1),vt.setAttribute("stroke","transparent"),vt.setAttribute("fill","transparent"),ct.append(vt),this.container.append(ct),!S.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,lt)}addHighlightArea(){this.container.classList.add("highlightArea")}}lt=new WeakMap;class Et extends Lt{constructor(F){super(F),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Z extends U{constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class gt extends U{constructor(S){super(S,{isRenderable:!0,ignoreBorder:!0});l(this,ft,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=e.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const S=this.data,{width:J,height:it}=_(S.rect),ct=this.svgFactory.create(J,it,!0);for(const wt of S.inkLists){let vt=[];for(const jt of wt){const Nt=jt.x-S.rect[0],Yt=S.rect[3]-jt.y;vt.push(`${Nt},${Yt}`)}vt=vt.join(" ");const zt=this.svgFactory.createElement(this.svgElementName);t(this,ft).push(zt),zt.setAttribute("points",vt),zt.setAttribute("stroke-width",S.borderStyle.width||1),zt.setAttribute("stroke","transparent"),zt.setAttribute("fill","transparent"),!S.popupRef&&this.hasPopupData&&this._createPopup(),ct.append(zt)}return this.container.append(ct),this.container}getElementsToTriggerPopup(){return t(this,ft)}addHighlightArea(){this.container.classList.add("highlightArea")}}ft=new WeakMap;class Rt extends U{constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class Pt extends U{constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class qt extends U{constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Kt extends U{constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class ie extends U{constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class xe extends U{constructor(S){var ct;super(S,{isRenderable:!0});l(this,Dt);l(this,Tt,null);const{filename:J,content:it}=this.data.file;this.filename=(0,w.getFilenameFromUrl)(J,!0),this.content=it,(ct=this.linkService.eventBus)==null||ct.dispatch("fileattachmentannotation",{source:this,filename:J,content:it})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:S,data:J}=this;let it;J.hasAppearance||J.fillAlpha===0?it=document.createElement("div"):(it=document.createElement("img"),it.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(J.name)?"paperclip":"pushpin"}.svg`,J.fillAlpha&&J.fillAlpha<1&&(it.style=`filter: opacity(${Math.round(J.fillAlpha*100)}%);`)),it.addEventListener("dblclick",T(this,Dt,Ln).bind(this)),I(this,Tt,it);const{isMac:ct}=e.FeatureTest.platform;return S.addEventListener("keydown",wt=>{wt.key==="Enter"&&(ct?wt.metaKey:wt.ctrlKey)&&T(this,Dt,Ln).call(this)}),!J.popupRef&&this.hasPopupData?this._createPopup():it.classList.add("popupTriggerArea"),S.append(it),S}getElementsToTriggerPopup(){return t(this,Tt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Tt=new WeakMap,Dt=new WeakSet,Ln=function(){var S;(S=this.downloadManager)==null||S.openOrDownloadData(this.content,this.filename)};class de{constructor({div:F,accessibilityManager:S,annotationCanvasMap:J,page:it,viewport:ct}){l(this,_e);l(this,fe);l(this,re,null);l(this,he,null);l(this,Te,new Map);this.div=F,I(this,re,S),I(this,he,J),this.page=it,this.viewport=ct,this.zIndex=0}async render(F){const{annotations:S}=F,J=this.div;(0,w.setLayerDimensions)(J,this.viewport);const it=new Map,ct={data:null,layer:J,linkService:F.linkService,downloadManager:F.downloadManager,imageResourcesPath:F.imageResourcesPath||"",renderForms:F.renderForms!==!1,svgFactory:new w.DOMSVGFactory,annotationStorage:F.annotationStorage||new m.AnnotationStorage,enableScripting:F.enableScripting===!0,hasJSActions:F.hasJSActions,fieldObjects:F.fieldObjects,parent:this,elements:null};for(const wt of S){if(wt.noHTML)continue;const vt=wt.annotationType===e.AnnotationType.POPUP;if(vt){const Nt=it.get(wt.id);if(!Nt)continue;ct.elements=Nt}else{const{width:Nt,height:Yt}=_(wt.rect);if(Nt<=0||Yt<=0)continue}ct.data=wt;const zt=D.create(ct);if(!zt.isRenderable)continue;if(!vt&&wt.popupRef){const Nt=it.get(wt.popupRef);Nt?Nt.push(zt):it.set(wt.popupRef,[zt])}zt.annotationEditorType>0&&t(this,Te).set(zt.data.id,zt);const jt=zt.render();wt.hidden&&(jt.style.visibility="hidden"),T(this,_e,Wr).call(this,jt,wt.id)}T(this,fe,Rn).call(this)}update({viewport:F}){const S=this.div;this.viewport=F,(0,w.setLayerDimensions)(S,{rotation:F.rotation}),T(this,fe,Rn).call(this),S.hidden=!1}getEditableAnnotations(){return Array.from(t(this,Te).values())}getEditableAnnotation(F){return t(this,Te).get(F)}}re=new WeakMap,he=new WeakMap,Te=new WeakMap,_e=new WeakSet,Wr=function(F,S){var it;const J=F.firstChild||F;J.id=`${e.AnnotationPrefix}${S}`,this.div.append(F),(it=t(this,re))==null||it.moveElementInDOM(this.div,F,J,!1)},fe=new WeakSet,Rn=function(){if(!t(this,he))return;const F=this.div;for(const[S,J]of t(this,he)){const it=F.querySelector(`[data-annotation-id="${S}"]`);if(!it)continue;const{firstChild:ct}=it;ct?ct.nodeName==="CANVAS"?ct.replaceWith(J):ct.before(J):it.append(J)}t(this,he).clear()}},792:(r,p,c)=>{var y,f,O,Xr,_;c.d(p,{AnnotationStorage:()=>W,PrintAnnotationStorage:()=>k,SerializableEmpty:()=>x});var e=c(292),w=c(310),m=c(651);const x=Object.freeze({map:null,hash:"",transfer:void 0});class W{constructor(){l(this,O);l(this,y,!1);l(this,f,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(U,Y){const at=t(this,f).get(U);return at===void 0?Y:Object.assign(Y,at)}getRawValue(U){return t(this,f).get(U)}remove(U){if(t(this,f).delete(U),t(this,f).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const Y of t(this,f).values())if(Y instanceof w.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(U,Y){const at=t(this,f).get(U);let Q=!1;if(at!==void 0)for(const[L,V]of Object.entries(Y))at[L]!==V&&(Q=!0,at[L]=V);else Q=!0,t(this,f).set(U,Y);Q&&T(this,O,Xr).call(this),Y instanceof w.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(Y.constructor._type)}has(U){return t(this,f).has(U)}getAll(){return t(this,f).size>0?(0,e.objectFromMap)(t(this,f)):null}setAll(U){for(const[Y,at]of Object.entries(U))this.setValue(Y,at)}get size(){return t(this,f).size}resetModified(){t(this,y)&&(I(this,y,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new k(this)}get serializable(){if(t(this,f).size===0)return x;const U=new Map,Y=new m.MurmurHash3_64,at=[],Q=Object.create(null);let L=!1;for(const[V,$]of t(this,f)){const N=$ instanceof w.AnnotationEditor?$.serialize(!1,Q):$;N&&(U.set(V,N),Y.update(`${V}:${JSON.stringify(N)}`),L||(L=!!N.bitmap))}if(L)for(const V of U.values())V.bitmap&&at.push(V.bitmap);return U.size>0?{map:U,hash:Y.hexdigest(),transfer:at}:x}get editorStats(){let U=null;const Y=new Map;for(const at of t(this,f).values()){if(!(at instanceof w.AnnotationEditor))continue;const Q=at.telemetryFinalData;if(!Q)continue;const{type:L}=Q;Y.has(L)||Y.set(L,Object.getPrototypeOf(at).constructor),U||(U=Object.create(null));const V=U[L]||(U[L]=new Map);for(const[$,N]of Object.entries(Q)){if($==="type")continue;let q=V.get($);q||(q=new Map,V.set($,q));const tt=q.get(N)??0;q.set(N,tt+1)}}for(const[at,Q]of Y)U[at]=Q.computeTelemetryFinalData(U[at]);return U}}y=new WeakMap,f=new WeakMap,O=new WeakSet,Xr=function(){t(this,y)||(I(this,y,!0),typeof this.onSetModified=="function"&&this.onSetModified())};class k extends W{constructor(Y){super();l(this,_,void 0);const{map:at,hash:Q,transfer:L}=Y.serializable,V=structuredClone(at,L?{transfer:L}:null);I(this,_,{map:V,hash:Q,transfer:L})}get print(){(0,e.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,_)}}_=new WeakMap},831:(r,p,c)=>{c.a(r,async(e,w)=>{var N,q,tt,bt,Js,Ct,Ki,_t,Mt,Lt,Et,Z,Yi,Rt,Pt,qt,Kt,ie,yi,de,le,Pn,Vt,ae;try{let Ce=function(B){if(typeof B=="string"||B instanceof URL?B={url:B}:(B instanceof ArrayBuffer||ArrayBuffer.isView(B))&&(B={data:B}),typeof B!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!B.url&&!B.data&&!B.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const b=new v,{docId:z}=b,X=B.url?ee(B.url):null,lt=B.data?Ee(B.data):null,ft=B.httpHeaders||null,Tt=B.withCredentials===!0,Dt=B.password??null,te=B.range instanceof E?B.range:null,re=Number.isInteger(B.rangeChunkSize)&&B.rangeChunkSize>0?B.rangeChunkSize:ne;let he=B.worker instanceof j?B.worker:null;const Te=B.verbosity,_e=typeof B.docBaseUrl=="string"&&!(0,W.isDataScheme)(B.docBaseUrl)?B.docBaseUrl:null,Fe=typeof B.cMapUrl=="string"?B.cMapUrl:null,fe=B.cMapPacked!==!1,Le=B.CMapReaderFactory||d,se=typeof B.standardFontDataUrl=="string"?B.standardFontDataUrl:null,F=B.StandardFontDataFactory||o,S=B.stopAtErrors!==!0,J=Number.isInteger(B.maxImageSize)&&B.maxImageSize>-1?B.maxImageSize:-1,it=B.isEvalSupported!==!1,ct=typeof B.isOffscreenCanvasSupported=="boolean"?B.isOffscreenCanvasSupported:!m.isNodeJS,wt=Number.isInteger(B.canvasMaxAreaInBytes)?B.canvasMaxAreaInBytes:-1,vt=typeof B.disableFontFace=="boolean"?B.disableFontFace:m.isNodeJS,zt=B.fontExtraProperties===!0,jt=B.enableXfa===!0,Nt=B.ownerDocument||globalThis.document,Yt=B.disableRange===!0,$t=B.disableStream===!0,xt=B.disableAutoFetch===!0,Bt=B.pdfBug===!0,Qt=te?te.length:B.length??NaN,ue=typeof B.useSystemFonts=="boolean"?B.useSystemFonts:!m.isNodeJS&&!vt,ce=typeof B.useWorkerFetch=="boolean"?B.useWorkerFetch:Le===W.DOMCMapReaderFactory&&F===W.DOMStandardFontDataFactory&&Fe&&se&&(0,W.isValidFetchUrl)(Fe,document.baseURI)&&(0,W.isValidFetchUrl)(se,document.baseURI),we=B.canvasFactory||new n({ownerDocument:Nt}),Me=B.filterFactory||new g({docId:z,ownerDocument:Nt}),ts=null;(0,m.setVerbosityLevel)(Te);const We={canvasFactory:we,filterFactory:Me};if(ce||(We.cMapReaderFactory=new Le({baseUrl:Fe,isCompressed:fe}),We.standardFontDataFactory=new F({baseUrl:se})),!he){const Ve={verbosity:Te,port:C.GlobalWorkerOptions.workerPort};he=Ve.port?j.fromPort(Ve):new j(Ve),b._worker=he}const Xe={docId:z,apiVersion:"4.1.392",data:lt,password:Dt,disableAutoFetch:xt,rangeChunkSize:re,length:Qt,docBaseUrl:_e,enableXfa:jt,evaluatorOptions:{maxImageSize:J,disableFontFace:vt,ignoreErrors:S,isEvalSupported:it,isOffscreenCanvasSupported:ct,canvasMaxAreaInBytes:wt,fontExtraProperties:zt,useSystemFonts:ue,cMapUrl:ce?Fe:null,standardFontDataUrl:ce?se:null}},ns={ignoreErrors:S,isEvalSupported:it,disableFontFace:vt,fontExtraProperties:zt,enableXfa:jt,ownerDocument:Nt,disableAutoFetch:xt,pdfBug:Bt,styleElement:ts};return he.promise.then(function(){if(b.destroyed)throw new Error("Loading aborted");const Ve=A(he,Xe),H=new Promise(function(dt){let Ht;te?Ht=new Y.PDFDataTransportStream(te,{disableRange:Yt,disableStream:$t}):lt||(Ht=(Ut=>m.isNodeJS?function(){return typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype}()&&(0,W.isValidFetchUrl)(Ut.url)?new at.PDFFetchStream(Ut):new L.PDFNodeStream(Ut):(0,W.isValidFetchUrl)(Ut.url)?new at.PDFFetchStream(Ut):new Q.PDFNetworkStream(Ut))({url:X,length:Qt,httpHeaders:ft,withCredentials:Tt,rangeChunkSize:re,disableRange:Yt,disableStream:$t})),dt(Ht)});return Promise.all([Ve,H]).then(function([dt,Ht]){if(b.destroyed)throw new Error("Loading aborted");const Ut=new _.MessageHandler(z,dt,he.port),Jt=new G(Ut,b,Ht,ns,We);b._transport=Jt,Ut.send("Ready",null)})}).catch(b._capability.reject),b},ee=function(B){if(B instanceof URL)return B.href;try{return new URL(B,window.location).href}catch{if(m.isNodeJS&&typeof B=="string")return B}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")},Ee=function(B){if(m.isNodeJS&&typeof Buffer<"u"&&B instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(B instanceof Uint8Array&&B.byteLength===B.buffer.byteLength)return B;if(typeof B=="string")return(0,m.stringToBytes)(B);if(B instanceof ArrayBuffer||ArrayBuffer.isView(B)||typeof B=="object"&&!isNaN(B==null?void 0:B.length))return new Uint8Array(B);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")};c.d(p,{PDFDataRangeTransport:()=>E,PDFWorker:()=>j,build:()=>St,getDocument:()=>Ce,version:()=>ut});var m=c(292),x=c(792),W=c(419),k=c(10),y=c(573),f=c(923),O=c(814),C=c(164),_=c(178),D=c(62),U=c(626),Y=c(585),at=c(94),Q=c(457),L=c(786),V=c(50),$=e([y,L]);[y,L]=$.then?(await $)():$;const ne=65536,et=100,i=5e3,n=m.isNodeJS?y.NodeCanvasFactory:W.DOMCanvasFactory,d=m.isNodeJS?y.NodeCMapReaderFactory:W.DOMCMapReaderFactory,g=m.isNodeJS?y.NodeFilterFactory:W.DOMFilterFactory,o=m.isNodeJS?y.NodeStandardFontDataFactory:W.DOMStandardFontDataFactory;async function A(B,b){if(B.destroyed)throw new Error("Worker was destroyed");const z=await B.messageHandler.sendWithPromise("GetDocRequest",b,b.data?[b.data.buffer]:null);if(B.destroyed)throw new Error("Worker was destroyed");return z}const P=class P{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${bs(P,N)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var b,z,X;this.destroyed=!0;try{(b=this._worker)!=null&&b.port&&(this._worker._pendingDestroy=!0),await((z=this._transport)==null?void 0:z.destroy())}catch(lt){throw(X=this._worker)!=null&&X.port&&delete this._worker._pendingDestroy,lt}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};N=new WeakMap,l(P,N,0);let v=P;class E{constructor(b,z,X=!1,lt=null){this.length=b,this.initialData=z,this.progressiveDone=X,this.contentDispositionFilename=lt,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(b){this._rangeListeners.push(b)}addProgressListener(b){this._progressListeners.push(b)}addProgressiveReadListener(b){this._progressiveReadListeners.push(b)}addProgressiveDoneListener(b){this._progressiveDoneListeners.push(b)}onDataRange(b,z){for(const X of this._rangeListeners)X(b,z)}onDataProgress(b,z){this._readyCapability.promise.then(()=>{for(const X of this._progressListeners)X(b,z)})}onDataProgressiveRead(b){this._readyCapability.promise.then(()=>{for(const z of this._progressiveReadListeners)z(b)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const b of this._progressiveDoneListeners)b()})}transportReady(){this._readyCapability.resolve()}requestDataRange(b,z){(0,m.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class u{constructor(b,z){this._pdfInfo=b,this._transport=z}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,m.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(b){return this._transport.getPage(b)}getPageIndex(b){return this._transport.getPageIndex(b)}getDestinations(){return this._transport.getDestinations()}getDestination(b){return this._transport.getDestination(b)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:b="display"}={}){const{renderingIntent:z}=this._transport.getRenderingIntent(b);return this._transport.getOptionalContentConfig(z)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(b=!1){return this._transport.startCleanup(b||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class a{constructor(b,z,X,lt=!1){l(this,bt);l(this,Ct);l(this,q,null);l(this,tt,!1);this._pageIndex=b,this._pageInfo=z,this._transport=X,this._stats=lt?new W.StatTimer:null,this._pdfBug=lt,this.commonObjs=X.commonObjs,this.objs=new ot,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:b,rotation:z=this.rotate,offsetX:X=0,offsetY:lt=0,dontFlip:ft=!1}={}){return new W.PageViewport({viewBox:this.view,scale:b,rotation:z,offsetX:X,offsetY:lt,dontFlip:ft})}getAnnotations({intent:b="display"}={}){const{renderingIntent:z}=this._transport.getRenderingIntent(b);return this._transport.getAnnotations(this._pageIndex,z)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,m.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var b;return((b=this._transport._htmlForXfa)==null?void 0:b.children[this._pageIndex])||null}render({canvasContext:b,viewport:z,intent:X="display",annotationMode:lt=m.AnnotationMode.ENABLE,transform:ft=null,background:Tt=null,optionalContentConfigPromise:Dt=null,annotationCanvasMap:te=null,pageColors:re=null,printAnnotationStorage:he=null}){var J,it;(J=this._stats)==null||J.time("Overall");const Te=this._transport.getRenderingIntent(X,lt,he),{renderingIntent:_e,cacheKey:Fe}=Te;I(this,tt,!1),T(this,Ct,Ki).call(this),Dt||(Dt=this._transport.getOptionalContentConfig(_e));let fe=this._intentStates.get(Fe);fe||(fe=Object.create(null),this._intentStates.set(Fe,fe)),fe.streamReaderCancelTimeout&&(clearTimeout(fe.streamReaderCancelTimeout),fe.streamReaderCancelTimeout=null);const Le=!!(_e&m.RenderingIntentFlag.PRINT);fe.displayReadyCapability||(fe.displayReadyCapability=Promise.withResolvers(),fe.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(it=this._stats)==null||it.time("Page Request"),this._pumpOperatorList(Te));const se=ct=>{var wt,vt;fe.renderTasks.delete(F),(this._maybeCleanupAfterRender||Le)&&I(this,tt,!0),T(this,bt,Js).call(this,!Le),ct?(F.capability.reject(ct),this._abortOperatorList({intentState:fe,reason:ct instanceof Error?ct:new Error(ct)})):F.capability.resolve(),(wt=this._stats)==null||wt.timeEnd("Rendering"),(vt=this._stats)==null||vt.timeEnd("Overall")},F=new At({callback:se,params:{canvasContext:b,viewport:z,transform:ft,background:Tt},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:te,operatorList:fe.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!Le,pdfBug:this._pdfBug,pageColors:re});(fe.renderTasks||(fe.renderTasks=new Set)).add(F);const S=F.task;return Promise.all([fe.displayReadyCapability.promise,Dt]).then(([ct,wt])=>{var vt;if(this.destroyed){se();return}if((vt=this._stats)==null||vt.time("Rendering"),!(wt.renderingIntent&_e))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");F.initializeGraphics({transparency:ct,optionalContentConfig:wt}),F.operatorListChanged()}).catch(se),S}getOperatorList({intent:b="display",annotationMode:z=m.AnnotationMode.ENABLE,printAnnotationStorage:X=null}={}){var te;function lt(){Tt.operatorList.lastChunk&&(Tt.opListReadCapability.resolve(Tt.operatorList),Tt.renderTasks.delete(Dt))}const ft=this._transport.getRenderingIntent(b,z,X,!0);let Tt=this._intentStates.get(ft.cacheKey);Tt||(Tt=Object.create(null),this._intentStates.set(ft.cacheKey,Tt));let Dt;return Tt.opListReadCapability||(Dt=Object.create(null),Dt.operatorListChanged=lt,Tt.opListReadCapability=Promise.withResolvers(),(Tt.renderTasks||(Tt.renderTasks=new Set)).add(Dt),Tt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(te=this._stats)==null||te.time("Page Request"),this._pumpOperatorList(ft)),Tt.opListReadCapability.promise}streamTextContent({includeMarkedContent:b=!1,disableNormalization:z=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:b===!0,disableNormalization:z===!0},{highWaterMark:100,size(X){return X.items.length}})}getTextContent(b={}){if(this._transport._htmlForXfa)return this.getXfa().then(X=>V.XfaText.textContent(X));const z=this.streamTextContent(b);return new Promise(function(X,lt){function ft(){Tt.read().then(function({value:te,done:re}){if(re){X(Dt);return}Object.assign(Dt.styles,te.styles),Dt.items.push(...te.items),ft()},lt)}const Tt=z.getReader(),Dt={items:[],styles:Object.create(null)};ft()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const b=[];for(const z of this._intentStates.values())if(this._abortOperatorList({intentState:z,reason:new Error("Page was destroyed."),force:!0}),!z.opListReadCapability)for(const X of z.renderTasks)b.push(X.completed),X.cancel();return this.objs.clear(),I(this,tt,!1),T(this,Ct,Ki).call(this),Promise.all(b)}cleanup(b=!1){I(this,tt,!0);const z=T(this,bt,Js).call(this,!1);return b&&z&&this._stats&&(this._stats=new W.StatTimer),z}_startRenderPage(b,z){var lt,ft;const X=this._intentStates.get(z);X&&((lt=this._stats)==null||lt.timeEnd("Page Request"),(ft=X.displayReadyCapability)==null||ft.resolve(b))}_renderPageChunk(b,z){for(let X=0,lt=b.length;X<lt;X++)z.operatorList.fnArray.push(b.fnArray[X]),z.operatorList.argsArray.push(b.argsArray[X]);z.operatorList.lastChunk=b.lastChunk,z.operatorList.separateAnnots=b.separateAnnots;for(const X of z.renderTasks)X.operatorListChanged();b.lastChunk&&T(this,bt,Js).call(this,!0)}_pumpOperatorList({renderingIntent:b,cacheKey:z,annotationStorageSerializable:X}){const{map:lt,transfer:ft}=X,Tt=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:b,cacheKey:z,annotationStorage:lt},ft).getReader(),Dt=this._intentStates.get(z);Dt.streamReader=Tt;const te=()=>{Tt.read().then(({value:re,done:he})=>{if(he){Dt.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(re,Dt),te())},re=>{if(Dt.streamReader=null,!this._transport.destroyed){if(Dt.operatorList){Dt.operatorList.lastChunk=!0;for(const he of Dt.renderTasks)he.operatorListChanged();T(this,bt,Js).call(this,!0)}if(Dt.displayReadyCapability)Dt.displayReadyCapability.reject(re);else if(Dt.opListReadCapability)Dt.opListReadCapability.reject(re);else throw re}})};te()}_abortOperatorList({intentState:b,reason:z,force:X=!1}){if(b.streamReader){if(b.streamReaderCancelTimeout&&(clearTimeout(b.streamReaderCancelTimeout),b.streamReaderCancelTimeout=null),!X){if(b.renderTasks.size>0)return;if(z instanceof W.RenderingCancelledException){let lt=et;z.extraDelay>0&&z.extraDelay<1e3&&(lt+=z.extraDelay),b.streamReaderCancelTimeout=setTimeout(()=>{b.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:b,reason:z,force:!0})},lt);return}}if(b.streamReader.cancel(new m.AbortException(z.message)).catch(()=>{}),b.streamReader=null,!this._transport.destroyed){for(const[lt,ft]of this._intentStates)if(ft===b){this._intentStates.delete(lt);break}this.cleanup()}}}get stats(){return this._stats}}q=new WeakMap,tt=new WeakMap,bt=new WeakSet,Js=function(b=!1){if(T(this,Ct,Ki).call(this),!t(this,tt)||this.destroyed)return!1;if(b)return I(this,q,setTimeout(()=>{I(this,q,null),T(this,bt,Js).call(this,!1)},i)),!1;for(const{renderTasks:z,operatorList:X}of this._intentStates.values())if(z.size>0||!X.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),I(this,tt,!1),!0},Ct=new WeakSet,Ki=function(){t(this,q)&&(clearTimeout(t(this,q)),I(this,q,null))};class h{constructor(){l(this,_t,new Set);l(this,Mt,Promise.resolve())}postMessage(b,z){const X={data:structuredClone(b,z?{transfer:z}:null)};t(this,Mt).then(()=>{for(const lt of t(this,_t))lt.call(this,X)})}addEventListener(b,z){t(this,_t).add(z)}removeEventListener(b,z){t(this,_t).delete(z)}terminate(){t(this,_t).clear()}}_t=new WeakMap,Mt=new WeakMap;const R={isWorkerDisabled:!1,fakeWorkerId:0};m.isNodeJS&&(R.isWorkerDisabled=!0,(Lt=C.GlobalWorkerOptions).workerSrc||(Lt.workerSrc="./pdf.worker.mjs")),R.isSameOrigin=function(B,b){let z;try{if(z=new URL(B),!z.origin||z.origin==="null")return!1}catch{return!1}const X=new URL(b,z);return z.origin===X.origin},R.createCDNWrapper=function(B){const b=`await import("${B}");`;return URL.createObjectURL(new Blob([b],{type:"text/javascript"}))};const K=class K{constructor({name:b=null,port:z=null,verbosity:X=(0,m.getVerbosityLevel)()}={}){var lt;if(this.name=b,this.destroyed=!1,this.verbosity=X,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,z){if((lt=t(K,Et))!=null&&lt.has(z))throw new Error("Cannot use more than one PDFWorker per port.");(t(K,Et)||I(K,Et,new WeakMap)).set(z,this),this._initializeFromPort(z);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(b){this._port=b,this._messageHandler=new _.MessageHandler("main","worker",b),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!R.isWorkerDisabled&&!t(K,Z,Yi)){let{workerSrc:b}=K;try{R.isSameOrigin(window.location.href,b)||(b=R.createCDNWrapper(new URL(b,window.location).href));const z=new Worker(b,{type:"module"}),X=new _.MessageHandler("main","worker",z),lt=()=>{z.removeEventListener("error",ft),X.destroy(),z.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},ft=()=>{this._webWorker||lt()};z.addEventListener("error",ft),X.on("test",Dt=>{if(z.removeEventListener("error",ft),this.destroyed){lt();return}Dt?(this._messageHandler=X,this._port=z,this._webWorker=z,this._readyCapability.resolve(),X.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),X.destroy(),z.terminate())}),X.on("ready",Dt=>{if(z.removeEventListener("error",ft),this.destroyed){lt();return}try{Tt()}catch{this._setupFakeWorker()}});const Tt=()=>{const Dt=new Uint8Array;X.send("test",Dt,[Dt.buffer])};Tt();return}catch{(0,m.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){R.isWorkerDisabled||((0,m.warn)("Setting up fake worker."),R.isWorkerDisabled=!0),K._setupFakeWorkerGlobal.then(b=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const z=new h;this._port=z;const X=`fake${R.fakeWorkerId++}`,lt=new _.MessageHandler(X+"_worker",X,z);b.setup(lt,z);const ft=new _.MessageHandler(X,X+"_worker",z);this._messageHandler=ft,this._readyCapability.resolve(),ft.send("configure",{verbosity:this.verbosity})}).catch(b=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${b.message}".`))})}destroy(){var b;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(b=t(K,Et))==null||b.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(b){var X;if(!(b!=null&&b.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const z=(X=t(this,Et))==null?void 0:X.get(b.port);if(z){if(z._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return z}return new K(b)}static get workerSrc(){if(C.GlobalWorkerOptions.workerSrc)return C.GlobalWorkerOptions.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){const b=async()=>t(this,Z,Yi)?t(this,Z,Yi):(await vs(()=>import(this.workerSrc).then(async z=>(await z.__tla,z)),[])).WorkerMessageHandler;return(0,m.shadow)(this,"_setupFakeWorkerGlobal",b())}};Et=new WeakMap,Z=new WeakSet,Yi=function(){var b;try{return((b=globalThis.pdfjsWorker)==null?void 0:b.WorkerMessageHandler)||null}catch{return null}},l(K,Z),l(K,Et,void 0);let j=K;class G{constructor(b,z,X,lt,ft){l(this,ie);l(this,Rt,new Map);l(this,Pt,new Map);l(this,qt,new Map);l(this,Kt,null);this.messageHandler=b,this.loadingTask=z,this.commonObjs=new ot,this.fontLoader=new k.FontLoader({ownerDocument:lt.ownerDocument,styleElement:lt.styleElement}),this._params=lt,this.canvasFactory=ft.canvasFactory,this.filterFactory=ft.filterFactory,this.cMapReaderFactory=ft.cMapReaderFactory,this.standardFontDataFactory=ft.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=X,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return(0,m.shadow)(this,"annotationStorage",new x.AnnotationStorage)}getRenderingIntent(b,z=m.AnnotationMode.ENABLE,X=null,lt=!1){let ft=m.RenderingIntentFlag.DISPLAY,Tt=x.SerializableEmpty;switch(b){case"any":ft=m.RenderingIntentFlag.ANY;break;case"display":break;case"print":ft=m.RenderingIntentFlag.PRINT;break;default:(0,m.warn)(`getRenderingIntent - invalid intent: ${b}`)}switch(z){case m.AnnotationMode.DISABLE:ft+=m.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case m.AnnotationMode.ENABLE:break;case m.AnnotationMode.ENABLE_FORMS:ft+=m.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case m.AnnotationMode.ENABLE_STORAGE:ft+=m.RenderingIntentFlag.ANNOTATIONS_STORAGE,Tt=(ft&m.RenderingIntentFlag.PRINT&&X instanceof x.PrintAnnotationStorage?X:this.annotationStorage).serializable;break;default:(0,m.warn)(`getRenderingIntent - invalid annotationMode: ${z}`)}return lt&&(ft+=m.RenderingIntentFlag.OPLIST),{renderingIntent:ft,cacheKey:`${ft}_${Tt.hash}`,annotationStorageSerializable:Tt}}destroy(){var X;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(X=t(this,Kt))==null||X.reject(new Error("Worker was destroyed during onPassword callback"));const b=[];for(const lt of t(this,Pt).values())b.push(lt._destroy());t(this,Pt).clear(),t(this,qt).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const z=this.messageHandler.sendWithPromise("Terminate",null);return b.push(z),Promise.all(b).then(()=>{var lt;this.commonObjs.clear(),this.fontLoader.clear(),t(this,Rt).clear(),this.filterFactory.destroy(),(0,O.cleanupTextLayer)(),(lt=this._networkStream)==null||lt.cancelAllRequests(new m.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:b,loadingTask:z}=this;b.on("GetReader",(X,lt)=>{(0,m.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=ft=>{this._lastProgress={loaded:ft.loaded,total:ft.total}},lt.onPull=()=>{this._fullReader.read().then(function({value:ft,done:Tt}){if(Tt){lt.close();return}(0,m.assert)(ft instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),lt.enqueue(new Uint8Array(ft),1,[ft])}).catch(ft=>{lt.error(ft)})},lt.onCancel=ft=>{this._fullReader.cancel(ft),lt.ready.catch(Tt=>{if(!this.destroyed)throw Tt})}}),b.on("ReaderHeadersReady",X=>{const lt=Promise.withResolvers(),ft=this._fullReader;return ft.headersReady.then(()=>{var Tt;(!ft.isStreamingSupported||!ft.isRangeSupported)&&(this._lastProgress&&((Tt=z.onProgress)==null||Tt.call(z,this._lastProgress)),ft.onProgress=Dt=>{var te;(te=z.onProgress)==null||te.call(z,{loaded:Dt.loaded,total:Dt.total})}),lt.resolve({isStreamingSupported:ft.isStreamingSupported,isRangeSupported:ft.isRangeSupported,contentLength:ft.contentLength})},lt.reject),lt.promise}),b.on("GetRangeReader",(X,lt)=>{(0,m.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const ft=this._networkStream.getRangeReader(X.begin,X.end);if(!ft){lt.close();return}lt.onPull=()=>{ft.read().then(function({value:Tt,done:Dt}){if(Dt){lt.close();return}(0,m.assert)(Tt instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),lt.enqueue(new Uint8Array(Tt),1,[Tt])}).catch(Tt=>{lt.error(Tt)})},lt.onCancel=Tt=>{ft.cancel(Tt),lt.ready.catch(Dt=>{if(!this.destroyed)throw Dt})}}),b.on("GetDoc",({pdfInfo:X})=>{this._numPages=X.numPages,this._htmlForXfa=X.htmlForXfa,delete X.htmlForXfa,z._capability.resolve(new u(X,this))}),b.on("DocException",function(X){let lt;switch(X.name){case"PasswordException":lt=new m.PasswordException(X.message,X.code);break;case"InvalidPDFException":lt=new m.InvalidPDFException(X.message);break;case"MissingPDFException":lt=new m.MissingPDFException(X.message);break;case"UnexpectedResponseException":lt=new m.UnexpectedResponseException(X.message,X.status);break;case"UnknownErrorException":lt=new m.UnknownErrorException(X.message,X.details);break;default:(0,m.unreachable)("DocException - expected a valid Error.")}z._capability.reject(lt)}),b.on("PasswordRequest",X=>{if(I(this,Kt,Promise.withResolvers()),z.onPassword){const lt=ft=>{ft instanceof Error?t(this,Kt).reject(ft):t(this,Kt).resolve({password:ft})};try{z.onPassword(lt,X.code)}catch(ft){t(this,Kt).reject(ft)}}else t(this,Kt).reject(new m.PasswordException(X.message,X.code));return t(this,Kt).promise}),b.on("DataLoaded",X=>{var lt;(lt=z.onProgress)==null||lt.call(z,{loaded:X.length,total:X.length}),this.downloadInfoCapability.resolve(X)}),b.on("StartRenderPage",X=>{this.destroyed||t(this,Pt).get(X.pageIndex)._startRenderPage(X.transparency,X.cacheKey)}),b.on("commonobj",([X,lt,ft])=>{var Tt;if(this.destroyed||this.commonObjs.has(X))return null;switch(lt){case"Font":const Dt=this._params;if("error"in ft){const Te=ft.error;(0,m.warn)(`Error during font loading: ${Te}`),this.commonObjs.resolve(X,Te);break}const te=Dt.pdfBug&&((Tt=globalThis.FontInspector)!=null&&Tt.enabled)?(Te,_e)=>globalThis.FontInspector.fontAdded(Te,_e):null,re=new k.FontFaceObject(ft,{isEvalSupported:Dt.isEvalSupported,disableFontFace:Dt.disableFontFace,ignoreErrors:Dt.ignoreErrors,inspectFont:te});this.fontLoader.bind(re).catch(()=>b.sendWithPromise("FontFallback",{id:X})).finally(()=>{!Dt.fontExtraProperties&&re.data&&(re.data=null),this.commonObjs.resolve(X,re)});break;case"CopyLocalImage":const{imageRef:he}=ft;(0,m.assert)(he,"The imageRef must be defined.");for(const Te of t(this,Pt).values())for(const[,_e]of Te.objs)if(_e.ref===he)return _e.dataLen?(this.commonObjs.resolve(X,structuredClone(_e)),_e.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(X,ft);break;default:throw new Error(`Got unknown common object type ${lt}`)}return null}),b.on("obj",([X,lt,ft,Tt])=>{var te;if(this.destroyed)return;const Dt=t(this,Pt).get(lt);if(!Dt.objs.has(X)){if(Dt._intentStates.size===0){(te=Tt==null?void 0:Tt.bitmap)==null||te.close();return}switch(ft){case"Image":Dt.objs.resolve(X,Tt),(Tt==null?void 0:Tt.dataLen)>m.MAX_IMAGE_SIZE_TO_CACHE&&(Dt._maybeCleanupAfterRender=!0);break;case"Pattern":Dt.objs.resolve(X,Tt);break;default:throw new Error(`Got unknown object type ${ft}`)}}}),b.on("DocProgress",X=>{var lt;this.destroyed||((lt=z.onProgress)==null||lt.call(z,{loaded:X.loaded,total:X.total}))}),b.on("FetchBuiltInCMap",X=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(X):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),b.on("FetchStandardFontData",X=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(X):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var X;this.annotationStorage.size<=0&&(0,m.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:b,transfer:z}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:b,filename:((X=this._fullReader)==null?void 0:X.filename)??null},z).finally(()=>{this.annotationStorage.resetModified()})}getPage(b){if(!Number.isInteger(b)||b<=0||b>this._numPages)return Promise.reject(new Error("Invalid page request."));const z=b-1,X=t(this,qt).get(z);if(X)return X;const lt=this.messageHandler.sendWithPromise("GetPage",{pageIndex:z}).then(ft=>{if(this.destroyed)throw new Error("Transport destroyed");const Tt=new a(z,ft,this,this._params.pdfBug);return t(this,Pt).set(z,Tt),Tt});return t(this,qt).set(z,lt),lt}getPageIndex(b){return typeof b!="object"||b===null||!Number.isInteger(b.num)||b.num<0||!Number.isInteger(b.gen)||b.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:b.num,gen:b.gen})}getAnnotations(b,z){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:b,intent:z})}getFieldObjects(){return T(this,ie,yi).call(this,"GetFieldObjects")}hasJSActions(){return T(this,ie,yi).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(b){return typeof b!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:b})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return T(this,ie,yi).call(this,"GetDocJSActions")}getPageJSActions(b){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:b})}getStructTree(b){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:b})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(b){return T(this,ie,yi).call(this,"GetOptionalContentConfig").then(z=>new U.OptionalContentConfig(z,b))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const b="GetMetadata",z=t(this,Rt).get(b);if(z)return z;const X=this.messageHandler.sendWithPromise(b,null).then(lt=>{var ft,Tt;return{info:lt[0],metadata:lt[1]?new D.Metadata(lt[1]):null,contentDispositionFilename:((ft=this._fullReader)==null?void 0:ft.filename)??null,contentLength:((Tt=this._fullReader)==null?void 0:Tt.contentLength)??null}});return t(this,Rt).set(b,X),X}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(b=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const z of t(this,Pt).values())if(!z.cleanup())throw new Error(`startCleanup: Page ${z.pageNumber} is currently rendering.`);this.commonObjs.clear(),b||this.fontLoader.clear(),t(this,Rt).clear(),this.filterFactory.destroy(!0),(0,O.cleanupTextLayer)()}}get loadingParams(){const{disableAutoFetch:b,enableXfa:z}=this._params;return(0,m.shadow)(this,"loadingParams",{disableAutoFetch:b,enableXfa:z})}}Rt=new WeakMap,Pt=new WeakMap,qt=new WeakMap,Kt=new WeakMap,ie=new WeakSet,yi=function(b,z=null){const X=t(this,Rt).get(b);if(X)return X;const lt=this.messageHandler.sendWithPromise(b,z);return t(this,Rt).set(b,lt),lt};const rt=Symbol("INITIAL_DATA");class ot{constructor(){l(this,le);l(this,de,Object.create(null))}get(b,z=null){if(z){const lt=T(this,le,Pn).call(this,b);return lt.promise.then(()=>z(lt.data)),null}const X=t(this,de)[b];if(!X||X.data===rt)throw new Error(`Requesting object that isn't resolved yet ${b}.`);return X.data}has(b){const z=t(this,de)[b];return!!z&&z.data!==rt}resolve(b,z=null){const X=T(this,le,Pn).call(this,b);X.data=z,X.resolve()}clear(){var b;for(const z in t(this,de)){const{data:X}=t(this,de)[z];(b=X==null?void 0:X.bitmap)==null||b.close()}I(this,de,Object.create(null))}*[Symbol.iterator](){for(const b in t(this,de)){const{data:z}=t(this,de)[b];z!==rt&&(yield[b,z])}}}de=new WeakMap,le=new WeakSet,Pn=function(b){var z;return(z=t(this,de))[b]||(z[b]={...Promise.withResolvers(),data:rt})};class yt{constructor(b){l(this,Vt,null);I(this,Vt,b),this.onContinue=null}get promise(){return t(this,Vt).capability.promise}cancel(b=0){t(this,Vt).cancel(null,b)}get separateAnnots(){const{separateAnnots:b}=t(this,Vt).operatorList;if(!b)return!1;const{annotationCanvasMap:z}=t(this,Vt);return b.form||b.canvas&&(z==null?void 0:z.size)>0}}Vt=new WeakMap;const nt=class nt{constructor({callback:b,params:z,objs:X,commonObjs:lt,annotationCanvasMap:ft,operatorList:Tt,pageIndex:Dt,canvasFactory:te,filterFactory:re,useRequestAnimationFrame:he=!1,pdfBug:Te=!1,pageColors:_e=null}){this.callback=b,this.params=z,this.objs=X,this.commonObjs=lt,this.annotationCanvasMap=ft,this.operatorListIdx=null,this.operatorList=Tt,this._pageIndex=Dt,this.canvasFactory=te,this.filterFactory=re,this._pdfBug=Te,this.pageColors=_e,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=he===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new yt(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=z.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:b=!1,optionalContentConfig:z}){var Dt,te;if(this.cancelled)return;if(this._canvas){if(t(nt,ae).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(nt,ae).add(this._canvas)}this._pdfBug&&((Dt=globalThis.StepperManager)!=null&&Dt.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:X,viewport:lt,transform:ft,background:Tt}=this.params;this.gfx=new f.CanvasGraphics(X,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:z},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:ft,viewport:lt,transparency:b,background:Tt}),this.operatorListIdx=0,this.graphicsReady=!0,(te=this.graphicsReadyCallback)==null||te.call(this)}cancel(b=null,z=0){var X;this.running=!1,this.cancelled=!0,(X=this.gfx)==null||X.endDrawing(),t(nt,ae).delete(this._canvas),this.callback(b||new W.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,z))}operatorListChanged(){var b;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(b=this.stepper)==null||b.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(nt,ae).delete(this._canvas),this.callback())))}};ae=new WeakMap,l(nt,ae,new WeakSet);let At=nt;const ut="4.1.392",St="fcb76a78d";w()}catch(Ce){w(Ce)}})},583:(r,p,c)=>{c.d(p,{BaseCMapReaderFactory:()=>x,BaseCanvasFactory:()=>m,BaseFilterFactory:()=>w,BaseSVGFactory:()=>k,BaseStandardFontDataFactory:()=>W});var e=c(292);class w{constructor(){this.constructor===w&&(0,e.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(f){return"none"}addHCMFilter(f,O){return"none"}addHighlightHCMFilter(f,O,C,_,D){return"none"}destroy(f=!1){}}class m{constructor(){this.constructor===m&&(0,e.unreachable)("Cannot initialize BaseCanvasFactory.")}create(f,O){if(f<=0||O<=0)throw new Error("Invalid canvas size");const C=this._createCanvas(f,O);return{canvas:C,context:C.getContext("2d")}}reset(f,O,C){if(!f.canvas)throw new Error("Canvas is not specified");if(O<=0||C<=0)throw new Error("Invalid canvas size");f.canvas.width=O,f.canvas.height=C}destroy(f){if(!f.canvas)throw new Error("Canvas is not specified");f.canvas.width=0,f.canvas.height=0,f.canvas=null,f.context=null}_createCanvas(f,O){(0,e.unreachable)("Abstract method `_createCanvas` called.")}}class x{constructor({baseUrl:f=null,isCompressed:O=!0}){this.constructor===x&&(0,e.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=f,this.isCompressed=O}async fetch({name:f}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!f)throw new Error("CMap name must be specified.");const O=this.baseUrl+f+(this.isCompressed?".bcmap":""),C=this.isCompressed?e.CMapCompressionType.BINARY:e.CMapCompressionType.NONE;return this._fetchData(O,C).catch(_=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${O}`)})}_fetchData(f,O){(0,e.unreachable)("Abstract method `_fetchData` called.")}}class W{constructor({baseUrl:f=null}){this.constructor===W&&(0,e.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=f}async fetch({filename:f}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!f)throw new Error("Font filename must be specified.");const O=`${this.baseUrl}${f}`;return this._fetchData(O).catch(C=>{throw new Error(`Unable to load font data at: ${O}`)})}_fetchData(f){(0,e.unreachable)("Abstract method `_fetchData` called.")}}class k{constructor(){this.constructor===k&&(0,e.unreachable)("Cannot initialize BaseSVGFactory.")}create(f,O,C=!1){if(f<=0||O<=0)throw new Error("Invalid SVG dimensions");const _=this._createSVG("svg:svg");return _.setAttribute("version","1.1"),C||(_.setAttribute("width",`${f}px`),_.setAttribute("height",`${O}px`)),_.setAttribute("preserveAspectRatio","none"),_.setAttribute("viewBox",`0 0 ${f} ${O}`),_}createElement(f){if(typeof f!="string")throw new Error("Invalid SVG element type");return this._createSVG(f)}_createSVG(f){(0,e.unreachable)("Abstract method `_createSVG` called.")}}},923:(r,p,c)=>{var ae,In,ee,Fn;c.d(p,{CanvasGraphics:()=>be});var e=c(292),w=c(419);const m={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function x(et,i){if(!i)return;const n=i[2]-i[0],d=i[3]-i[1],g=new Path2D;g.rect(i[0],i[1],n,d),et.clip(g)}class W{constructor(){this.constructor===W&&(0,e.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,e.unreachable)("Abstract method `getPattern` called.")}}class k extends W{constructor(i){super(),this._type=i[1],this._bbox=i[2],this._colorStops=i[3],this._p0=i[4],this._p1=i[5],this._r0=i[6],this._r1=i[7],this.matrix=null}_createGradient(i){let n;this._type==="axial"?n=i.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(n=i.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const d of this._colorStops)n.addColorStop(d[0],d[1]);return n}getPattern(i,n,d,g){let o;if(g===m.STROKE||g===m.FILL){const A=n.current.getClippedPathBoundingBox(g,(0,w.getCurrentTransform)(i))||[0,0,0,0],v=Math.ceil(A[2]-A[0])||1,E=Math.ceil(A[3]-A[1])||1,u=n.cachedCanvases.getCanvas("pattern",v,E,!0),a=u.context;a.clearRect(0,0,a.canvas.width,a.canvas.height),a.beginPath(),a.rect(0,0,a.canvas.width,a.canvas.height),a.translate(-A[0],-A[1]),d=e.Util.transform(d,[1,0,0,1,A[0],A[1]]),a.transform(...n.baseTransform),this.matrix&&a.transform(...this.matrix),x(a,this._bbox),a.fillStyle=this._createGradient(a),a.fill(),o=i.createPattern(u.canvas,"no-repeat");const h=new DOMMatrix(d);o.setTransform(h)}else x(i,this._bbox),o=this._createGradient(i);return o}}function y(et,i,n,d,g,o,A,v){const E=i.coords,u=i.colors,a=et.data,h=et.width*4;let R;E[n+1]>E[d+1]&&(R=n,n=d,d=R,R=o,o=A,A=R),E[d+1]>E[g+1]&&(R=d,d=g,g=R,R=A,A=v,v=R),E[n+1]>E[d+1]&&(R=n,n=d,d=R,R=o,o=A,A=R);const j=(E[n]+i.offsetX)*i.scaleX,G=(E[n+1]+i.offsetY)*i.scaleY,rt=(E[d]+i.offsetX)*i.scaleX,ot=(E[d+1]+i.offsetY)*i.scaleY,yt=(E[g]+i.offsetX)*i.scaleX,At=(E[g+1]+i.offsetY)*i.scaleY;if(G>=At)return;const ut=u[o],St=u[o+1],P=u[o+2],K=u[A],nt=u[A+1],B=u[A+2],b=u[v],z=u[v+1],X=u[v+2],lt=Math.round(G),ft=Math.round(At);let Tt,Dt,te,re,he,Te,_e,Fe;for(let fe=lt;fe<=ft;fe++){if(fe<ot){const J=fe<G?0:(G-fe)/(G-ot);Tt=j-(j-rt)*J,Dt=ut-(ut-K)*J,te=St-(St-nt)*J,re=P-(P-B)*J}else{let J;fe>At?J=1:ot===At?J=0:J=(ot-fe)/(ot-At),Tt=rt-(rt-yt)*J,Dt=K-(K-b)*J,te=nt-(nt-z)*J,re=B-(B-X)*J}let Le;fe<G?Le=0:fe>At?Le=1:Le=(G-fe)/(G-At),he=j-(j-yt)*Le,Te=ut-(ut-b)*Le,_e=St-(St-z)*Le,Fe=P-(P-X)*Le;const se=Math.round(Math.min(Tt,he)),F=Math.round(Math.max(Tt,he));let S=h*fe+se*4;for(let J=se;J<=F;J++)Le=(Tt-J)/(Tt-he),Le<0?Le=0:Le>1&&(Le=1),a[S++]=Dt-(Dt-Te)*Le|0,a[S++]=te-(te-_e)*Le|0,a[S++]=re-(re-Fe)*Le|0,a[S++]=255}}function f(et,i,n){const d=i.coords,g=i.colors;let o,A;switch(i.type){case"lattice":const v=i.verticesPerRow,E=Math.floor(d.length/v)-1,u=v-1;for(o=0;o<E;o++){let a=o*v;for(let h=0;h<u;h++,a++)y(et,n,d[a],d[a+1],d[a+v],g[a],g[a+1],g[a+v]),y(et,n,d[a+v+1],d[a+1],d[a+v],g[a+v+1],g[a+1],g[a+v])}break;case"triangles":for(o=0,A=d.length;o<A;o+=3)y(et,n,d[o],d[o+1],d[o+2],g[o],g[o+1],g[o+2]);break;default:throw new Error("illegal figure")}}class O extends W{constructor(i){super(),this._coords=i[2],this._colors=i[3],this._figures=i[4],this._bounds=i[5],this._bbox=i[7],this._background=i[8],this.matrix=null}_createMeshCanvas(i,n,d){const g=Math.floor(this._bounds[0]),o=Math.floor(this._bounds[1]),A=Math.ceil(this._bounds[2])-g,v=Math.ceil(this._bounds[3])-o,E=Math.min(Math.ceil(Math.abs(A*i[0]*1.1)),3e3),u=Math.min(Math.ceil(Math.abs(v*i[1]*1.1)),3e3),a=A/E,h=v/u,R={coords:this._coords,colors:this._colors,offsetX:-g,offsetY:-o,scaleX:1/a,scaleY:1/h},j=E+2*2,G=u+2*2,rt=d.getCanvas("mesh",j,G,!1),ot=rt.context,yt=ot.createImageData(E,u);if(n){const At=yt.data;for(let ut=0,St=At.length;ut<St;ut+=4)At[ut]=n[0],At[ut+1]=n[1],At[ut+2]=n[2],At[ut+3]=255}for(const At of this._figures)f(yt,At,R);return ot.putImageData(yt,2,2),{canvas:rt.canvas,offsetX:g-2*a,offsetY:o-2*h,scaleX:a,scaleY:h}}getPattern(i,n,d,g){x(i,this._bbox);let o;if(g===m.SHADING)o=e.Util.singularValueDecompose2dScale((0,w.getCurrentTransform)(i));else if(o=e.Util.singularValueDecompose2dScale(n.baseTransform),this.matrix){const v=e.Util.singularValueDecompose2dScale(this.matrix);o=[o[0]*v[0],o[1]*v[1]]}const A=this._createMeshCanvas(o,g===m.SHADING?null:this._background,n.cachedCanvases);return g!==m.SHADING&&(i.setTransform(...n.baseTransform),this.matrix&&i.transform(...this.matrix)),i.translate(A.offsetX,A.offsetY),i.scale(A.scaleX,A.scaleY),i.createPattern(A.canvas,"no-repeat")}}class C extends W{getPattern(){return"hotpink"}}function _(et){switch(et[0]){case"RadialAxial":return new k(et);case"Mesh":return new O(et);case"Dummy":return new C}throw new Error(`Unknown IR type: ${et[0]}`)}const D={COLORED:1,UNCOLORED:2},Vt=class Vt{constructor(i,n,d,g,o){this.operatorList=i[2],this.matrix=i[3]||[1,0,0,1,0,0],this.bbox=i[4],this.xstep=i[5],this.ystep=i[6],this.paintType=i[7],this.tilingType=i[8],this.color=n,this.ctx=d,this.canvasGraphicsFactory=g,this.baseTransform=o}createPatternCanvas(i){const n=this.operatorList,d=this.bbox,g=this.xstep,o=this.ystep,A=this.paintType,v=this.tilingType,E=this.color,u=this.canvasGraphicsFactory;(0,e.info)("TilingType: "+v);const a=d[0],h=d[1],R=d[2],j=d[3],G=e.Util.singularValueDecompose2dScale(this.matrix),rt=e.Util.singularValueDecompose2dScale(this.baseTransform),ot=[G[0]*rt[0],G[1]*rt[1]],yt=this.getSizeAndScale(g,this.ctx.canvas.width,ot[0]),At=this.getSizeAndScale(o,this.ctx.canvas.height,ot[1]),ut=i.cachedCanvases.getCanvas("pattern",yt.size,At.size,!0),St=ut.context,P=u.createCanvasGraphics(St);P.groupLevel=i.groupLevel,this.setFillAndStrokeStyleToContext(P,A,E);let K=a,nt=h,B=R,b=j;return a<0&&(K=0,B+=Math.abs(a)),h<0&&(nt=0,b+=Math.abs(h)),St.translate(-(yt.scale*K),-(At.scale*nt)),P.transform(yt.scale,0,0,At.scale,0,0),St.save(),this.clipBbox(P,K,nt,B,b),P.baseTransform=(0,w.getCurrentTransform)(P.ctx),P.executeOperatorList(n),P.endDrawing(),{canvas:ut.canvas,scaleX:yt.scale,scaleY:At.scale,offsetX:K,offsetY:nt}}getSizeAndScale(i,n,d){i=Math.abs(i);const g=Math.max(Vt.MAX_PATTERN_SIZE,n);let o=Math.ceil(i*d);return o>=g?o=g:d=o/i,{scale:d,size:o}}clipBbox(i,n,d,g,o){const A=g-n,v=o-d;i.ctx.rect(n,d,A,v),i.current.updateRectMinMax((0,w.getCurrentTransform)(i.ctx),[n,d,g,o]),i.clip(),i.endPath()}setFillAndStrokeStyleToContext(i,n,d){const g=i.ctx,o=i.current;switch(n){case D.COLORED:const A=this.ctx;g.fillStyle=A.fillStyle,g.strokeStyle=A.strokeStyle,o.fillColor=A.fillStyle,o.strokeColor=A.strokeStyle;break;case D.UNCOLORED:const v=e.Util.makeHexColor(d[0],d[1],d[2]);g.fillStyle=v,g.strokeStyle=v,o.fillColor=v,o.strokeColor=v;break;default:throw new e.FormatError(`Unsupported paint type: ${n}`)}}getPattern(i,n,d,g){let o=d;g!==m.SHADING&&(o=e.Util.transform(o,n.baseTransform),this.matrix&&(o=e.Util.transform(o,this.matrix)));const A=this.createPatternCanvas(n);let v=new DOMMatrix(o);v=v.translate(A.offsetX,A.offsetY),v=v.scale(1/A.scaleX,1/A.scaleY);const E=i.createPattern(A.canvas,"repeat");return E.setTransform(v),E}};me(Vt,"MAX_PATTERN_SIZE",3e3);let U=Vt;function Y({src:et,srcPos:i=0,dest:n,width:d,height:g,nonBlackColor:o=4294967295,inverseDecode:A=!1}){const v=e.FeatureTest.isLittleEndian?4278190080:255,[E,u]=A?[o,v]:[v,o],a=d>>3,h=d&7,R=et.length;n=new Uint32Array(n.buffer);let j=0;for(let G=0;G<g;G++){for(const ot=i+a;i<ot;i++){const yt=i<R?et[i]:255;n[j++]=yt&128?u:E,n[j++]=yt&64?u:E,n[j++]=yt&32?u:E,n[j++]=yt&16?u:E,n[j++]=yt&8?u:E,n[j++]=yt&4?u:E,n[j++]=yt&2?u:E,n[j++]=yt&1?u:E}if(h===0)continue;const rt=i<R?et[i++]:255;for(let ot=0;ot<h;ot++)n[j++]=rt&1<<7-ot?u:E}return{srcPos:i,destPos:j}}const at=16,Q=100,L=4096,V=15,$=10,N=1e3,q=16;function tt(et,i){if(et._removeMirroring)throw new Error("Context is already forwarding operations.");et.__originalSave=et.save,et.__originalRestore=et.restore,et.__originalRotate=et.rotate,et.__originalScale=et.scale,et.__originalTranslate=et.translate,et.__originalTransform=et.transform,et.__originalSetTransform=et.setTransform,et.__originalResetTransform=et.resetTransform,et.__originalClip=et.clip,et.__originalMoveTo=et.moveTo,et.__originalLineTo=et.lineTo,et.__originalBezierCurveTo=et.bezierCurveTo,et.__originalRect=et.rect,et.__originalClosePath=et.closePath,et.__originalBeginPath=et.beginPath,et._removeMirroring=()=>{et.save=et.__originalSave,et.restore=et.__originalRestore,et.rotate=et.__originalRotate,et.scale=et.__originalScale,et.translate=et.__originalTranslate,et.transform=et.__originalTransform,et.setTransform=et.__originalSetTransform,et.resetTransform=et.__originalResetTransform,et.clip=et.__originalClip,et.moveTo=et.__originalMoveTo,et.lineTo=et.__originalLineTo,et.bezierCurveTo=et.__originalBezierCurveTo,et.rect=et.__originalRect,et.closePath=et.__originalClosePath,et.beginPath=et.__originalBeginPath,delete et._removeMirroring},et.save=function(){i.save(),this.__originalSave()},et.restore=function(){i.restore(),this.__originalRestore()},et.translate=function(n,d){i.translate(n,d),this.__originalTranslate(n,d)},et.scale=function(n,d){i.scale(n,d),this.__originalScale(n,d)},et.transform=function(n,d,g,o,A,v){i.transform(n,d,g,o,A,v),this.__originalTransform(n,d,g,o,A,v)},et.setTransform=function(n,d,g,o,A,v){i.setTransform(n,d,g,o,A,v),this.__originalSetTransform(n,d,g,o,A,v)},et.resetTransform=function(){i.resetTransform(),this.__originalResetTransform()},et.rotate=function(n){i.rotate(n),this.__originalRotate(n)},et.clip=function(n){i.clip(n),this.__originalClip(n)},et.moveTo=function(n,d){i.moveTo(n,d),this.__originalMoveTo(n,d)},et.lineTo=function(n,d){i.lineTo(n,d),this.__originalLineTo(n,d)},et.bezierCurveTo=function(n,d,g,o,A,v){i.bezierCurveTo(n,d,g,o,A,v),this.__originalBezierCurveTo(n,d,g,o,A,v)},et.rect=function(n,d,g,o){i.rect(n,d,g,o),this.__originalRect(n,d,g,o)},et.closePath=function(){i.closePath(),this.__originalClosePath()},et.beginPath=function(){i.beginPath(),this.__originalBeginPath()}}class bt{constructor(i){this.canvasFactory=i,this.cache=Object.create(null)}getCanvas(i,n,d){let g;return this.cache[i]!==void 0?(g=this.cache[i],this.canvasFactory.reset(g,n,d)):(g=this.canvasFactory.create(n,d),this.cache[i]=g),g}delete(i){delete this.cache[i]}clear(){for(const i in this.cache){const n=this.cache[i];this.canvasFactory.destroy(n),delete this.cache[i]}}}function Ft(et,i,n,d,g,o,A,v,E,u){const[a,h,R,j,G,rt]=(0,w.getCurrentTransform)(et);if(h===0&&R===0){const At=A*a+G,ut=Math.round(At),St=v*j+rt,P=Math.round(St),K=(A+E)*a+G,nt=Math.abs(Math.round(K)-ut)||1,B=(v+u)*j+rt,b=Math.abs(Math.round(B)-P)||1;return et.setTransform(Math.sign(a),0,0,Math.sign(j),ut,P),et.drawImage(i,n,d,g,o,0,0,nt,b),et.setTransform(a,h,R,j,G,rt),[nt,b]}if(a===0&&j===0){const At=v*R+G,ut=Math.round(At),St=A*h+rt,P=Math.round(St),K=(v+u)*R+G,nt=Math.abs(Math.round(K)-ut)||1,B=(A+E)*h+rt,b=Math.abs(Math.round(B)-P)||1;return et.setTransform(0,Math.sign(h),Math.sign(R),0,ut,P),et.drawImage(i,n,d,g,o,0,0,b,nt),et.setTransform(a,h,R,j,G,rt),[b,nt]}et.drawImage(i,n,d,g,o,A,v,E,u);const ot=Math.hypot(a,h),yt=Math.hypot(R,j);return[ot*E,yt*u]}function Ct(et){const{width:i,height:n}=et;if(i>N||n>N)return null;const d=1e3,g=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),o=i+1;let A=new Uint8Array(o*(n+1)),v,E,u;const a=i+7&-8;let h=new Uint8Array(a*n),R=0;for(const ot of et.data){let yt=128;for(;yt>0;)h[R++]=ot&yt?0:255,yt>>=1}let j=0;for(R=0,h[R]!==0&&(A[0]=1,++j),E=1;E<i;E++)h[R]!==h[R+1]&&(A[E]=h[R]?2:1,++j),R++;for(h[R]!==0&&(A[E]=2,++j),v=1;v<n;v++){R=v*a,u=v*o,h[R-a]!==h[R]&&(A[u]=h[R]?1:8,++j);let ot=(h[R]?4:0)+(h[R-a]?8:0);for(E=1;E<i;E++)ot=(ot>>2)+(h[R+1]?4:0)+(h[R-a+1]?8:0),g[ot]&&(A[u+E]=g[ot],++j),R++;if(h[R-a]!==h[R]&&(A[u+E]=h[R]?2:4,++j),j>d)return null}for(R=a*(n-1),u=v*o,h[R]!==0&&(A[u]=8,++j),E=1;E<i;E++)h[R]!==h[R+1]&&(A[u+E]=h[R]?4:8,++j),R++;if(h[R]!==0&&(A[u+E]=4,++j),j>d)return null;const G=new Int32Array([0,o,-1,0,-o,0,0,0,1]),rt=new Path2D;for(v=0;j&&v<=n;v++){let ot=v*o;const yt=ot+i;for(;ot<yt&&!A[ot];)ot++;if(ot===yt)continue;rt.moveTo(ot%o,v);const At=ot;let ut=A[ot];do{const St=G[ut];do ot+=St;while(!A[ot]);const P=A[ot];P!==5&&P!==10?(ut=P,A[ot]=0):(ut=P&51*ut>>4,A[ot]&=ut>>2|ut<<2),rt.lineTo(ot%o,ot/o|0),A[ot]||--j}while(At!==ot);--v}return h=null,A=null,function(ot){ot.save(),ot.scale(1/i,-1/n),ot.translate(0,-n),ot.fill(rt),ot.beginPath(),ot.restore()}}class Ot{constructor(i,n){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=e.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=e.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=e.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,i,n])}clone(){const i=Object.create(this);return i.clipBox=this.clipBox.slice(),i}setCurrentPoint(i,n){this.x=i,this.y=n}updatePathMinMax(i,n,d){[n,d]=e.Util.applyTransform([n,d],i),this.minX=Math.min(this.minX,n),this.minY=Math.min(this.minY,d),this.maxX=Math.max(this.maxX,n),this.maxY=Math.max(this.maxY,d)}updateRectMinMax(i,n){const d=e.Util.applyTransform(n,i),g=e.Util.applyTransform(n.slice(2),i),o=e.Util.applyTransform([n[0],n[3]],i),A=e.Util.applyTransform([n[2],n[1]],i);this.minX=Math.min(this.minX,d[0],g[0],o[0],A[0]),this.minY=Math.min(this.minY,d[1],g[1],o[1],A[1]),this.maxX=Math.max(this.maxX,d[0],g[0],o[0],A[0]),this.maxY=Math.max(this.maxY,d[1],g[1],o[1],A[1])}updateScalingPathMinMax(i,n){e.Util.scaleMinMax(i,n),this.minX=Math.min(this.minX,n[0]),this.minY=Math.min(this.minY,n[1]),this.maxX=Math.max(this.maxX,n[2]),this.maxY=Math.max(this.maxY,n[3])}updateCurvePathMinMax(i,n,d,g,o,A,v,E,u,a){const h=e.Util.bezierBoundingBox(n,d,g,o,A,v,E,u,a);a||this.updateRectMinMax(i,h)}getPathBoundingBox(i=m.FILL,n=null){const d=[this.minX,this.minY,this.maxX,this.maxY];if(i===m.STROKE){n||(0,e.unreachable)("Stroke bounding box must include transform.");const g=e.Util.singularValueDecompose2dScale(n),o=g[0]*this.lineWidth/2,A=g[1]*this.lineWidth/2;d[0]-=o,d[1]-=A,d[2]+=o,d[3]+=A}return d}updateClipFromPath(){const i=e.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(i||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(i){this.clipBox=i,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(i=m.FILL,n=null){return e.Util.intersect(this.clipBox,this.getPathBoundingBox(i,n))}}function _t(et,i){if(typeof ImageData<"u"&&i instanceof ImageData){et.putImageData(i,0,0);return}const n=i.height,d=i.width,g=n%q,o=(n-g)/q,A=g===0?o:o+1,v=et.createImageData(d,q);let E=0,u;const a=i.data,h=v.data;let R,j,G,rt;if(i.kind===e.ImageKind.GRAYSCALE_1BPP){const ot=a.byteLength,yt=new Uint32Array(h.buffer,0,h.byteLength>>2),At=yt.length,ut=d+7>>3,St=4294967295,P=e.FeatureTest.isLittleEndian?4278190080:255;for(R=0;R<A;R++){for(G=R<o?q:g,u=0,j=0;j<G;j++){const K=ot-E;let nt=0;const B=K>ut?d:K*8-7,b=B&-8;let z=0,X=0;for(;nt<b;nt+=8)X=a[E++],yt[u++]=X&128?St:P,yt[u++]=X&64?St:P,yt[u++]=X&32?St:P,yt[u++]=X&16?St:P,yt[u++]=X&8?St:P,yt[u++]=X&4?St:P,yt[u++]=X&2?St:P,yt[u++]=X&1?St:P;for(;nt<B;nt++)z===0&&(X=a[E++],z=128),yt[u++]=X&z?St:P,z>>=1}for(;u<At;)yt[u++]=0;et.putImageData(v,0,R*q)}}else if(i.kind===e.ImageKind.RGBA_32BPP){for(j=0,rt=d*q*4,R=0;R<o;R++)h.set(a.subarray(E,E+rt)),E+=rt,et.putImageData(v,0,j),j+=q;R<A&&(rt=d*g*4,h.set(a.subarray(E,E+rt)),et.putImageData(v,0,j))}else if(i.kind===e.ImageKind.RGB_24BPP)for(G=q,rt=d*G,R=0;R<A;R++){for(R>=o&&(G=g,rt=d*G),u=0,j=rt;j--;)h[u++]=a[E++],h[u++]=a[E++],h[u++]=a[E++],h[u++]=255;et.putImageData(v,0,R*q)}else throw new Error(`bad image kind: ${i.kind}`)}function Mt(et,i){if(i.bitmap){et.drawImage(i.bitmap,0,0);return}const n=i.height,d=i.width,g=n%q,o=(n-g)/q,A=g===0?o:o+1,v=et.createImageData(d,q);let E=0;const u=i.data,a=v.data;for(let h=0;h<A;h++){const R=h<o?q:g;({srcPos:E}=Y({src:u,srcPos:E,dest:a,width:d,height:R,nonBlackColor:0})),et.putImageData(v,0,h*q)}}function Lt(et,i){const n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const d of n)et[d]!==void 0&&(i[d]=et[d]);et.setLineDash!==void 0&&(i.setLineDash(et.getLineDash()),i.lineDashOffset=et.lineDashOffset)}function Et(et){if(et.strokeStyle=et.fillStyle="#000000",et.fillRule="nonzero",et.globalAlpha=1,et.lineWidth=1,et.lineCap="butt",et.lineJoin="miter",et.miterLimit=10,et.globalCompositeOperation="source-over",et.font="10px sans-serif",et.setLineDash!==void 0&&(et.setLineDash([]),et.lineDashOffset=0),!e.isNodeJS){const{filter:i}=et;i!=="none"&&i!==""&&(et.filter="none")}}function Z(et,i,n,d){const g=et.length;for(let o=3;o<g;o+=4){const A=et[o];if(A===0)et[o-3]=i,et[o-2]=n,et[o-1]=d;else if(A<255){const v=255-A;et[o-3]=et[o-3]*A+i*v>>8,et[o-2]=et[o-2]*A+n*v>>8,et[o-1]=et[o-1]*A+d*v>>8}}}function gt(et,i,n){const d=et.length,g=1/255;for(let o=3;o<d;o+=4){const A=n?n[et[o]]:et[o];i[o]=i[o]*A*g|0}}function Rt(et,i,n){const d=et.length;for(let g=3;g<d;g+=4){const o=et[g-3]*77+et[g-2]*152+et[g-1]*28;i[g]=n?i[g]*n[o>>8]>>8:i[g]*o>>16}}function Pt(et,i,n,d,g,o,A,v,E,u,a){const h=!!o,R=h?o[0]:0,j=h?o[1]:0,G=h?o[2]:0,rt=g==="Luminosity"?Rt:gt,ot=Math.min(d,Math.ceil(1048576/n));for(let yt=0;yt<d;yt+=ot){const At=Math.min(ot,d-yt),ut=et.getImageData(v-u,yt+(E-a),n,At),St=i.getImageData(v,yt+E,n,At);h&&Z(ut.data,R,j,G),rt(ut.data,St.data,A),i.putImageData(St,v,yt+E)}}function qt(et,i,n,d){const g=d[0],o=d[1],A=d[2]-g,v=d[3]-o;A===0||v===0||(Pt(i.context,n,A,v,i.subtype,i.backdrop,i.transferMap,g,o,i.offsetX,i.offsetY),et.save(),et.globalAlpha=1,et.globalCompositeOperation="source-over",et.setTransform(1,0,0,1,0,0),et.drawImage(n.canvas,0,0),et.restore())}function Kt(et,i){const n=e.Util.singularValueDecompose2dScale(et);n[0]=Math.fround(n[0]),n[1]=Math.fround(n[1]);const d=Math.fround((globalThis.devicePixelRatio||1)*w.PixelsPerInch.PDF_TO_CSS_UNITS);return i!==void 0?i:n[0]<=d||n[1]<=d}const ie=["butt","round","square"],xe=["miter","round","bevel"],de={},le={},ne=class ne{constructor(i,n,d,g,o,{optionalContentConfig:A,markedContentStack:v=null},E,u){l(this,ae);l(this,ee);this.ctx=i,this.current=new Ot(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=n,this.objs=d,this.canvasFactory=g,this.filterFactory=o,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=v||[],this.optionalContentConfig=A,this.cachedCanvases=new bt(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=E,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(i,n=null){return typeof i=="string"?i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i):n}beginDrawing({transform:i,viewport:n,transparency:d=!1,background:g=null}){const o=this.ctx.canvas.width,A=this.ctx.canvas.height,v=this.ctx.fillStyle;if(this.ctx.fillStyle=g||"#ffffff",this.ctx.fillRect(0,0,o,A),this.ctx.fillStyle=v,d){const E=this.cachedCanvases.getCanvas("transparent",o,A);this.compositeCtx=this.ctx,this.transparentCanvas=E.canvas,this.ctx=E.context,this.ctx.save(),this.ctx.transform(...(0,w.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),Et(this.ctx),i&&(this.ctx.transform(...i),this.outputScaleX=i[0],this.outputScaleY=i[0]),this.ctx.transform(...n.transform),this.viewportScale=n.scale,this.baseTransform=(0,w.getCurrentTransform)(this.ctx)}executeOperatorList(i,n,d,g){const o=i.argsArray,A=i.fnArray;let v=n||0;const E=o.length;if(E===v)return v;const u=E-v>$&&typeof d=="function",a=u?Date.now()+V:0;let h=0;const R=this.commonObjs,j=this.objs;let G;for(;;){if(g!==void 0&&v===g.nextBreakPoint)return g.breakIt(v,d),v;if(G=A[v],G!==e.OPS.dependency)this[G].apply(this,o[v]);else for(const rt of o[v]){const ot=rt.startsWith("g_")?R:j;if(!ot.has(rt))return ot.get(rt,d),v}if(v++,v===E)return v;if(u&&++h>$){if(Date.now()>a)return d(),v;h=0}}}endDrawing(){T(this,ae,In).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const i of this._cachedBitmapsMap.values()){for(const n of i.values())typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&(n.width=n.height=0);i.clear()}this._cachedBitmapsMap.clear(),T(this,ee,Fn).call(this)}_scaleImage(i,n){const d=i.width,g=i.height;let o=Math.max(Math.hypot(n[0],n[1]),1),A=Math.max(Math.hypot(n[2],n[3]),1),v=d,E=g,u="prescale1",a,h;for(;o>2&&v>1||A>2&&E>1;){let R=v,j=E;o>2&&v>1&&(R=v>=16384?Math.floor(v/2)-1||1:Math.ceil(v/2),o/=v/R),A>2&&E>1&&(j=E>=16384?Math.floor(E/2)-1||1:Math.ceil(E)/2,A/=E/j),a=this.cachedCanvases.getCanvas(u,R,j),h=a.context,h.clearRect(0,0,R,j),h.drawImage(i,0,0,v,E,0,0,R,j),i=a.canvas,v=R,E=j,u=u==="prescale1"?"prescale2":"prescale1"}return{img:i,paintWidth:v,paintHeight:E}}_createMaskCanvas(i){const n=this.ctx,{width:d,height:g}=i,o=this.current.fillColor,A=this.current.patternFill,v=(0,w.getCurrentTransform)(n);let E,u,a,h;if((i.bitmap||i.data)&&i.count>1){const B=i.bitmap||i.data.buffer;u=JSON.stringify(A?v:[v.slice(0,4),o]),E=this._cachedBitmapsMap.get(B),E||(E=new Map,this._cachedBitmapsMap.set(B,E));const b=E.get(u);if(b&&!A){const z=Math.round(Math.min(v[0],v[2])+v[4]),X=Math.round(Math.min(v[1],v[3])+v[5]);return{canvas:b,offsetX:z,offsetY:X}}a=b}a||(h=this.cachedCanvases.getCanvas("maskCanvas",d,g),Mt(h.context,i));let R=e.Util.transform(v,[1/d,0,0,-1/g,0,0]);R=e.Util.transform(R,[1,0,0,1,0,-g]);const[j,G,rt,ot]=e.Util.getAxialAlignedBoundingBox([0,0,d,g],R),yt=Math.round(rt-j)||1,At=Math.round(ot-G)||1,ut=this.cachedCanvases.getCanvas("fillCanvas",yt,At),St=ut.context,P=j,K=G;St.translate(-P,-K),St.transform(...R),a||(a=this._scaleImage(h.canvas,(0,w.getCurrentTransformInverse)(St)),a=a.img,E&&A&&E.set(u,a)),St.imageSmoothingEnabled=Kt((0,w.getCurrentTransform)(St),i.interpolate),Ft(St,a,0,0,a.width,a.height,0,0,d,g),St.globalCompositeOperation="source-in";const nt=e.Util.transform((0,w.getCurrentTransformInverse)(St),[1,0,0,1,-P,-K]);return St.fillStyle=A?o.getPattern(n,this,nt,m.FILL):o,St.fillRect(0,0,d,g),E&&!A&&(this.cachedCanvases.delete("fillCanvas"),E.set(u,ut.canvas)),{canvas:ut.canvas,offsetX:Math.round(P),offsetY:Math.round(K)}}setLineWidth(i){i!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=i,this.ctx.lineWidth=i}setLineCap(i){this.ctx.lineCap=ie[i]}setLineJoin(i){this.ctx.lineJoin=xe[i]}setMiterLimit(i){this.ctx.miterLimit=i}setDash(i,n){const d=this.ctx;d.setLineDash!==void 0&&(d.setLineDash(i),d.lineDashOffset=n)}setRenderingIntent(i){}setFlatness(i){}setGState(i){for(const[n,d]of i)switch(n){case"LW":this.setLineWidth(d);break;case"LC":this.setLineCap(d);break;case"LJ":this.setLineJoin(d);break;case"ML":this.setMiterLimit(d);break;case"D":this.setDash(d[0],d[1]);break;case"RI":this.setRenderingIntent(d);break;case"FL":this.setFlatness(d);break;case"Font":this.setFont(d[0],d[1]);break;case"CA":this.current.strokeAlpha=d;break;case"ca":this.current.fillAlpha=d,this.ctx.globalAlpha=d;break;case"BM":this.ctx.globalCompositeOperation=d;break;case"SMask":this.current.activeSMask=d?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(d);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const i=this.inSMaskMode;this.current.activeSMask&&!i?this.beginSMaskMode():!this.current.activeSMask&&i&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const i=this.ctx.canvas.width,n=this.ctx.canvas.height,d="smaskGroupAt"+this.groupLevel,g=this.cachedCanvases.getCanvas(d,i,n);this.suspendedCtx=this.ctx,this.ctx=g.context;const o=this.ctx;o.setTransform(...(0,w.getCurrentTransform)(this.suspendedCtx)),Lt(this.suspendedCtx,o),tt(o,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Lt(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(i){if(!this.current.activeSMask)return;i?(i[0]=Math.floor(i[0]),i[1]=Math.floor(i[1]),i[2]=Math.ceil(i[2]),i[3]=Math.ceil(i[3])):i=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const n=this.current.activeSMask,d=this.suspendedCtx;qt(d,n,this.ctx,i),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(Lt(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const i=this.current;this.stateStack.push(i),this.current=i.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Lt(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(i,n,d,g,o,A){this.ctx.transform(i,n,d,g,o,A),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(i,n,d){const g=this.ctx,o=this.current;let A=o.x,v=o.y,E,u;const a=(0,w.getCurrentTransform)(g),h=a[0]===0&&a[3]===0||a[1]===0&&a[2]===0,R=h?d.slice(0):null;for(let j=0,G=0,rt=i.length;j<rt;j++)switch(i[j]|0){case e.OPS.rectangle:A=n[G++],v=n[G++];const ot=n[G++],yt=n[G++],At=A+ot,ut=v+yt;g.moveTo(A,v),ot===0||yt===0?g.lineTo(At,ut):(g.lineTo(At,v),g.lineTo(At,ut),g.lineTo(A,ut)),h||o.updateRectMinMax(a,[A,v,At,ut]),g.closePath();break;case e.OPS.moveTo:A=n[G++],v=n[G++],g.moveTo(A,v),h||o.updatePathMinMax(a,A,v);break;case e.OPS.lineTo:A=n[G++],v=n[G++],g.lineTo(A,v),h||o.updatePathMinMax(a,A,v);break;case e.OPS.curveTo:E=A,u=v,A=n[G+4],v=n[G+5],g.bezierCurveTo(n[G],n[G+1],n[G+2],n[G+3],A,v),o.updateCurvePathMinMax(a,E,u,n[G],n[G+1],n[G+2],n[G+3],A,v,R),G+=6;break;case e.OPS.curveTo2:E=A,u=v,g.bezierCurveTo(A,v,n[G],n[G+1],n[G+2],n[G+3]),o.updateCurvePathMinMax(a,E,u,A,v,n[G],n[G+1],n[G+2],n[G+3],R),A=n[G+2],v=n[G+3],G+=4;break;case e.OPS.curveTo3:E=A,u=v,A=n[G+2],v=n[G+3],g.bezierCurveTo(n[G],n[G+1],A,v,A,v),o.updateCurvePathMinMax(a,E,u,n[G],n[G+1],A,v,A,v,R),G+=4;break;case e.OPS.closePath:g.closePath();break}h&&o.updateScalingPathMinMax(a,R),o.setCurrentPoint(A,v)}closePath(){this.ctx.closePath()}stroke(i=!0){const n=this.ctx,d=this.current.strokeColor;n.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof d=="object"&&(d!=null&&d.getPattern)?(n.save(),n.strokeStyle=d.getPattern(n,this,(0,w.getCurrentTransformInverse)(n),m.STROKE),this.rescaleAndStroke(!1),n.restore()):this.rescaleAndStroke(!0)),i&&this.consumePath(this.current.getClippedPathBoundingBox()),n.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(i=!0){const n=this.ctx,d=this.current.fillColor,g=this.current.patternFill;let o=!1;g&&(n.save(),n.fillStyle=d.getPattern(n,this,(0,w.getCurrentTransformInverse)(n),m.FILL),o=!0);const A=this.current.getClippedPathBoundingBox();this.contentVisible&&A!==null&&(this.pendingEOFill?(n.fill("evenodd"),this.pendingEOFill=!1):n.fill()),o&&n.restore(),i&&this.consumePath(A)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=de}eoClip(){this.pendingClip=le}beginText(){this.current.textMatrix=e.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const i=this.pendingTextPaths,n=this.ctx;if(i===void 0){n.beginPath();return}n.save(),n.beginPath();for(const d of i)n.setTransform(...d.transform),n.translate(d.x,d.y),d.addToPath(n,d.fontSize);n.restore(),n.clip(),n.beginPath(),delete this.pendingTextPaths}setCharSpacing(i){this.current.charSpacing=i}setWordSpacing(i){this.current.wordSpacing=i}setHScale(i){this.current.textHScale=i/100}setLeading(i){this.current.leading=-i}setFont(i,n){var a;const d=this.commonObjs.get(i),g=this.current;if(!d)throw new Error(`Can't find font for ${i}`);if(g.fontMatrix=d.fontMatrix||e.FONT_IDENTITY_MATRIX,(g.fontMatrix[0]===0||g.fontMatrix[3]===0)&&(0,e.warn)("Invalid font matrix for font "+i),n<0?(n=-n,g.fontDirection=-1):g.fontDirection=1,this.current.font=d,this.current.fontSize=n,d.isType3Font)return;const o=d.loadedName||"sans-serif",A=((a=d.systemFontInfo)==null?void 0:a.css)||`"${o}", ${d.fallbackName}`;let v="normal";d.black?v="900":d.bold&&(v="bold");const E=d.italic?"italic":"normal";let u=n;n<at?u=at:n>Q&&(u=Q),this.current.fontSizeScale=n/u,this.ctx.font=`${E} ${v} ${u}px ${A}`}setTextRenderingMode(i){this.current.textRenderingMode=i}setTextRise(i){this.current.textRise=i}moveText(i,n){this.current.x=this.current.lineX+=i,this.current.y=this.current.lineY+=n}setLeadingMoveText(i,n){this.setLeading(-n),this.moveText(i,n)}setTextMatrix(i,n,d,g,o,A){this.current.textMatrix=[i,n,d,g,o,A],this.current.textMatrixScale=Math.hypot(i,n),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(i,n,d,g){const o=this.ctx,A=this.current,v=A.font,E=A.textRenderingMode,u=A.fontSize/A.fontSizeScale,a=E&e.TextRenderingMode.FILL_STROKE_MASK,h=!!(E&e.TextRenderingMode.ADD_TO_PATH_FLAG),R=A.patternFill&&!v.missingFile;let j;(v.disableFontFace||h||R)&&(j=v.getPathGenerator(this.commonObjs,i)),v.disableFontFace||R?(o.save(),o.translate(n,d),o.beginPath(),j(o,u),g&&o.setTransform(...g),(a===e.TextRenderingMode.FILL||a===e.TextRenderingMode.FILL_STROKE)&&o.fill(),(a===e.TextRenderingMode.STROKE||a===e.TextRenderingMode.FILL_STROKE)&&o.stroke(),o.restore()):((a===e.TextRenderingMode.FILL||a===e.TextRenderingMode.FILL_STROKE)&&o.fillText(i,n,d),(a===e.TextRenderingMode.STROKE||a===e.TextRenderingMode.FILL_STROKE)&&o.strokeText(i,n,d)),h&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,w.getCurrentTransform)(o),x:n,y:d,fontSize:u,addToPath:j})}get isFontSubpixelAAEnabled(){const{context:i}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);i.scale(1.5,1),i.fillText("I",0,10);const n=i.getImageData(0,0,10,10).data;let d=!1;for(let g=3;g<n.length;g+=4)if(n[g]>0&&n[g]<255){d=!0;break}return(0,e.shadow)(this,"isFontSubpixelAAEnabled",d)}showText(i){const n=this.current,d=n.font;if(d.isType3Font)return this.showType3Text(i);const g=n.fontSize;if(g===0)return;const o=this.ctx,A=n.fontSizeScale,v=n.charSpacing,E=n.wordSpacing,u=n.fontDirection,a=n.textHScale*u,h=i.length,R=d.vertical,j=R?1:-1,G=d.defaultVMetrics,rt=g*n.fontMatrix[0],ot=n.textRenderingMode===e.TextRenderingMode.FILL&&!d.disableFontFace&&!n.patternFill;o.save(),o.transform(...n.textMatrix),o.translate(n.x,n.y+n.textRise),u>0?o.scale(a,-1):o.scale(a,1);let yt;if(n.patternFill){o.save();const K=n.fillColor.getPattern(o,this,(0,w.getCurrentTransformInverse)(o),m.FILL);yt=(0,w.getCurrentTransform)(o),o.restore(),o.fillStyle=K}let At=n.lineWidth;const ut=n.textMatrixScale;if(ut===0||At===0){const K=n.textRenderingMode&e.TextRenderingMode.FILL_STROKE_MASK;(K===e.TextRenderingMode.STROKE||K===e.TextRenderingMode.FILL_STROKE)&&(At=this.getSinglePixelWidth())}else At/=ut;if(A!==1&&(o.scale(A,A),At/=A),o.lineWidth=At,d.isInvalidPDFjsFont){const K=[];let nt=0;for(const B of i)K.push(B.unicode),nt+=B.width;o.fillText(K.join(""),0,0),n.x+=nt*rt*a,o.restore(),this.compose();return}let St=0,P;for(P=0;P<h;++P){const K=i[P];if(typeof K=="number"){St+=j*K*g/1e3;continue}let nt=!1;const B=(K.isSpace?E:0)+v,b=K.fontChar,z=K.accent;let X,lt,ft=K.width;if(R){const Dt=K.vmetric||G,te=-(K.vmetric?Dt[1]:ft*.5)*rt,re=Dt[2]*rt;ft=Dt?-Dt[0]:ft,X=te/A,lt=(St+re)/A}else X=St/A,lt=0;if(d.remeasure&&ft>0){const Dt=o.measureText(b).width*1e3/g*A;if(ft<Dt&&this.isFontSubpixelAAEnabled){const te=ft/Dt;nt=!0,o.save(),o.scale(te,1),X/=te}else ft!==Dt&&(X+=(ft-Dt)/2e3*g/A)}if(this.contentVisible&&(K.isInFont||d.missingFile)){if(ot&&!z)o.fillText(b,X,lt);else if(this.paintChar(b,X,lt,yt),z){const Dt=X+g*z.offset.x/A,te=lt-g*z.offset.y/A;this.paintChar(z.fontChar,Dt,te,yt)}}const Tt=R?ft*rt-B*u:ft*rt+B*u;St+=Tt,nt&&o.restore()}R?n.y-=St:n.x+=St*a,o.restore(),this.compose()}showType3Text(i){const n=this.ctx,d=this.current,g=d.font,o=d.fontSize,A=d.fontDirection,v=g.vertical?1:-1,E=d.charSpacing,u=d.wordSpacing,a=d.textHScale*A,h=d.fontMatrix||e.FONT_IDENTITY_MATRIX,R=i.length,j=d.textRenderingMode===e.TextRenderingMode.INVISIBLE;let G,rt,ot,yt;if(!(j||o===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),n.transform(...d.textMatrix),n.translate(d.x,d.y),n.scale(a,A),G=0;G<R;++G){if(rt=i[G],typeof rt=="number"){yt=v*rt*o/1e3,this.ctx.translate(yt,0),d.x+=yt*a;continue}const At=(rt.isSpace?u:0)+E,ut=g.charProcOperatorList[rt.operatorListId];if(!ut){(0,e.warn)(`Type3 character "${rt.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=rt,this.save(),n.scale(o,o),n.transform(...h),this.executeOperatorList(ut),this.restore()),ot=e.Util.applyTransform([rt.width,0],h)[0]*o+At,n.translate(ot,0),d.x+=ot*a}n.restore(),this.processingType3=null}}setCharWidth(i,n){}setCharWidthAndBounds(i,n,d,g,o,A){this.ctx.rect(d,g,o-d,A-g),this.ctx.clip(),this.endPath()}getColorN_Pattern(i){let n;if(i[0]==="TilingPattern"){const d=i[1],g=this.baseTransform||(0,w.getCurrentTransform)(this.ctx),o={createCanvasGraphics:A=>new ne(A,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};n=new U(i,d,this.ctx,o,g)}else n=this._getPattern(i[1],i[2]);return n}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(i,n,d){const g=e.Util.makeHexColor(i,n,d);this.ctx.strokeStyle=g,this.current.strokeColor=g}setFillRGBColor(i,n,d){const g=e.Util.makeHexColor(i,n,d);this.ctx.fillStyle=g,this.current.fillColor=g,this.current.patternFill=!1}_getPattern(i,n=null){let d;return this.cachedPatterns.has(i)?d=this.cachedPatterns.get(i):(d=_(this.getObject(i)),this.cachedPatterns.set(i,d)),n&&(d.matrix=n),d}shadingFill(i){if(!this.contentVisible)return;const n=this.ctx;this.save();const d=this._getPattern(i);n.fillStyle=d.getPattern(n,this,(0,w.getCurrentTransformInverse)(n),m.SHADING);const g=(0,w.getCurrentTransformInverse)(n);if(g){const{width:o,height:A}=n.canvas,[v,E,u,a]=e.Util.getAxialAlignedBoundingBox([0,0,o,A],g);this.ctx.fillRect(v,E,u-v,a-E)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,e.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,e.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(i,n){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(i)&&i.length===6&&this.transform(...i),this.baseTransform=(0,w.getCurrentTransform)(this.ctx),n)){const d=n[2]-n[0],g=n[3]-n[1];this.ctx.rect(n[0],n[1],d,g),this.current.updateRectMinMax((0,w.getCurrentTransform)(this.ctx),n),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(i){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;i.isolated||(0,e.info)("TODO: Support non-isolated groups."),i.knockout&&(0,e.warn)("Knockout groups not supported.");const d=(0,w.getCurrentTransform)(n);if(i.matrix&&n.transform(...i.matrix),!i.bbox)throw new Error("Bounding box is required.");let g=e.Util.getAxialAlignedBoundingBox(i.bbox,(0,w.getCurrentTransform)(n));const o=[0,0,n.canvas.width,n.canvas.height];g=e.Util.intersect(g,o)||[0,0,0,0];const A=Math.floor(g[0]),v=Math.floor(g[1]);let E=Math.max(Math.ceil(g[2])-A,1),u=Math.max(Math.ceil(g[3])-v,1),a=1,h=1;E>L&&(a=E/L,E=L),u>L&&(h=u/L,u=L),this.current.startNewPathAndClipBox([0,0,E,u]);let R="groupAt"+this.groupLevel;i.smask&&(R+="_smask_"+this.smaskCounter++%2);const j=this.cachedCanvases.getCanvas(R,E,u),G=j.context;G.scale(1/a,1/h),G.translate(-A,-v),G.transform(...d),i.smask?this.smaskStack.push({canvas:j.canvas,context:G,offsetX:A,offsetY:v,scaleX:a,scaleY:h,subtype:i.smask.subtype,backdrop:i.smask.backdrop,transferMap:i.smask.transferMap||null,startTransformInverse:null}):(n.setTransform(1,0,0,1,0,0),n.translate(A,v),n.scale(a,h),n.save()),Lt(n,G),this.ctx=G,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(i){if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,d=this.groupStack.pop();if(this.ctx=d,this.ctx.imageSmoothingEnabled=!1,i.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const g=(0,w.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...g);const o=e.Util.getAxialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],g);this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(i,n,d,g,o){if(T(this,ae,In).call(this),Et(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(n)&&n.length===4){const A=n[2]-n[0],v=n[3]-n[1];if(o&&this.annotationCanvasMap){d=d.slice(),d[4]-=n[0],d[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=A,n[3]=v;const[E,u]=e.Util.singularValueDecompose2dScale((0,w.getCurrentTransform)(this.ctx)),{viewportScale:a}=this,h=Math.ceil(A*this.outputScaleX*a),R=Math.ceil(v*this.outputScaleY*a);this.annotationCanvas=this.canvasFactory.create(h,R);const{canvas:j,context:G}=this.annotationCanvas;this.annotationCanvasMap.set(i,j),this.annotationCanvas.savedCtx=this.ctx,this.ctx=G,this.ctx.save(),this.ctx.setTransform(E,0,0,-u,0,v*u),Et(this.ctx)}else Et(this.ctx),this.ctx.rect(n[0],n[1],A,v),this.ctx.clip(),this.endPath()}this.current=new Ot(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...d),this.transform(...g)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),T(this,ee,Fn).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(i){if(!this.contentVisible)return;const n=i.count;i=this.getObject(i.data,i),i.count=n;const d=this.ctx,g=this.processingType3;if(g&&(g.compiled===void 0&&(g.compiled=Ct(i)),g.compiled)){g.compiled(d);return}const o=this._createMaskCanvas(i),A=o.canvas;d.save(),d.setTransform(1,0,0,1,0,0),d.drawImage(A,o.offsetX,o.offsetY),d.restore(),this.compose()}paintImageMaskXObjectRepeat(i,n,d=0,g=0,o,A){if(!this.contentVisible)return;i=this.getObject(i.data,i);const v=this.ctx;v.save();const E=(0,w.getCurrentTransform)(v);v.transform(n,d,g,o,0,0);const u=this._createMaskCanvas(i);v.setTransform(1,0,0,1,u.offsetX-E[4],u.offsetY-E[5]);for(let a=0,h=A.length;a<h;a+=2){const R=e.Util.transform(E,[n,d,g,o,A[a],A[a+1]]),[j,G]=e.Util.applyTransform([0,0],R);v.drawImage(u.canvas,j,G)}v.restore(),this.compose()}paintImageMaskXObjectGroup(i){if(!this.contentVisible)return;const n=this.ctx,d=this.current.fillColor,g=this.current.patternFill;for(const o of i){const{data:A,width:v,height:E,transform:u}=o,a=this.cachedCanvases.getCanvas("maskCanvas",v,E),h=a.context;h.save();const R=this.getObject(A,o);Mt(h,R),h.globalCompositeOperation="source-in",h.fillStyle=g?d.getPattern(h,this,(0,w.getCurrentTransformInverse)(n),m.FILL):d,h.fillRect(0,0,v,E),h.restore(),n.save(),n.transform(...u),n.scale(1,-1),Ft(n,a.canvas,0,0,v,E,0,-1,1,1),n.restore()}this.compose()}paintImageXObject(i){if(!this.contentVisible)return;const n=this.getObject(i);if(!n){(0,e.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(n)}paintImageXObjectRepeat(i,n,d,g){if(!this.contentVisible)return;const o=this.getObject(i);if(!o){(0,e.warn)("Dependent image isn't ready yet");return}const A=o.width,v=o.height,E=[];for(let u=0,a=g.length;u<a;u+=2)E.push({transform:[n,0,0,d,g[u],g[u+1]],x:0,y:0,w:A,h:v});this.paintInlineImageXObjectGroup(o,E)}applyTransferMapsToCanvas(i){return this.current.transferMaps!=="none"&&(i.filter=this.current.transferMaps,i.drawImage(i.canvas,0,0),i.filter="none"),i.canvas}applyTransferMapsToBitmap(i){if(this.current.transferMaps==="none")return i.bitmap;const{bitmap:n,width:d,height:g}=i,o=this.cachedCanvases.getCanvas("inlineImage",d,g),A=o.context;return A.filter=this.current.transferMaps,A.drawImage(n,0,0),A.filter="none",o.canvas}paintInlineImageXObject(i){if(!this.contentVisible)return;const n=i.width,d=i.height,g=this.ctx;if(this.save(),!e.isNodeJS){const{filter:v}=g;v!=="none"&&v!==""&&(g.filter="none")}g.scale(1/n,-1/d);let o;if(i.bitmap)o=this.applyTransferMapsToBitmap(i);else if(typeof HTMLElement=="function"&&i instanceof HTMLElement||!i.data)o=i;else{const v=this.cachedCanvases.getCanvas("inlineImage",n,d).context;_t(v,i),o=this.applyTransferMapsToCanvas(v)}const A=this._scaleImage(o,(0,w.getCurrentTransformInverse)(g));g.imageSmoothingEnabled=Kt((0,w.getCurrentTransform)(g),i.interpolate),Ft(g,A.img,0,0,A.paintWidth,A.paintHeight,0,-d,n,d),this.compose(),this.restore()}paintInlineImageXObjectGroup(i,n){if(!this.contentVisible)return;const d=this.ctx;let g;if(i.bitmap)g=i.bitmap;else{const o=i.width,A=i.height,v=this.cachedCanvases.getCanvas("inlineImage",o,A).context;_t(v,i),g=this.applyTransferMapsToCanvas(v)}for(const o of n)d.save(),d.transform(...o.transform),d.scale(1,-1),Ft(d,g,o.x,o.y,o.w,o.h,0,-1,1,1),d.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(i){}markPointProps(i,n){}beginMarkedContent(i){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(i,n){i==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(i){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const d=this.ctx;this.pendingClip&&(n||(this.pendingClip===le?d.clip("evenodd"):d.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),d.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const i=(0,w.getCurrentTransform)(this.ctx);if(i[1]===0&&i[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(i[0]),Math.abs(i[3]));else{const n=Math.abs(i[0]*i[3]-i[2]*i[1]),d=Math.hypot(i[0],i[2]),g=Math.hypot(i[1],i[3]);this._cachedGetSinglePixelWidth=Math.max(d,g)/n}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:i}=this.current,{a:n,b:d,c:g,d:o}=this.ctx.getTransform();let A,v;if(d===0&&g===0){const E=Math.abs(n),u=Math.abs(o);if(E===u)if(i===0)A=v=1/E;else{const a=E*i;A=v=a<1?1/a:1}else if(i===0)A=1/E,v=1/u;else{const a=E*i,h=u*i;A=a<1?1/a:1,v=h<1?1/h:1}}else{const E=Math.abs(n*o-d*g),u=Math.hypot(n,d),a=Math.hypot(g,o);if(i===0)A=a/E,v=u/E;else{const h=i*E;A=a>h?a/h:1,v=u>h?u/h:1}}this._cachedScaleForStroking[0]=A,this._cachedScaleForStroking[1]=v}return this._cachedScaleForStroking}rescaleAndStroke(i){const{ctx:n}=this,{lineWidth:d}=this.current,[g,o]=this.getScaleForStroking();if(n.lineWidth=d||1,g===1&&o===1){n.stroke();return}const A=n.getLineDash();if(i&&n.save(),n.scale(g,o),A.length>0){const v=Math.max(g,o);n.setLineDash(A.map(E=>E/v)),n.lineDashOffset/=v}n.stroke(),i&&n.restore()}isContentVisible(){for(let i=this.markedContentStack.length-1;i>=0;i--)if(!this.markedContentStack[i].visible)return!1;return!0}};ae=new WeakSet,In=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},ee=new WeakSet,Fn=function(){if(this.pageColors){const i=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(i!=="none"){const n=this.ctx.filter;this.ctx.filter=i,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=n}}};let be=ne;for(const et in e.OPS)be.prototype[et]!==void 0&&(be.prototype[e.OPS[et]]=be.prototype[et])},419:(r,p,c)=>{var Lt,Et,Z,gt,Rt,Pt,qt,Qs,ie,Zs,de,ti,be,Dn,ae,Ji,ee,Qi,ne,_i,i,wi;c.d(p,{DOMCMapReaderFactory:()=>f,DOMCanvasFactory:()=>k,DOMFilterFactory:()=>W,DOMSVGFactory:()=>C,DOMStandardFontDataFactory:()=>O,PDFDateString:()=>q,PageViewport:()=>_,PixelsPerInch:()=>x,RenderingCancelledException:()=>D,StatTimer:()=>L,fetchData:()=>y,getColorValues:()=>Ft,getCurrentTransform:()=>Ct,getCurrentTransformInverse:()=>Ot,getFilenameFromUrl:()=>at,getPdfFilenameFromUrl:()=>Q,getRGB:()=>bt,getXfaPageViewport:()=>tt,isDataScheme:()=>U,isPdfFile:()=>Y,isValidFetchUrl:()=>V,noContextMenu:()=>$,setLayerDimensions:()=>_t});var e=c(583),w=c(292);const m="http://www.w3.org/2000/svg",Mt=class Mt{};me(Mt,"CSS",96),me(Mt,"PDF",72),me(Mt,"PDF_TO_CSS_UNITS",Mt.CSS/Mt.PDF);let x=Mt;class W extends e.BaseFilterFactory{constructor({docId:o,ownerDocument:A=globalThis.document}={}){super();l(this,qt);l(this,ie);l(this,de);l(this,be);l(this,ae);l(this,ee);l(this,ne);l(this,i);l(this,Lt,void 0);l(this,Et,void 0);l(this,Z,void 0);l(this,gt,void 0);l(this,Rt,void 0);l(this,Pt,0);I(this,Z,o),I(this,gt,A)}addFilter(o){if(!o)return"none";let A=t(this,qt,Qs).get(o);if(A)return A;let v,E,u,a;if(o.length===1){const G=o[0],rt=new Array(256);for(let ot=0;ot<256;ot++)rt[ot]=G[ot]/255;a=v=E=u=rt.join(",")}else{const[G,rt,ot]=o,yt=new Array(256),At=new Array(256),ut=new Array(256);for(let St=0;St<256;St++)yt[St]=G[St]/255,At[St]=rt[St]/255,ut[St]=ot[St]/255;v=yt.join(","),E=At.join(","),u=ut.join(","),a=`${v}${E}${u}`}if(A=t(this,qt,Qs).get(a),A)return t(this,qt,Qs).set(o,A),A;const h=`g_${t(this,Z)}_transfer_map_${bs(this,Pt)._++}`,R=`url(#${h})`;t(this,qt,Qs).set(o,R),t(this,qt,Qs).set(a,R);const j=T(this,ae,Ji).call(this,h);return T(this,ne,_i).call(this,v,E,u,j),R}addHCMFilter(o,A){var yt;const v=`${o}-${A}`,E="base";let u=t(this,ie,Zs).get(E);if((u==null?void 0:u.key)===v||(u?((yt=u.filter)==null||yt.remove(),u.key=v,u.url="none",u.filter=null):(u={key:v,url:"none",filter:null},t(this,ie,Zs).set(E,u)),!o||!A))return u.url;const a=T(this,i,wi).call(this,o);o=w.Util.makeHexColor(...a);const h=T(this,i,wi).call(this,A);if(A=w.Util.makeHexColor(...h),t(this,de,ti).style.color="",o==="#000000"&&A==="#ffffff"||o===A)return u.url;const R=new Array(256);for(let At=0;At<=255;At++){const ut=At/255;R[At]=ut<=.03928?ut/12.92:((ut+.055)/1.055)**2.4}const j=R.join(","),G=`g_${t(this,Z)}_hcm_filter`,rt=u.filter=T(this,ae,Ji).call(this,G);T(this,ne,_i).call(this,j,j,j,rt),T(this,be,Dn).call(this,rt);const ot=(At,ut)=>{const St=a[At]/255,P=h[At]/255,K=new Array(ut+1);for(let nt=0;nt<=ut;nt++)K[nt]=St+nt/ut*(P-St);return K.join(",")};return T(this,ne,_i).call(this,ot(0,5),ot(1,5),ot(2,5),rt),u.url=`url(#${G})`,u.url}addHighlightHCMFilter(o,A,v,E,u){var P;const a=`${A}-${v}-${E}-${u}`;let h=t(this,ie,Zs).get(o);if((h==null?void 0:h.key)===a||(h?((P=h.filter)==null||P.remove(),h.key=a,h.url="none",h.filter=null):(h={key:a,url:"none",filter:null},t(this,ie,Zs).set(o,h)),!A||!v))return h.url;const[R,j]=[A,v].map(T(this,i,wi).bind(this));let G=Math.round(.2126*R[0]+.7152*R[1]+.0722*R[2]),rt=Math.round(.2126*j[0]+.7152*j[1]+.0722*j[2]),[ot,yt]=[E,u].map(T(this,i,wi).bind(this));rt<G&&([G,rt,ot,yt]=[rt,G,yt,ot]),t(this,de,ti).style.color="";const At=(K,nt,B)=>{const b=new Array(256),z=(rt-G)/B,X=K/255,lt=(nt-K)/(255*B);let ft=0;for(let Tt=0;Tt<=B;Tt++){const Dt=Math.round(G+Tt*z),te=X+Tt*lt;for(let re=ft;re<=Dt;re++)b[re]=te;ft=Dt+1}for(let Tt=ft;Tt<256;Tt++)b[Tt]=b[ft-1];return b.join(",")},ut=`g_${t(this,Z)}_hcm_${o}_filter`,St=h.filter=T(this,ae,Ji).call(this,ut);return T(this,be,Dn).call(this,St),T(this,ne,_i).call(this,At(ot[0],yt[0],5),At(ot[1],yt[1],5),At(ot[2],yt[2],5),St),h.url=`url(#${ut})`,h.url}destroy(o=!1){o&&t(this,ie,Zs).size!==0||(t(this,Et)&&(t(this,Et).parentNode.parentNode.remove(),I(this,Et,null)),t(this,Lt)&&(t(this,Lt).clear(),I(this,Lt,null)),I(this,Pt,0))}}Lt=new WeakMap,Et=new WeakMap,Z=new WeakMap,gt=new WeakMap,Rt=new WeakMap,Pt=new WeakMap,qt=new WeakSet,Qs=function(){return t(this,Lt)||I(this,Lt,new Map)},ie=new WeakSet,Zs=function(){return t(this,Rt)||I(this,Rt,new Map)},de=new WeakSet,ti=function(){if(!t(this,Et)){const o=t(this,gt).createElement("div"),{style:A}=o;A.visibility="hidden",A.contain="strict",A.width=A.height=0,A.position="absolute",A.top=A.left=0,A.zIndex=-1;const v=t(this,gt).createElementNS(m,"svg");v.setAttribute("width",0),v.setAttribute("height",0),I(this,Et,t(this,gt).createElementNS(m,"defs")),o.append(v),v.append(t(this,Et)),t(this,gt).body.append(o)}return t(this,Et)},be=new WeakSet,Dn=function(o){const A=t(this,gt).createElementNS(m,"feColorMatrix");A.setAttribute("type","matrix"),A.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),o.append(A)},ae=new WeakSet,Ji=function(o){const A=t(this,gt).createElementNS(m,"filter");return A.setAttribute("color-interpolation-filters","sRGB"),A.setAttribute("id",o),t(this,de,ti).append(A),A},ee=new WeakSet,Qi=function(o,A,v){const E=t(this,gt).createElementNS(m,A);E.setAttribute("type","discrete"),E.setAttribute("tableValues",v),o.append(E)},ne=new WeakSet,_i=function(o,A,v,E){const u=t(this,gt).createElementNS(m,"feComponentTransfer");E.append(u),T(this,ee,Qi).call(this,u,"feFuncR",o),T(this,ee,Qi).call(this,u,"feFuncG",A),T(this,ee,Qi).call(this,u,"feFuncB",v)},i=new WeakSet,wi=function(o){return t(this,de,ti).style.color=o,bt(getComputedStyle(t(this,de,ti)).getPropertyValue("color"))};class k extends e.BaseCanvasFactory{constructor({ownerDocument:g=globalThis.document}={}){super(),this._document=g}_createCanvas(g,o){const A=this._document.createElement("canvas");return A.width=g,A.height=o,A}}async function y(d,g="text"){if(V(d,document.baseURI)){const o=await fetch(d);if(!o.ok)throw new Error(o.statusText);switch(g){case"arraybuffer":return o.arrayBuffer();case"blob":return o.blob();case"json":return o.json()}return o.text()}return new Promise((o,A)=>{const v=new XMLHttpRequest;v.open("GET",d,!0),v.responseType=g,v.onreadystatechange=()=>{if(v.readyState===XMLHttpRequest.DONE){if(v.status===200||v.status===0){switch(g){case"arraybuffer":case"blob":case"json":o(v.response);return}o(v.responseText);return}A(new Error(v.statusText))}},v.send(null)})}class f extends e.BaseCMapReaderFactory{_fetchData(g,o){return y(g,this.isCompressed?"arraybuffer":"text").then(A=>({cMapData:A instanceof ArrayBuffer?new Uint8Array(A):(0,w.stringToBytes)(A),compressionType:o}))}}class O extends e.BaseStandardFontDataFactory{_fetchData(g){return y(g,"arraybuffer").then(o=>new Uint8Array(o))}}class C extends e.BaseSVGFactory{_createSVG(g){return document.createElementNS(m,g)}}class _{constructor({viewBox:g,scale:o,rotation:A,offsetX:v=0,offsetY:E=0,dontFlip:u=!1}){this.viewBox=g,this.scale=o,this.rotation=A,this.offsetX=v,this.offsetY=E;const a=(g[2]+g[0])/2,h=(g[3]+g[1])/2;let R,j,G,rt;switch(A%=360,A<0&&(A+=360),A){case 180:R=-1,j=0,G=0,rt=1;break;case 90:R=0,j=1,G=1,rt=0;break;case 270:R=0,j=-1,G=-1,rt=0;break;case 0:R=1,j=0,G=0,rt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(G=-G,rt=-rt);let ot,yt,At,ut;R===0?(ot=Math.abs(h-g[1])*o+v,yt=Math.abs(a-g[0])*o+E,At=(g[3]-g[1])*o,ut=(g[2]-g[0])*o):(ot=Math.abs(a-g[0])*o+v,yt=Math.abs(h-g[1])*o+E,At=(g[2]-g[0])*o,ut=(g[3]-g[1])*o),this.transform=[R*o,j*o,G*o,rt*o,ot-R*o*a-G*o*h,yt-j*o*a-rt*o*h],this.width=At,this.height=ut}get rawDims(){const{viewBox:g}=this;return(0,w.shadow)(this,"rawDims",{pageWidth:g[2]-g[0],pageHeight:g[3]-g[1],pageX:g[0],pageY:g[1]})}clone({scale:g=this.scale,rotation:o=this.rotation,offsetX:A=this.offsetX,offsetY:v=this.offsetY,dontFlip:E=!1}={}){return new _({viewBox:this.viewBox.slice(),scale:g,rotation:o,offsetX:A,offsetY:v,dontFlip:E})}convertToViewportPoint(g,o){return w.Util.applyTransform([g,o],this.transform)}convertToViewportRectangle(g){const o=w.Util.applyTransform([g[0],g[1]],this.transform),A=w.Util.applyTransform([g[2],g[3]],this.transform);return[o[0],o[1],A[0],A[1]]}convertToPdfPoint(g,o){return w.Util.applyInverseTransform([g,o],this.transform)}}class D extends w.BaseException{constructor(g,o=0){super(g,"RenderingCancelledException"),this.extraDelay=o}}function U(d){const g=d.length;let o=0;for(;o<g&&d[o].trim()==="";)o++;return d.substring(o,o+5).toLowerCase()==="data:"}function Y(d){return typeof d=="string"&&/\.pdf$/i.test(d)}function at(d,g=!1){return g||([d]=d.split(/[#?]/,1)),d.substring(d.lastIndexOf("/")+1)}function Q(d,g="document.pdf"){if(typeof d!="string")return g;if(U(d))return(0,w.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),g;const o=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,A=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,v=o.exec(d);let E=A.exec(v[1])||A.exec(v[2])||A.exec(v[3]);if(E&&(E=E[0],E.includes("%")))try{E=A.exec(decodeURIComponent(E))[0]}catch{}return E||g}class L{constructor(){me(this,"started",Object.create(null));me(this,"times",[])}time(g){g in this.started&&(0,w.warn)(`Timer is already running for ${g}`),this.started[g]=Date.now()}timeEnd(g){g in this.started||(0,w.warn)(`Timer has not been started for ${g}`),this.times.push({name:g,start:this.started[g],end:Date.now()}),delete this.started[g]}toString(){const g=[];let o=0;for(const{name:A}of this.times)o=Math.max(A.length,o);for(const{name:A,start:v,end:E}of this.times)g.push(`${A.padEnd(o)} ${E-v}ms
`);return g.join("")}}function V(d,g){try{const{protocol:o}=g?new URL(d,g):new URL(d);return o==="http:"||o==="https:"}catch{return!1}}function $(d){d.preventDefault()}let N;class q{static toDateObject(g){if(!g||typeof g!="string")return null;N||(N=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const o=N.exec(g);if(!o)return null;const A=parseInt(o[1],10);let v=parseInt(o[2],10);v=v>=1&&v<=12?v-1:0;let E=parseInt(o[3],10);E=E>=1&&E<=31?E:1;let u=parseInt(o[4],10);u=u>=0&&u<=23?u:0;let a=parseInt(o[5],10);a=a>=0&&a<=59?a:0;let h=parseInt(o[6],10);h=h>=0&&h<=59?h:0;const R=o[7]||"Z";let j=parseInt(o[8],10);j=j>=0&&j<=23?j:0;let G=parseInt(o[9],10)||0;return G=G>=0&&G<=59?G:0,R==="-"?(u+=j,a+=G):R==="+"&&(u-=j,a-=G),new Date(Date.UTC(A,v,E,u,a,h))}}function tt(d,{scale:g=1,rotation:o=0}){const{width:A,height:v}=d.attributes.style,E=[0,0,parseInt(A),parseInt(v)];return new _({viewBox:E,scale:g,rotation:o})}function bt(d){if(d.startsWith("#")){const g=parseInt(d.slice(1),16);return[(g&16711680)>>16,(g&65280)>>8,g&255]}return d.startsWith("rgb(")?d.slice(4,-1).split(",").map(g=>parseInt(g)):d.startsWith("rgba(")?d.slice(5,-1).split(",").map(g=>parseInt(g)).slice(0,3):((0,w.warn)(`Not a valid color format: "${d}"`),[0,0,0])}function Ft(d){const g=document.createElement("span");g.style.visibility="hidden",document.body.append(g);for(const o of d.keys()){g.style.color=o;const A=window.getComputedStyle(g).color;d.set(o,bt(A))}g.remove()}function Ct(d){const{a:g,b:o,c:A,d:v,e:E,f:u}=d.getTransform();return[g,o,A,v,E,u]}function Ot(d){const{a:g,b:o,c:A,d:v,e:E,f:u}=d.getTransform().invertSelf();return[g,o,A,v,E,u]}function _t(d,g,o=!1,A=!0){if(g instanceof _){const{pageWidth:v,pageHeight:E}=g.rawDims,{style:u}=d,a=w.FeatureTest.isCSSRoundSupported,h=`var(--scale-factor) * ${v}px`,R=`var(--scale-factor) * ${E}px`,j=a?`round(${h}, 1px)`:`calc(${h})`,G=a?`round(${R}, 1px)`:`calc(${R})`;!o||g.rotation%180===0?(u.width=j,u.height=G):(u.width=G,u.height=j)}A&&d.setAttribute("data-main-rotation",g.rotation)}},47:(r,p,c)=>{var x,W,k,y,f,Nn,C,On,D,Kr;c.d(p,{DrawLayer:()=>m});var e=c(419),w=c(292);const Y=class Y{constructor({pageIndex:Q}){l(this,C);l(this,D);l(this,x,null);l(this,W,0);l(this,k,new Map);l(this,y,new Map);this.pageIndex=Q}setParent(Q){if(!t(this,x)){I(this,x,Q);return}if(t(this,x)!==Q){if(t(this,k).size>0)for(const L of t(this,k).values())L.remove(),Q.append(L);I(this,x,Q)}}static get _svgFactory(){return(0,w.shadow)(this,"_svgFactory",new e.DOMSVGFactory)}highlight(Q,L,V,$=!1){const N=bs(this,W)._++,q=T(this,C,On).call(this,Q.box);q.classList.add("highlight"),Q.free&&q.classList.add("free");const tt=Y._svgFactory.createElement("defs");q.append(tt);const bt=Y._svgFactory.createElement("path");tt.append(bt);const Ft=`path_p${this.pageIndex}_${N}`;bt.setAttribute("id",Ft),bt.setAttribute("d",Q.toSVGPath()),$&&t(this,y).set(N,bt);const Ct=T(this,D,Kr).call(this,tt,Ft),Ot=Y._svgFactory.createElement("use");return q.append(Ot),q.setAttribute("fill",L),q.setAttribute("fill-opacity",V),Ot.setAttribute("href",`#${Ft}`),t(this,k).set(N,q),{id:N,clipPathId:`url(#${Ct})`}}highlightOutline(Q){const L=bs(this,W)._++,V=T(this,C,On).call(this,Q.box);V.classList.add("highlightOutline");const $=Y._svgFactory.createElement("defs");V.append($);const N=Y._svgFactory.createElement("path");$.append(N);const q=`path_p${this.pageIndex}_${L}`;N.setAttribute("id",q),N.setAttribute("d",Q.toSVGPath()),N.setAttribute("vector-effect","non-scaling-stroke");let tt;if(Q.free){V.classList.add("free");const Ct=Y._svgFactory.createElement("mask");$.append(Ct),tt=`mask_p${this.pageIndex}_${L}`,Ct.setAttribute("id",tt),Ct.setAttribute("maskUnits","objectBoundingBox");const Ot=Y._svgFactory.createElement("rect");Ct.append(Ot),Ot.setAttribute("width","1"),Ot.setAttribute("height","1"),Ot.setAttribute("fill","white");const _t=Y._svgFactory.createElement("use");Ct.append(_t),_t.setAttribute("href",`#${q}`),_t.setAttribute("stroke","none"),_t.setAttribute("fill","black"),_t.setAttribute("fill-rule","nonzero"),_t.classList.add("mask")}const bt=Y._svgFactory.createElement("use");V.append(bt),bt.setAttribute("href",`#${q}`),tt&&bt.setAttribute("mask",`url(#${tt})`);const Ft=bt.cloneNode();return V.append(Ft),bt.classList.add("mainOutline"),Ft.classList.add("secondaryOutline"),t(this,k).set(L,V),L}finalizeLine(Q,L){const V=t(this,y).get(Q);t(this,y).delete(Q),this.updateBox(Q,L.box),V.setAttribute("d",L.toSVGPath())}updateLine(Q,L){t(this,k).get(Q).firstChild.firstChild.setAttribute("d",L.toSVGPath())}removeFreeHighlight(Q){this.remove(Q),t(this,y).delete(Q)}updatePath(Q,L){t(this,y).get(Q).setAttribute("d",L.toSVGPath())}updateBox(Q,L){var V;T(V=Y,f,Nn).call(V,t(this,k).get(Q),L)}show(Q,L){t(this,k).get(Q).classList.toggle("hidden",!L)}rotate(Q,L){t(this,k).get(Q).setAttribute("data-main-rotation",L)}changeColor(Q,L){t(this,k).get(Q).setAttribute("fill",L)}changeOpacity(Q,L){t(this,k).get(Q).setAttribute("fill-opacity",L)}addClass(Q,L){t(this,k).get(Q).classList.add(L)}removeClass(Q,L){t(this,k).get(Q).classList.remove(L)}remove(Q){t(this,x)!==null&&(t(this,k).get(Q).remove(),t(this,k).delete(Q))}destroy(){I(this,x,null);for(const Q of t(this,k).values())Q.remove();t(this,k).clear()}};x=new WeakMap,W=new WeakMap,k=new WeakMap,y=new WeakMap,f=new WeakSet,Nn=function(Q,{x:L=0,y:V=0,width:$=1,height:N=1}={}){const{style:q}=Q;q.top=`${100*V}%`,q.left=`${100*L}%`,q.width=`${100*$}%`,q.height=`${100*N}%`},C=new WeakSet,On=function(Q){var V;const L=Y._svgFactory.create(1,1,!0);return t(this,x).append(L),L.setAttribute("aria-hidden",!0),T(V=Y,f,Nn).call(V,L,Q),L},D=new WeakSet,Kr=function(Q,L){const V=Y._svgFactory.createElement("clipPath");Q.append(V);const $=`clip_${L}`;V.setAttribute("id",$),V.setAttribute("clipPathUnits","objectBoundingBox");const N=Y._svgFactory.createElement("use");return V.append(N),N.setAttribute("href",`#${L}`),N.classList.add("clip"),$},l(Y,f);let m=Y},731:(r,p,c)=>{var Y,at,Q,L,V,$,N,q,tt,bt,Ft,Yr,Ot,Jr,Mt,Qr,Et,Zi,gt,tn,Pt,en,Kt,Zr,xe,Hn,le,ta,ae,Ce,ee,Ee,ne,et,i,n,d,g,o,A,v,E,u,a,h,R,j,G,Bn,ot,Un,At,ea,St,sa,K,ia,B,$n,z,Ei,lt,ei,Tt,na,te,sn,he,Si,_e,ra,fe,aa,se,oa,S,ha,ct,wt,vt,zt,jt,Nt,Yt,$t,xt,Bt,Qt,ue,ce,we,Me,ts,la,Xe,ca,Ve,da,dt,ua,Ut,Vn,Zt,pa,ve,jn,He,ga,qe,fa,ks,ma,Di,ba,Ni,va,us,Os,ai,Gn,Us,nn,$s,rn,As,si,oi,qn,Vs,an,Oi,Aa,hi,zn,Hi,ya,Bi,_a,li,Wn,js,on,Ls,xi,je,Ge,ys,ps,_s,Gs,hs,Rs,ls,rs,ci,Ps,Ci,Is,Ti,qs,hn,di,Xn,Ui,wa,$i,Ea,ui,Kn,zs,ln,Vi,Sa,Fs,Ws,cs,Ds,gs,fs,ms,es,ws,Xs,Ks,Ye,pe,Es,ji,xa,gi,Yn,fi,Jn,mi,Qn,Ys,cn;c.d(p,{AnnotationEditorLayer:()=>U});var e=c(292),w=c(310),m=c(830),x=c(976);const W=/\r\n?|\n/g,Vt=class Vt extends w.AnnotationEditor{constructor(s){super({...s,name:"freeTextEditor"});l(this,Ft);l(this,Ot);l(this,Mt);l(this,Et);l(this,Pt);l(this,Kt);l(this,le);l(this,Y,this.editorDivBlur.bind(this));l(this,at,this.editorDivFocus.bind(this));l(this,Q,this.editorDivInput.bind(this));l(this,L,this.editorDivKeydown.bind(this));l(this,V,this.editorDivPaste.bind(this));l(this,$,void 0);l(this,N,"");l(this,q,`${this.id}-editor`);l(this,tt,void 0);l(this,bt,null);I(this,$,s.color||Vt._defaultColor||w.AnnotationEditor._defaultLineColor),I(this,tt,s.fontSize||Vt._defaultFontSize)}static get _keyboardManager(){const s=Vt.prototype,M=mt=>mt.isEmpty(),st=m.AnnotationEditorUIManager.TRANSLATE_SMALL,ht=m.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,e.shadow)(this,"_keyboardManager",new m.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],s.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],s.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],s._translateEmpty,{args:[-st,0],checker:M}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],s._translateEmpty,{args:[-ht,0],checker:M}],[["ArrowRight","mac+ArrowRight"],s._translateEmpty,{args:[st,0],checker:M}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],s._translateEmpty,{args:[ht,0],checker:M}],[["ArrowUp","mac+ArrowUp"],s._translateEmpty,{args:[0,-st],checker:M}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],s._translateEmpty,{args:[0,-ht],checker:M}],[["ArrowDown","mac+ArrowDown"],s._translateEmpty,{args:[0,st],checker:M}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],s._translateEmpty,{args:[0,ht],checker:M}]]))}static initialize(s,M){w.AnnotationEditor.initialize(s,M,{strings:["pdfjs-free-text-default-content"]});const st=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(st.getPropertyValue("--freetext-padding"))}static updateDefaultParams(s,M){switch(s){case e.AnnotationEditorParamsType.FREETEXT_SIZE:Vt._defaultFontSize=M;break;case e.AnnotationEditorParamsType.FREETEXT_COLOR:Vt._defaultColor=M;break}}updateParams(s,M){switch(s){case e.AnnotationEditorParamsType.FREETEXT_SIZE:T(this,Ft,Yr).call(this,M);break;case e.AnnotationEditorParamsType.FREETEXT_COLOR:T(this,Ot,Jr).call(this,M);break}}static get defaultPropertiesToUpdate(){return[[e.AnnotationEditorParamsType.FREETEXT_SIZE,Vt._defaultFontSize],[e.AnnotationEditorParamsType.FREETEXT_COLOR,Vt._defaultColor||w.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[e.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,tt)],[e.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,$)]]}_translateEmpty(s,M){this._uiManager.translateSelectedEditors(s,M,!0)}getInitialTranslation(){const s=this.parentScale;return[-Vt._internalPadding*s,-(Vt._internalPadding+t(this,tt))*s]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(e.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,L)),this.editorDiv.addEventListener("focus",t(this,at)),this.editorDiv.addEventListener("blur",t(this,Y)),this.editorDiv.addEventListener("input",t(this,Q)),this.editorDiv.addEventListener("paste",t(this,V)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,q)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,L)),this.editorDiv.removeEventListener("focus",t(this,at)),this.editorDiv.removeEventListener("blur",t(this,Y)),this.editorDiv.removeEventListener("input",t(this,Q)),this.editorDiv.removeEventListener("paste",t(this,V)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(s){this._focusEventsAllowed&&(super.focusin(s),s.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var s;this.width||(this.enableEditMode(),this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const s=t(this,N),M=I(this,N,T(this,Mt,Qr).call(this).trimEnd());if(s===M)return;const st=ht=>{if(I(this,N,ht),!ht){this.remove();return}T(this,Pt,en).call(this),this._uiManager.rebuild(this),T(this,Et,Zi).call(this)};this.addCommands({cmd:()=>{st(M)},undo:()=>{st(s)},mustExec:!1}),T(this,Et,Zi).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(s){this.enterInEditMode()}keydown(s){s.target===this.div&&s.key==="Enter"&&(this.enterInEditMode(),s.preventDefault())}editorDivKeydown(s){Vt._keyboardManager.exec(this,s)}editorDivFocus(s){this.isEditing=!0}editorDivBlur(s){this.isEditing=!1}editorDivInput(s){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let s,M;this.width&&(s=this.x,M=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,q)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text"),this.enableEditing(),w.AnnotationEditor._l10nPromise.get("pdfjs-free-text-default-content").then(ht=>{var mt;return(mt=this.editorDiv)==null?void 0:mt.setAttribute("default-content",ht)}),this.editorDiv.contentEditable=!0;const{style:st}=this.editorDiv;if(st.fontSize=`calc(${t(this,tt)}px * var(--scale-factor))`,st.color=t(this,$),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,m.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[ht,mt]=this.parentDimensions;if(this.annotationElementId){const{position:It}=t(this,bt);let[Gt,kt]=this.getInitialTranslation();[Gt,kt]=this.pageTranslationToScreen(Gt,kt);const[Xt,Wt]=this.pageDimensions,[Ae,ye]=this.pageTranslation;let Se,ke;switch(this.rotation){case 0:Se=s+(It[0]-Ae)/Xt,ke=M+this.height-(It[1]-ye)/Wt;break;case 90:Se=s+(It[0]-Ae)/Xt,ke=M-(It[1]-ye)/Wt,[Gt,kt]=[kt,-Gt];break;case 180:Se=s-this.width+(It[0]-Ae)/Xt,ke=M-(It[1]-ye)/Wt,[Gt,kt]=[-Gt,-kt];break;case 270:Se=s+(It[0]-Ae-this.height*Wt)/Xt,ke=M+(It[1]-ye-this.width*Xt)/Wt,[Gt,kt]=[-kt,Gt];break}this.setAt(Se*ht,ke*mt,Gt,kt)}else this.setAt(s*ht,M*mt,this.width*ht,this.height*mt);T(this,Pt,en).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(s){var Se,ke,$e;const M=s.clipboardData||window.clipboardData,{types:st}=M;if(st.length===1&&st[0]==="text/plain")return;s.preventDefault();const ht=T(Se=Vt,xe,Hn).call(Se,M.getData("text")||"").replaceAll(W,`
`);if(!ht)return;const mt=window.getSelection();if(!mt.rangeCount)return;this.editorDiv.normalize(),mt.deleteFromDocument();const It=mt.getRangeAt(0);if(!ht.includes(`
`)){It.insertNode(document.createTextNode(ht)),this.editorDiv.normalize(),mt.collapseToStart();return}const{startContainer:Gt,startOffset:kt}=It,Xt=[],Wt=[];if(Gt.nodeType===Node.TEXT_NODE){const De=Gt.parentElement;if(Wt.push(Gt.nodeValue.slice(kt).replaceAll(W,"")),De!==this.editorDiv){let Ue=Xt;for(const Be of this.editorDiv.childNodes){if(Be===De){Ue=Wt;continue}Ue.push(T(ke=Vt,gt,tn).call(ke,Be))}}Xt.push(Gt.nodeValue.slice(0,kt).replaceAll(W,""))}else if(Gt===this.editorDiv){let De=Xt,Ue=0;for(const Be of this.editorDiv.childNodes)Ue++===kt&&(De=Wt),De.push(T($e=Vt,gt,tn).call($e,Be))}I(this,N,`${Xt.join(`
`)}${ht}${Wt.join(`
`)}`),T(this,Pt,en).call(this);const Ae=new Range;let ye=Xt.reduce((De,Ue)=>De+Ue.length,0);for(const{firstChild:De}of this.editorDiv.childNodes)if(De.nodeType===Node.TEXT_NODE){const Ue=De.nodeValue.length;if(ye<=Ue){Ae.setStart(De,ye),Ae.setEnd(De,ye);break}ye-=Ue}mt.removeAllRanges(),mt.addRange(Ae)}get contentDiv(){return this.editorDiv}static deserialize(s,M,st){var It;let ht=null;if(s instanceof x.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:Gt,fontColor:kt},rect:Xt,rotation:Wt,id:Ae},textContent:ye,textPosition:Se,parent:{page:{pageNumber:ke}}}=s;if(!ye||ye.length===0)return null;ht=s={annotationType:e.AnnotationEditorType.FREETEXT,color:Array.from(kt),fontSize:Gt,value:ye.join(`
`),position:Se,pageIndex:ke-1,rect:Xt,rotation:Wt,id:Ae,deleted:!1}}const mt=super.deserialize(s,M,st);return I(mt,tt,s.fontSize),I(mt,$,e.Util.makeHexColor(...s.color)),I(mt,N,T(It=Vt,xe,Hn).call(It,s.value)),mt.annotationElementId=s.id||null,I(mt,bt,ht),mt}serialize(s=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const M=Vt._internalPadding*this.parentScale,st=this.getRect(M,M),ht=w.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,$)),mt={annotationType:e.AnnotationEditorType.FREETEXT,color:ht,fontSize:t(this,tt),value:T(this,Kt,Zr).call(this),pageIndex:this.pageIndex,rect:st,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return s?mt:this.annotationElementId&&!T(this,le,ta).call(this,mt)?null:(mt.id=this.annotationElementId,mt)}};Y=new WeakMap,at=new WeakMap,Q=new WeakMap,L=new WeakMap,V=new WeakMap,$=new WeakMap,N=new WeakMap,q=new WeakMap,tt=new WeakMap,bt=new WeakMap,Ft=new WeakSet,Yr=function(s){const M=ht=>{this.editorDiv.style.fontSize=`calc(${ht}px * var(--scale-factor))`,this.translate(0,-(ht-t(this,tt))*this.parentScale),I(this,tt,ht),T(this,Et,Zi).call(this)},st=t(this,tt);this.addCommands({cmd:M.bind(this,s),undo:M.bind(this,st),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Ot=new WeakSet,Jr=function(s){const M=ht=>{I(this,$,this.editorDiv.style.color=ht)},st=t(this,$);this.addCommands({cmd:M.bind(this,s),undo:M.bind(this,st),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Mt=new WeakSet,Qr=function(){var M;const s=[];this.editorDiv.normalize();for(const st of this.editorDiv.childNodes)s.push(T(M=Vt,gt,tn).call(M,st));return s.join(`
`)},Et=new WeakSet,Zi=function(){const[s,M]=this.parentDimensions;let st;if(this.isAttachedToDOM)st=this.div.getBoundingClientRect();else{const{currentLayer:ht,div:mt}=this,It=mt.style.display;mt.style.display="hidden",ht.div.append(this.div),st=mt.getBoundingClientRect(),mt.remove(),mt.style.display=It}this.rotation%180===this.parentRotation%180?(this.width=st.width/s,this.height=st.height/M):(this.width=st.height/s,this.height=st.width/M),this.fixAndSetPosition()},gt=new WeakSet,tn=function(s){return(s.nodeType===Node.TEXT_NODE?s.nodeValue:s.innerText).replaceAll(W,"")},Pt=new WeakSet,en=function(){if(this.editorDiv.replaceChildren(),!!t(this,N))for(const s of t(this,N).split(`
`)){const M=document.createElement("div");M.append(s?document.createTextNode(s):document.createElement("br")),this.editorDiv.append(M)}},Kt=new WeakSet,Zr=function(){return t(this,N).replaceAll("\xA0"," ")},xe=new WeakSet,Hn=function(s){return s.replaceAll(" ","\xA0")},le=new WeakSet,ta=function(s){const{value:M,fontSize:st,color:ht,pageIndex:mt}=t(this,bt);return this._hasBeenMoved||s.value!==M||s.fontSize!==st||s.color.some((It,Gt)=>It!==ht[Gt])||s.pageIndex!==mt},l(Vt,gt),l(Vt,xe),me(Vt,"_freeTextDefaultContent",""),me(Vt,"_internalPadding",0),me(Vt,"_defaultColor",null),me(Vt,"_defaultFontSize",10),me(Vt,"_type","freetext"),me(Vt,"_editorType",e.AnnotationEditorType.FREETEXT);let k=Vt;var y=c(61),f=c(259),O=c(419);const it=class it extends w.AnnotationEditor{constructor(s){super({...s,name:"highlightEditor"});l(this,G);l(this,ot);l(this,At);l(this,St);l(this,K);l(this,B);l(this,z);l(this,Tt);l(this,te);l(this,he);l(this,_e);l(this,fe);l(this,ae,null);l(this,Ce,0);l(this,ee,void 0);l(this,Ee,null);l(this,ne,null);l(this,et,null);l(this,i,null);l(this,n,0);l(this,d,null);l(this,g,null);l(this,o,null);l(this,A,!1);l(this,v,T(this,Tt,na).bind(this));l(this,E,null);l(this,u,void 0);l(this,a,null);l(this,h,"");l(this,R,void 0);l(this,j,"");this.color=s.color||it._defaultColor,I(this,R,s.thickness||it._defaultThickness),I(this,u,s.opacity||it._defaultOpacity),I(this,ee,s.boxes||null),I(this,j,s.methodOfCreation||""),I(this,h,s.text||""),this._isDraggable=!1,s.highlightId>-1?(I(this,A,!0),T(this,ot,Un).call(this,s),T(this,z,Ei).call(this)):(I(this,ae,s.anchorNode),I(this,Ce,s.anchorOffset),I(this,i,s.focusNode),I(this,n,s.focusOffset),T(this,G,Bn).call(this),T(this,z,Ei).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const s=it.prototype;return(0,e.shadow)(this,"_keyboardManager",new m.KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],s._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],s._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],s._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],s._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:t(this,A)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:t(this,R),methodOfCreation:t(this,j)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(s){return{numberOfColors:s.get("color").size}}static initialize(s,M){var st;w.AnnotationEditor.initialize(s,M),it._defaultColor||(it._defaultColor=((st=M.highlightColors)==null?void 0:st.values().next().value)||"#fff066")}static updateDefaultParams(s,M){switch(s){case e.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:it._defaultColor=M;break;case e.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:it._defaultThickness=M;break}}translateInPage(s,M){}get toolbarPosition(){return t(this,E)}updateParams(s,M){switch(s){case e.AnnotationEditorParamsType.HIGHLIGHT_COLOR:T(this,At,ea).call(this,M);break;case e.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:T(this,St,sa).call(this,M);break}}static get defaultPropertiesToUpdate(){return[[e.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR,it._defaultColor],[e.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS,it._defaultThickness]]}get propertiesToUpdate(){return[[e.AnnotationEditorParamsType.HIGHLIGHT_COLOR,this.color||it._defaultColor],[e.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS,t(this,R)||it._defaultThickness],[e.AnnotationEditorParamsType.HIGHLIGHT_FREE,t(this,A)]]}async addEditToolbar(){const s=await super.addEditToolbar();return s?(this._uiManager.highlightColors&&(I(this,ne,new f.ColorPicker({editor:this})),s.addColorPicker(t(this,ne))),s):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(T(this,he,Si).call(this))}getBaseTranslation(){return[0,0]}getRect(s,M){return super.getRect(s,M,T(this,he,Si).call(this))}onceAdded(){this.parent.addUndoableEditor(this),this.div.focus()}remove(){T(this,B,$n).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(T(this,z,Ei).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(s){var st;let M=!1;this.parent&&!s?T(this,B,$n).call(this):s&&(T(this,z,Ei).call(this,s),M=!this.parent&&((st=this.div)==null?void 0:st.classList.contains("selectedEditor"))),super.setParent(s),this.show(this._isVisible),M&&this.select()}rotate(s){var ht,mt,It;const{drawLayer:M}=this.parent;let st;t(this,A)?(s=(s-this.rotation+360)%360,st=T(ht=it,lt,ei).call(ht,t(this,g).box,s)):st=T(mt=it,lt,ei).call(mt,this,s),M.rotate(t(this,o),s),M.rotate(t(this,a),s),M.updateBox(t(this,o),st),M.updateBox(t(this,a),T(It=it,lt,ei).call(It,t(this,et).box,s))}render(){if(this.div)return this.div;const s=super.render();t(this,h)&&(s.setAttribute("aria-label",t(this,h)),s.setAttribute("role","mark")),t(this,A)?s.classList.add("free"):this.div.addEventListener("keydown",t(this,v));const M=I(this,d,document.createElement("div"));s.append(M),M.setAttribute("aria-hidden","true"),M.className="internal",M.style.clipPath=t(this,Ee);const[st,ht]=this.parentDimensions;return this.setDims(this.width*st,this.height*ht),(0,m.bindEvents)(this,t(this,d),["pointerover","pointerleave"]),this.enableEditing(),s}pointerover(){this.parent.drawLayer.addClass(t(this,a),"hovered")}pointerleave(){this.parent.drawLayer.removeClass(t(this,a),"hovered")}_moveCaret(s){switch(this.parent.unselect(this),s){case 0:case 2:T(this,te,sn).call(this,!0);break;case 1:case 3:T(this,te,sn).call(this,!1);break}}select(){var s,M;super.select(),t(this,a)&&((s=this.parent)==null||s.drawLayer.removeClass(t(this,a),"hovered"),(M=this.parent)==null||M.drawLayer.addClass(t(this,a),"selected"))}unselect(){var s;super.unselect(),t(this,a)&&((s=this.parent)==null||s.drawLayer.removeClass(t(this,a),"selected"),t(this,A)||T(this,te,sn).call(this,!1))}get _mustFixPosition(){return!t(this,A)}show(s=this._isVisible){super.show(s),this.parent&&(this.parent.drawLayer.show(t(this,o),s),this.parent.drawLayer.show(t(this,a),s))}static startHighlighting(s,M,{target:st,x:ht,y:mt}){const{x:It,y:Gt,width:kt,height:Xt}=st.getBoundingClientRect(),Wt=ke=>{T(this,se,oa).call(this,s,ke)},Ae={capture:!0,passive:!1},ye=ke=>{ke.preventDefault(),ke.stopPropagation()},Se=ke=>{st.removeEventListener("pointermove",Wt),window.removeEventListener("blur",Se),window.removeEventListener("pointerup",Se),window.removeEventListener("pointerdown",ye,Ae),window.removeEventListener("contextmenu",O.noContextMenu),T(this,S,ha).call(this,s,ke)};window.addEventListener("blur",Se),window.addEventListener("pointerup",Se),window.addEventListener("pointerdown",ye,Ae),window.addEventListener("contextmenu",O.noContextMenu),st.addEventListener("pointermove",Wt),this._freeHighlight=new y.FreeOutliner({x:ht,y:mt},[It,Gt,kt,Xt],s.scale,this._defaultThickness/2,M,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=s.drawLayer.highlight(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static deserialize(s,M,st){var ke;const ht=super.deserialize(s,M,st),{rect:[mt,It,Gt,kt],color:Xt,quadPoints:Wt}=s;ht.color=e.Util.makeHexColor(...Xt),I(ht,u,s.opacity);const[Ae,ye]=ht.pageDimensions;ht.width=(Gt-mt)/Ae,ht.height=(kt-It)/ye;const Se=I(ht,ee,[]);for(let $e=0;$e<Wt.length;$e+=8)Se.push({x:(Wt[4]-Gt)/Ae,y:(kt-(1-Wt[$e+5]))/ye,width:(Wt[$e+2]-Wt[$e])/Ae,height:(Wt[$e+5]-Wt[$e+1])/ye});return T(ke=ht,G,Bn).call(ke),ht}serialize(s=!1){if(this.isEmpty()||s)return null;const M=this.getRect(0,0),st=w.AnnotationEditor._colorManager.convert(this.color);return{annotationType:e.AnnotationEditorType.HIGHLIGHT,color:st,opacity:t(this,u),thickness:t(this,R),quadPoints:T(this,_e,ra).call(this),outlines:T(this,fe,aa).call(this,M),pageIndex:this.pageIndex,rect:M,rotation:T(this,he,Si).call(this),structTreeParentId:this._structTreeParentId}}static canCreateNewEmptyEditor(){return!1}};ae=new WeakMap,Ce=new WeakMap,ee=new WeakMap,Ee=new WeakMap,ne=new WeakMap,et=new WeakMap,i=new WeakMap,n=new WeakMap,d=new WeakMap,g=new WeakMap,o=new WeakMap,A=new WeakMap,v=new WeakMap,E=new WeakMap,u=new WeakMap,a=new WeakMap,h=new WeakMap,R=new WeakMap,j=new WeakMap,G=new WeakSet,Bn=function(){const s=new y.Outliner(t(this,ee),.001);I(this,g,s.getOutlines()),{x:this.x,y:this.y,width:this.width,height:this.height}=t(this,g).box;const M=new y.Outliner(t(this,ee),.0025,.001,this._uiManager.direction==="ltr");I(this,et,M.getOutlines());const{lastPoint:st}=t(this,et).box;I(this,E,[(st[0]-this.x)/this.width,(st[1]-this.y)/this.height])},ot=new WeakSet,Un=function({highlightOutlines:s,highlightId:M,clipPathId:st}){var Wt,Ae;if(I(this,g,s),I(this,et,s.getNewOutline(t(this,R)/2+1.5,.0025)),M>=0)I(this,o,M),I(this,Ee,st),this.parent.drawLayer.finalizeLine(M,s),I(this,a,this.parent.drawLayer.highlightOutline(t(this,et)));else if(this.parent){const ye=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(t(this,o),s),this.parent.drawLayer.updateBox(t(this,o),T(Wt=it,lt,ei).call(Wt,t(this,g).box,(ye-this.rotation+360)%360)),this.parent.drawLayer.updateLine(t(this,a),t(this,et)),this.parent.drawLayer.updateBox(t(this,a),T(Ae=it,lt,ei).call(Ae,t(this,et).box,ye))}const{x:mt,y:It,width:Gt,height:kt}=s.box;switch(this.rotation){case 0:this.x=mt,this.y=It,this.width=Gt,this.height=kt;break;case 90:{const[ye,Se]=this.parentDimensions;this.x=It,this.y=1-mt,this.width=Gt*Se/ye,this.height=kt*ye/Se;break}case 180:this.x=1-mt,this.y=1-It,this.width=Gt,this.height=kt;break;case 270:{const[ye,Se]=this.parentDimensions;this.x=1-It,this.y=mt,this.width=Gt*Se/ye,this.height=kt*ye/Se;break}}const{lastPoint:Xt}=t(this,et).box;I(this,E,[(Xt[0]-mt)/Gt,(Xt[1]-It)/kt])},At=new WeakSet,ea=function(s){const M=ht=>{var mt,It;this.color=ht,(mt=this.parent)==null||mt.drawLayer.changeColor(t(this,o),ht),(It=t(this,ne))==null||It.updateColor(ht)},st=this.color;this.addCommands({cmd:M.bind(this,s),undo:M.bind(this,st),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e.AnnotationEditorParamsType.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(s)},!0)},St=new WeakSet,sa=function(s){const M=t(this,R),st=ht=>{I(this,R,ht),T(this,K,ia).call(this,ht)};this.addCommands({cmd:st.bind(this,s),undo:st.bind(this,M),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:s},!0)},K=new WeakSet,ia=function(s){if(!t(this,A))return;T(this,ot,Un).call(this,{highlightOutlines:t(this,g).getNewOutline(s/2)}),this.fixAndSetPosition();const[M,st]=this.parentDimensions;this.setDims(this.width*M,this.height*st)},B=new WeakSet,$n=function(){t(this,o)===null||!this.parent||(this.parent.drawLayer.remove(t(this,o)),I(this,o,null),this.parent.drawLayer.remove(t(this,a)),I(this,a,null))},z=new WeakSet,Ei=function(s=this.parent){t(this,o)===null&&({id:bs(this,o)._,clipPathId:bs(this,Ee)._}=s.drawLayer.highlight(t(this,g),this.color,t(this,u)),I(this,a,s.drawLayer.highlightOutline(t(this,et))),t(this,d)&&(t(this,d).style.clipPath=t(this,Ee)))},lt=new WeakSet,ei=function({x:s,y:M,width:st,height:ht},mt){switch(mt){case 90:return{x:1-M-ht,y:s,width:ht,height:st};case 180:return{x:1-s-st,y:1-M-ht,width:st,height:ht};case 270:return{x:M,y:1-s-st,width:ht,height:st}}return{x:s,y:M,width:st,height:ht}},Tt=new WeakSet,na=function(s){it._keyboardManager.exec(this,s)},te=new WeakSet,sn=function(s){if(!t(this,ae))return;const M=window.getSelection();s?M.setPosition(t(this,ae),t(this,Ce)):M.setPosition(t(this,i),t(this,n))},he=new WeakSet,Si=function(){return t(this,A)?this.rotation:0},_e=new WeakSet,ra=function(){if(t(this,A))return null;const[s,M]=this.pageDimensions,st=t(this,ee),ht=new Array(st.length*8);let mt=0;for(const{x:It,y:Gt,width:kt,height:Xt}of st){const Wt=It*s,Ae=(1-Gt-Xt)*M;ht[mt]=ht[mt+4]=Wt,ht[mt+1]=ht[mt+3]=Ae,ht[mt+2]=ht[mt+6]=Wt+kt*s,ht[mt+5]=ht[mt+7]=Ae+Xt*M,mt+=8}return ht},fe=new WeakSet,aa=function(s){return t(this,g).serialize(s,T(this,he,Si).call(this))},se=new WeakSet,oa=function(s,M){this._freeHighlight.add(M)&&s.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)},S=new WeakSet,ha=function(s,M){this._freeHighlight.isEmpty()?s.drawLayer.removeFreeHighlight(this._freeHighlightId):s.createAndAddNewEditor(M,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},l(it,lt),l(it,se),l(it,S),me(it,"_defaultColor",null),me(it,"_defaultOpacity",1),me(it,"_defaultThickness",12),me(it,"_l10nPromise"),me(it,"_type","highlight"),me(it,"_editorType",e.AnnotationEditorType.HIGHLIGHT),me(it,"_freeHighlightId",-1),me(it,"_freeHighlight",null),me(it,"_freeHighlightClipId","");let C=it;const Ne=class Ne extends w.AnnotationEditor{constructor(s){super({...s,name:"inkEditor"});l(this,ts);l(this,Xe);l(this,Ve);l(this,dt);l(this,Ut);l(this,Zt);l(this,ve);l(this,He);l(this,qe);l(this,ks);l(this,Di);l(this,Ni);l(this,us);l(this,ai);l(this,Us);l(this,$s);l(this,As);l(this,oi);l(this,Vs);l(this,Bi);l(this,li);l(this,js);l(this,Ls);l(this,ct,0);l(this,wt,0);l(this,vt,this.canvasPointermove.bind(this));l(this,zt,this.canvasPointerleave.bind(this));l(this,jt,this.canvasPointerup.bind(this));l(this,Nt,this.canvasPointerdown.bind(this));l(this,Yt,null);l(this,$t,new Path2D);l(this,xt,!1);l(this,Bt,!1);l(this,Qt,!1);l(this,ue,null);l(this,ce,0);l(this,we,0);l(this,Me,null);this.color=s.color||null,this.thickness=s.thickness||null,this.opacity=s.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(s,M){w.AnnotationEditor.initialize(s,M)}static updateDefaultParams(s,M){switch(s){case e.AnnotationEditorParamsType.INK_THICKNESS:Ne._defaultThickness=M;break;case e.AnnotationEditorParamsType.INK_COLOR:Ne._defaultColor=M;break;case e.AnnotationEditorParamsType.INK_OPACITY:Ne._defaultOpacity=M/100;break}}updateParams(s,M){switch(s){case e.AnnotationEditorParamsType.INK_THICKNESS:T(this,ts,la).call(this,M);break;case e.AnnotationEditorParamsType.INK_COLOR:T(this,Xe,ca).call(this,M);break;case e.AnnotationEditorParamsType.INK_OPACITY:T(this,Ve,da).call(this,M);break}}static get defaultPropertiesToUpdate(){return[[e.AnnotationEditorParamsType.INK_THICKNESS,Ne._defaultThickness],[e.AnnotationEditorParamsType.INK_COLOR,Ne._defaultColor||w.AnnotationEditor._defaultLineColor],[e.AnnotationEditorParamsType.INK_OPACITY,Math.round(Ne._defaultOpacity*100)]]}get propertiesToUpdate(){return[[e.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Ne._defaultThickness],[e.AnnotationEditorParamsType.INK_COLOR,this.color||Ne._defaultColor||w.AnnotationEditor._defaultLineColor],[e.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Ne._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(T(this,Us,nn).call(this),T(this,$s,rn).call(this)),this.isAttachedToDOM||(this.parent.add(this),T(this,As,si).call(this)),T(this,Ls,xi).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,Yt)&&(clearTimeout(t(this,Yt)),I(this,Yt,null)),t(this,ue).disconnect(),I(this,ue,null),super.remove())}setParent(s){!this.parent&&s?this._uiManager.removeShouldRescale(this):this.parent&&s===null&&this._uiManager.addShouldRescale(this),super.setParent(s)}onScaleChanging(){const[s,M]=this.parentDimensions,st=this.width*s,ht=this.height*M;this.setDimensions(st,ht)}enableEditMode(){t(this,xt)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,Nt)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,Nt)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,xt)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),I(this,xt,!0),this.div.classList.add("disabled"),T(this,Ls,xi).call(this,!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(s){this._focusEventsAllowed&&(super.focusin(s),this.enableEditMode())}canvasPointerdown(s){s.button!==0||!this.isInEditMode()||t(this,xt)||(this.setInForeground(),s.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),T(this,Zt,pa).call(this,s.offsetX,s.offsetY))}canvasPointermove(s){s.preventDefault(),T(this,ve,jn).call(this,s.offsetX,s.offsetY)}canvasPointerup(s){s.preventDefault(),T(this,ai,Gn).call(this,s)}canvasPointerleave(s){T(this,ai,Gn).call(this,s)}get isResizable(){return!this.isEmpty()&&t(this,xt)}render(){if(this.div)return this.div;let s,M;this.width&&(s=this.x,M=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[st,ht,mt,It]=T(this,dt,ua).call(this);if(this.setAt(st,ht,0,0),this.setDims(mt,It),T(this,Us,nn).call(this),this.width){const[Gt,kt]=this.parentDimensions;this.setAspectRatio(this.width*Gt,this.height*kt),this.setAt(s*Gt,M*kt,this.width*Gt,this.height*kt),I(this,Qt,!0),T(this,As,si).call(this),this.setDims(this.width*Gt,this.height*kt),T(this,us,Os).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return T(this,$s,rn).call(this),this.div}setDimensions(s,M){const st=Math.round(s),ht=Math.round(M);if(t(this,ce)===st&&t(this,we)===ht)return;I(this,ce,st),I(this,we,ht),this.canvas.style.visibility="hidden";const[mt,It]=this.parentDimensions;this.width=s/mt,this.height=M/It,this.fixAndSetPosition(),t(this,xt)&&T(this,oi,qn).call(this,s,M),T(this,As,si).call(this),T(this,us,Os).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(s,M,st){var $e,De,Ue;if(s instanceof x.InkAnnotationElement)return null;const ht=super.deserialize(s,M,st);ht.thickness=s.thickness,ht.color=e.Util.makeHexColor(...s.color),ht.opacity=s.opacity;const[mt,It]=ht.pageDimensions,Gt=ht.width*mt,kt=ht.height*It,Xt=ht.parentScale,Wt=s.thickness/2;I(ht,xt,!0),I(ht,ce,Math.round(Gt)),I(ht,we,Math.round(kt));const{paths:Ae,rect:ye,rotation:Se}=s;for(let{bezier:Be}of Ae){Be=T($e=Ne,Hi,ya).call($e,Be,ye,Se);const ds=[];ht.paths.push(ds);let bi=Xt*(Be[0]-Wt),vi=Xt*(Be[1]-Wt);for(let os=2,xn=Be.length;os<xn;os+=6){const Cn=Xt*(Be[os]-Wt),qi=Xt*(Be[os+1]-Wt),zi=Xt*(Be[os+2]-Wt),Wi=Xt*(Be[os+3]-Wt),Ai=Xt*(Be[os+4]-Wt),jr=Xt*(Be[os+5]-Wt);ds.push([[bi,vi],[Cn,qi],[zi,Wi],[Ai,jr]]),bi=Ai,vi=jr}const Gi=T(this,Oi,Aa).call(this,ds);ht.bezierPath2D.push(Gi)}const ke=T(De=ht,li,Wn).call(De);return I(ht,wt,Math.max(w.AnnotationEditor.MIN_SIZE,ke[2]-ke[0])),I(ht,ct,Math.max(w.AnnotationEditor.MIN_SIZE,ke[3]-ke[1])),T(Ue=ht,oi,qn).call(Ue,Gt,kt),ht}serialize(){if(this.isEmpty())return null;const s=this.getRect(0,0),M=w.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:e.AnnotationEditorType.INK,color:M,thickness:this.thickness,opacity:this.opacity,paths:T(this,Bi,_a).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,s),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};ct=new WeakMap,wt=new WeakMap,vt=new WeakMap,zt=new WeakMap,jt=new WeakMap,Nt=new WeakMap,Yt=new WeakMap,$t=new WeakMap,xt=new WeakMap,Bt=new WeakMap,Qt=new WeakMap,ue=new WeakMap,ce=new WeakMap,we=new WeakMap,Me=new WeakMap,ts=new WeakSet,la=function(s){const M=ht=>{this.thickness=ht,T(this,Ls,xi).call(this)},st=this.thickness;this.addCommands({cmd:M.bind(this,s),undo:M.bind(this,st),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Xe=new WeakSet,ca=function(s){const M=ht=>{this.color=ht,T(this,us,Os).call(this)},st=this.color;this.addCommands({cmd:M.bind(this,s),undo:M.bind(this,st),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Ve=new WeakSet,da=function(s){const M=ht=>{this.opacity=ht,T(this,us,Os).call(this)};s/=100;const st=this.opacity;this.addCommands({cmd:M.bind(this,s),undo:M.bind(this,st),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},dt=new WeakSet,ua=function(){const{parentRotation:s,parentDimensions:[M,st]}=this;switch(s){case 90:return[0,st,st,M];case 180:return[M,st,M,st];case 270:return[M,0,st,M];default:return[0,0,M,st]}},Ut=new WeakSet,Vn=function(){const{ctx:s,color:M,opacity:st,thickness:ht,parentScale:mt,scaleFactor:It}=this;s.lineWidth=ht*mt/It,s.lineCap="round",s.lineJoin="round",s.miterLimit=10,s.strokeStyle=`${M}${(0,m.opacityToHex)(st)}`},Zt=new WeakSet,pa=function(s,M){this.canvas.addEventListener("contextmenu",O.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,zt)),this.canvas.addEventListener("pointermove",t(this,vt)),this.canvas.addEventListener("pointerup",t(this,jt)),this.canvas.removeEventListener("pointerdown",t(this,Nt)),this.isEditing=!0,t(this,Qt)||(I(this,Qt,!0),T(this,As,si).call(this),this.thickness||(this.thickness=Ne._defaultThickness),this.color||(this.color=Ne._defaultColor||w.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Ne._defaultOpacity)),this.currentPath.push([s,M]),I(this,Bt,!1),T(this,Ut,Vn).call(this),I(this,Me,()=>{T(this,ks,ma).call(this),t(this,Me)&&window.requestAnimationFrame(t(this,Me))}),window.requestAnimationFrame(t(this,Me))},ve=new WeakSet,jn=function(s,M){const[st,ht]=this.currentPath.at(-1);if(this.currentPath.length>1&&s===st&&M===ht)return;const mt=this.currentPath;let It=t(this,$t);if(mt.push([s,M]),I(this,Bt,!0),mt.length<=2){It.moveTo(...mt[0]),It.lineTo(s,M);return}mt.length===3&&(I(this,$t,It=new Path2D),It.moveTo(...mt[0])),T(this,Di,ba).call(this,It,...mt.at(-3),...mt.at(-2),s,M)},He=new WeakSet,ga=function(){if(this.currentPath.length===0)return;const s=this.currentPath.at(-1);t(this,$t).lineTo(...s)},qe=new WeakSet,fa=function(s,M){I(this,Me,null),s=Math.min(Math.max(s,0),this.canvas.width),M=Math.min(Math.max(M,0),this.canvas.height),T(this,ve,jn).call(this,s,M),T(this,He,ga).call(this);let st;if(this.currentPath.length!==1)st=T(this,Ni,va).call(this);else{const kt=[s,M];st=[[kt,kt.slice(),kt.slice(),kt]]}const ht=t(this,$t),mt=this.currentPath;this.currentPath=[],I(this,$t,new Path2D);const It=()=>{this.allRawPaths.push(mt),this.paths.push(st),this.bezierPath2D.push(ht),this._uiManager.rebuild(this)},Gt=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(T(this,Us,nn).call(this),T(this,$s,rn).call(this)),T(this,Ls,xi).call(this))};this.addCommands({cmd:It,undo:Gt,mustExec:!0})},ks=new WeakSet,ma=function(){if(!t(this,Bt))return;I(this,Bt,!1);const s=Math.ceil(this.thickness*this.parentScale),M=this.currentPath.slice(-3),st=M.map(It=>It[0]),ht=M.map(It=>It[1]);Math.min(...st)-s,Math.max(...st)+s,Math.min(...ht)-s,Math.max(...ht)+s;const{ctx:mt}=this;mt.save(),mt.clearRect(0,0,this.canvas.width,this.canvas.height);for(const It of this.bezierPath2D)mt.stroke(It);mt.stroke(t(this,$t)),mt.restore()},Di=new WeakSet,ba=function(s,M,st,ht,mt,It,Gt){const kt=(M+ht)/2,Xt=(st+mt)/2,Wt=(ht+It)/2,Ae=(mt+Gt)/2;s.bezierCurveTo(kt+2*(ht-kt)/3,Xt+2*(mt-Xt)/3,Wt+2*(ht-Wt)/3,Ae+2*(mt-Ae)/3,Wt,Ae)},Ni=new WeakSet,va=function(){const s=this.currentPath;if(s.length<=2)return[[s[0],s[0],s.at(-1),s.at(-1)]];const M=[];let st,[ht,mt]=s[0];for(st=1;st<s.length-2;st++){const[ye,Se]=s[st],[ke,$e]=s[st+1],De=(ye+ke)/2,Ue=(Se+$e)/2,Be=[ht+2*(ye-ht)/3,mt+2*(Se-mt)/3],ds=[De+2*(ye-De)/3,Ue+2*(Se-Ue)/3];M.push([[ht,mt],Be,ds,[De,Ue]]),[ht,mt]=[De,Ue]}const[It,Gt]=s[st],[kt,Xt]=s[st+1],Wt=[ht+2*(It-ht)/3,mt+2*(Gt-mt)/3],Ae=[kt+2*(It-kt)/3,Xt+2*(Gt-Xt)/3];return M.push([[ht,mt],Wt,Ae,[kt,Xt]]),M},us=new WeakSet,Os=function(){if(this.isEmpty()){T(this,Vs,an).call(this);return}T(this,Ut,Vn).call(this);const{canvas:s,ctx:M}=this;M.setTransform(1,0,0,1,0,0),M.clearRect(0,0,s.width,s.height),T(this,Vs,an).call(this);for(const st of this.bezierPath2D)M.stroke(st)},ai=new WeakSet,Gn=function(s){this.canvas.removeEventListener("pointerleave",t(this,zt)),this.canvas.removeEventListener("pointermove",t(this,vt)),this.canvas.removeEventListener("pointerup",t(this,jt)),this.canvas.addEventListener("pointerdown",t(this,Nt)),t(this,Yt)&&clearTimeout(t(this,Yt)),I(this,Yt,setTimeout(()=>{I(this,Yt,null),this.canvas.removeEventListener("contextmenu",O.noContextMenu)},10)),T(this,qe,fa).call(this,s.offsetX,s.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Us=new WeakSet,nn=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},$s=new WeakSet,rn=function(){I(this,ue,new ResizeObserver(s=>{const M=s[0].contentRect;M.width&&M.height&&this.setDimensions(M.width,M.height)})),t(this,ue).observe(this.div)},As=new WeakSet,si=function(){if(!t(this,Qt))return;const[s,M]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*s),this.canvas.height=Math.ceil(this.height*M),T(this,Vs,an).call(this)},oi=new WeakSet,qn=function(s,M){const st=T(this,js,on).call(this),ht=(s-st)/t(this,wt),mt=(M-st)/t(this,ct);this.scaleFactor=Math.min(ht,mt)},Vs=new WeakSet,an=function(){const s=T(this,js,on).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+s,this.translationY*this.scaleFactor+s)},Oi=new WeakSet,Aa=function(s){const M=new Path2D;for(let st=0,ht=s.length;st<ht;st++){const[mt,It,Gt,kt]=s[st];st===0&&M.moveTo(...mt),M.bezierCurveTo(It[0],It[1],Gt[0],Gt[1],kt[0],kt[1])}return M},hi=new WeakSet,zn=function(s,M,st){const[ht,mt,It,Gt]=M;switch(st){case 0:for(let kt=0,Xt=s.length;kt<Xt;kt+=2)s[kt]+=ht,s[kt+1]=Gt-s[kt+1];break;case 90:for(let kt=0,Xt=s.length;kt<Xt;kt+=2){const Wt=s[kt];s[kt]=s[kt+1]+ht,s[kt+1]=Wt+mt}break;case 180:for(let kt=0,Xt=s.length;kt<Xt;kt+=2)s[kt]=It-s[kt],s[kt+1]+=mt;break;case 270:for(let kt=0,Xt=s.length;kt<Xt;kt+=2){const Wt=s[kt];s[kt]=It-s[kt+1],s[kt+1]=Gt-Wt}break;default:throw new Error("Invalid rotation")}return s},Hi=new WeakSet,ya=function(s,M,st){const[ht,mt,It,Gt]=M;switch(st){case 0:for(let kt=0,Xt=s.length;kt<Xt;kt+=2)s[kt]-=ht,s[kt+1]=Gt-s[kt+1];break;case 90:for(let kt=0,Xt=s.length;kt<Xt;kt+=2){const Wt=s[kt];s[kt]=s[kt+1]-mt,s[kt+1]=Wt-ht}break;case 180:for(let kt=0,Xt=s.length;kt<Xt;kt+=2)s[kt]=It-s[kt],s[kt+1]-=mt;break;case 270:for(let kt=0,Xt=s.length;kt<Xt;kt+=2){const Wt=s[kt];s[kt]=Gt-s[kt+1],s[kt+1]=It-Wt}break;default:throw new Error("Invalid rotation")}return s},Bi=new WeakSet,_a=function(s,M,st,ht){var Xt,Wt;const mt=[],It=this.thickness/2,Gt=s*M+It,kt=s*st+It;for(const Ae of this.paths){const ye=[],Se=[];for(let ke=0,$e=Ae.length;ke<$e;ke++){const[De,Ue,Be,ds]=Ae[ke];if(De[0]===ds[0]&&De[1]===ds[1]&&$e===1){const Wi=s*De[0]+Gt,Ai=s*De[1]+kt;ye.push(Wi,Ai),Se.push(Wi,Ai);break}const bi=s*De[0]+Gt,vi=s*De[1]+kt,Gi=s*Ue[0]+Gt,os=s*Ue[1]+kt,xn=s*Be[0]+Gt,Cn=s*Be[1]+kt,qi=s*ds[0]+Gt,zi=s*ds[1]+kt;ke===0&&(ye.push(bi,vi),Se.push(bi,vi)),ye.push(Gi,os,xn,Cn,qi,zi),Se.push(Gi,os),ke===$e-1&&Se.push(qi,zi)}mt.push({bezier:T(Xt=Ne,hi,zn).call(Xt,ye,ht,this.rotation),points:T(Wt=Ne,hi,zn).call(Wt,Se,ht,this.rotation)})}return mt},li=new WeakSet,Wn=function(){let s=1/0,M=-1/0,st=1/0,ht=-1/0;for(const mt of this.paths)for(const[It,Gt,kt,Xt]of mt){const Wt=e.Util.bezierBoundingBox(...It,...Gt,...kt,...Xt);s=Math.min(s,Wt[0]),st=Math.min(st,Wt[1]),M=Math.max(M,Wt[2]),ht=Math.max(ht,Wt[3])}return[s,st,M,ht]},js=new WeakSet,on=function(){return t(this,xt)?Math.ceil(this.thickness*this.parentScale):0},Ls=new WeakSet,xi=function(s=!1){if(this.isEmpty())return;if(!t(this,xt)){T(this,us,Os).call(this);return}const M=T(this,li,Wn).call(this),st=T(this,js,on).call(this);I(this,wt,Math.max(w.AnnotationEditor.MIN_SIZE,M[2]-M[0])),I(this,ct,Math.max(w.AnnotationEditor.MIN_SIZE,M[3]-M[1]));const ht=Math.ceil(st+t(this,wt)*this.scaleFactor),mt=Math.ceil(st+t(this,ct)*this.scaleFactor),[It,Gt]=this.parentDimensions;this.width=ht/It,this.height=mt/Gt,this.setAspectRatio(ht,mt);const kt=this.translationX,Xt=this.translationY;this.translationX=-M[0],this.translationY=-M[1],T(this,As,si).call(this),T(this,us,Os).call(this),I(this,ce,ht),I(this,we,mt),this.setDims(ht,mt);const Wt=s?st/this.scaleFactor/2:0;this.translate(kt-this.translationX-Wt,Xt-this.translationY-Wt)},l(Ne,Oi),l(Ne,hi),l(Ne,Hi),me(Ne,"_defaultColor",null),me(Ne,"_defaultOpacity",1),me(Ne,"_defaultThickness",1),me(Ne,"_type","ink"),me(Ne,"_editorType",e.AnnotationEditorType.INK);let _=Ne;const pi=class pi extends w.AnnotationEditor{constructor(s){super({...s,name:"stampEditor"});l(this,Ps);l(this,Is);l(this,qs);l(this,di);l(this,Ui);l(this,$i);l(this,ui);l(this,zs);l(this,Vi);l(this,je,null);l(this,Ge,null);l(this,ys,null);l(this,ps,null);l(this,_s,null);l(this,Gs,"");l(this,hs,null);l(this,Rs,null);l(this,ls,null);l(this,rs,!1);l(this,ci,!1);I(this,ps,s.bitmapUrl),I(this,_s,s.bitmapFile)}static initialize(s,M){w.AnnotationEditor.initialize(s,M)}static get supportedTypes(){const s=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,e.shadow)(this,"supportedTypes",s.map(M=>`image/${M}`))}static get supportedTypesStr(){return(0,e.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(s){return this.supportedTypes.includes(s)}static paste(s,M){M.pasteEditor(e.AnnotationEditorType.STAMP,{bitmapFile:s.getAsFile()})}remove(){var s,M;t(this,Ge)&&(I(this,je,null),this._uiManager.imageManager.deleteId(t(this,Ge)),(s=t(this,hs))==null||s.remove(),I(this,hs,null),(M=t(this,Rs))==null||M.disconnect(),I(this,Rs,null),t(this,ls)&&(clearTimeout(t(this,ls)),I(this,ls,null))),super.remove()}rebuild(){if(!this.parent){t(this,Ge)&&T(this,qs,hn).call(this);return}super.rebuild(),this.div!==null&&(t(this,Ge)&&t(this,hs)===null&&T(this,qs,hn).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,ys)||t(this,je)||t(this,ps)||t(this,_s)||t(this,Ge))}get isResizable(){return!0}render(){if(this.div)return this.div;let s,M;if(this.width&&(s=this.x,M=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),t(this,je)?T(this,di,Xn).call(this):T(this,qs,hn).call(this),this.width){const[st,ht]=this.parentDimensions;this.setAt(s*st,M*ht,this.width*st,this.height*ht)}return this.div}getImageForAltText(){return t(this,hs)}static deserialize(s,M,st){if(s instanceof x.StampAnnotationElement)return null;const ht=super.deserialize(s,M,st),{rect:mt,bitmapUrl:It,bitmapId:Gt,isSvg:kt,accessibilityData:Xt}=s;Gt&&st.imageManager.isValidId(Gt)?I(ht,Ge,Gt):I(ht,ps,It),I(ht,rs,kt);const[Wt,Ae]=ht.pageDimensions;return ht.width=(mt[2]-mt[0])/Wt,ht.height=(mt[3]-mt[1])/Ae,Xt&&(ht.altTextData=Xt),ht}serialize(s=!1,M=null){if(this.isEmpty())return null;const st={annotationType:e.AnnotationEditorType.STAMP,bitmapId:t(this,Ge),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,rs),structTreeParentId:this._structTreeParentId};if(s)return st.bitmapUrl=T(this,zs,ln).call(this,!0),st.accessibilityData=this.altTextData,st;const{decorative:ht,altText:mt}=this.altTextData;if(!ht&&mt&&(st.accessibilityData={type:"Figure",alt:mt}),M===null)return st;M.stamps||(M.stamps=new Map);const It=t(this,rs)?(st.rect[2]-st.rect[0])*(st.rect[3]-st.rect[1]):null;if(!M.stamps.has(t(this,Ge)))M.stamps.set(t(this,Ge),{area:It,serialized:st}),st.bitmap=T(this,zs,ln).call(this,!1);else if(t(this,rs)){const Gt=M.stamps.get(t(this,Ge));It>Gt.area&&(Gt.area=It,Gt.serialized.bitmap.close(),Gt.serialized.bitmap=T(this,zs,ln).call(this,!1))}return st}};je=new WeakMap,Ge=new WeakMap,ys=new WeakMap,ps=new WeakMap,_s=new WeakMap,Gs=new WeakMap,hs=new WeakMap,Rs=new WeakMap,ls=new WeakMap,rs=new WeakMap,ci=new WeakMap,Ps=new WeakSet,Ci=function(s,M=!1){if(!s){this.remove();return}I(this,je,s.bitmap),M||(I(this,Ge,s.id),I(this,rs,s.isSvg)),s.file&&I(this,Gs,s.file.name),T(this,di,Xn).call(this)},Is=new WeakSet,Ti=function(){I(this,ys,null),this._uiManager.enableWaiting(!1),t(this,hs)&&this.div.focus()},qs=new WeakSet,hn=function(){if(t(this,Ge)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,Ge)).then(M=>T(this,Ps,Ci).call(this,M,!0)).finally(()=>T(this,Is,Ti).call(this));return}if(t(this,ps)){const M=t(this,ps);I(this,ps,null),this._uiManager.enableWaiting(!0),I(this,ys,this._uiManager.imageManager.getFromUrl(M).then(st=>T(this,Ps,Ci).call(this,st)).finally(()=>T(this,Is,Ti).call(this)));return}if(t(this,_s)){const M=t(this,_s);I(this,_s,null),this._uiManager.enableWaiting(!0),I(this,ys,this._uiManager.imageManager.getFromFile(M).then(st=>T(this,Ps,Ci).call(this,st)).finally(()=>T(this,Is,Ti).call(this)));return}const s=document.createElement("input");s.type="file",s.accept=pi.supportedTypesStr,I(this,ys,new Promise(M=>{s.addEventListener("change",async()=>{if(!s.files||s.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const st=await this._uiManager.imageManager.getFromFile(s.files[0]);T(this,Ps,Ci).call(this,st)}M()}),s.addEventListener("cancel",()=>{this.remove(),M()})}).finally(()=>T(this,Is,Ti).call(this))),s.click()},di=new WeakSet,Xn=function(){const{div:s}=this;let{width:M,height:st}=t(this,je);const[ht,mt]=this.pageDimensions,It=.75;if(this.width)M=this.width*ht,st=this.height*mt;else if(M>It*ht||st>It*mt){const Wt=Math.min(It*ht/M,It*mt/st);M*=Wt,st*=Wt}const[Gt,kt]=this.parentDimensions;this.setDims(M*Gt/ht,st*kt/mt),this._uiManager.enableWaiting(!1);const Xt=I(this,hs,document.createElement("canvas"));s.append(Xt),s.hidden=!1,T(this,ui,Kn).call(this,M,st),T(this,Vi,Sa).call(this),t(this,ci)||(this.parent.addUndoableEditor(this),I(this,ci,!0)),this._reportTelemetry({action:"inserted_image"}),t(this,Gs)&&Xt.setAttribute("aria-label",t(this,Gs))},Ui=new WeakSet,wa=function(s,M){var It;const[st,ht]=this.parentDimensions;this.width=s/st,this.height=M/ht,this.setDims(s,M),(It=this._initialOptions)!=null&&It.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,ls)!==null&&clearTimeout(t(this,ls)),I(this,ls,setTimeout(()=>{I(this,ls,null),T(this,ui,Kn).call(this,s,M)},200))},$i=new WeakSet,Ea=function(s,M){const{width:st,height:ht}=t(this,je);let mt=st,It=ht,Gt=t(this,je);for(;mt>2*s||It>2*M;){const kt=mt,Xt=It;mt>2*s&&(mt=mt>=16384?Math.floor(mt/2)-1:Math.ceil(mt/2)),It>2*M&&(It=It>=16384?Math.floor(It/2)-1:Math.ceil(It/2));const Wt=new OffscreenCanvas(mt,It);Wt.getContext("2d").drawImage(Gt,0,0,kt,Xt,0,0,mt,It),Gt=Wt.transferToImageBitmap()}return Gt},ui=new WeakSet,Kn=function(s,M){s=Math.ceil(s),M=Math.ceil(M);const st=t(this,hs);if(!st||st.width===s&&st.height===M)return;st.width=s,st.height=M;const ht=t(this,rs)?t(this,je):T(this,$i,Ea).call(this,s,M);if(this._uiManager.hasMLManager&&!this.hasAltText()){const It=new OffscreenCanvas(s,M);It.getContext("2d").drawImage(ht,0,0,ht.width,ht.height,0,0,s,M),It.convertToBlob().then(Gt=>{const kt=new FileReader;kt.onload=()=>{const Xt=kt.result;this._uiManager.mlGuess({service:"image-to-text",request:{imageData:Xt}}).then(Wt=>{const Ae=(Wt==null?void 0:Wt.output)||"";this.parent&&Ae&&!this.hasAltText()&&(this.altTextData={altText:Ae,decorative:!1})})},kt.readAsDataURL(Gt)})}const mt=st.getContext("2d");mt.filter=this._uiManager.hcmFilter,mt.drawImage(ht,0,0,ht.width,ht.height,0,0,s,M)},zs=new WeakSet,ln=function(s){if(s){if(t(this,rs)){const st=this._uiManager.imageManager.getSvgUrl(t(this,Ge));if(st)return st}const M=document.createElement("canvas");return{width:M.width,height:M.height}=t(this,je),M.getContext("2d").drawImage(t(this,je),0,0),M.toDataURL()}if(t(this,rs)){const[M,st]=this.pageDimensions,ht=Math.round(this.width*M*O.PixelsPerInch.PDF_TO_CSS_UNITS),mt=Math.round(this.height*st*O.PixelsPerInch.PDF_TO_CSS_UNITS),It=new OffscreenCanvas(ht,mt);return It.getContext("2d").drawImage(t(this,je),0,0,t(this,je).width,t(this,je).height,0,0,ht,mt),It.transferToImageBitmap()}return structuredClone(t(this,je))},Vi=new WeakSet,Sa=function(){I(this,Rs,new ResizeObserver(s=>{const M=s[0].contentRect;M.width&&M.height&&T(this,Ui,wa).call(this,M.width,M.height)})),t(this,Rs).observe(this.div)},me(pi,"_type","stamp"),me(pi,"_editorType",e.AnnotationEditorType.STAMP);let D=pi;const as=class as{constructor({uiManager:pt,pageIndex:s,div:M,accessibilityManager:st,annotationLayer:ht,drawLayer:mt,textLayer:It,viewport:Gt,l10n:kt}){l(this,ji);l(this,gi);l(this,fi);l(this,mi);l(this,Ys);l(this,Fs,void 0);l(this,Ws,!1);l(this,cs,null);l(this,Ds,null);l(this,gs,null);l(this,fs,null);l(this,ms,null);l(this,es,new Map);l(this,ws,!1);l(this,Xs,!1);l(this,Ks,!1);l(this,Ye,null);l(this,pe,void 0);const Xt=[...t(as,Es).values()];if(!as._initialized){as._initialized=!0;for(const Wt of Xt)Wt.initialize(kt,pt)}pt.registerEditorTypes(Xt),I(this,pe,pt),this.pageIndex=s,this.div=M,I(this,Fs,st),I(this,cs,ht),this.viewport=Gt,I(this,Ye,It),this.drawLayer=mt,t(this,pe).addLayer(this)}get isEmpty(){return t(this,es).size===0}get isInvisible(){return this.isEmpty&&t(this,pe).getMode()===e.AnnotationEditorType.NONE}updateToolbar(pt){t(this,pe).updateToolbar(pt)}updateMode(pt=t(this,pe).getMode()){switch(T(this,Ys,cn).call(this),pt){case e.AnnotationEditorType.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case e.AnnotationEditorType.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case e.AnnotationEditorType.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:s}=this.div;for(const M of t(as,Es).values())s.toggle(`${M._type}Editing`,pt===M._editorType);this.div.hidden=!1}hasTextLayer(pt){var s;return pt===((s=t(this,Ye))==null?void 0:s.div)}addInkEditorIfNeeded(pt){if(t(this,pe).getMode()===e.AnnotationEditorType.INK){if(!pt){for(const s of t(this,es).values())if(s.isEmpty()){s.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}}setEditingState(pt){t(this,pe).setEditingState(pt)}addCommands(pt){t(this,pe).addCommands(pt)}togglePointerEvents(pt=!1){this.div.classList.toggle("disabled",!pt)}toggleAnnotationLayerPointerEvents(pt=!1){var s;(s=t(this,cs))==null||s.div.classList.toggle("disabled",!pt)}enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const pt=new Set;for(const M of t(this,es).values())M.enableEditing(),M.annotationElementId&&pt.add(M.annotationElementId);if(!t(this,cs))return;const s=t(this,cs).getEditableAnnotations();for(const M of s){if(M.hide(),t(this,pe).isDeletedAnnotationElement(M.data.id)||pt.has(M.data.id))continue;const st=this.deserialize(M);st&&(this.addOrRebuild(st),st.enableEditing())}}disable(){var M;I(this,Ks,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const pt=new Set;for(const st of t(this,es).values()){if(st.disableEditing(),!st.annotationElementId||st.serialize()!==null){pt.add(st.annotationElementId);continue}(M=this.getEditableAnnotation(st.annotationElementId))==null||M.show(),st.remove()}if(t(this,cs)){const st=t(this,cs).getEditableAnnotations();for(const ht of st){const{id:mt}=ht.data;pt.has(mt)||t(this,pe).isDeletedAnnotationElement(mt)||ht.show()}}T(this,Ys,cn).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const st of t(as,Es).values())s.remove(`${st._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),I(this,Ks,!1)}getEditableAnnotation(pt){var s;return((s=t(this,cs))==null?void 0:s.getEditableAnnotation(pt))||null}setActiveEditor(pt){t(this,pe).getActive()!==pt&&t(this,pe).setActiveEditor(pt)}enableTextSelection(){var pt;this.div.tabIndex=-1,(pt=t(this,Ye))!=null&&pt.div&&!t(this,fs)&&(I(this,fs,T(this,ji,xa).bind(this)),t(this,Ye).div.addEventListener("pointerdown",t(this,fs)),t(this,Ye).div.classList.add("highlighting"))}disableTextSelection(){var pt;this.div.tabIndex=0,(pt=t(this,Ye))!=null&&pt.div&&t(this,fs)&&(t(this,Ye).div.removeEventListener("pointerdown",t(this,fs)),I(this,fs,null),t(this,Ye).div.classList.remove("highlighting"))}enableClick(){t(this,gs)||(I(this,gs,this.pointerdown.bind(this)),I(this,Ds,this.pointerup.bind(this)),this.div.addEventListener("pointerdown",t(this,gs)),this.div.addEventListener("pointerup",t(this,Ds)))}disableClick(){t(this,gs)&&(this.div.removeEventListener("pointerdown",t(this,gs)),this.div.removeEventListener("pointerup",t(this,Ds)),I(this,gs,null),I(this,Ds,null))}attach(pt){t(this,es).set(pt.id,pt);const{annotationElementId:s}=pt;s&&t(this,pe).isDeletedAnnotationElement(s)&&t(this,pe).removeDeletedAnnotationElement(pt)}detach(pt){var s;t(this,es).delete(pt.id),(s=t(this,Fs))==null||s.removePointerInTextLayer(pt.contentDiv),!t(this,Ks)&&pt.annotationElementId&&t(this,pe).addDeletedAnnotationElement(pt)}remove(pt){this.detach(pt),t(this,pe).removeEditor(pt),pt.div.remove(),pt.isAttachedToDOM=!1,t(this,Xs)||this.addInkEditorIfNeeded(!1)}changeParent(pt){var s;pt.parent!==this&&(pt.annotationElementId&&(t(this,pe).addDeletedAnnotationElement(pt.annotationElementId),w.AnnotationEditor.deleteAnnotationElement(pt),pt.annotationElementId=null),this.attach(pt),(s=pt.parent)==null||s.detach(pt),pt.setParent(this),pt.div&&pt.isAttachedToDOM&&(pt.div.remove(),this.div.append(pt.div)))}add(pt){if(!(pt.parent===this&&pt.isAttachedToDOM)){if(this.changeParent(pt),t(this,pe).addEditor(pt),this.attach(pt),!pt.isAttachedToDOM){const s=pt.render();this.div.append(s),pt.isAttachedToDOM=!0}pt.fixAndSetPosition(),pt.onceAdded(),t(this,pe).addToAnnotationStorage(pt),pt._reportTelemetry(pt.telemetryInitialData)}}moveEditorInDOM(pt){var M;if(!pt.isAttachedToDOM)return;const{activeElement:s}=document;pt.div.contains(s)&&!t(this,ms)&&(pt._focusEventsAllowed=!1,I(this,ms,setTimeout(()=>{I(this,ms,null),pt.div.contains(document.activeElement)?pt._focusEventsAllowed=!0:(pt.div.addEventListener("focusin",()=>{pt._focusEventsAllowed=!0},{once:!0}),s.focus())},0))),pt._structTreeParentId=(M=t(this,Fs))==null?void 0:M.moveElementInDOM(this.div,pt.div,pt.contentDiv,!0)}addOrRebuild(pt){pt.needsToBeRebuilt()?(pt.parent||(pt.parent=this),pt.rebuild(),pt.show()):this.add(pt)}addUndoableEditor(pt){const s=()=>pt._uiManager.rebuild(pt),M=()=>{pt.remove()};this.addCommands({cmd:s,undo:M,mustExec:!1})}getNextId(){return t(this,pe).getId()}canCreateNewEmptyEditor(){var pt;return(pt=t(this,gi,Yn))==null?void 0:pt.canCreateNewEmptyEditor()}pasteEditor(pt,s){t(this,pe).updateToolbar(pt),t(this,pe).updateMode(pt);const{offsetX:M,offsetY:st}=T(this,mi,Qn).call(this),ht=this.getNextId(),mt=T(this,fi,Jn).call(this,{parent:this,id:ht,x:M,y:st,uiManager:t(this,pe),isCentered:!0,...s});mt&&this.add(mt)}deserialize(pt){var s;return((s=t(as,Es).get(pt.annotationType??pt.annotationEditorType))==null?void 0:s.deserialize(pt,this,t(this,pe)))||null}createAndAddNewEditor(pt,s,M={}){const st=this.getNextId(),ht=T(this,fi,Jn).call(this,{parent:this,id:st,x:pt.offsetX,y:pt.offsetY,uiManager:t(this,pe),isCentered:s,...M});return ht&&this.add(ht),ht}addNewEditor(){this.createAndAddNewEditor(T(this,mi,Qn).call(this),!0)}setSelected(pt){t(this,pe).setSelected(pt)}toggleSelected(pt){t(this,pe).toggleSelected(pt)}isSelected(pt){return t(this,pe).isSelected(pt)}unselect(pt){t(this,pe).unselect(pt)}pointerup(pt){const{isMac:s}=e.FeatureTest.platform;if(!(pt.button!==0||pt.ctrlKey&&s)&&pt.target===this.div&&t(this,ws)){if(I(this,ws,!1),!t(this,Ws)){I(this,Ws,!0);return}if(t(this,pe).getMode()===e.AnnotationEditorType.STAMP){t(this,pe).unselectAll();return}this.createAndAddNewEditor(pt,!1)}}pointerdown(pt){if(t(this,pe).getMode()===e.AnnotationEditorType.HIGHLIGHT&&this.enableTextSelection(),t(this,ws)){I(this,ws,!1);return}const{isMac:s}=e.FeatureTest.platform;if(pt.button!==0||pt.ctrlKey&&s||pt.target!==this.div)return;I(this,ws,!0);const M=t(this,pe).getActive();I(this,Ws,!M||M.isEmpty())}findNewParent(pt,s,M){const st=t(this,pe).findParent(s,M);return st===null||st===this?!1:(st.changeParent(pt),!0)}destroy(){var pt,s;((pt=t(this,pe).getActive())==null?void 0:pt.parent)===this&&(t(this,pe).commitOrRemove(),t(this,pe).setActiveEditor(null)),t(this,ms)&&(clearTimeout(t(this,ms)),I(this,ms,null));for(const M of t(this,es).values())(s=t(this,Fs))==null||s.removePointerInTextLayer(M.contentDiv),M.setParent(null),M.isAttachedToDOM=!1,M.div.remove();this.div=null,t(this,es).clear(),t(this,pe).removeLayer(this)}render({viewport:pt}){this.viewport=pt,(0,O.setLayerDimensions)(this.div,pt);for(const s of t(this,pe).getEditors(this.pageIndex))this.add(s),s.rebuild();this.updateMode()}update({viewport:pt}){t(this,pe).commitOrRemove(),T(this,Ys,cn).call(this);const s=this.viewport.rotation,M=pt.rotation;if(this.viewport=pt,(0,O.setLayerDimensions)(this.div,{rotation:M}),s!==M)for(const st of t(this,es).values())st.rotate(M);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:pt,pageHeight:s}=this.viewport.rawDims;return[pt,s]}get scale(){return t(this,pe).viewParameters.realScale}};Fs=new WeakMap,Ws=new WeakMap,cs=new WeakMap,Ds=new WeakMap,gs=new WeakMap,fs=new WeakMap,ms=new WeakMap,es=new WeakMap,ws=new WeakMap,Xs=new WeakMap,Ks=new WeakMap,Ye=new WeakMap,pe=new WeakMap,Es=new WeakMap,ji=new WeakSet,xa=function(pt){if(t(this,pe).unselectAll(),pt.target===t(this,Ye).div){const{isMac:s}=e.FeatureTest.platform;if(pt.button!==0||pt.ctrlKey&&s)return;t(this,pe).showAllEditors("highlight",!0,!0),t(this,Ye).div.classList.add("free"),C.startHighlighting(this,t(this,pe).direction==="ltr",pt),t(this,Ye).div.addEventListener("pointerup",()=>{t(this,Ye).div.classList.remove("free")},{once:!0}),pt.preventDefault()}},gi=new WeakSet,Yn=function(){return t(as,Es).get(t(this,pe).getMode())},fi=new WeakSet,Jn=function(pt){const s=t(this,gi,Yn);return s?new s.prototype.constructor(pt):null},mi=new WeakSet,Qn=function(){const{x:pt,y:s,width:M,height:st}=this.div.getBoundingClientRect(),ht=Math.max(0,pt),mt=Math.max(0,s),It=Math.min(window.innerWidth,pt+M),Gt=Math.min(window.innerHeight,s+st),kt=(ht+It)/2-pt,Xt=(mt+Gt)/2-s,[Wt,Ae]=this.viewport.rotation%180===0?[kt,Xt]:[Xt,kt];return{offsetX:Wt,offsetY:Ae}},Ys=new WeakSet,cn=function(){I(this,Xs,!0);for(const pt of t(this,es).values())pt.isEmpty()&&pt.remove();I(this,Xs,!1)},me(as,"_initialized",!1),l(as,Es,new Map([k,_,D,C].map(pt=>[pt._editorType,pt])));let U=as},259:(r,p,c)=>{var W,k,y,f,O,C,_,D,U,Y,at,Q,L,Zn,$,tr,q,Ca,bt,Hs,Ct,Ta,_t,Ss;c.d(p,{ColorPicker:()=>x});var e=c(292),w=c(830),m=c(419);const Lt=class Lt{constructor({editor:Z=null,uiManager:gt=null}){l(this,L);l(this,$);l(this,q);l(this,bt);l(this,Ct);l(this,_t);l(this,W,T(this,q,Ca).bind(this));l(this,k,T(this,Ct,Ta).bind(this));l(this,y,null);l(this,f,null);l(this,O,void 0);l(this,C,null);l(this,_,!1);l(this,D,!1);l(this,U,null);l(this,Y,void 0);l(this,at,null);l(this,Q,void 0);var Rt;Z?(I(this,D,!1),I(this,Q,e.AnnotationEditorParamsType.HIGHLIGHT_COLOR),I(this,U,Z)):(I(this,D,!0),I(this,Q,e.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR)),I(this,at,(Z==null?void 0:Z._uiManager)||gt),I(this,Y,t(this,at)._eventBus),I(this,O,(Z==null?void 0:Z.color)||((Rt=t(this,at))==null?void 0:Rt.highlightColors.values().next().value)||"#FFFF98")}static get _keyboardManager(){return(0,e.shadow)(this,"_keyboardManager",new w.KeyboardManager([[["Escape","mac+Escape"],Lt.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Lt.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Lt.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Lt.prototype._moveToPrevious],[["Home","mac+Home"],Lt.prototype._moveToBeginning],[["End","mac+End"],Lt.prototype._moveToEnd]]))}renderButton(){const Z=I(this,y,document.createElement("button"));Z.className="colorPicker",Z.tabIndex="0",Z.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),Z.setAttribute("aria-haspopup",!0),Z.addEventListener("click",T(this,bt,Hs).bind(this)),Z.addEventListener("keydown",t(this,W));const gt=I(this,f,document.createElement("span"));return gt.className="swatch",gt.setAttribute("aria-hidden",!0),gt.style.backgroundColor=t(this,O),Z.append(gt),Z}renderMainDropdown(){const Z=I(this,C,T(this,L,Zn).call(this));return Z.setAttribute("aria-orientation","horizontal"),Z.setAttribute("aria-labelledby","highlightColorPickerLabel"),Z}_colorSelectFromKeyboard(Z){if(Z.target===t(this,y)){T(this,bt,Hs).call(this,Z);return}const gt=Z.target.getAttribute("data-color");gt&&T(this,$,tr).call(this,gt,Z)}_moveToNext(Z){var gt,Rt;if(!t(this,_t,Ss)){T(this,bt,Hs).call(this,Z);return}if(Z.target===t(this,y)){(gt=t(this,C).firstChild)==null||gt.focus();return}(Rt=Z.target.nextSibling)==null||Rt.focus()}_moveToPrevious(Z){var gt,Rt;if(Z.target===((gt=t(this,C))==null?void 0:gt.firstChild)||Z.target===t(this,y)){t(this,_t,Ss)&&this._hideDropdownFromKeyboard();return}t(this,_t,Ss)||T(this,bt,Hs).call(this,Z),(Rt=Z.target.previousSibling)==null||Rt.focus()}_moveToBeginning(Z){var gt;if(!t(this,_t,Ss)){T(this,bt,Hs).call(this,Z);return}(gt=t(this,C).firstChild)==null||gt.focus()}_moveToEnd(Z){var gt;if(!t(this,_t,Ss)){T(this,bt,Hs).call(this,Z);return}(gt=t(this,C).lastChild)==null||gt.focus()}hideDropdown(){var Z;(Z=t(this,C))==null||Z.classList.add("hidden"),window.removeEventListener("pointerdown",t(this,k))}_hideDropdownFromKeyboard(){var Z;if(!t(this,D)){if(!t(this,_t,Ss)){(Z=t(this,U))==null||Z.unselect();return}this.hideDropdown(),t(this,y).focus({preventScroll:!0,focusVisible:t(this,_)})}}updateColor(Z){if(t(this,f)&&(t(this,f).style.backgroundColor=Z),!t(this,C))return;const gt=t(this,at).highlightColors.values();for(const Rt of t(this,C).children)Rt.setAttribute("aria-selected",gt.next().value===Z)}destroy(){var Z,gt;(Z=t(this,y))==null||Z.remove(),I(this,y,null),I(this,f,null),(gt=t(this,C))==null||gt.remove(),I(this,C,null)}};W=new WeakMap,k=new WeakMap,y=new WeakMap,f=new WeakMap,O=new WeakMap,C=new WeakMap,_=new WeakMap,D=new WeakMap,U=new WeakMap,Y=new WeakMap,at=new WeakMap,Q=new WeakMap,L=new WeakSet,Zn=function(){const Z=document.createElement("div");Z.addEventListener("contextmenu",m.noContextMenu),Z.className="dropdown",Z.role="listbox",Z.setAttribute("aria-multiselectable",!1),Z.setAttribute("aria-orientation","vertical"),Z.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[gt,Rt]of t(this,at).highlightColors){const Pt=document.createElement("button");Pt.tabIndex="0",Pt.role="option",Pt.setAttribute("data-color",Rt),Pt.title=gt,Pt.setAttribute("data-l10n-id",`pdfjs-editor-colorpicker-${gt}`);const qt=document.createElement("span");Pt.append(qt),qt.className="swatch",qt.style.backgroundColor=Rt,Pt.setAttribute("aria-selected",Rt===t(this,O)),Pt.addEventListener("click",T(this,$,tr).bind(this,Rt)),Z.append(Pt)}return Z.addEventListener("keydown",t(this,W)),Z},$=new WeakSet,tr=function(Z,gt){gt.stopPropagation(),t(this,Y).dispatch("switchannotationeditorparams",{source:this,type:t(this,Q),value:Z})},q=new WeakSet,Ca=function(Z){Lt._keyboardManager.exec(this,Z)},bt=new WeakSet,Hs=function(Z){if(t(this,_t,Ss)){this.hideDropdown();return}if(I(this,_,Z.detail===0),window.addEventListener("pointerdown",t(this,k)),t(this,C)){t(this,C).classList.remove("hidden");return}const gt=I(this,C,T(this,L,Zn).call(this));t(this,y).append(gt)},Ct=new WeakSet,Ta=function(Z){var gt;(gt=t(this,C))!=null&&gt.contains(Z.target)||this.hideDropdown()},_t=new WeakSet,Ss=function(){return t(this,C)&&!t(this,C).classList.contains("hidden")};let x=Lt},310:(r,p,c)=>{var f,O,C,_,D,U,Y,at,er,V,$,N,q,tt,bt,Ft,Ct,Ot,_t,Mt,Lt,Et,Z,gt,Rt,Pt,qt,Kt,ie,xe,de,sr,be,ir,ae,nr,ee,Ma,ne,ka,i,rr,d,ar,o,or,v,La,u,Ra,h,Pa,j,Ia,rt,hr,yt,Mi;c.d(p,{AnnotationEditor:()=>k});var e=c(830),w=c(292),m=c(419);const L=class L{constructor(P){l(this,at);l(this,f,"");l(this,O,!1);l(this,C,null);l(this,_,null);l(this,D,null);l(this,U,!1);l(this,Y,null);I(this,Y,P)}static initialize(P){L._l10nPromise||(L._l10nPromise=P)}async render(){const P=I(this,C,document.createElement("button"));P.className="altText";const K=await L._l10nPromise.get("pdfjs-editor-alt-text-button-label");P.textContent=K,P.setAttribute("aria-label",K),P.tabIndex="0",P.addEventListener("contextmenu",m.noContextMenu),P.addEventListener("pointerdown",B=>B.stopPropagation());const nt=B=>{B.preventDefault(),t(this,Y)._uiManager.editAltText(t(this,Y))};return P.addEventListener("click",nt,{capture:!0}),P.addEventListener("keydown",B=>{B.target===P&&B.key==="Enter"&&(I(this,U,!0),nt(B))}),await T(this,at,er).call(this),P}finish(){t(this,C)&&(t(this,C).focus({focusVisible:t(this,U)}),I(this,U,!1))}isEmpty(){return!t(this,f)&&!t(this,O)}get data(){return{altText:t(this,f),decorative:t(this,O)}}set data({altText:P,decorative:K}){t(this,f)===P&&t(this,O)===K||(I(this,f,P),I(this,O,K),T(this,at,er).call(this))}toggle(P=!1){t(this,C)&&(!P&&t(this,D)&&(clearTimeout(t(this,D)),I(this,D,null)),t(this,C).disabled=!P)}destroy(){var P;(P=t(this,C))==null||P.remove(),I(this,C,null),I(this,_,null)}};f=new WeakMap,O=new WeakMap,C=new WeakMap,_=new WeakMap,D=new WeakMap,U=new WeakMap,Y=new WeakMap,at=new WeakSet,er=async function(){var nt,B;const P=t(this,C);if(!P)return;if(!t(this,f)&&!t(this,O)){P.classList.remove("done"),(nt=t(this,_))==null||nt.remove();return}P.classList.add("done"),L._l10nPromise.get("pdfjs-editor-alt-text-edit-button-label").then(b=>{P.setAttribute("aria-label",b)});let K=t(this,_);if(!K){I(this,_,K=document.createElement("span")),K.className="tooltip",K.setAttribute("role","tooltip");const b=K.id=`alt-text-tooltip-${t(this,Y).id}`;P.setAttribute("aria-describedby",b);const z=100;P.addEventListener("mouseenter",()=>{I(this,D,setTimeout(()=>{I(this,D,null),t(this,_).classList.add("show"),t(this,Y)._reportTelemetry({action:"alt_text_tooltip"})},z))}),P.addEventListener("mouseleave",()=>{var X;t(this,D)&&(clearTimeout(t(this,D)),I(this,D,null)),(X=t(this,_))==null||X.classList.remove("show")})}K.innerText=t(this,O)?await L._l10nPromise.get("pdfjs-editor-alt-text-decorative-tooltip"):t(this,f),K.parentNode||P.append(K),(B=t(this,Y).getImageForAltText())==null||B.setAttribute("aria-describedby",K.id)},me(L,"_l10nPromise",null);let x=L;var W=c(362);const ut=class ut{constructor(P){l(this,de);l(this,ae);l(this,ee);l(this,ne);l(this,i);l(this,d);l(this,o);l(this,v);l(this,u);l(this,h);l(this,j);l(this,rt);l(this,yt);l(this,V,null);l(this,$,null);l(this,N,!1);l(this,q,!1);l(this,tt,null);l(this,bt,null);l(this,Ft,this.focusin.bind(this));l(this,Ct,this.focusout.bind(this));l(this,Ot,null);l(this,_t,"");l(this,Mt,!1);l(this,Lt,null);l(this,Et,!1);l(this,Z,!1);l(this,gt,!1);l(this,Rt,null);l(this,Pt,0);l(this,qt,0);l(this,Kt,null);me(this,"_initialOptions",Object.create(null));me(this,"_isVisible",!0);me(this,"_uiManager",null);me(this,"_focusEventsAllowed",!0);me(this,"_l10nPromise",null);l(this,ie,!1);l(this,xe,ut._zIndex++);this.constructor===ut&&(0,w.unreachable)("Cannot initialize AnnotationEditor."),this.parent=P.parent,this.id=P.id,this.width=this.height=null,this.pageIndex=P.parent.pageIndex,this.name=P.name,this.div=null,this._uiManager=P.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=P.isCentered,this._structTreeParentId=null;const{rotation:K,rawDims:{pageWidth:nt,pageHeight:B,pageX:b,pageY:z}}=this.parent.viewport;this.rotation=K,this.pageRotation=(360+K-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[nt,B],this.pageTranslation=[b,z];const[X,lt]=this.parentDimensions;this.x=P.x/X,this.y=P.y/lt,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const P=ut.prototype._resizeWithKeyboard,K=e.AnnotationEditorUIManager.TRANSLATE_SMALL,nt=e.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,w.shadow)(this,"_resizerKeyboardManager",new e.KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],P,{args:[-K,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],P,{args:[-nt,0]}],[["ArrowRight","mac+ArrowRight"],P,{args:[K,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],P,{args:[nt,0]}],[["ArrowUp","mac+ArrowUp"],P,{args:[0,-K]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],P,{args:[0,-nt]}],[["ArrowDown","mac+ArrowDown"],P,{args:[0,K]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],P,{args:[0,nt]}],[["Escape","mac+Escape"],ut.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,w.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(P){const K=new y({id:P.parent.getNextId(),parent:P.parent,uiManager:P._uiManager});K.annotationElementId=P.annotationElementId,K.deleted=!0,K._uiManager.addToAnnotationStorage(K)}static initialize(P,K,nt){if(ut._l10nPromise||(ut._l10nPromise=new Map(["pdfjs-editor-alt-text-button-label","pdfjs-editor-alt-text-edit-button-label","pdfjs-editor-alt-text-decorative-tooltip","pdfjs-editor-resizer-label-topLeft","pdfjs-editor-resizer-label-topMiddle","pdfjs-editor-resizer-label-topRight","pdfjs-editor-resizer-label-middleRight","pdfjs-editor-resizer-label-bottomRight","pdfjs-editor-resizer-label-bottomMiddle","pdfjs-editor-resizer-label-bottomLeft","pdfjs-editor-resizer-label-middleLeft"].map(b=>[b,P.get(b.replaceAll(/([A-Z])/g,z=>`-${z.toLowerCase()}`))]))),nt==null?void 0:nt.strings)for(const b of nt.strings)ut._l10nPromise.set(b,P.get(b));if(ut._borderLineWidth!==-1)return;const B=getComputedStyle(document.documentElement);ut._borderLineWidth=parseFloat(B.getPropertyValue("--outline-width"))||0}static updateDefaultParams(P,K){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(P){return!1}static paste(P,K){(0,w.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,ie)}set _isDraggable(P){var K;I(this,ie,P),(K=this.div)==null||K.classList.toggle("draggable",P)}get isEnterHandled(){return!0}center(){const[P,K]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*K/(P*2),this.y+=this.width*P/(K*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*K/(P*2),this.y-=this.width*P/(K*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(P){this._uiManager.addCommands(P)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,xe)}setParent(P){P!==null?(this.pageIndex=P.pageIndex,this.pageDimensions=P.pageDimensions):T(this,yt,Mi).call(this),this.parent=P}focusin(P){this._focusEventsAllowed&&(t(this,Mt)?I(this,Mt,!1):this.parent.setSelected(this))}focusout(P){var K,nt;!this._focusEventsAllowed||!this.isAttachedToDOM||(K=P.relatedTarget)!=null&&K.closest(`#${this.id}`)||(P.preventDefault(),(nt=this.parent)!=null&&nt.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(P,K,nt,B){const[b,z]=this.parentDimensions;[nt,B]=this.screenToPageTranslation(nt,B),this.x=(P+nt)/b,this.y=(K+B)/z,this.fixAndSetPosition()}translate(P,K){T(this,de,sr).call(this,this.parentDimensions,P,K)}translateInPage(P,K){t(this,Lt)||I(this,Lt,[this.x,this.y]),T(this,de,sr).call(this,this.pageDimensions,P,K),this.div.scrollIntoView({block:"nearest"})}drag(P,K){t(this,Lt)||I(this,Lt,[this.x,this.y]);const[nt,B]=this.parentDimensions;if(this.x+=P/nt,this.y+=K/B,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:ft,y:Tt}=this.div.getBoundingClientRect();this.parent.findNewParent(this,ft,Tt)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:b,y:z}=this;const[X,lt]=this.getBaseTranslation();b+=X,z+=lt,this.div.style.left=`${(100*b).toFixed(2)}%`,this.div.style.top=`${(100*z).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!t(this,Lt)&&(t(this,Lt)[0]!==this.x||t(this,Lt)[1]!==this.y)}getBaseTranslation(){const[P,K]=this.parentDimensions,{_borderLineWidth:nt}=ut,B=nt/P,b=nt/K;switch(this.rotation){case 90:return[-B,b];case 180:return[B,b];case 270:return[B,-b];default:return[-B,-b]}}get _mustFixPosition(){return!0}fixAndSetPosition(P=this.rotation){const[K,nt]=this.pageDimensions;let{x:B,y:b,width:z,height:X}=this;if(z*=K,X*=nt,B*=K,b*=nt,this._mustFixPosition)switch(P){case 0:B=Math.max(0,Math.min(K-z,B)),b=Math.max(0,Math.min(nt-X,b));break;case 90:B=Math.max(0,Math.min(K-X,B)),b=Math.min(nt,Math.max(z,b));break;case 180:B=Math.min(K,Math.max(z,B)),b=Math.min(nt,Math.max(X,b));break;case 270:B=Math.min(K,Math.max(X,B)),b=Math.max(0,Math.min(nt-z,b));break}this.x=B/=K,this.y=b/=nt;const[lt,ft]=this.getBaseTranslation();B+=lt,b+=ft;const{style:Tt}=this.div;Tt.left=`${(100*B).toFixed(2)}%`,Tt.top=`${(100*b).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(P,K){var nt;return T(nt=ut,be,ir).call(nt,P,K,this.parentRotation)}pageTranslationToScreen(P,K){var nt;return T(nt=ut,be,ir).call(nt,P,K,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:P,pageDimensions:[K,nt]}=this,B=K*P,b=nt*P;return w.FeatureTest.isCSSRoundSupported?[Math.round(B),Math.round(b)]:[B,b]}setDims(P,K){const[nt,B]=this.parentDimensions;this.div.style.width=`${(100*P/nt).toFixed(2)}%`,t(this,q)||(this.div.style.height=`${(100*K/B).toFixed(2)}%`)}fixDims(){const{style:P}=this.div,{height:K,width:nt}=P,B=nt.endsWith("%"),b=!t(this,q)&&K.endsWith("%");if(B&&b)return;const[z,X]=this.parentDimensions;B||(P.width=`${(100*parseFloat(nt)/z).toFixed(2)}%`),!t(this,q)&&!b&&(P.height=`${(100*parseFloat(K)/X).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}altTextFinish(){var P;(P=t(this,$))==null||P.finish()}async addEditToolbar(){return t(this,Ot)||t(this,Z)?t(this,Ot):(I(this,Ot,new W.EditorToolbar(this)),this.div.append(t(this,Ot).render()),t(this,$)&&t(this,Ot).addAltTextButton(await t(this,$).render()),t(this,Ot))}removeEditToolbar(){var P;t(this,Ot)&&(t(this,Ot).remove(),I(this,Ot,null),(P=t(this,$))==null||P.destroy())}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){t(this,$)||(x.initialize(ut._l10nPromise),I(this,$,new x(this)),await this.addEditToolbar())}get altTextData(){var P;return(P=t(this,$))==null?void 0:P.data}set altTextData(P){t(this,$)&&(t(this,$).data=P)}hasAltText(){var P;return!((P=t(this,$))!=null&&P.isEmpty())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=t(this,N)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.div.addEventListener("focusin",t(this,Ft)),this.div.addEventListener("focusout",t(this,Ct));const[P,K]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*K/P).toFixed(2)}%`,this.div.style.maxHeight=`${(100*P/K).toFixed(2)}%`);const[nt,B]=this.getInitialTranslation();return this.translate(nt,B),(0,e.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(P){const{isMac:K}=w.FeatureTest.platform;if(P.button!==0||P.ctrlKey&&K){P.preventDefault();return}if(I(this,Mt,!0),this._isDraggable){T(this,v,La).call(this,P);return}T(this,o,or).call(this,P)}moveInDOM(){t(this,Rt)&&clearTimeout(t(this,Rt)),I(this,Rt,setTimeout(()=>{var P;I(this,Rt,null),(P=this.parent)==null||P.moveEditorInDOM(this)},0))}_setParentAndPosition(P,K,nt){P.changeParent(this),this.x=K,this.y=nt,this.fixAndSetPosition()}getRect(P,K,nt=this.rotation){const B=this.parentScale,[b,z]=this.pageDimensions,[X,lt]=this.pageTranslation,ft=P/B,Tt=K/B,Dt=this.x*b,te=this.y*z,re=this.width*b,he=this.height*z;switch(nt){case 0:return[Dt+ft+X,z-te-Tt-he+lt,Dt+ft+re+X,z-te-Tt+lt];case 90:return[Dt+Tt+X,z-te+ft+lt,Dt+Tt+he+X,z-te+ft+re+lt];case 180:return[Dt-ft-re+X,z-te+Tt+lt,Dt-ft+X,z-te+Tt+he+lt];case 270:return[Dt-Tt-he+X,z-te-ft-re+lt,Dt-Tt+X,z-te-ft+lt];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(P,K){const[nt,B,b,z]=P,X=b-nt,lt=z-B;switch(this.rotation){case 0:return[nt,K-z,X,lt];case 90:return[nt,K-B,lt,X];case 180:return[b,K-B,X,lt];case 270:return[b,K-z,lt,X];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){I(this,Z,!0)}disableEditMode(){I(this,Z,!1)}isInEditMode(){return t(this,Z)}shouldGetKeyboardEvents(){return t(this,gt)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var P,K;(P=this.div)==null||P.addEventListener("focusin",t(this,Ft)),(K=this.div)==null||K.addEventListener("focusout",t(this,Ct))}rotate(P){}serialize(P=!1,K=null){(0,w.unreachable)("An editor must be serializable")}static deserialize(P,K,nt){const B=new this.prototype.constructor({parent:K,id:K.getNextId(),uiManager:nt});B.rotation=P.rotation;const[b,z]=B.pageDimensions,[X,lt,ft,Tt]=B.getRectInCurrentCoords(P.rect,z);return B.x=X/b,B.y=lt/z,B.width=ft/b,B.height=Tt/z,B}remove(){if(this.div.removeEventListener("focusin",t(this,Ft)),this.div.removeEventListener("focusout",t(this,Ct)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),t(this,Rt)&&(clearTimeout(t(this,Rt)),I(this,Rt,null)),T(this,yt,Mi).call(this),this.removeEditToolbar(),t(this,Kt)){for(const P of t(this,Kt).values())clearTimeout(P);I(this,Kt,null)}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(T(this,ee,Ma).call(this),t(this,tt).classList.remove("hidden"),(0,e.bindEvents)(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(P){if(!this.isResizable||P.target!==this.div||P.key!=="Enter")return;this._uiManager.setSelected(this),I(this,bt,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const K=t(this,tt).children;if(!t(this,V)){I(this,V,Array.from(K));const z=T(this,u,Ra).bind(this),X=T(this,h,Pa).bind(this);for(const lt of t(this,V)){const ft=lt.getAttribute("data-resizer-name");lt.setAttribute("role","spinbutton"),lt.addEventListener("keydown",z),lt.addEventListener("blur",X),lt.addEventListener("focus",T(this,j,Ia).bind(this,ft)),ut._l10nPromise.get(`pdfjs-editor-resizer-label-${ft}`).then(Tt=>lt.setAttribute("aria-label",Tt))}}const nt=t(this,V)[0];let B=0;for(const z of K){if(z===nt)break;B++}const b=(360-this.rotation+this.parentRotation)%360/90*(t(this,V).length/4);if(b!==B){if(b<B)for(let X=0;X<B-b;X++)t(this,tt).append(t(this,tt).firstChild);else if(b>B)for(let X=0;X<b-B;X++)t(this,tt).firstChild.before(t(this,tt).lastChild);let z=0;for(const X of K){const lt=t(this,V)[z++].getAttribute("data-resizer-name");ut._l10nPromise.get(`pdfjs-editor-resizer-label-${lt}`).then(ft=>X.setAttribute("aria-label",ft))}}T(this,rt,hr).call(this,0),I(this,gt,!0),t(this,tt).firstChild.focus({focusVisible:!0}),P.preventDefault(),P.stopImmediatePropagation()}_resizeWithKeyboard(P,K){t(this,gt)&&T(this,d,ar).call(this,t(this,_t),{movementX:P,movementY:K})}_stopResizingWithKeyboard(){T(this,yt,Mi).call(this),this.div.focus()}select(){var P,K;if(this.makeResizable(),(P=this.div)==null||P.classList.add("selectedEditor"),!t(this,Ot)){this.addEditToolbar().then(()=>{var nt,B;(nt=this.div)!=null&&nt.classList.contains("selectedEditor")&&((B=t(this,Ot))==null||B.show())});return}(K=t(this,Ot))==null||K.show()}unselect(){var P,K,nt,B;(P=t(this,tt))==null||P.classList.add("hidden"),(K=this.div)==null||K.classList.remove("selectedEditor"),(nt=this.div)!=null&&nt.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(B=t(this,Ot))==null||B.hide()}updateParams(P,K){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return t(this,Et)}set isEditing(P){I(this,Et,P),this.parent&&(P?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(P,K){I(this,q,!0);const nt=P/K,{style:B}=this.div;B.aspectRatio=nt,B.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(P,K=!1){if(K){t(this,Kt)||I(this,Kt,new Map);const{action:nt}=P;let B=t(this,Kt).get(nt);B&&clearTimeout(B),B=setTimeout(()=>{this._reportTelemetry(P),t(this,Kt).delete(nt),t(this,Kt).size===0&&I(this,Kt,null)},ut._telemetryTimeout),t(this,Kt).set(nt,B);return}P.type||(P.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:P}})}show(P=this._isVisible){this.div.classList.toggle("hidden",!P),this._isVisible=P}enable(){this.div&&(this.div.tabIndex=0),I(this,N,!1)}disable(){this.div&&(this.div.tabIndex=-1),I(this,N,!0)}};V=new WeakMap,$=new WeakMap,N=new WeakMap,q=new WeakMap,tt=new WeakMap,bt=new WeakMap,Ft=new WeakMap,Ct=new WeakMap,Ot=new WeakMap,_t=new WeakMap,Mt=new WeakMap,Lt=new WeakMap,Et=new WeakMap,Z=new WeakMap,gt=new WeakMap,Rt=new WeakMap,Pt=new WeakMap,qt=new WeakMap,Kt=new WeakMap,ie=new WeakMap,xe=new WeakMap,de=new WeakSet,sr=function([P,K],nt,B){[nt,B]=this.screenToPageTranslation(nt,B),this.x+=nt/P,this.y+=B/K,this.fixAndSetPosition()},be=new WeakSet,ir=function(P,K,nt){switch(nt){case 90:return[K,-P];case 180:return[-P,-K];case 270:return[-K,P];default:return[P,K]}},ae=new WeakSet,nr=function(P){switch(P){case 90:{const[K,nt]=this.pageDimensions;return[0,-K/nt,nt/K,0]}case 180:return[-1,0,0,-1];case 270:{const[K,nt]=this.pageDimensions;return[0,K/nt,-nt/K,0]}default:return[1,0,0,1]}},ee=new WeakSet,Ma=function(){if(t(this,tt))return;I(this,tt,document.createElement("div")),t(this,tt).classList.add("resizers");const P=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"];for(const K of P){const nt=document.createElement("div");t(this,tt).append(nt),nt.classList.add("resizer",K),nt.setAttribute("data-resizer-name",K),nt.addEventListener("pointerdown",T(this,ne,ka).bind(this,K)),nt.addEventListener("contextmenu",m.noContextMenu),nt.tabIndex=-1}this.div.prepend(t(this,tt))},ne=new WeakSet,ka=function(P,K){var he;K.preventDefault();const{isMac:nt}=w.FeatureTest.platform;if(K.button!==0||K.ctrlKey&&nt)return;(he=t(this,$))==null||he.toggle(!1);const B=T(this,d,ar).bind(this,P),b=this._isDraggable;this._isDraggable=!1;const z={passive:!0,capture:!0};this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",B,z);const X=this.x,lt=this.y,ft=this.width,Tt=this.height,Dt=this.parent.div.style.cursor,te=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(K.target).cursor;const re=()=>{var Te;this.parent.togglePointerEvents(!0),(Te=t(this,$))==null||Te.toggle(!0),this._isDraggable=b,window.removeEventListener("pointerup",re),window.removeEventListener("blur",re),window.removeEventListener("pointermove",B,z),this.parent.div.style.cursor=Dt,this.div.style.cursor=te,T(this,i,rr).call(this,X,lt,ft,Tt)};window.addEventListener("pointerup",re),window.addEventListener("blur",re)},i=new WeakSet,rr=function(P,K,nt,B){const b=this.x,z=this.y,X=this.width,lt=this.height;b===P&&z===K&&X===nt&&lt===B||this.addCommands({cmd:()=>{this.width=X,this.height=lt,this.x=b,this.y=z;const[ft,Tt]=this.parentDimensions;this.setDims(ft*X,Tt*lt),this.fixAndSetPosition()},undo:()=>{this.width=nt,this.height=B,this.x=P,this.y=K;const[ft,Tt]=this.parentDimensions;this.setDims(ft*nt,Tt*B),this.fixAndSetPosition()},mustExec:!0})},d=new WeakSet,ar=function(P,K){const[nt,B]=this.parentDimensions,b=this.x,z=this.y,X=this.width,lt=this.height,ft=ut.MIN_SIZE/nt,Tt=ut.MIN_SIZE/B,Dt=xt=>Math.round(xt*1e4)/1e4,te=T(this,ae,nr).call(this,this.rotation),re=(xt,Bt)=>[te[0]*xt+te[2]*Bt,te[1]*xt+te[3]*Bt],he=T(this,ae,nr).call(this,360-this.rotation),Te=(xt,Bt)=>[he[0]*xt+he[2]*Bt,he[1]*xt+he[3]*Bt];let _e,Fe,fe=!1,Le=!1;switch(P){case"topLeft":fe=!0,_e=(xt,Bt)=>[0,0],Fe=(xt,Bt)=>[xt,Bt];break;case"topMiddle":_e=(xt,Bt)=>[xt/2,0],Fe=(xt,Bt)=>[xt/2,Bt];break;case"topRight":fe=!0,_e=(xt,Bt)=>[xt,0],Fe=(xt,Bt)=>[0,Bt];break;case"middleRight":Le=!0,_e=(xt,Bt)=>[xt,Bt/2],Fe=(xt,Bt)=>[0,Bt/2];break;case"bottomRight":fe=!0,_e=(xt,Bt)=>[xt,Bt],Fe=(xt,Bt)=>[0,0];break;case"bottomMiddle":_e=(xt,Bt)=>[xt/2,Bt],Fe=(xt,Bt)=>[xt/2,0];break;case"bottomLeft":fe=!0,_e=(xt,Bt)=>[0,Bt],Fe=(xt,Bt)=>[xt,0];break;case"middleLeft":Le=!0,_e=(xt,Bt)=>[0,Bt/2],Fe=(xt,Bt)=>[xt,Bt/2];break}const se=_e(X,lt),F=Fe(X,lt);let S=re(...F);const J=Dt(b+S[0]),it=Dt(z+S[1]);let ct=1,wt=1,[vt,zt]=this.screenToPageTranslation(K.movementX,K.movementY);if([vt,zt]=Te(vt/nt,zt/B),fe){const xt=Math.hypot(X,lt);ct=wt=Math.max(Math.min(Math.hypot(F[0]-se[0]-vt,F[1]-se[1]-zt)/xt,1/X,1/lt),ft/X,Tt/lt)}else Le?ct=Math.max(ft,Math.min(1,Math.abs(F[0]-se[0]-vt)))/X:wt=Math.max(Tt,Math.min(1,Math.abs(F[1]-se[1]-zt)))/lt;const jt=Dt(X*ct),Nt=Dt(lt*wt);S=re(...Fe(jt,Nt));const Yt=J-S[0],$t=it-S[1];this.width=jt,this.height=Nt,this.x=Yt,this.y=$t,this.setDims(nt*jt,B*Nt),this.fixAndSetPosition()},o=new WeakSet,or=function(P){const{isMac:K}=w.FeatureTest.platform;P.ctrlKey&&!K||P.shiftKey||P.metaKey&&K?this.parent.toggleSelected(this):this.parent.setSelected(this)},v=new WeakSet,La=function(P){const K=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let nt,B;K&&(this.div.classList.add("moving"),nt={passive:!0,capture:!0},I(this,Pt,P.clientX),I(this,qt,P.clientY),B=z=>{const{clientX:X,clientY:lt}=z,[ft,Tt]=this.screenToPageTranslation(X-t(this,Pt),lt-t(this,qt));I(this,Pt,X),I(this,qt,lt),this._uiManager.dragSelectedEditors(ft,Tt)},window.addEventListener("pointermove",B,nt));const b=()=>{window.removeEventListener("pointerup",b),window.removeEventListener("blur",b),K&&(this.div.classList.remove("moving"),window.removeEventListener("pointermove",B,nt)),I(this,Mt,!1),this._uiManager.endDragSession()||T(this,o,or).call(this,P)};window.addEventListener("pointerup",b),window.addEventListener("blur",b)},u=new WeakSet,Ra=function(P){ut._resizerKeyboardManager.exec(this,P)},h=new WeakSet,Pa=function(P){var K;t(this,gt)&&((K=P.relatedTarget)==null?void 0:K.parentNode)!==t(this,tt)&&T(this,yt,Mi).call(this)},j=new WeakSet,Ia=function(P){I(this,_t,t(this,gt)?P:"")},rt=new WeakSet,hr=function(P){if(t(this,V))for(const K of t(this,V))K.tabIndex=P},yt=new WeakSet,Mi=function(){if(I(this,gt,!1),T(this,rt,hr).call(this,-1),t(this,bt)){const{savedX:P,savedY:K,savedWidth:nt,savedHeight:B}=t(this,bt);T(this,i,rr).call(this,P,K,nt,B),I(this,bt,null)}},l(ut,be),me(ut,"_borderLineWidth",-1),me(ut,"_colorManager",new e.ColorManager),me(ut,"_zIndex",1),me(ut,"_telemetryTimeout",1e3);let k=ut;class y extends k{constructor(P){super(P),this.annotationElementId=P.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},61:(r,p,c)=>{var y,f,O,C,Fa,D,dn,Y,Da,Q,Na,V,lr,N,q,tt,bt,Ft,Ct,Ot,_t,Mt,Lt,Et,Z,gt,Rt,Pt,qt,Kt,ie,xe,cr,be,Vt,ae,Ce,ee,Ee,ne,et,ki,n,Li,g,Oa;c.d(p,{FreeOutliner:()=>W,Outliner:()=>w});var e=c(292);class w{constructor(v,E=0,u=0,a=!0){l(this,C);l(this,D);l(this,Y);l(this,Q);l(this,V);l(this,y,void 0);l(this,f,[]);l(this,O,[]);let h=1/0,R=-1/0,j=1/0,G=-1/0;const rt=10**-4;for(const{x:K,y:nt,width:B,height:b}of v){const z=Math.floor((K-E)/rt)*rt,X=Math.ceil((K+B+E)/rt)*rt,lt=Math.floor((nt-E)/rt)*rt,ft=Math.ceil((nt+b+E)/rt)*rt,Tt=[z,lt,ft,!0],Dt=[X,lt,ft,!1];t(this,f).push(Tt,Dt),h=Math.min(h,z),R=Math.max(R,X),j=Math.min(j,lt),G=Math.max(G,ft)}const ot=R-h+2*u,yt=G-j+2*u,At=h-u,ut=j-u,St=t(this,f).at(a?-1:-2),P=[St[0],St[2]];for(const K of t(this,f)){const[nt,B,b]=K;K[0]=(nt-At)/ot,K[1]=(B-ut)/yt,K[2]=(b-ut)/yt}I(this,y,{x:At,y:ut,width:ot,height:yt,lastPoint:P})}getOutlines(){t(this,f).sort((E,u)=>E[0]-u[0]||E[1]-u[1]||E[2]-u[2]);const v=[];for(const E of t(this,f))E[3]?(v.push(...T(this,V,lr).call(this,E)),T(this,Y,Da).call(this,E)):(T(this,Q,Na).call(this,E),v.push(...T(this,V,lr).call(this,E)));return T(this,C,Fa).call(this,v)}}y=new WeakMap,f=new WeakMap,O=new WeakMap,C=new WeakSet,Fa=function(v){const E=[],u=new Set;for(const R of v){const[j,G,rt]=R;E.push([j,G,R],[j,rt,R])}E.sort((R,j)=>R[1]-j[1]||R[0]-j[0]);for(let R=0,j=E.length;R<j;R+=2){const G=E[R][2],rt=E[R+1][2];G.push(rt),rt.push(G),u.add(G),u.add(rt)}const a=[];let h;for(;u.size>0;){const R=u.values().next().value;let[j,G,rt,ot,yt]=R;u.delete(R);let At=j,ut=G;for(h=[j,rt],a.push(h);;){let St;if(u.has(ot))St=ot;else if(u.has(yt))St=yt;else break;u.delete(St),[j,G,rt,ot,yt]=St,At!==j&&(h.push(At,ut,j,ut===G?G:rt),At=j),ut=ut===G?rt:G}h.push(At,ut)}return new x(a,t(this,y))},D=new WeakSet,dn=function(v){const E=t(this,O);let u=0,a=E.length-1;for(;u<=a;){const h=u+a>>1,R=E[h][0];if(R===v)return h;R<v?u=h+1:a=h-1}return a+1},Y=new WeakSet,Da=function([,v,E]){const u=T(this,D,dn).call(this,v);t(this,O).splice(u,0,[v,E])},Q=new WeakSet,Na=function([,v,E]){const u=T(this,D,dn).call(this,v);for(let a=u;a<t(this,O).length;a++){const[h,R]=t(this,O)[a];if(h!==v)break;if(h===v&&R===E){t(this,O).splice(a,1);return}}for(let a=u-1;a>=0;a--){const[h,R]=t(this,O)[a];if(h!==v)break;if(h===v&&R===E){t(this,O).splice(a,1);return}}},V=new WeakSet,lr=function(v){const[E,u,a]=v,h=[[E,u,a]],R=T(this,D,dn).call(this,a);for(let j=0;j<R;j++){const[G,rt]=t(this,O)[j];for(let ot=0,yt=h.length;ot<yt;ot++){const[,At,ut]=h[ot];if(!(rt<=At||ut<=G)){if(At>=G){if(ut>rt)h[ot][1]=rt;else{if(yt===1)return[];h.splice(ot,1),ot--,yt--}continue}h[ot][2]=G,ut>rt&&h.push([E,rt,ut])}}}return h};class m{toSVGPath(){throw new Error("Abstract method `toSVGPath` must be implemented.")}get box(){throw new Error("Abstract getter `box` must be implemented.")}serialize(v,E){throw new Error("Abstract method `serialize` must be implemented.")}get free(){return this instanceof k}}class x extends m{constructor(E,u){super();l(this,N,void 0);l(this,q,void 0);I(this,q,E),I(this,N,u)}toSVGPath(){const E=[];for(const u of t(this,q)){let[a,h]=u;E.push(`M${a} ${h}`);for(let R=2;R<u.length;R+=2){const j=u[R],G=u[R+1];j===a?(E.push(`V${G}`),h=G):G===h&&(E.push(`H${j}`),a=j)}E.push("Z")}return E.join(" ")}serialize([E,u,a,h],R){const j=[],G=a-E,rt=h-u;for(const ot of t(this,q)){const yt=new Array(ot.length);for(let At=0;At<ot.length;At+=2)yt[At]=E+ot[At]*G,yt[At+1]=h-ot[At+1]*rt;j.push(yt)}return j}get box(){return t(this,N)}}N=new WeakMap,q=new WeakMap;const le=class le{constructor({x:v,y:E},u,a,h,R,j=0){l(this,xe);l(this,tt,void 0);l(this,bt,[]);l(this,Ft,void 0);l(this,Ct,void 0);l(this,Ot,[]);l(this,_t,new Float64Array(18));l(this,Mt,void 0);l(this,Lt,void 0);l(this,Et,void 0);l(this,Z,void 0);l(this,gt,void 0);l(this,Rt,void 0);l(this,Pt,[]);I(this,tt,u),I(this,Rt,h*a),I(this,Ct,R),t(this,_t).set([NaN,NaN,NaN,NaN,v,E],6),I(this,Ft,j),I(this,Z,t(le,qt)*a),I(this,Et,t(le,ie)*a),I(this,gt,a),t(this,Pt).push(v,E)}get free(){return!0}isEmpty(){return isNaN(t(this,_t)[8])}add({x:v,y:E}){var Tt;I(this,Mt,v),I(this,Lt,E);const[u,a,h,R]=t(this,tt);let[j,G,rt,ot]=t(this,_t).subarray(8,12);const yt=v-rt,At=E-ot,ut=Math.hypot(yt,At);if(ut<t(this,Et))return!1;const St=ut-t(this,Z),P=St/ut,K=P*yt,nt=P*At;let B=j,b=G;j=rt,G=ot,rt+=K,ot+=nt,(Tt=t(this,Pt))==null||Tt.push(v,E);const z=-nt/St,X=K/St,lt=z*t(this,Rt),ft=X*t(this,Rt);return t(this,_t).set(t(this,_t).subarray(2,8),0),t(this,_t).set([rt+lt,ot+ft],4),t(this,_t).set(t(this,_t).subarray(14,18),12),t(this,_t).set([rt-lt,ot-ft],16),isNaN(t(this,_t)[6])?(t(this,Ot).length===0&&(t(this,_t).set([j+lt,G+ft],2),t(this,Ot).push(NaN,NaN,NaN,NaN,(j+lt-u)/h,(G+ft-a)/R),t(this,_t).set([j-lt,G-ft],14),t(this,bt).push(NaN,NaN,NaN,NaN,(j-lt-u)/h,(G-ft-a)/R)),t(this,_t).set([B,b,j,G,rt,ot],6),!this.isEmpty()):(t(this,_t).set([B,b,j,G,rt,ot],6),Math.abs(Math.atan2(b-G,B-j)-Math.atan2(nt,K))<Math.PI/2?([j,G,rt,ot]=t(this,_t).subarray(2,6),t(this,Ot).push(NaN,NaN,NaN,NaN,((j+rt)/2-u)/h,((G+ot)/2-a)/R),[j,G,B,b]=t(this,_t).subarray(14,18),t(this,bt).push(NaN,NaN,NaN,NaN,((B+j)/2-u)/h,((b+G)/2-a)/R),!0):([B,b,j,G,rt,ot]=t(this,_t).subarray(0,6),t(this,Ot).push(((B+5*j)/6-u)/h,((b+5*G)/6-a)/R,((5*j+rt)/6-u)/h,((5*G+ot)/6-a)/R,((j+rt)/2-u)/h,((G+ot)/2-a)/R),[rt,ot,j,G,B,b]=t(this,_t).subarray(12,18),t(this,bt).push(((B+5*j)/6-u)/h,((b+5*G)/6-a)/R,((5*j+rt)/6-u)/h,((5*G+ot)/6-a)/R,((j+rt)/2-u)/h,((G+ot)/2-a)/R),!0))}toSVGPath(){if(this.isEmpty())return"";const v=t(this,Ot),E=t(this,bt),u=t(this,_t).subarray(4,6),a=t(this,_t).subarray(16,18),[h,R,j,G]=t(this,tt),[rt,ot,yt,At]=T(this,xe,cr).call(this);if(isNaN(t(this,_t)[6])&&!this.isEmpty())return`M${(t(this,_t)[2]-h)/j} ${(t(this,_t)[3]-R)/G} L${(t(this,_t)[4]-h)/j} ${(t(this,_t)[5]-R)/G} L${rt} ${ot} L${yt} ${At} L${(t(this,_t)[16]-h)/j} ${(t(this,_t)[17]-R)/G} L${(t(this,_t)[14]-h)/j} ${(t(this,_t)[15]-R)/G} Z`;const ut=[];ut.push(`M${v[4]} ${v[5]}`);for(let St=6;St<v.length;St+=6)isNaN(v[St])?ut.push(`L${v[St+4]} ${v[St+5]}`):ut.push(`C${v[St]} ${v[St+1]} ${v[St+2]} ${v[St+3]} ${v[St+4]} ${v[St+5]}`);ut.push(`L${(u[0]-h)/j} ${(u[1]-R)/G} L${rt} ${ot} L${yt} ${At} L${(a[0]-h)/j} ${(a[1]-R)/G}`);for(let St=E.length-6;St>=6;St-=6)isNaN(E[St])?ut.push(`L${E[St+4]} ${E[St+5]}`):ut.push(`C${E[St]} ${E[St+1]} ${E[St+2]} ${E[St+3]} ${E[St+4]} ${E[St+5]}`);return ut.push(`L${E[4]} ${E[5]} Z`),ut.join(" ")}getOutlines(){var nt;const v=t(this,Ot),E=t(this,bt),u=t(this,_t),a=u.subarray(4,6),h=u.subarray(16,18),[R,j,G,rt]=t(this,tt),ot=new Float64Array((((nt=t(this,Pt))==null?void 0:nt.length)??0)+2);for(let B=0,b=ot.length-2;B<b;B+=2)ot[B]=(t(this,Pt)[B]-R)/G,ot[B+1]=(t(this,Pt)[B+1]-j)/rt;ot[ot.length-2]=(t(this,Mt)-R)/G,ot[ot.length-1]=(t(this,Lt)-j)/rt;const[yt,At,ut,St]=T(this,xe,cr).call(this);if(isNaN(u[6])&&!this.isEmpty()){const B=new Float64Array(36);return B.set([NaN,NaN,NaN,NaN,(u[2]-R)/G,(u[3]-j)/rt,NaN,NaN,NaN,NaN,(u[4]-R)/G,(u[5]-j)/rt,NaN,NaN,NaN,NaN,yt,At,NaN,NaN,NaN,NaN,ut,St,NaN,NaN,NaN,NaN,(u[16]-R)/G,(u[17]-j)/rt,NaN,NaN,NaN,NaN,(u[14]-R)/G,(u[15]-j)/rt],0),new k(B,ot,t(this,tt),t(this,gt),t(this,Ft),t(this,Ct))}const P=new Float64Array(t(this,Ot).length+24+t(this,bt).length);let K=v.length;for(let B=0;B<K;B+=2){if(isNaN(v[B])){P[B]=P[B+1]=NaN;continue}P[B]=v[B],P[B+1]=v[B+1]}P.set([NaN,NaN,NaN,NaN,(a[0]-R)/G,(a[1]-j)/rt,NaN,NaN,NaN,NaN,yt,At,NaN,NaN,NaN,NaN,ut,St,NaN,NaN,NaN,NaN,(h[0]-R)/G,(h[1]-j)/rt],K),K+=24;for(let B=E.length-6;B>=6;B-=6)for(let b=0;b<6;b+=2){if(isNaN(E[B+b])){P[K]=P[K+1]=NaN,K+=2;continue}P[K]=E[B+b],P[K+1]=E[B+b+1],K+=2}return P.set([NaN,NaN,NaN,NaN,E[4],E[5]],K),new k(P,ot,t(this,tt),t(this,gt),t(this,Ft),t(this,Ct))}};tt=new WeakMap,bt=new WeakMap,Ft=new WeakMap,Ct=new WeakMap,Ot=new WeakMap,_t=new WeakMap,Mt=new WeakMap,Lt=new WeakMap,Et=new WeakMap,Z=new WeakMap,gt=new WeakMap,Rt=new WeakMap,Pt=new WeakMap,qt=new WeakMap,Kt=new WeakMap,ie=new WeakMap,xe=new WeakSet,cr=function(){const v=t(this,_t).subarray(4,6),E=t(this,_t).subarray(16,18),[u,a,h,R]=t(this,tt);return[(t(this,Mt)+(v[0]-E[0])/2-u)/h,(t(this,Lt)+(v[1]-E[1])/2-a)/R,(t(this,Mt)+(E[0]-v[0])/2-u)/h,(t(this,Lt)+(E[1]-v[1])/2-a)/R]},l(le,qt,8),l(le,Kt,2),l(le,ie,t(le,qt)+t(le,Kt));let W=le;class k extends m{constructor(E,u,a,h,R,j){super();l(this,et);l(this,n);l(this,g);l(this,be,void 0);l(this,Vt,null);l(this,ae,void 0);l(this,Ce,void 0);l(this,ee,void 0);l(this,Ee,void 0);l(this,ne,void 0);I(this,ne,E),I(this,ee,u),I(this,be,a),I(this,Ee,h),I(this,ae,R),I(this,Ce,j),T(this,g,Oa).call(this,j);const{x:G,y:rt,width:ot,height:yt}=t(this,Vt);for(let At=0,ut=E.length;At<ut;At+=2)E[At]=(E[At]-G)/ot,E[At+1]=(E[At+1]-rt)/yt;for(let At=0,ut=u.length;At<ut;At+=2)u[At]=(u[At]-G)/ot,u[At+1]=(u[At+1]-rt)/yt}toSVGPath(){const E=[`M${t(this,ne)[4]} ${t(this,ne)[5]}`];for(let u=6,a=t(this,ne).length;u<a;u+=6){if(isNaN(t(this,ne)[u])){E.push(`L${t(this,ne)[u+4]} ${t(this,ne)[u+5]}`);continue}E.push(`C${t(this,ne)[u]} ${t(this,ne)[u+1]} ${t(this,ne)[u+2]} ${t(this,ne)[u+3]} ${t(this,ne)[u+4]} ${t(this,ne)[u+5]}`)}return E.push("Z"),E.join(" ")}serialize([E,u,a,h],R){const j=a-E,G=h-u;let rt,ot;switch(R){case 0:rt=T(this,et,ki).call(this,t(this,ne),E,h,j,-G),ot=T(this,et,ki).call(this,t(this,ee),E,h,j,-G);break;case 90:rt=T(this,n,Li).call(this,t(this,ne),E,u,j,G),ot=T(this,n,Li).call(this,t(this,ee),E,u,j,G);break;case 180:rt=T(this,et,ki).call(this,t(this,ne),a,u,-j,G),ot=T(this,et,ki).call(this,t(this,ee),a,u,-j,G);break;case 270:rt=T(this,n,Li).call(this,t(this,ne),a,h,-j,-G),ot=T(this,n,Li).call(this,t(this,ee),a,h,-j,-G);break}return{outline:Array.from(rt),points:[Array.from(ot)]}}get box(){return t(this,Vt)}getNewOutline(E,u){const{x:a,y:h,width:R,height:j}=t(this,Vt),[G,rt,ot,yt]=t(this,be),At=R*ot,ut=j*yt,St=a*ot+G,P=h*yt+rt,K=new W({x:t(this,ee)[0]*At+St,y:t(this,ee)[1]*ut+P},t(this,be),t(this,Ee),E,t(this,Ce),u??t(this,ae));for(let nt=2;nt<t(this,ee).length;nt+=2)K.add({x:t(this,ee)[nt]*At+St,y:t(this,ee)[nt+1]*ut+P});return K.getOutlines()}}be=new WeakMap,Vt=new WeakMap,ae=new WeakMap,Ce=new WeakMap,ee=new WeakMap,Ee=new WeakMap,ne=new WeakMap,et=new WeakSet,ki=function(E,u,a,h,R){const j=new Float64Array(E.length);for(let G=0,rt=E.length;G<rt;G+=2)j[G]=u+E[G]*h,j[G+1]=a+E[G+1]*R;return j},n=new WeakSet,Li=function(E,u,a,h,R){const j=new Float64Array(E.length);for(let G=0,rt=E.length;G<rt;G+=2)j[G]=u+E[G+1]*h,j[G+1]=a+E[G]*R;return j},g=new WeakSet,Oa=function(E){const u=t(this,ne);let a=u[4],h=u[5],R=a,j=h,G=a,rt=h,ot=a,yt=h;const At=E?Math.max:Math.min;for(let nt=6,B=u.length;nt<B;nt+=6){if(isNaN(u[nt]))R=Math.min(R,u[nt+4]),j=Math.min(j,u[nt+5]),G=Math.max(G,u[nt+4]),rt=Math.max(rt,u[nt+5]),yt<u[nt+5]?(ot=u[nt+4],yt=u[nt+5]):yt===u[nt+5]&&(ot=At(ot,u[nt+4]));else{const b=e.Util.bezierBoundingBox(a,h,...u.slice(nt,nt+6));R=Math.min(R,b[0]),j=Math.min(j,b[1]),G=Math.max(G,b[2]),rt=Math.max(rt,b[3]),yt<b[3]?(ot=b[2],yt=b[3]):yt===b[3]&&(ot=At(ot,b[2]))}a=u[nt+4],h=u[nt+5]}const ut=R-t(this,ae),St=j-t(this,ae),P=G-R+2*t(this,ae),K=rt-j+2*t(this,ae);I(this,Vt,{x:ut,y:St,width:P,height:K,lastPoint:[ot,yt]})}},362:(r,p,c)=>{var x,W,k,y,f,Ha,C,Ba,D,Ua,Y,un,Q,$a,V,dr,q,tt,bt,Ft,Va,Ot,ja,Mt,Ga;c.d(p,{EditorToolbar:()=>w,HighlightToolbar:()=>m});var e=c(419);const N=class N{constructor(Z){l(this,C);l(this,D);l(this,Y);l(this,Q);l(this,V);l(this,x,null);l(this,W,null);l(this,k,void 0);l(this,y,null);I(this,k,Z)}render(){const Z=I(this,x,document.createElement("div"));Z.className="editToolbar",Z.setAttribute("role","toolbar"),Z.addEventListener("contextmenu",e.noContextMenu),Z.addEventListener("pointerdown",T(N,f,Ha));const gt=I(this,y,document.createElement("div"));gt.className="buttons",Z.append(gt);const Rt=t(this,k).toolbarPosition;if(Rt){const{style:Pt}=Z,qt=t(this,k)._uiManager.direction==="ltr"?1-Rt[0]:Rt[0];Pt.insetInlineEnd=`${100*qt}%`,Pt.top=`calc(${100*Rt[1]}% + var(--editor-toolbar-vert-offset))`}return T(this,Q,$a).call(this),Z}hide(){var Z;t(this,x).classList.add("hidden"),(Z=t(this,W))==null||Z.hideDropdown()}show(){t(this,x).classList.remove("hidden")}addAltTextButton(Z){T(this,Y,un).call(this,Z),t(this,y).prepend(Z,t(this,V,dr))}addColorPicker(Z){I(this,W,Z);const gt=Z.renderButton();T(this,Y,un).call(this,gt),t(this,y).prepend(gt,t(this,V,dr))}remove(){var Z;t(this,x).remove(),(Z=t(this,W))==null||Z.destroy(),I(this,W,null)}};x=new WeakMap,W=new WeakMap,k=new WeakMap,y=new WeakMap,f=new WeakSet,Ha=function(Z){Z.stopPropagation()},C=new WeakSet,Ba=function(Z){t(this,k)._focusEventsAllowed=!1,Z.preventDefault(),Z.stopPropagation()},D=new WeakSet,Ua=function(Z){t(this,k)._focusEventsAllowed=!0,Z.preventDefault(),Z.stopPropagation()},Y=new WeakSet,un=function(Z){Z.addEventListener("focusin",T(this,C,Ba).bind(this),{capture:!0}),Z.addEventListener("focusout",T(this,D,Ua).bind(this),{capture:!0}),Z.addEventListener("contextmenu",e.noContextMenu)},Q=new WeakSet,$a=function(){const Z=document.createElement("button");Z.className="delete",Z.tabIndex=0,Z.setAttribute("data-l10n-id",`pdfjs-editor-remove-${t(this,k).editorType}-button`),T(this,Y,un).call(this,Z),Z.addEventListener("click",gt=>{t(this,k)._uiManager.delete()}),t(this,y).append(Z)},V=new WeakSet,dr=function(){const Z=document.createElement("div");return Z.className="divider",Z},l(N,f);let w=N;class m{constructor(Z){l(this,Ft);l(this,Ot);l(this,Mt);l(this,q,null);l(this,tt,null);l(this,bt,void 0);I(this,bt,Z)}show(Z,gt,Rt){const[Pt,qt]=T(this,Ot,ja).call(this,gt,Rt),{style:Kt}=t(this,tt)||I(this,tt,T(this,Ft,Va).call(this));Z.append(t(this,tt)),Kt.insetInlineEnd=`${100*Pt}%`,Kt.top=`calc(${100*qt}% + var(--editor-toolbar-vert-offset))`}hide(){t(this,tt).remove()}}q=new WeakMap,tt=new WeakMap,bt=new WeakMap,Ft=new WeakSet,Va=function(){const Z=I(this,tt,document.createElement("div"));Z.className="editToolbar",Z.setAttribute("role","toolbar"),Z.addEventListener("contextmenu",e.noContextMenu);const gt=I(this,q,document.createElement("div"));return gt.className="buttons",Z.append(gt),T(this,Mt,Ga).call(this),Z},Ot=new WeakSet,ja=function(Z,gt){let Rt=0,Pt=0;for(const qt of Z){const Kt=qt.y+qt.height;if(Kt<Rt)continue;const ie=qt.x+(gt?qt.width:0);if(Kt>Rt){Pt=ie,Rt=Kt;continue}gt?ie>Pt&&(Pt=ie):ie<Pt&&(Pt=ie)}return[gt?1-Pt:Pt,Rt]},Mt=new WeakSet,Ga=function(){const Z=document.createElement("button");Z.className="highlightButton",Z.tabIndex=0,Z.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const gt=document.createElement("span");Z.append(gt),gt.className="visuallyHidden",gt.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label"),Z.addEventListener("contextmenu",e.noContextMenu),Z.addEventListener("click",()=>{t(this,bt).highlightSelection("floating_button")}),t(this,q).append(Z)}},830:(r,p,c)=>{var D,U,Y,at,Q,ur,$,N,q,tt,bt,qa,Ot,_t,Mt,Lt,Et,Z,gt,Rt,Pt,qt,Kt,ie,xe,de,le,be,Vt,ae,Ce,ee,Ee,ne,et,i,n,d,g,o,A,v,E,u,a,h,R,j,G,rt,ot,yt,At,ut,St,P,K,nt,pn,b,za,X,Wa,ft,gn,Dt,Xa,re,Ka,Te,Ya,Fe,pr,Le,gr,F,fr,J,mr,ct,br,vt,Je,jt,xs,Yt,Ja,xt,Qa,Qt,vr,ce,Za,Me,Ri,We,Ar;c.d(p,{AnnotationEditorUIManager:()=>_,ColorManager:()=>C,KeyboardManager:()=>O,bindEvents:()=>x,opacityToHex:()=>W});var e=c(292),w=c(419),m=c(362);function x(Ve,H,dt){for(const Ht of dt)H.addEventListener(Ht,Ve[Ht].bind(Ve))}function W(Ve){return Math.round(Math.min(255,Math.max(1,255*Ve))).toString(16).padStart(2,"0")}class k{constructor(){l(this,D,0)}get id(){return`${e.AnnotationEditorPrefix}${bs(this,D)._++}`}}D=new WeakMap;const V=class V{constructor(){l(this,Q);l(this,U,(0,e.getUuid)());l(this,Y,0);l(this,at,null)}static get _isSVGFittingCanvas(){const H='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',dt=new OffscreenCanvas(1,3).getContext("2d"),Ht=new Image;Ht.src=H;const Ut=Ht.decode().then(()=>(dt.drawImage(Ht,0,0,1,1,0,0,1,3),new Uint32Array(dt.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,e.shadow)(this,"_isSVGFittingCanvas",Ut)}async getFromFile(H){const{lastModified:dt,name:Ht,size:Ut,type:Jt}=H;return T(this,Q,ur).call(this,`${dt}_${Ht}_${Ut}_${Jt}`,H)}async getFromUrl(H){return T(this,Q,ur).call(this,H,H)}async getFromId(H){t(this,at)||I(this,at,new Map);const dt=t(this,at).get(H);return dt?dt.bitmap?(dt.refCounter+=1,dt):dt.file?this.getFromFile(dt.file):this.getFromUrl(dt.url):null}getSvgUrl(H){const dt=t(this,at).get(H);return dt!=null&&dt.isSvg?dt.svgUrl:null}deleteId(H){t(this,at)||I(this,at,new Map);const dt=t(this,at).get(H);dt&&(dt.refCounter-=1,dt.refCounter===0&&(dt.bitmap=null))}isValidId(H){return H.startsWith(`image_${t(this,U)}_`)}};U=new WeakMap,Y=new WeakMap,at=new WeakMap,Q=new WeakSet,ur=async function(H,dt){t(this,at)||I(this,at,new Map);let Ht=t(this,at).get(H);if(Ht===null)return null;if(Ht!=null&&Ht.bitmap)return Ht.refCounter+=1,Ht;try{Ht||(Ht={bitmap:null,id:`image_${t(this,U)}_${bs(this,Y)._++}`,refCounter:0,isSvg:!1});let Ut;if(typeof dt=="string"?(Ht.url=dt,Ut=await(0,w.fetchData)(dt,"blob")):Ut=Ht.file=dt,Ut.type==="image/svg+xml"){const Jt=V._isSVGFittingCanvas,Zt=new FileReader,oe=new Image,ve=new Promise((Re,He)=>{oe.onload=()=>{Ht.bitmap=oe,Ht.isSvg=!0,Re()},Zt.onload=async()=>{const Ke=Ht.svgUrl=Zt.result;oe.src=await Jt?`${Ke}#svgView(preserveAspectRatio(none))`:Ke},oe.onerror=Zt.onerror=He});Zt.readAsDataURL(Ut),await ve}else Ht.bitmap=await createImageBitmap(Ut);Ht.refCounter=1}catch(Ut){console.error(Ut),Ht=null}return t(this,at).set(H,Ht),Ht&&t(this,at).set(Ht.id,Ht),Ht};let y=V;class f{constructor(H=128){l(this,$,[]);l(this,N,!1);l(this,q,void 0);l(this,tt,-1);I(this,q,H)}add({cmd:H,undo:dt,post:Ht,mustExec:Ut,type:Jt=NaN,overwriteIfSameType:Zt=!1,keepUndo:oe=!1}){if(Ut&&H(),t(this,N))return;const ve={cmd:H,undo:dt,post:Ht,type:Jt};if(t(this,tt)===-1){t(this,$).length>0&&(t(this,$).length=0),I(this,tt,0),t(this,$).push(ve);return}if(Zt&&t(this,$)[t(this,tt)].type===Jt){oe&&(ve.undo=t(this,$)[t(this,tt)].undo),t(this,$)[t(this,tt)]=ve;return}const Re=t(this,tt)+1;Re===t(this,q)?t(this,$).splice(0,1):(I(this,tt,Re),Re<t(this,$).length&&t(this,$).splice(Re)),t(this,$).push(ve)}undo(){if(t(this,tt)===-1)return;I(this,N,!0);const{undo:H,post:dt}=t(this,$)[t(this,tt)];H(),dt==null||dt(),I(this,N,!1),I(this,tt,t(this,tt)-1)}redo(){if(t(this,tt)<t(this,$).length-1){I(this,tt,t(this,tt)+1),I(this,N,!0);const{cmd:H,post:dt}=t(this,$)[t(this,tt)];H(),dt==null||dt(),I(this,N,!1)}}hasSomethingToUndo(){return t(this,tt)!==-1}hasSomethingToRedo(){return t(this,tt)<t(this,$).length-1}destroy(){I(this,$,null)}}$=new WeakMap,N=new WeakMap,q=new WeakMap,tt=new WeakMap;class O{constructor(H){l(this,bt);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:dt}=e.FeatureTest.platform;for(const[Ht,Ut,Jt={}]of H)for(const Zt of Ht){const oe=Zt.startsWith("mac+");dt&&oe?(this.callbacks.set(Zt.slice(4),{callback:Ut,options:Jt}),this.allKeys.add(Zt.split("+").at(-1))):!dt&&!oe&&(this.callbacks.set(Zt,{callback:Ut,options:Jt}),this.allKeys.add(Zt.split("+").at(-1)))}}exec(H,dt){if(!this.allKeys.has(dt.key))return;const Ht=this.callbacks.get(T(this,bt,qa).call(this,dt));if(!Ht)return;const{callback:Ut,options:{bubbles:Jt=!1,args:Zt=[],checker:oe=null}}=Ht;oe&&!oe(H,dt)||(Ut.bind(H,...Zt,dt)(),Jt||(dt.stopPropagation(),dt.preventDefault()))}}bt=new WeakSet,qa=function(H){H.altKey&&this.buffer.push("alt"),H.ctrlKey&&this.buffer.push("ctrl"),H.metaKey&&this.buffer.push("meta"),H.shiftKey&&this.buffer.push("shift"),this.buffer.push(H.key);const dt=this.buffer.join("+");return this.buffer.length=0,dt};const Ct=class Ct{get _colors(){const H=new Map([["CanvasText",null],["Canvas",null]]);return(0,w.getColorValues)(H),(0,e.shadow)(this,"_colors",H)}convert(H){const dt=(0,w.getRGB)(H);if(!window.matchMedia("(forced-colors: active)").matches)return dt;for(const[Ht,Ut]of this._colors)if(Ut.every((Jt,Zt)=>Jt===dt[Zt]))return Ct._colorsMapping.get(Ht);return dt}getHexCode(H){const dt=this._colors.get(H);return dt?e.Util.makeHexColor(...dt):H}};me(Ct,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let C=Ct;const ns=class ns{constructor(H,dt,Ht,Ut,Jt,Zt,oe,ve,Re){l(this,nt);l(this,b);l(this,X);l(this,ft);l(this,Dt);l(this,re);l(this,Te);l(this,Fe);l(this,Le);l(this,F);l(this,J);l(this,ct);l(this,vt);l(this,jt);l(this,Yt);l(this,xt);l(this,Qt);l(this,ce);l(this,Me);l(this,We);l(this,Ot,null);l(this,_t,new Map);l(this,Mt,new Map);l(this,Lt,null);l(this,Et,null);l(this,Z,new f);l(this,gt,0);l(this,Rt,new Set);l(this,Pt,null);l(this,qt,null);l(this,Kt,new Set);l(this,ie,!1);l(this,xe,null);l(this,de,null);l(this,le,null);l(this,be,!1);l(this,Vt,null);l(this,ae,new k);l(this,Ce,!1);l(this,ee,!1);l(this,Ee,null);l(this,ne,null);l(this,et,null);l(this,i,e.AnnotationEditorType.NONE);l(this,n,new Set);l(this,d,null);l(this,g,null);l(this,o,null);l(this,A,this.blur.bind(this));l(this,v,this.focus.bind(this));l(this,E,this.copy.bind(this));l(this,u,this.cut.bind(this));l(this,a,this.paste.bind(this));l(this,h,this.keydown.bind(this));l(this,R,this.keyup.bind(this));l(this,j,this.onEditingAction.bind(this));l(this,G,this.onPageChanging.bind(this));l(this,rt,this.onScaleChanging.bind(this));l(this,ot,T(this,X,Wa).bind(this));l(this,yt,this.onRotationChanging.bind(this));l(this,At,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});l(this,ut,[0,0]);l(this,St,null);l(this,P,null);l(this,K,null);I(this,P,H),I(this,K,dt),I(this,Lt,Ht),this._eventBus=Ut,this._eventBus._on("editingaction",t(this,j)),this._eventBus._on("pagechanging",t(this,G)),this._eventBus._on("scalechanging",t(this,rt)),this._eventBus._on("rotationchanging",t(this,yt)),T(this,Dt,Xa).call(this),T(this,Le,gr).call(this),I(this,Et,Jt.annotationStorage),I(this,xe,Jt.filterFactory),I(this,g,Zt),I(this,le,oe||null),I(this,ie,ve),I(this,et,Re||null),this.viewParameters={realScale:w.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}static get _keyboardManager(){const H=ns.prototype,dt=Zt=>t(Zt,P).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&Zt.hasSomethingToControl(),Ht=(Zt,{target:oe})=>{if(oe instanceof HTMLInputElement){const{type:ve}=oe;return ve!=="text"&&ve!=="number"}return!0},Ut=this.TRANSLATE_SMALL,Jt=this.TRANSLATE_BIG;return(0,e.shadow)(this,"_keyboardManager",new O([[["ctrl+a","mac+meta+a"],H.selectAll,{checker:Ht}],[["ctrl+z","mac+meta+z"],H.undo,{checker:Ht}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],H.redo,{checker:Ht}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],H.delete,{checker:Ht}],[["Enter","mac+Enter"],H.addNewEditorFromKeyboard,{checker:(Zt,{target:oe})=>!(oe instanceof HTMLButtonElement)&&t(Zt,P).contains(oe)&&!Zt.isEnterHandled}],[[" ","mac+ "],H.addNewEditorFromKeyboard,{checker:(Zt,{target:oe})=>!(oe instanceof HTMLButtonElement)&&t(Zt,P).contains(document.activeElement)}],[["Escape","mac+Escape"],H.unselectAll],[["ArrowLeft","mac+ArrowLeft"],H.translateSelectedEditors,{args:[-Ut,0],checker:dt}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],H.translateSelectedEditors,{args:[-Jt,0],checker:dt}],[["ArrowRight","mac+ArrowRight"],H.translateSelectedEditors,{args:[Ut,0],checker:dt}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],H.translateSelectedEditors,{args:[Jt,0],checker:dt}],[["ArrowUp","mac+ArrowUp"],H.translateSelectedEditors,{args:[0,-Ut],checker:dt}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],H.translateSelectedEditors,{args:[0,-Jt],checker:dt}],[["ArrowDown","mac+ArrowDown"],H.translateSelectedEditors,{args:[0,Ut],checker:dt}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],H.translateSelectedEditors,{args:[0,Jt],checker:dt}]]))}destroy(){var H,dt;T(this,F,fr).call(this),T(this,Fe,pr).call(this),this._eventBus._off("editingaction",t(this,j)),this._eventBus._off("pagechanging",t(this,G)),this._eventBus._off("scalechanging",t(this,rt)),this._eventBus._off("rotationchanging",t(this,yt));for(const Ht of t(this,Mt).values())Ht.destroy();t(this,Mt).clear(),t(this,_t).clear(),t(this,Kt).clear(),I(this,Ot,null),t(this,n).clear(),t(this,Z).destroy(),(H=t(this,Lt))==null||H.destroy(),(dt=t(this,Vt))==null||dt.hide(),I(this,Vt,null),t(this,de)&&(clearTimeout(t(this,de)),I(this,de,null)),t(this,St)&&(clearTimeout(t(this,St)),I(this,St,null)),T(this,re,Ka).call(this)}async mlGuess(H){var dt;return((dt=t(this,et))==null?void 0:dt.guess(H))||null}get hasMLManager(){return!!t(this,et)}get hcmFilter(){return(0,e.shadow)(this,"hcmFilter",t(this,g)?t(this,xe).addHCMFilter(t(this,g).foreground,t(this,g).background):"none")}get direction(){return(0,e.shadow)(this,"direction",getComputedStyle(t(this,P)).direction)}get highlightColors(){return(0,e.shadow)(this,"highlightColors",t(this,le)?new Map(t(this,le).split(",").map(H=>H.split("=").map(dt=>dt.trim()))):null)}get highlightColorNames(){return(0,e.shadow)(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,H=>H.reverse())):null)}setMainHighlightColorPicker(H){I(this,ne,H)}editAltText(H){var dt;(dt=t(this,Lt))==null||dt.editAltText(this,H)}onPageChanging({pageNumber:H}){I(this,gt,H-1)}focusMainContainer(){t(this,P).focus()}findParent(H,dt){for(const Ht of t(this,Mt).values()){const{x:Ut,y:Jt,width:Zt,height:oe}=Ht.div.getBoundingClientRect();if(H>=Ut&&H<=Ut+Zt&&dt>=Jt&&dt<=Jt+oe)return Ht}return null}disableUserSelect(H=!1){t(this,K).classList.toggle("noUserSelect",H)}addShouldRescale(H){t(this,Kt).add(H)}removeShouldRescale(H){t(this,Kt).delete(H)}onScaleChanging({scale:H}){this.commitOrRemove(),this.viewParameters.realScale=H*w.PixelsPerInch.PDF_TO_CSS_UNITS;for(const dt of t(this,Kt))dt.onScaleChanging()}onRotationChanging({pagesRotation:H}){this.commitOrRemove(),this.viewParameters.rotation=H}highlightSelection(H=""){const dt=document.getSelection();if(!dt||dt.isCollapsed)return;const{anchorNode:Ht,anchorOffset:Ut,focusNode:Jt,focusOffset:Zt}=dt,oe=dt.toString(),ve=T(this,nt,pn).call(this,dt).closest(".textLayer"),Re=this.getSelectionBoxes(ve);if(Re){dt.empty(),t(this,i)===e.AnnotationEditorType.NONE&&(this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e.AnnotationEditorType.HIGHLIGHT}),this.showAllEditors("highlight",!0,!0));for(const He of t(this,Mt).values())if(He.hasTextLayer(ve)){He.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:H,boxes:Re,anchorNode:Ht,anchorOffset:Ut,focusNode:Jt,focusOffset:Zt,text:oe});break}}}addToAnnotationStorage(H){!H.isEmpty()&&t(this,Et)&&!t(this,Et).has(H.id)&&t(this,Et).setValue(H.id,H)}blur(){if(this.isShiftKeyDown=!1,t(this,be)&&(I(this,be,!1),T(this,ft,gn).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:H}=document;for(const dt of t(this,n))if(dt.div.contains(H)){I(this,Ee,[dt,H]),dt._focusEventsAllowed=!1;break}}focus(){if(!t(this,Ee))return;const[H,dt]=t(this,Ee);I(this,Ee,null),dt.addEventListener("focusin",()=>{H._focusEventsAllowed=!0},{once:!0}),dt.focus()}addEditListeners(){T(this,Le,gr).call(this),T(this,J,mr).call(this)}removeEditListeners(){T(this,F,fr).call(this),T(this,ct,br).call(this)}copy(H){var Ht;if(H.preventDefault(),(Ht=t(this,Ot))==null||Ht.commitOrRemove(),!this.hasSelection)return;const dt=[];for(const Ut of t(this,n)){const Jt=Ut.serialize(!0);Jt&&dt.push(Jt)}dt.length!==0&&H.clipboardData.setData("application/pdfjs",JSON.stringify(dt))}cut(H){this.copy(H),this.delete()}paste(H){H.preventDefault();const{clipboardData:dt}=H;for(const Jt of dt.items)for(const Zt of t(this,qt))if(Zt.isHandlingMimeForPasting(Jt.type)){Zt.paste(Jt,this.currentLayer);return}let Ht=dt.getData("application/pdfjs");if(!Ht)return;try{Ht=JSON.parse(Ht)}catch(Jt){(0,e.warn)(`paste: "${Jt.message}".`);return}if(!Array.isArray(Ht))return;this.unselectAll();const Ut=this.currentLayer;try{const Jt=[];for(const ve of Ht){const Re=Ut.deserialize(ve);if(!Re)return;Jt.push(Re)}const Zt=()=>{for(const ve of Jt)T(this,Qt,vr).call(this,ve);T(this,We,Ar).call(this,Jt)},oe=()=>{for(const ve of Jt)ve.remove()};this.addCommands({cmd:Zt,undo:oe,mustExec:!0})}catch(Jt){(0,e.warn)(`paste: "${Jt.message}".`)}}keydown(H){!this.isShiftKeyDown&&H.key==="Shift"&&(this.isShiftKeyDown=!0),t(this,i)!==e.AnnotationEditorType.NONE&&!this.isEditorHandlingKeyboard&&ns._keyboardManager.exec(this,H)}keyup(H){this.isShiftKeyDown&&H.key==="Shift"&&(this.isShiftKeyDown=!1,t(this,be)&&(I(this,be,!1),T(this,ft,gn).call(this,"main_toolbar")))}onEditingAction({name:H}){switch(H){case"undo":case"redo":case"delete":case"selectAll":this[H]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(H){H?(T(this,Te,Ya).call(this),T(this,J,mr).call(this),T(this,vt,Je).call(this,{isEditing:t(this,i)!==e.AnnotationEditorType.NONE,isEmpty:T(this,Me,Ri).call(this),hasSomethingToUndo:t(this,Z).hasSomethingToUndo(),hasSomethingToRedo:t(this,Z).hasSomethingToRedo(),hasSelectedEditor:!1})):(T(this,Fe,pr).call(this),T(this,ct,br).call(this),T(this,vt,Je).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(H){if(!t(this,qt)){I(this,qt,H);for(const dt of t(this,qt))T(this,jt,xs).call(this,dt.defaultPropertiesToUpdate)}}getId(){return t(this,ae).id}get currentLayer(){return t(this,Mt).get(t(this,gt))}getLayer(H){return t(this,Mt).get(H)}get currentPageIndex(){return t(this,gt)}addLayer(H){t(this,Mt).set(H.pageIndex,H),t(this,Ce)?H.enable():H.disable()}removeLayer(H){t(this,Mt).delete(H.pageIndex)}updateMode(H,dt=null,Ht=!1){if(t(this,i)!==H){if(I(this,i,H),H===e.AnnotationEditorType.NONE){this.setEditingState(!1),T(this,xt,Qa).call(this);return}this.setEditingState(!0),T(this,Yt,Ja).call(this),this.unselectAll();for(const Ut of t(this,Mt).values())Ut.updateMode(H);if(!dt&&Ht){this.addNewEditorFromKeyboard();return}if(dt){for(const Ut of t(this,_t).values())if(Ut.annotationElementId===dt){this.setSelected(Ut),Ut.enterInEditMode();break}}}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(H){H!==t(this,i)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:H})}updateParams(H,dt){var Ht;if(t(this,qt)){switch(H){case e.AnnotationEditorParamsType.CREATE:this.currentLayer.addNewEditor();return;case e.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:(Ht=t(this,ne))==null||Ht.updateColor(dt);break;case e.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(t(this,o)||I(this,o,new Map)).set(H,dt),this.showAllEditors("highlight",dt);break}for(const Ut of t(this,n))Ut.updateParams(H,dt);for(const Ut of t(this,qt))Ut.updateDefaultParams(H,dt)}}showAllEditors(H,dt,Ht=!1){var Ut;for(const Jt of t(this,_t).values())Jt.editorType===H&&Jt.show(dt);(((Ut=t(this,o))==null?void 0:Ut.get(e.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL))??!0)!==dt&&T(this,jt,xs).call(this,[[e.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL,dt]])}enableWaiting(H=!1){if(t(this,ee)!==H){I(this,ee,H);for(const dt of t(this,Mt).values())H?dt.disableClick():dt.enableClick(),dt.div.classList.toggle("waiting",H)}}getEditors(H){const dt=[];for(const Ht of t(this,_t).values())Ht.pageIndex===H&&dt.push(Ht);return dt}getEditor(H){return t(this,_t).get(H)}addEditor(H){t(this,_t).set(H.id,H)}removeEditor(H){var dt;H.div.contains(document.activeElement)&&(t(this,de)&&clearTimeout(t(this,de)),I(this,de,setTimeout(()=>{this.focusMainContainer(),I(this,de,null)},0))),t(this,_t).delete(H.id),this.unselect(H),(!H.annotationElementId||!t(this,Rt).has(H.annotationElementId))&&((dt=t(this,Et))==null||dt.remove(H.id))}addDeletedAnnotationElement(H){t(this,Rt).add(H.annotationElementId),H.deleted=!0}isDeletedAnnotationElement(H){return t(this,Rt).has(H)}removeDeletedAnnotationElement(H){t(this,Rt).delete(H.annotationElementId),H.deleted=!1}setActiveEditor(H){t(this,Ot)!==H&&(I(this,Ot,H),H&&T(this,jt,xs).call(this,H.propertiesToUpdate))}updateUI(H){t(this,ce,Za)===H&&T(this,jt,xs).call(this,H.propertiesToUpdate)}toggleSelected(H){if(t(this,n).has(H)){t(this,n).delete(H),H.unselect(),T(this,vt,Je).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,n).add(H),H.select(),T(this,jt,xs).call(this,H.propertiesToUpdate),T(this,vt,Je).call(this,{hasSelectedEditor:!0})}setSelected(H){for(const dt of t(this,n))dt!==H&&dt.unselect();t(this,n).clear(),t(this,n).add(H),H.select(),T(this,jt,xs).call(this,H.propertiesToUpdate),T(this,vt,Je).call(this,{hasSelectedEditor:!0})}isSelected(H){return t(this,n).has(H)}get firstSelectedEditor(){return t(this,n).values().next().value}unselect(H){H.unselect(),t(this,n).delete(H),T(this,vt,Je).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,n).size!==0}get isEnterHandled(){return t(this,n).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){t(this,Z).undo(),T(this,vt,Je).call(this,{hasSomethingToUndo:t(this,Z).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:T(this,Me,Ri).call(this)})}redo(){t(this,Z).redo(),T(this,vt,Je).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,Z).hasSomethingToRedo(),isEmpty:T(this,Me,Ri).call(this)})}addCommands(H){t(this,Z).add(H),T(this,vt,Je).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:T(this,Me,Ri).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const H=[...t(this,n)],dt=()=>{for(const Ut of H)Ut.remove()},Ht=()=>{for(const Ut of H)T(this,Qt,vr).call(this,Ut)};this.addCommands({cmd:dt,undo:Ht,mustExec:!0})}commitOrRemove(){var H;(H=t(this,Ot))==null||H.commitOrRemove()}hasSomethingToControl(){return t(this,Ot)||this.hasSelection}selectAll(){for(const H of t(this,n))H.commit();T(this,We,Ar).call(this,t(this,_t).values())}unselectAll(){if(!(t(this,Ot)&&(t(this,Ot).commitOrRemove(),t(this,i)!==e.AnnotationEditorType.NONE))&&this.hasSelection){for(const H of t(this,n))H.unselect();t(this,n).clear(),T(this,vt,Je).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(H,dt,Ht=!1){if(Ht||this.commitOrRemove(),!this.hasSelection)return;t(this,ut)[0]+=H,t(this,ut)[1]+=dt;const[Ut,Jt]=t(this,ut),Zt=[...t(this,n)];t(this,St)&&clearTimeout(t(this,St)),I(this,St,setTimeout(()=>{I(this,St,null),t(this,ut)[0]=t(this,ut)[1]=0,this.addCommands({cmd:()=>{for(const ve of Zt)t(this,_t).has(ve.id)&&ve.translateInPage(Ut,Jt)},undo:()=>{for(const ve of Zt)t(this,_t).has(ve.id)&&ve.translateInPage(-Ut,-Jt)},mustExec:!1})},1e3));for(const ve of Zt)ve.translateInPage(H,dt)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),I(this,Pt,new Map);for(const H of t(this,n))t(this,Pt).set(H,{savedX:H.x,savedY:H.y,savedPageIndex:H.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,Pt))return!1;this.disableUserSelect(!1);const H=t(this,Pt);I(this,Pt,null);let dt=!1;for(const[{x:Ut,y:Jt,pageIndex:Zt},oe]of H)oe.newX=Ut,oe.newY=Jt,oe.newPageIndex=Zt,dt||(dt=Ut!==oe.savedX||Jt!==oe.savedY||Zt!==oe.savedPageIndex);if(!dt)return!1;const Ht=(Ut,Jt,Zt,oe)=>{if(t(this,_t).has(Ut.id)){const ve=t(this,Mt).get(oe);ve?Ut._setParentAndPosition(ve,Jt,Zt):(Ut.pageIndex=oe,Ut.x=Jt,Ut.y=Zt)}};return this.addCommands({cmd:()=>{for(const[Ut,{newX:Jt,newY:Zt,newPageIndex:oe}]of H)Ht(Ut,Jt,Zt,oe)},undo:()=>{for(const[Ut,{savedX:Jt,savedY:Zt,savedPageIndex:oe}]of H)Ht(Ut,Jt,Zt,oe)},mustExec:!0}),!0}dragSelectedEditors(H,dt){if(t(this,Pt))for(const Ht of t(this,Pt).keys())Ht.drag(H,dt)}rebuild(H){if(H.parent===null){const dt=this.getLayer(H.pageIndex);dt?(dt.changeParent(H),dt.addOrRebuild(H)):(this.addEditor(H),this.addToAnnotationStorage(H),H.rebuild())}else H.parent.addOrRebuild(H)}get isEditorHandlingKeyboard(){var H;return((H=this.getActive())==null?void 0:H.shouldGetKeyboardEvents())||t(this,n).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(H){return t(this,Ot)===H}getActive(){return t(this,Ot)}getMode(){return t(this,i)}get imageManager(){return(0,e.shadow)(this,"imageManager",new y)}getSelectionBoxes(H){if(!H)return null;const dt=document.getSelection();for(let Re=0,He=dt.rangeCount;Re<He;Re++)if(!H.contains(dt.getRangeAt(Re).commonAncestorContainer))return null;const{x:Ht,y:Ut,width:Jt,height:Zt}=H.getBoundingClientRect();let oe;switch(H.getAttribute("data-main-rotation")){case"90":oe=(Re,He,Ke,qe)=>({x:(He-Ut)/Zt,y:1-(Re+Ke-Ht)/Jt,width:qe/Zt,height:Ke/Jt});break;case"180":oe=(Re,He,Ke,qe)=>({x:1-(Re+Ke-Ht)/Jt,y:1-(He+qe-Ut)/Zt,width:Ke/Jt,height:qe/Zt});break;case"270":oe=(Re,He,Ke,qe)=>({x:1-(He+qe-Ut)/Zt,y:(Re-Ht)/Jt,width:qe/Zt,height:Ke/Jt});break;default:oe=(Re,He,Ke,qe)=>({x:(Re-Ht)/Jt,y:(He-Ut)/Zt,width:Ke/Jt,height:qe/Zt});break}const ve=[];for(let Re=0,He=dt.rangeCount;Re<He;Re++){const Ke=dt.getRangeAt(Re);if(!Ke.collapsed)for(const{x:qe,y:sh,width:ks,height:Vr}of Ke.getClientRects())ks===0||Vr===0||ve.push(oe(qe,sh,ks,Vr))}return ve.length===0?null:ve}};Ot=new WeakMap,_t=new WeakMap,Mt=new WeakMap,Lt=new WeakMap,Et=new WeakMap,Z=new WeakMap,gt=new WeakMap,Rt=new WeakMap,Pt=new WeakMap,qt=new WeakMap,Kt=new WeakMap,ie=new WeakMap,xe=new WeakMap,de=new WeakMap,le=new WeakMap,be=new WeakMap,Vt=new WeakMap,ae=new WeakMap,Ce=new WeakMap,ee=new WeakMap,Ee=new WeakMap,ne=new WeakMap,et=new WeakMap,i=new WeakMap,n=new WeakMap,d=new WeakMap,g=new WeakMap,o=new WeakMap,A=new WeakMap,v=new WeakMap,E=new WeakMap,u=new WeakMap,a=new WeakMap,h=new WeakMap,R=new WeakMap,j=new WeakMap,G=new WeakMap,rt=new WeakMap,ot=new WeakMap,yt=new WeakMap,At=new WeakMap,ut=new WeakMap,St=new WeakMap,P=new WeakMap,K=new WeakMap,nt=new WeakSet,pn=function({anchorNode:H}){return H.nodeType===Node.TEXT_NODE?H.parentElement:H},b=new WeakSet,za=function(){const H=document.getSelection();if(!H||H.isCollapsed)return;const dt=T(this,nt,pn).call(this,H).closest(".textLayer"),Ht=this.getSelectionBoxes(dt);Ht&&(t(this,Vt)||I(this,Vt,new m.HighlightToolbar(this)),t(this,Vt).show(dt,Ht,this.direction==="ltr"))},X=new WeakSet,Wa=function(){var Ht,Ut,Jt;const H=document.getSelection();if(!H||H.isCollapsed){t(this,d)&&((Ht=t(this,Vt))==null||Ht.hide(),I(this,d,null),T(this,vt,Je).call(this,{hasSelectedText:!1}));return}const{anchorNode:dt}=H;if(dt!==t(this,d)){if(!T(this,nt,pn).call(this,H).closest(".textLayer")){t(this,d)&&((Ut=t(this,Vt))==null||Ut.hide(),I(this,d,null),T(this,vt,Je).call(this,{hasSelectedText:!1}));return}if((Jt=t(this,Vt))==null||Jt.hide(),I(this,d,dt),T(this,vt,Je).call(this,{hasSelectedText:!0}),!(t(this,i)!==e.AnnotationEditorType.HIGHLIGHT&&t(this,i)!==e.AnnotationEditorType.NONE)&&(t(this,i)===e.AnnotationEditorType.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),I(this,be,this.isShiftKeyDown),!this.isShiftKeyDown)){const Zt=oe=>{oe.type==="pointerup"&&oe.button!==0||(window.removeEventListener("pointerup",Zt),window.removeEventListener("blur",Zt),oe.type==="pointerup"&&T(this,ft,gn).call(this,"main_toolbar"))};window.addEventListener("pointerup",Zt),window.addEventListener("blur",Zt)}}},ft=new WeakSet,gn=function(H=""){t(this,i)===e.AnnotationEditorType.HIGHLIGHT?this.highlightSelection(H):t(this,ie)&&T(this,b,za).call(this)},Dt=new WeakSet,Xa=function(){document.addEventListener("selectionchange",t(this,ot))},re=new WeakSet,Ka=function(){document.removeEventListener("selectionchange",t(this,ot))},Te=new WeakSet,Ya=function(){window.addEventListener("focus",t(this,v)),window.addEventListener("blur",t(this,A))},Fe=new WeakSet,pr=function(){window.removeEventListener("focus",t(this,v)),window.removeEventListener("blur",t(this,A))},Le=new WeakSet,gr=function(){window.addEventListener("keydown",t(this,h)),window.addEventListener("keyup",t(this,R))},F=new WeakSet,fr=function(){window.removeEventListener("keydown",t(this,h)),window.removeEventListener("keyup",t(this,R))},J=new WeakSet,mr=function(){document.addEventListener("copy",t(this,E)),document.addEventListener("cut",t(this,u)),document.addEventListener("paste",t(this,a))},ct=new WeakSet,br=function(){document.removeEventListener("copy",t(this,E)),document.removeEventListener("cut",t(this,u)),document.removeEventListener("paste",t(this,a))},vt=new WeakSet,Je=function(H){Object.entries(H).some(([dt,Ht])=>t(this,At)[dt]!==Ht)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,At),H)}),t(this,i)===e.AnnotationEditorType.HIGHLIGHT&&H.hasSelectedEditor===!1&&T(this,jt,xs).call(this,[[e.AnnotationEditorParamsType.HIGHLIGHT_FREE,!0]]))},jt=new WeakSet,xs=function(H){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:H})},Yt=new WeakSet,Ja=function(){if(!t(this,Ce)){I(this,Ce,!0);for(const H of t(this,Mt).values())H.enable();for(const H of t(this,_t).values())H.enable()}},xt=new WeakSet,Qa=function(){if(this.unselectAll(),t(this,Ce)){I(this,Ce,!1);for(const H of t(this,Mt).values())H.disable();for(const H of t(this,_t).values())H.disable()}},Qt=new WeakSet,vr=function(H){const dt=t(this,Mt).get(H.pageIndex);dt?dt.addOrRebuild(H):(this.addEditor(H),this.addToAnnotationStorage(H))},ce=new WeakSet,Za=function(){let H=null;for(H of t(this,n));return H},Me=new WeakSet,Ri=function(){if(t(this,_t).size===0)return!0;if(t(this,_t).size===1)for(const H of t(this,_t).values())return H.isEmpty();return!1},We=new WeakSet,Ar=function(H){for(const dt of t(this,n))dt.unselect();t(this,n).clear();for(const dt of H)dt.isEmpty()||(t(this,n).add(dt),dt.select());T(this,vt,Je).call(this,{hasSelectedEditor:this.hasSelection})},me(ns,"TRANSLATE_SMALL",1),me(ns,"TRANSLATE_BIG",10);let _=ns},94:(r,p,c)=>{c.d(p,{PDFFetchStream:()=>k});var e=c(292),w=c(490);function m(O,C,_){return{method:"GET",headers:O,signal:_.signal,mode:"cors",credentials:C?"include":"same-origin",redirect:"follow"}}function x(O){const C=new Headers;for(const _ in O){const D=O[_];D!==void 0&&C.append(_,D)}return C}function W(O){return O instanceof Uint8Array?O.buffer:O instanceof ArrayBuffer?O:((0,e.warn)(`getArrayBuffer - unexpected data format: ${O}`),new Uint8Array(O).buffer)}class k{constructor(C){this.source=C,this.isHttp=/^https?:/i.test(C.url),this.httpHeaders=this.isHttp&&C.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var C;return((C=this._fullRequestReader)==null?void 0:C._loaded)??0}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new y(this),this._fullRequestReader}getRangeReader(C,_){if(_<=this._progressiveDataLength)return null;const D=new f(this,C,_);return this._rangeRequestReaders.push(D),D}cancelAllRequests(C){var _;(_=this._fullRequestReader)==null||_.cancel(C);for(const D of this._rangeRequestReaders.slice(0))D.cancel(C)}}class y{constructor(C){this._stream=C,this._reader=null,this._loaded=0,this._filename=null;const _=C.source;this._withCredentials=_.withCredentials||!1,this._contentLength=_.length,this._headersCapability=Promise.withResolvers(),this._disableRange=_.disableRange||!1,this._rangeChunkSize=_.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!_.disableStream,this._isRangeSupported=!_.disableRange,this._headers=x(this._stream.httpHeaders);const D=_.url;fetch(D,m(this._headers,this._withCredentials,this._abortController)).then(U=>{if(!(0,w.validateResponseStatus)(U.status))throw(0,w.createResponseStatusError)(U.status,D);this._reader=U.body.getReader(),this._headersCapability.resolve();const Y=L=>U.headers.get(L),{allowRangeRequests:at,suggestedLength:Q}=(0,w.validateRangeRequestCapabilities)({getResponseHeader:Y,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=at,this._contentLength=Q||this._contentLength,this._filename=(0,w.extractFilenameFromHeader)(Y),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new e.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var D;await this._headersCapability.promise;const{value:C,done:_}=await this._reader.read();return _?{value:C,done:_}:(this._loaded+=C.byteLength,(D=this.onProgress)==null||D.call(this,{loaded:this._loaded,total:this._contentLength}),{value:W(C),done:!1})}cancel(C){var _;(_=this._reader)==null||_.cancel(C),this._abortController.abort()}}class f{constructor(C,_,D){this._stream=C,this._reader=null,this._loaded=0;const U=C.source;this._withCredentials=U.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!U.disableStream,this._abortController=new AbortController,this._headers=x(this._stream.httpHeaders),this._headers.append("Range",`bytes=${_}-${D-1}`);const Y=U.url;fetch(Y,m(this._headers,this._withCredentials,this._abortController)).then(at=>{if(!(0,w.validateResponseStatus)(at.status))throw(0,w.createResponseStatusError)(at.status,Y);this._readCapability.resolve(),this._reader=at.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var D;await this._readCapability.promise;const{value:C,done:_}=await this._reader.read();return _?{value:C,done:_}:(this._loaded+=C.byteLength,(D=this.onProgress)==null||D.call(this,{loaded:this._loaded}),{value:W(C),done:!1})}cancel(C){var _;(_=this._reader)==null||_.cancel(C),this._abortController.abort()}}},10:(r,p,c)=>{var x;c.d(p,{FontFaceObject:()=>m,FontLoader:()=>w});var e=c(292);class w{constructor({ownerDocument:k=globalThis.document,styleElement:y=null}){l(this,x,new Set);this._document=k,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(k){this.nativeFontFaces.add(k),this._document.fonts.add(k)}removeNativeFontFace(k){this.nativeFontFaces.delete(k),this._document.fonts.delete(k)}insertRule(k){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const y=this.styleElement.sheet;y.insertRule(k,y.cssRules.length)}clear(){for(const k of this.nativeFontFaces)this._document.fonts.delete(k);this.nativeFontFaces.clear(),t(this,x).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:k,_inspectFont:y}){if(!(!k||t(this,x).has(k.loadedName))){if((0,e.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:f,src:O,style:C}=k,_=new FontFace(f,O,C);this.addNativeFontFace(_);try{await _.load(),t(this,x).add(f),y==null||y(k)}catch{(0,e.warn)(`Cannot load system font: ${k.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(_)}return}(0,e.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(k){if(k.attached||k.missingFile&&!k.systemFontInfo)return;if(k.attached=!0,k.systemFontInfo){await this.loadSystemFont(k);return}if(this.isFontLoadingAPISupported){const f=k.createNativeFontFace();if(f){this.addNativeFontFace(f);try{await f.loaded}catch(O){throw(0,e.warn)(`Failed to load font '${f.family}': '${O}'.`),k.disableFontFace=!0,O}}return}const y=k.createFontFaceRule();if(y){if(this.insertRule(y),this.isSyncFontLoadingSupported)return;await new Promise(f=>{const O=this._queueLoadingCallback(f);this._prepareFontLoadEvent(k,O)})}}get isFontLoadingAPISupported(){var y;const k=!!((y=this._document)!=null&&y.fonts);return(0,e.shadow)(this,"isFontLoadingAPISupported",k)}get isSyncFontLoadingSupported(){let k=!1;return(e.isNodeJS||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(k=!0),(0,e.shadow)(this,"isSyncFontLoadingSupported",k)}_queueLoadingCallback(k){function y(){for((0,e.assert)(!O.done,"completeRequest() cannot be called twice."),O.done=!0;f.length>0&&f[0].done;){const C=f.shift();setTimeout(C.callback,0)}}const{loadingRequests:f}=this,O={done:!1,complete:y,callback:k};return f.push(O),O}get _loadTestFont(){const k=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,e.shadow)(this,"_loadTestFont",k)}_prepareFontLoadEvent(k,y){function f(Ft,Ct){return Ft.charCodeAt(Ct)<<24|Ft.charCodeAt(Ct+1)<<16|Ft.charCodeAt(Ct+2)<<8|Ft.charCodeAt(Ct+3)&255}function O(Ft,Ct,Ot,_t){const Mt=Ft.substring(0,Ct),Lt=Ft.substring(Ct+Ot);return Mt+_t+Lt}let C,_;const D=this._document.createElement("canvas");D.width=1,D.height=1;const U=D.getContext("2d");let Y=0;function at(Ft,Ct){if(++Y>30){(0,e.warn)("Load test font never loaded."),Ct();return}if(U.font="30px "+Ft,U.fillText(".",0,20),U.getImageData(0,0,1,1).data[3]>0){Ct();return}setTimeout(at.bind(null,Ft,Ct))}const Q=`lt${Date.now()}${this.loadTestFontId++}`;let L=this._loadTestFont;L=O(L,976,Q.length,Q);const V=16,$=1482184792;let N=f(L,V);for(C=0,_=Q.length-3;C<_;C+=4)N=N-$+f(Q,C)|0;C<Q.length&&(N=N-$+f(Q+"XXX",C)|0),L=O(L,V,4,(0,e.string32)(N));const q=`url(data:font/opentype;base64,${btoa(L)});`,tt=`@font-face {font-family:"${Q}";src:${q}}`;this.insertRule(tt);const bt=this._document.createElement("div");bt.style.visibility="hidden",bt.style.width=bt.style.height="10px",bt.style.position="absolute",bt.style.top=bt.style.left="0px";for(const Ft of[k.loadedName,Q]){const Ct=this._document.createElement("span");Ct.textContent="Hi",Ct.style.fontFamily=Ft,bt.append(Ct)}this._document.body.append(bt),at(Q,()=>{bt.remove(),y.complete()})}}x=new WeakMap;class m{constructor(k,{isEvalSupported:y=!0,disableFontFace:f=!1,ignoreErrors:O=!1,inspectFont:C=null}){this.compiledGlyphs=Object.create(null);for(const _ in k)this[_]=k[_];this.isEvalSupported=y!==!1,this.disableFontFace=f===!0,this.ignoreErrors=O===!0,this._inspectFont=C}createNativeFontFace(){var y;if(!this.data||this.disableFontFace)return null;let k;if(!this.cssFontInfo)k=new FontFace(this.loadedName,this.data,{});else{const f={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(f.style=`oblique ${this.cssFontInfo.italicAngle}deg`),k=new FontFace(this.cssFontInfo.fontFamily,this.data,f)}return(y=this._inspectFont)==null||y.call(this,this),k}createFontFaceRule(){var O;if(!this.data||this.disableFontFace)return null;const k=(0,e.bytesToString)(this.data),y=`url(data:${this.mimetype};base64,${btoa(k)});`;let f;if(!this.cssFontInfo)f=`@font-face {font-family:"${this.loadedName}";src:${y}}`;else{let C=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(C+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),f=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${C}src:${y}}`}return(O=this._inspectFont)==null||O.call(this,this,y),f}getPathGenerator(k,y){if(this.compiledGlyphs[y]!==void 0)return this.compiledGlyphs[y];let f;try{f=k.get(this.loadedName+"_path_"+y)}catch(O){if(!this.ignoreErrors)throw O;return(0,e.warn)(`getPathGenerator - ignoring character: "${O}".`),this.compiledGlyphs[y]=function(C,_){}}if(this.isEvalSupported&&e.FeatureTest.isEvalSupported){const O=[];for(const C of f){const _=C.args!==void 0?C.args.join(","):"";O.push("c.",C.cmd,"(",_,`);
`)}return this.compiledGlyphs[y]=new Function("c","size",O.join(""))}return this.compiledGlyphs[y]=function(O,C){for(const _ of f)_.cmd==="scale"&&(_.args=[C,-C]),O[_.cmd].apply(O,_.args)}}}},62:(r,p,c)=>{var m,x;c.d(p,{Metadata:()=>w});var e=c(292);class w{constructor({parsedData:k,rawData:y}){l(this,m,void 0);l(this,x,void 0);I(this,m,k),I(this,x,y)}getRaw(){return t(this,x)}get(k){return t(this,m).get(k)??null}getAll(){return(0,e.objectFromMap)(t(this,m))}has(k){return t(this,m).has(k)}}m=new WeakMap,x=new WeakMap},457:(r,p,c)=>{c.d(p,{PDFNetworkStream:()=>y});var e=c(292),w=c(490);const m=200,x=206;function W(C){const _=C.response;return typeof _!="string"?_:(0,e.stringToBytes)(_).buffer}class k{constructor(_,D={}){this.url=_,this.isHttp=/^https?:/i.test(_),this.httpHeaders=this.isHttp&&D.httpHeaders||Object.create(null),this.withCredentials=D.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(_,D,U){const Y={begin:_,end:D};for(const at in U)Y[at]=U[at];return this.request(Y)}requestFull(_){return this.request(_)}request(_){const D=new XMLHttpRequest,U=this.currXhrId++,Y=this.pendingRequests[U]={xhr:D};D.open("GET",this.url),D.withCredentials=this.withCredentials;for(const at in this.httpHeaders){const Q=this.httpHeaders[at];Q!==void 0&&D.setRequestHeader(at,Q)}return this.isHttp&&"begin"in _&&"end"in _?(D.setRequestHeader("Range",`bytes=${_.begin}-${_.end-1}`),Y.expectedStatus=x):Y.expectedStatus=m,D.responseType="arraybuffer",_.onError&&(D.onerror=function(at){_.onError(D.status)}),D.onreadystatechange=this.onStateChange.bind(this,U),D.onprogress=this.onProgress.bind(this,U),Y.onHeadersReceived=_.onHeadersReceived,Y.onDone=_.onDone,Y.onError=_.onError,Y.onProgress=_.onProgress,D.send(null),U}onProgress(_,D){var Y;const U=this.pendingRequests[_];U&&((Y=U.onProgress)==null||Y.call(U,D))}onStateChange(_,D){var L,V,$;const U=this.pendingRequests[_];if(!U)return;const Y=U.xhr;if(Y.readyState>=2&&U.onHeadersReceived&&(U.onHeadersReceived(),delete U.onHeadersReceived),Y.readyState!==4||!(_ in this.pendingRequests))return;if(delete this.pendingRequests[_],Y.status===0&&this.isHttp){(L=U.onError)==null||L.call(U,Y.status);return}const at=Y.status||m;if(!(at===m&&U.expectedStatus===x)&&at!==U.expectedStatus){(V=U.onError)==null||V.call(U,Y.status);return}const Q=W(Y);if(at===x){const N=Y.getResponseHeader("Content-Range"),q=/bytes (\d+)-(\d+)\/(\d+)/.exec(N);U.onDone({begin:parseInt(q[1],10),chunk:Q})}else Q?U.onDone({begin:0,chunk:Q}):($=U.onError)==null||$.call(U,Y.status)}getRequestXhr(_){return this.pendingRequests[_].xhr}isPendingRequest(_){return _ in this.pendingRequests}abortRequest(_){const D=this.pendingRequests[_].xhr;delete this.pendingRequests[_],D.abort()}}class y{constructor(_){this._source=_,this._manager=new k(_.url,{httpHeaders:_.httpHeaders,withCredentials:_.withCredentials}),this._rangeChunkSize=_.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(_){const D=this._rangeRequestReaders.indexOf(_);D>=0&&this._rangeRequestReaders.splice(D,1)}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new f(this._manager,this._source),this._fullRequestReader}getRangeReader(_,D){const U=new O(this._manager,_,D);return U.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(U),U}cancelAllRequests(_){var D;(D=this._fullRequestReader)==null||D.cancel(_);for(const U of this._rangeRequestReaders.slice(0))U.cancel(_)}}class f{constructor(_,D){this._manager=_;const U={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=D.url,this._fullRequestId=_.requestFull(U),this._headersReceivedCapability=Promise.withResolvers(),this._disableRange=D.disableRange||!1,this._contentLength=D.length,this._rangeChunkSize=D.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const _=this._fullRequestId,D=this._manager.getRequestXhr(_),U=Q=>D.getResponseHeader(Q),{allowRangeRequests:Y,suggestedLength:at}=(0,w.validateRangeRequestCapabilities)({getResponseHeader:U,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});Y&&(this._isRangeSupported=!0),this._contentLength=at||this._contentLength,this._filename=(0,w.extractFilenameFromHeader)(U),this._isRangeSupported&&this._manager.abortRequest(_),this._headersReceivedCapability.resolve()}_onDone(_){if(_&&(this._requests.length>0?this._requests.shift().resolve({value:_.chunk,done:!1}):this._cachedChunks.push(_.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const D of this._requests)D.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(_){this._storedError=(0,w.createResponseStatusError)(_,this._url),this._headersReceivedCapability.reject(this._storedError);for(const D of this._requests)D.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(_){var D;(D=this.onProgress)==null||D.call(this,{loaded:_.loaded,total:_.lengthComputable?_.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const _=Promise.withResolvers();return this._requests.push(_),_.promise}cancel(_){this._done=!0,this._headersReceivedCapability.reject(_);for(const D of this._requests)D.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class O{constructor(_,D,U){this._manager=_;const Y={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=_.url,this._requestId=_.requestRange(D,U,Y),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var _;(_=this.onClosed)==null||_.call(this,this)}_onDone(_){const D=_.chunk;this._requests.length>0?this._requests.shift().resolve({value:D,done:!1}):this._queuedChunk=D,this._done=!0;for(const U of this._requests)U.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(_){this._storedError=(0,w.createResponseStatusError)(_,this._url);for(const D of this._requests)D.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(_){var D;this.isStreamingSupported||((D=this.onProgress)==null||D.call(this,{loaded:_.loaded}))}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const D=this._queuedChunk;return this._queuedChunk=null,{value:D,done:!1}}if(this._done)return{value:void 0,done:!0};const _=Promise.withResolvers();return this._requests.push(_),_.promise}cancel(_){this._done=!0;for(const D of this._requests)D.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},490:(r,p,c)=>{c.d(p,{createResponseStatusError:()=>k,extractFilenameFromHeader:()=>W,validateRangeRequestCapabilities:()=>x,validateResponseStatus:()=>y});var e=c(292);function w(f){let O=!0,C=_("filename\\*","i").exec(f);if(C){C=C[1];let V=at(C);return V=unescape(V),V=Q(V),V=L(V),U(V)}if(C=Y(f),C){const V=L(C);return U(V)}if(C=_("filename","i").exec(f),C){C=C[1];let V=at(C);return V=L(V),U(V)}function _(V,$){return new RegExp("(?:^|;)\\s*"+V+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',$)}function D(V,$){if(V){if(!/^[\x00-\xFF]+$/.test($))return $;try{const N=new TextDecoder(V,{fatal:!0}),q=(0,e.stringToBytes)($);$=N.decode(q),O=!1}catch{}}return $}function U(V){return O&&/[\x80-\xff]/.test(V)&&(V=D("utf-8",V),O&&(V=D("iso-8859-1",V))),V}function Y(V){const $=[];let N;const q=_("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(N=q.exec(V))!==null;){let[,bt,Ft,Ct]=N;if(bt=parseInt(bt,10),bt in $){if(bt===0)break;continue}$[bt]=[Ft,Ct]}const tt=[];for(let bt=0;bt<$.length&&bt in $;++bt){let[Ft,Ct]=$[bt];Ct=at(Ct),Ft&&(Ct=unescape(Ct),bt===0&&(Ct=Q(Ct))),tt.push(Ct)}return tt.join("")}function at(V){if(V.startsWith('"')){const $=V.slice(1).split('\\"');for(let N=0;N<$.length;++N){const q=$[N].indexOf('"');q!==-1&&($[N]=$[N].slice(0,q),$.length=N+1),$[N]=$[N].replaceAll(/\\(.)/g,"$1")}V=$.join('"')}return V}function Q(V){const $=V.indexOf("'");if($===-1)return V;const N=V.slice(0,$),q=V.slice($+1).replace(/^[^']*'/,"");return D(N,q)}function L(V){return!V.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(V)?V:V.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function($,N,q,tt){if(q==="q"||q==="Q")return tt=tt.replaceAll("_"," "),tt=tt.replaceAll(/=([0-9a-fA-F]{2})/g,function(bt,Ft){return String.fromCharCode(parseInt(Ft,16))}),D(N,tt);try{tt=atob(tt)}catch{}return D(N,tt)})}return""}var m=c(419);function x({getResponseHeader:f,isHttp:O,rangeChunkSize:C,disableRange:_}){const D={allowRangeRequests:!1,suggestedLength:void 0},U=parseInt(f("Content-Length"),10);return!Number.isInteger(U)||(D.suggestedLength=U,U<=2*C)||_||!O||f("Accept-Ranges")!=="bytes"||(f("Content-Encoding")||"identity")!=="identity"||(D.allowRangeRequests=!0),D}function W(f){const O=f("Content-Disposition");if(O){let C=w(O);if(C.includes("%"))try{C=decodeURIComponent(C)}catch{}if((0,m.isPdfFile)(C))return C}return null}function k(f,O){return f===404||f===0&&O.startsWith("file:")?new e.MissingPDFException('Missing PDF "'+O+'".'):new e.UnexpectedResponseException(`Unexpected server response (${f}) while retrieving PDF "${O}".`,f)}function y(f){return f===200||f===206}},786:(r,p,c)=>{c.a(r,async(e,w)=>{try{let W=function($){const N=C.parse($);return N.protocol==="file:"||N.host?N:/^[a-z]:[/\\]/i.test($)?C.parse(`file:///${$}`):(N.host||(N.protocol="file:"),N)},k=function($,N){return{protocol:$.protocol,auth:$.auth,host:$.hostname,port:$.port,path:$.path,method:"GET",headers:N}};c.d(p,{PDFNodeStream:()=>D});var m=c(292),x=c(490);let y,f,O,C;m.isNodeJS&&(y=await vs(()=>import("./chunk.js"),[]),f=await vs(()=>import("./chunk.js"),[]),O=await vs(()=>import("./chunk.js"),[]),C=await vs(()=>import("./chunk.js"),[]));const _=/^file:\/\/\/[a-zA-Z]:\//;class D{constructor(N){this.source=N,this.url=W(N.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&N.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var N;return((N=this._fullRequestReader)==null?void 0:N._loaded)??0}getFullReader(){return(0,m.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new L(this):new at(this),this._fullRequestReader}getRangeReader(N,q){if(q<=this._progressiveDataLength)return null;const tt=this.isFsUrl?new V(this,N,q):new Q(this,N,q);return this._rangeRequestReaders.push(tt),tt}cancelAllRequests(N){var q;(q=this._fullRequestReader)==null||q.cancel(N);for(const tt of this._rangeRequestReaders.slice(0))tt.cancel(N)}}class U{constructor(N){this._url=N.url,this._done=!1,this._storedError=null,this.onProgress=null;const q=N.source;this._contentLength=q.length,this._loaded=0,this._filename=null,this._disableRange=q.disableRange||!1,this._rangeChunkSize=q.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!q.disableStream,this._isRangeSupported=!q.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var q;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const N=this._readableStream.read();return N===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=N.length,(q=this.onProgress)==null||q.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(N).buffer,done:!1})}cancel(N){if(!this._readableStream){this._error(N);return}this._readableStream.destroy(N)}_error(N){this._storedError=N,this._readCapability.resolve()}_setReadableStream(N){this._readableStream=N,N.on("readable",()=>{this._readCapability.resolve()}),N.on("end",()=>{N.destroy(),this._done=!0,this._readCapability.resolve()}),N.on("error",q=>{this._error(q)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new m.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Y{constructor(N){this._url=N.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const q=N.source;this._isStreamingSupported=!q.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var q;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const N=this._readableStream.read();return N===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=N.length,(q=this.onProgress)==null||q.call(this,{loaded:this._loaded}),{value:new Uint8Array(N).buffer,done:!1})}cancel(N){if(!this._readableStream){this._error(N);return}this._readableStream.destroy(N)}_error(N){this._storedError=N,this._readCapability.resolve()}_setReadableStream(N){this._readableStream=N,N.on("readable",()=>{this._readCapability.resolve()}),N.on("end",()=>{N.destroy(),this._done=!0,this._readCapability.resolve()}),N.on("error",q=>{this._error(q)}),this._storedError&&this._readableStream.destroy(this._storedError)}}class at extends U{constructor(N){super(N);const q=tt=>{if(tt.statusCode===404){const Ot=new m.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Ot,this._headersCapability.reject(Ot);return}this._headersCapability.resolve(),this._setReadableStream(tt);const bt=Ot=>this._readableStream.headers[Ot.toLowerCase()],{allowRangeRequests:Ft,suggestedLength:Ct}=(0,x.validateRangeRequestCapabilities)({getResponseHeader:bt,isHttp:N.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=Ft,this._contentLength=Ct||this._contentLength,this._filename=(0,x.extractFilenameFromHeader)(bt)};this._request=null,this._url.protocol==="http:"?this._request=f.request(k(this._url,N.httpHeaders),q):this._request=O.request(k(this._url,N.httpHeaders),q),this._request.on("error",tt=>{this._storedError=tt,this._headersCapability.reject(tt)}),this._request.end()}}class Q extends Y{constructor(N,q,tt){super(N),this._httpHeaders={};for(const Ft in N.httpHeaders){const Ct=N.httpHeaders[Ft];Ct!==void 0&&(this._httpHeaders[Ft]=Ct)}this._httpHeaders.Range=`bytes=${q}-${tt-1}`;const bt=Ft=>{if(Ft.statusCode===404){const Ct=new m.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Ct;return}this._setReadableStream(Ft)};this._request=null,this._url.protocol==="http:"?this._request=f.request(k(this._url,this._httpHeaders),bt):this._request=O.request(k(this._url,this._httpHeaders),bt),this._request.on("error",Ft=>{this._storedError=Ft}),this._request.end()}}class L extends U{constructor(N){super(N);let q=decodeURIComponent(this._url.path);_.test(this._url.href)&&(q=q.replace(/^\//,"")),y.promises.lstat(q).then(tt=>{this._contentLength=tt.size,this._setReadableStream(y.createReadStream(q)),this._headersCapability.resolve()},tt=>{tt.code==="ENOENT"&&(tt=new m.MissingPDFException(`Missing PDF "${q}".`)),this._storedError=tt,this._headersCapability.reject(tt)})}}class V extends Y{constructor(N,q,tt){super(N);let bt=decodeURIComponent(this._url.path);_.test(this._url.href)&&(bt=bt.replace(/^\//,"")),this._setReadableStream(y.createReadStream(bt,{start:q,end:tt-1}))}}w()}catch(W){w(W)}},1)},573:(r,p,c)=>{c.a(r,async(e,w)=>{try{c.d(p,{NodeCMapReaderFactory:()=>_,NodeCanvasFactory:()=>C,NodeFilterFactory:()=>O,NodeStandardFontDataFactory:()=>D});var m=c(583),x=c(292);let W,k,y;if(x.isNodeJS){W=await vs(()=>import("./chunk.js"),[]);try{k=await vs(()=>import("./chunk.js"),[])}catch{}try{y=await vs(()=>import("./chunk2.js"),[])}catch{}}const f=function(U){return W.promises.readFile(U).then(Y=>new Uint8Array(Y))};class O extends m.BaseFilterFactory{}class C extends m.BaseCanvasFactory{_createCanvas(Y,at){return k.createCanvas(Y,at)}}class _ extends m.BaseCMapReaderFactory{_fetchData(Y,at){return f(Y).then(Q=>({cMapData:Q,compressionType:at}))}}class D extends m.BaseStandardFontDataFactory{_fetchData(Y){return f(Y)}}w()}catch(W){w(W)}},1)},626:(r,p,c)=>{var k,y,f,O,C,_,D,U,Y,yr;c.d(p,{OptionalContentConfig:()=>W});var e=c(292),w=c(651);const m=Symbol("INTERNAL");class x{constructor(L,{name:V,intent:$,usage:N}){l(this,k,!1);l(this,y,!1);l(this,f,!1);l(this,O,!0);I(this,k,!!(L&e.RenderingIntentFlag.DISPLAY)),I(this,y,!!(L&e.RenderingIntentFlag.PRINT)),this.name=V,this.intent=$,this.usage=N}get visible(){if(t(this,f))return t(this,O);if(!t(this,O))return!1;const{print:L,view:V}=this.usage;return t(this,k)?(V==null?void 0:V.viewState)!=="OFF":t(this,y)?(L==null?void 0:L.printState)!=="OFF":!0}_setVisible(L,V,$=!1){L!==m&&(0,e.unreachable)("Internal method `_setVisible` called."),I(this,f,$),I(this,O,V)}}k=new WeakMap,y=new WeakMap,f=new WeakMap,O=new WeakMap;class W{constructor(L,V=e.RenderingIntentFlag.DISPLAY){l(this,Y);l(this,C,null);l(this,_,new Map);l(this,D,null);l(this,U,null);if(this.renderingIntent=V,this.name=null,this.creator=null,L!==null){this.name=L.name,this.creator=L.creator,I(this,U,L.order);for(const $ of L.groups)t(this,_).set($.id,new x(V,$));if(L.baseState==="OFF")for(const $ of t(this,_).values())$._setVisible(m,!1);for(const $ of L.on)t(this,_).get($)._setVisible(m,!0);for(const $ of L.off)t(this,_).get($)._setVisible(m,!1);I(this,D,this.getHash())}}isVisible(L){if(t(this,_).size===0)return!0;if(!L)return(0,e.info)("Optional content group not defined."),!0;if(L.type==="OCG")return t(this,_).has(L.id)?t(this,_).get(L.id).visible:((0,e.warn)(`Optional content group not found: ${L.id}`),!0);if(L.type==="OCMD"){if(L.expression)return T(this,Y,yr).call(this,L.expression);if(!L.policy||L.policy==="AnyOn"){for(const V of L.ids){if(!t(this,_).has(V))return(0,e.warn)(`Optional content group not found: ${V}`),!0;if(t(this,_).get(V).visible)return!0}return!1}else if(L.policy==="AllOn"){for(const V of L.ids){if(!t(this,_).has(V))return(0,e.warn)(`Optional content group not found: ${V}`),!0;if(!t(this,_).get(V).visible)return!1}return!0}else if(L.policy==="AnyOff"){for(const V of L.ids){if(!t(this,_).has(V))return(0,e.warn)(`Optional content group not found: ${V}`),!0;if(!t(this,_).get(V).visible)return!0}return!1}else if(L.policy==="AllOff"){for(const V of L.ids){if(!t(this,_).has(V))return(0,e.warn)(`Optional content group not found: ${V}`),!0;if(t(this,_).get(V).visible)return!1}return!0}return(0,e.warn)(`Unknown optional content policy ${L.policy}.`),!0}return(0,e.warn)(`Unknown group type ${L.type}.`),!0}setVisibility(L,V=!0){const $=t(this,_).get(L);if(!$){(0,e.warn)(`Optional content group not found: ${L}`);return}$._setVisible(m,!!V,!0),I(this,C,null)}setOCGState({state:L,preserveRB:V}){let $;for(const N of L){switch(N){case"ON":case"OFF":case"Toggle":$=N;continue}const q=t(this,_).get(N);if(q)switch($){case"ON":q._setVisible(m,!0);break;case"OFF":q._setVisible(m,!1);break;case"Toggle":q._setVisible(m,!q.visible);break}}I(this,C,null)}get hasInitialVisibility(){return t(this,D)===null||this.getHash()===t(this,D)}getOrder(){return t(this,_).size?t(this,U)?t(this,U).slice():[...t(this,_).keys()]:null}getGroups(){return t(this,_).size>0?(0,e.objectFromMap)(t(this,_)):null}getGroup(L){return t(this,_).get(L)||null}getHash(){if(t(this,C)!==null)return t(this,C);const L=new w.MurmurHash3_64;for(const[V,$]of t(this,_))L.update(`${V}:${$.visible}`);return I(this,C,L.hexdigest())}}C=new WeakMap,_=new WeakMap,D=new WeakMap,U=new WeakMap,Y=new WeakSet,yr=function(L){const V=L.length;if(V<2)return!0;const $=L[0];for(let N=1;N<V;N++){const q=L[N];let tt;if(Array.isArray(q))tt=T(this,Y,yr).call(this,q);else if(t(this,_).has(q))tt=t(this,_).get(q).visible;else return(0,e.warn)(`Optional content group not found: ${q}`),!0;switch($){case"And":if(!tt)return!1;break;case"Or":if(tt)return!0;break;case"Not":return!tt;default:return!0}}return $==="And"}},814:(r,p,c)=>{c.d(p,{cleanupTextLayer:()=>O,renderTextLayer:()=>at,updateTextLayer:()=>Q});var e=c(292),w=c(419);const m=1e5,x=30,W=.8,k=new Map;let y=null;function f(){if(!y){const L=document.createElement("canvas");L.className="hiddenCanvasElement",document.body.append(L),y=L.getContext("2d",{alpha:!1})}return y}function O(){y==null||y.canvas.remove(),y=null}function C(L){const V=k.get(L);if(V)return V;const $=f(),N=$.font;$.canvas.width=$.canvas.height=x,$.font=`${x}px ${L}`;const q=$.measureText("");let tt=q.fontBoundingBoxAscent,bt=Math.abs(q.fontBoundingBoxDescent);if(tt){const Ct=tt/(tt+bt);return k.set(L,Ct),$.canvas.width=$.canvas.height=0,$.font=N,Ct}$.strokeStyle="red",$.clearRect(0,0,x,x),$.strokeText("g",0,0);let Ft=$.getImageData(0,0,x,x).data;bt=0;for(let Ct=Ft.length-1-3;Ct>=0;Ct-=4)if(Ft[Ct]>0){bt=Math.ceil(Ct/4/x);break}$.clearRect(0,0,x,x),$.strokeText("A",0,x),Ft=$.getImageData(0,0,x,x).data,tt=0;for(let Ct=0,Ot=Ft.length;Ct<Ot;Ct+=4)if(Ft[Ct]>0){tt=x-Math.floor(Ct/4/x);break}if($.canvas.width=$.canvas.height=0,$.font=N,tt){const Ct=tt/(tt+bt);return k.set(L,Ct),Ct}return k.set(L,W),W}function _(L,V,$){const N=document.createElement("span"),q={angle:0,canvasWidth:0,hasText:V.str!=="",hasEOL:V.hasEOL,fontSize:0};L._textDivs.push(N);const tt=e.Util.transform(L._transform,V.transform);let bt=Math.atan2(tt[1],tt[0]);const Ft=$[V.fontName];Ft.vertical&&(bt+=Math.PI/2);const Ct=L._fontInspectorEnabled&&Ft.fontSubstitution||Ft.fontFamily,Ot=Math.hypot(tt[2],tt[3]),_t=Ot*C(Ct);let Mt,Lt;bt===0?(Mt=tt[4],Lt=tt[5]-_t):(Mt=tt[4]+_t*Math.sin(bt),Lt=tt[5]-_t*Math.cos(bt));const Et="calc(var(--scale-factor)*",Z=N.style;L._container===L._rootContainer?(Z.left=`${(100*Mt/L._pageWidth).toFixed(2)}%`,Z.top=`${(100*Lt/L._pageHeight).toFixed(2)}%`):(Z.left=`${Et}${Mt.toFixed(2)}px)`,Z.top=`${Et}${Lt.toFixed(2)}px)`),Z.fontSize=`${Et}${Ot.toFixed(2)}px)`,Z.fontFamily=Ct,q.fontSize=Ot,N.setAttribute("role","presentation"),N.textContent=V.str,N.dir=V.dir,L._fontInspectorEnabled&&(N.dataset.fontName=Ft.fontSubstitutionLoadedName||V.fontName),bt!==0&&(q.angle=bt*(180/Math.PI));let gt=!1;if(V.str.length>1)gt=!0;else if(V.str!==" "&&V.transform[0]!==V.transform[3]){const Rt=Math.abs(V.transform[0]),Pt=Math.abs(V.transform[3]);Rt!==Pt&&Math.max(Rt,Pt)/Math.min(Rt,Pt)>1.5&&(gt=!0)}gt&&(q.canvasWidth=Ft.vertical?V.height:V.width),L._textDivProperties.set(N,q),L._isReadableStream&&L._layoutText(N)}function D(L){const{div:V,scale:$,properties:N,ctx:q,prevFontSize:tt,prevFontFamily:bt}=L,{style:Ft}=V;let Ct="";if(N.canvasWidth!==0&&N.hasText){const{fontFamily:Ot}=Ft,{canvasWidth:_t,fontSize:Mt}=N;(tt!==Mt||bt!==Ot)&&(q.font=`${Mt*$}px ${Ot}`,L.prevFontSize=Mt,L.prevFontFamily=Ot);const{width:Lt}=q.measureText(V.textContent);Lt>0&&(Ct=`scaleX(${_t*$/Lt})`)}N.angle!==0&&(Ct=`rotate(${N.angle}deg) ${Ct}`),Ct.length>0&&(Ft.transform=Ct)}function U(L){if(L._canceled)return;const V=L._textDivs,$=L._capability;if(V.length>m){$.resolve();return}if(!L._isReadableStream)for(const N of V)L._layoutText(N);$.resolve()}class Y{constructor({textContentSource:V,container:$,viewport:N,textDivs:q,textDivProperties:tt,textContentItemsStr:bt}){var Mt;this._textContentSource=V,this._isReadableStream=V instanceof ReadableStream,this._container=this._rootContainer=$,this._textDivs=q||[],this._textContentItemsStr=bt||[],this._fontInspectorEnabled=!!((Mt=globalThis.FontInspector)!=null&&Mt.enabled),this._reader=null,this._textDivProperties=tt||new WeakMap,this._canceled=!1,this._capability=Promise.withResolvers(),this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:N.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:f()};const{pageWidth:Ft,pageHeight:Ct,pageX:Ot,pageY:_t}=N.rawDims;this._transform=[1,0,0,-1,-Ot,_t+Ct],this._pageWidth=Ft,this._pageHeight=Ct,(0,w.setLayerDimensions)($,N),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new e.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new e.AbortException("TextLayer task cancelled."))}_processItems(V,$){for(const N of V){if(N.str===void 0){if(N.type==="beginMarkedContentProps"||N.type==="beginMarkedContent"){const q=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),N.id!==null&&this._container.setAttribute("id",`${N.id}`),q.append(this._container)}else N.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(N.str),_(this,N,$)}}_layoutText(V){const $=this._layoutTextParams.properties=this._textDivProperties.get(V);if(this._layoutTextParams.div=V,D(this._layoutTextParams),$.hasText&&this._container.append(V),$.hasEOL){const N=document.createElement("br");N.setAttribute("role","presentation"),this._container.append(N)}}_render(){const{promise:V,resolve:$,reject:N}=Promise.withResolvers();let q=Object.create(null);if(this._isReadableStream){const tt=()=>{this._reader.read().then(({value:bt,done:Ft})=>{if(Ft){$();return}Object.assign(q,bt.styles),this._processItems(bt.items,q),tt()},N)};this._reader=this._textContentSource.getReader(),tt()}else if(this._textContentSource){const{items:tt,styles:bt}=this._textContentSource;this._processItems(tt,bt),$()}else throw new Error('No "textContentSource" parameter specified.');V.then(()=>{q=null,U(this)},this._capability.reject)}}function at(L){const V=new Y(L);return V._render(),V}function Q({container:L,viewport:V,textDivs:$,textDivProperties:N,mustRotate:q=!0,mustRescale:tt=!0}){if(q&&(0,w.setLayerDimensions)(L,{rotation:V.rotation}),tt){const bt=f(),Ft={prevFontSize:null,prevFontFamily:null,div:null,scale:V.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:bt};for(const Ct of $)Ft.properties=N.get(Ct),Ft.div=Ct,D(Ft)}}},585:(r,p,c)=>{c.d(p,{PDFDataTransportStream:()=>m});var e=c(292),w=c(419);class m{constructor(y,{disableRange:f=!1,disableStream:O=!1}){(0,e.assert)(y,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:C,initialData:_,progressiveDone:D,contentDispositionFilename:U}=y;if(this._queuedChunks=[],this._progressiveDone=D,this._contentDispositionFilename=U,(_==null?void 0:_.length)>0){const Y=_ instanceof Uint8Array&&_.byteLength===_.buffer.byteLength?_.buffer:new Uint8Array(_).buffer;this._queuedChunks.push(Y)}this._pdfDataRangeTransport=y,this._isStreamingSupported=!O,this._isRangeSupported=!f,this._contentLength=C,this._fullRequestReader=null,this._rangeReaders=[],y.addRangeListener((Y,at)=>{this._onReceiveData({begin:Y,chunk:at})}),y.addProgressListener((Y,at)=>{this._onProgress({loaded:Y,total:at})}),y.addProgressiveReadListener(Y=>{this._onReceiveData({chunk:Y})}),y.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),y.transportReady()}_onReceiveData({begin:y,chunk:f}){const O=f instanceof Uint8Array&&f.byteLength===f.buffer.byteLength?f.buffer:new Uint8Array(f).buffer;if(y===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(O):this._queuedChunks.push(O);else{const C=this._rangeReaders.some(function(_){return _._begin!==y?!1:(_._enqueue(O),!0)});(0,e.assert)(C,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var y;return((y=this._fullRequestReader)==null?void 0:y._loaded)??0}_onProgress(y){var f,O,C,_;y.total===void 0?(O=(f=this._rangeReaders[0])==null?void 0:f.onProgress)==null||O.call(f,{loaded:y.loaded}):(_=(C=this._fullRequestReader)==null?void 0:C.onProgress)==null||_.call(C,{loaded:y.loaded,total:y.total})}_onProgressiveDone(){var y;(y=this._fullRequestReader)==null||y.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(y){const f=this._rangeReaders.indexOf(y);f>=0&&this._rangeReaders.splice(f,1)}getFullReader(){(0,e.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const y=this._queuedChunks;return this._queuedChunks=null,new x(this,y,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(y,f){if(f<=this._progressiveDataLength)return null;const O=new W(this,y,f);return this._pdfDataRangeTransport.requestDataRange(y,f),this._rangeReaders.push(O),O}cancelAllRequests(y){var f;(f=this._fullRequestReader)==null||f.cancel(y);for(const O of this._rangeReaders.slice(0))O.cancel(y);this._pdfDataRangeTransport.abort()}}class x{constructor(y,f,O=!1,C=null){this._stream=y,this._done=O||!1,this._filename=(0,w.isPdfFile)(C)?C:null,this._queuedChunks=f||[],this._loaded=0;for(const _ of this._queuedChunks)this._loaded+=_.byteLength;this._requests=[],this._headersReady=Promise.resolve(),y._fullRequestReader=this,this.onProgress=null}_enqueue(y){this._done||(this._requests.length>0?this._requests.shift().resolve({value:y,done:!1}):this._queuedChunks.push(y),this._loaded+=y.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const y=Promise.withResolvers();return this._requests.push(y),y.promise}cancel(y){this._done=!0;for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class W{constructor(y,f,O){this._stream=y,this._begin=f,this._end=O,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(y){if(!this._done){if(this._requests.length===0)this._queuedChunk=y;else{this._requests.shift().resolve({value:y,done:!1});for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const f=this._queuedChunk;return this._queuedChunk=null,{value:f,done:!1}}if(this._done)return{value:void 0,done:!0};const y=Promise.withResolvers();return this._requests.push(y),y.promise}cancel(y){this._done=!0;for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},164:(r,p,c)=>{var w,m;c.d(p,{GlobalWorkerOptions:()=>e});class e{static get workerPort(){return t(this,w)}static set workerPort(W){if(!(typeof Worker<"u"&&W instanceof Worker)&&W!==null)throw new Error("Invalid `workerPort` type.");I(this,w,W)}static get workerSrc(){return t(this,m)}static set workerSrc(W){if(typeof W!="string")throw new Error("Invalid `workerSrc` type.");I(this,m,W)}}w=new WeakMap,m=new WeakMap,l(e,w,null),l(e,m,"")},284:(r,p,c)=>{c.d(p,{XfaLayer:()=>w});var e=c(50);class w{static setupStorage(x,W,k,y,f){const O=y.getValue(W,{value:null});switch(k.name){case"textarea":if(O.value!==null&&(x.textContent=O.value),f==="print")break;x.addEventListener("input",C=>{y.setValue(W,{value:C.target.value})});break;case"input":if(k.attributes.type==="radio"||k.attributes.type==="checkbox"){if(O.value===k.attributes.xfaOn?x.setAttribute("checked",!0):O.value===k.attributes.xfaOff&&x.removeAttribute("checked"),f==="print")break;x.addEventListener("change",C=>{y.setValue(W,{value:C.target.checked?C.target.getAttribute("xfaOn"):C.target.getAttribute("xfaOff")})})}else{if(O.value!==null&&x.setAttribute("value",O.value),f==="print")break;x.addEventListener("input",C=>{y.setValue(W,{value:C.target.value})})}break;case"select":if(O.value!==null){x.setAttribute("value",O.value);for(const C of k.children)C.attributes.value===O.value?C.attributes.selected=!0:C.attributes.hasOwnProperty("selected")&&delete C.attributes.selected}x.addEventListener("input",C=>{const _=C.target.options,D=_.selectedIndex===-1?"":_[_.selectedIndex].value;y.setValue(W,{value:D})});break}}static setAttributes({html:x,element:W,storage:k=null,intent:y,linkService:f}){const{attributes:O}=W,C=x instanceof HTMLAnchorElement;O.type==="radio"&&(O.name=`${O.name}-${y}`);for(const[_,D]of Object.entries(O))if(D!=null)switch(_){case"class":D.length&&x.setAttribute(_,D.join(" "));break;case"dataId":break;case"id":x.setAttribute("data-element-id",D);break;case"style":Object.assign(x.style,D);break;case"textContent":x.textContent=D;break;default:(!C||_!=="href"&&_!=="newWindow")&&x.setAttribute(_,D)}C&&f.addLinkAttributes(x,O.href,O.newWindow),k&&O.dataId&&this.setupStorage(x,O.dataId,W,k)}static render(x){var Y,at;const W=x.annotationStorage,k=x.linkService,y=x.xfaHtml,f=x.intent||"display",O=document.createElement(y.name);y.attributes&&this.setAttributes({html:O,element:y,intent:f,linkService:k});const C=f!=="richText",_=x.div;if(_.append(O),x.viewport){const Q=`matrix(${x.viewport.transform.join(",")})`;_.style.transform=Q}C&&_.setAttribute("class","xfaLayer xfaFont");const D=[];if(y.children.length===0){if(y.value){const Q=document.createTextNode(y.value);O.append(Q),C&&e.XfaText.shouldBuildText(y.name)&&D.push(Q)}return{textDivs:D}}const U=[[y,-1,O]];for(;U.length>0;){const[Q,L,V]=U.at(-1);if(L+1===Q.children.length){U.pop();continue}const $=Q.children[++U.at(-1)[1]];if($===null)continue;const{name:N}=$;if(N==="#text"){const tt=document.createTextNode($.value);D.push(tt),V.append(tt);continue}const q=(Y=$==null?void 0:$.attributes)!=null&&Y.xmlns?document.createElementNS($.attributes.xmlns,N):document.createElement(N);if(V.append(q),$.attributes&&this.setAttributes({html:q,element:$,storage:W,intent:f,linkService:k}),((at=$.children)==null?void 0:at.length)>0)U.push([$,-1,q]);else if($.value){const tt=document.createTextNode($.value);C&&e.XfaText.shouldBuildText(N)&&D.push(tt),q.append(tt)}}for(const Q of _.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))Q.setAttribute("readOnly",!0);return{textDivs:D}}static update(x){const W=`matrix(${x.viewport.transform.join(",")})`;x.div.style.transform=W,x.div.hidden=!1}}},50:(r,p,c)=>{c.d(p,{XfaText:()=>e});class e{static textContent(m){const x=[],W={items:x,styles:Object.create(null)};function k(y){var C;if(!y)return;let f=null;const O=y.name;if(O==="#text")f=y.value;else if(e.shouldBuildText(O))(C=y==null?void 0:y.attributes)!=null&&C.textContent?f=y.attributes.textContent:y.value&&(f=y.value);else return;if(f!==null&&x.push({str:f}),!!y.children)for(const _ of y.children)k(_)}return k(m),W}static shouldBuildText(m){return!(m==="textarea"||m==="input"||m==="option"||m==="select")}}},228:(r,p,c)=>{c.a(r,async(e,w)=>{try{c.d(p,{AbortException:()=>m.AbortException,AnnotationEditorLayer:()=>y.AnnotationEditorLayer,AnnotationEditorParamsType:()=>m.AnnotationEditorParamsType,AnnotationEditorType:()=>m.AnnotationEditorType,AnnotationEditorUIManager:()=>f.AnnotationEditorUIManager,AnnotationLayer:()=>O.AnnotationLayer,AnnotationMode:()=>m.AnnotationMode,CMapCompressionType:()=>m.CMapCompressionType,ColorPicker:()=>C.ColorPicker,DOMSVGFactory:()=>W.DOMSVGFactory,DrawLayer:()=>_.DrawLayer,FeatureTest:()=>m.FeatureTest,GlobalWorkerOptions:()=>D.GlobalWorkerOptions,ImageKind:()=>m.ImageKind,InvalidPDFException:()=>m.InvalidPDFException,MissingPDFException:()=>m.MissingPDFException,OPS:()=>m.OPS,Outliner:()=>U.Outliner,PDFDataRangeTransport:()=>x.PDFDataRangeTransport,PDFDateString:()=>W.PDFDateString,PDFWorker:()=>x.PDFWorker,PasswordResponses:()=>m.PasswordResponses,PermissionFlag:()=>m.PermissionFlag,PixelsPerInch:()=>W.PixelsPerInch,RenderingCancelledException:()=>W.RenderingCancelledException,UnexpectedResponseException:()=>m.UnexpectedResponseException,Util:()=>m.Util,VerbosityLevel:()=>m.VerbosityLevel,XfaLayer:()=>Y.XfaLayer,build:()=>x.build,createValidAbsoluteUrl:()=>m.createValidAbsoluteUrl,fetchData:()=>W.fetchData,getDocument:()=>x.getDocument,getFilenameFromUrl:()=>W.getFilenameFromUrl,getPdfFilenameFromUrl:()=>W.getPdfFilenameFromUrl,getXfaPageViewport:()=>W.getXfaPageViewport,isDataScheme:()=>W.isDataScheme,isPdfFile:()=>W.isPdfFile,noContextMenu:()=>W.noContextMenu,normalizeUnicode:()=>m.normalizeUnicode,renderTextLayer:()=>k.renderTextLayer,setLayerDimensions:()=>W.setLayerDimensions,shadow:()=>m.shadow,updateTextLayer:()=>k.updateTextLayer,version:()=>x.version});var m=c(292),x=c(831),W=c(419),k=c(814),y=c(731),f=c(830),O=c(976),C=c(259),_=c(47),D=c(164),U=c(61),Y=c(284),at=e([x]);x=(at.then?(await at)():at)[0];const Q="4.1.392",L="fcb76a78d";w()}catch(Q){w(Q)}})},178:(r,p,c)=>{var k,to,f,eo,C,fn;c.d(p,{MessageHandler:()=>W});var e=c(292);const w={UNKNOWN:0,DATA:1,ERROR:2},m={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function x(D){switch(D instanceof Error||typeof D=="object"&&D!==null||(0,e.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),D.name){case"AbortException":return new e.AbortException(D.message);case"MissingPDFException":return new e.MissingPDFException(D.message);case"PasswordException":return new e.PasswordException(D.message,D.code);case"UnexpectedResponseException":return new e.UnexpectedResponseException(D.message,D.status);case"UnknownErrorException":return new e.UnknownErrorException(D.message,D.details);default:return new e.UnknownErrorException(D.message,D.toString())}}class W{constructor(U,Y,at){l(this,k);l(this,f);l(this,C);this.sourceName=U,this.targetName=Y,this.comObj=at,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=Q=>{const L=Q.data;if(L.targetName!==this.sourceName)return;if(L.stream){T(this,f,eo).call(this,L);return}if(L.callback){const $=L.callbackId,N=this.callbackCapabilities[$];if(!N)throw new Error(`Cannot resolve callback ${$}`);if(delete this.callbackCapabilities[$],L.callback===w.DATA)N.resolve(L.data);else if(L.callback===w.ERROR)N.reject(x(L.reason));else throw new Error("Unexpected callback case");return}const V=this.actionHandler[L.action];if(!V)throw new Error(`Unknown action from worker: ${L.action}`);if(L.callbackId){const $=this.sourceName,N=L.sourceName;new Promise(function(q){q(V(L.data))}).then(function(q){at.postMessage({sourceName:$,targetName:N,callback:w.DATA,callbackId:L.callbackId,data:q})},function(q){at.postMessage({sourceName:$,targetName:N,callback:w.ERROR,callbackId:L.callbackId,reason:x(q)})});return}if(L.streamId){T(this,k,to).call(this,L);return}V(L.data)},at.addEventListener("message",this._onComObjOnMessage)}on(U,Y){const at=this.actionHandler;if(at[U])throw new Error(`There is already an actionName called "${U}"`);at[U]=Y}send(U,Y,at){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:U,data:Y},at)}sendWithPromise(U,Y,at){const Q=this.callbackId++,L=Promise.withResolvers();this.callbackCapabilities[Q]=L;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:U,callbackId:Q,data:Y},at)}catch(V){L.reject(V)}return L.promise}sendWithStream(U,Y,at,Q){const L=this.streamId++,V=this.sourceName,$=this.targetName,N=this.comObj;return new ReadableStream({start:q=>{const tt=Promise.withResolvers();return this.streamControllers[L]={controller:q,startCall:tt,pullCall:null,cancelCall:null,isClosed:!1},N.postMessage({sourceName:V,targetName:$,action:U,streamId:L,data:Y,desiredSize:q.desiredSize},Q),tt.promise},pull:q=>{const tt=Promise.withResolvers();return this.streamControllers[L].pullCall=tt,N.postMessage({sourceName:V,targetName:$,stream:m.PULL,streamId:L,desiredSize:q.desiredSize}),tt.promise},cancel:q=>{(0,e.assert)(q instanceof Error,"cancel must have a valid reason");const tt=Promise.withResolvers();return this.streamControllers[L].cancelCall=tt,this.streamControllers[L].isClosed=!0,N.postMessage({sourceName:V,targetName:$,stream:m.CANCEL,streamId:L,reason:x(q)}),tt.promise}},at)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}k=new WeakSet,to=function(U){const Y=U.streamId,at=this.sourceName,Q=U.sourceName,L=this.comObj,V=this,$=this.actionHandler[U.action],N={enqueue(q,tt=1,bt){if(this.isCancelled)return;const Ft=this.desiredSize;this.desiredSize-=tt,Ft>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),L.postMessage({sourceName:at,targetName:Q,stream:m.ENQUEUE,streamId:Y,chunk:q},bt)},close(){this.isCancelled||(this.isCancelled=!0,L.postMessage({sourceName:at,targetName:Q,stream:m.CLOSE,streamId:Y}),delete V.streamSinks[Y])},error(q){(0,e.assert)(q instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,L.postMessage({sourceName:at,targetName:Q,stream:m.ERROR,streamId:Y,reason:x(q)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:U.desiredSize,ready:null};N.sinkCapability.resolve(),N.ready=N.sinkCapability.promise,this.streamSinks[Y]=N,new Promise(function(q){q($(U.data,N))}).then(function(){L.postMessage({sourceName:at,targetName:Q,stream:m.START_COMPLETE,streamId:Y,success:!0})},function(q){L.postMessage({sourceName:at,targetName:Q,stream:m.START_COMPLETE,streamId:Y,reason:x(q)})})},f=new WeakSet,eo=function(U){const Y=U.streamId,at=this.sourceName,Q=U.sourceName,L=this.comObj,V=this.streamControllers[Y],$=this.streamSinks[Y];switch(U.stream){case m.START_COMPLETE:U.success?V.startCall.resolve():V.startCall.reject(x(U.reason));break;case m.PULL_COMPLETE:U.success?V.pullCall.resolve():V.pullCall.reject(x(U.reason));break;case m.PULL:if(!$){L.postMessage({sourceName:at,targetName:Q,stream:m.PULL_COMPLETE,streamId:Y,success:!0});break}$.desiredSize<=0&&U.desiredSize>0&&$.sinkCapability.resolve(),$.desiredSize=U.desiredSize,new Promise(function(N){var q;N((q=$.onPull)==null?void 0:q.call($))}).then(function(){L.postMessage({sourceName:at,targetName:Q,stream:m.PULL_COMPLETE,streamId:Y,success:!0})},function(N){L.postMessage({sourceName:at,targetName:Q,stream:m.PULL_COMPLETE,streamId:Y,reason:x(N)})});break;case m.ENQUEUE:if((0,e.assert)(V,"enqueue should have stream controller"),V.isClosed)break;V.controller.enqueue(U.chunk);break;case m.CLOSE:if((0,e.assert)(V,"close should have stream controller"),V.isClosed)break;V.isClosed=!0,V.controller.close(),T(this,C,fn).call(this,V,Y);break;case m.ERROR:(0,e.assert)(V,"error should have stream controller"),V.controller.error(x(U.reason)),T(this,C,fn).call(this,V,Y);break;case m.CANCEL_COMPLETE:U.success?V.cancelCall.resolve():V.cancelCall.reject(x(U.reason)),T(this,C,fn).call(this,V,Y);break;case m.CANCEL:if(!$)break;new Promise(function(N){var q;N((q=$.onCancel)==null?void 0:q.call($,x(U.reason)))}).then(function(){L.postMessage({sourceName:at,targetName:Q,stream:m.CANCEL_COMPLETE,streamId:Y,success:!0})},function(N){L.postMessage({sourceName:at,targetName:Q,stream:m.CANCEL_COMPLETE,streamId:Y,reason:x(N)})}),$.sinkCapability.reject(x(U.reason)),$.isCancelled=!0,delete this.streamSinks[Y];break;default:throw new Error("Unexpected stream case")}},C=new WeakSet,fn=async function(U,Y){var at,Q,L;await Promise.allSettled([(at=U.startCall)==null?void 0:at.promise,(Q=U.pullCall)==null?void 0:Q.promise,(L=U.cancelCall)==null?void 0:L.promise]),delete this.streamControllers[Y]}},651:(r,p,c)=>{c.d(p,{MurmurHash3_64:()=>x});const e=3285377520,w=4294901760,m=65535;class x{constructor(k){this.h1=k?k&4294967295:e,this.h2=k?k&4294967295:e}update(k){let y,f;if(typeof k=="string"){y=new Uint8Array(k.length*2),f=0;for(let N=0,q=k.length;N<q;N++){const tt=k.charCodeAt(N);tt<=255?y[f++]=tt:(y[f++]=tt>>>8,y[f++]=tt&255)}}else if(ArrayBuffer.isView(k))y=k.slice(),f=y.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const O=f>>2,C=f-O*4,_=new Uint32Array(y.buffer,0,O);let D=0,U=0,Y=this.h1,at=this.h2;const Q=3432918353,L=461845907,V=Q&m,$=L&m;for(let N=0;N<O;N++)N&1?(D=_[N],D=D*Q&w|D*V&m,D=D<<15|D>>>17,D=D*L&w|D*$&m,Y^=D,Y=Y<<13|Y>>>19,Y=Y*5+3864292196):(U=_[N],U=U*Q&w|U*V&m,U=U<<15|U>>>17,U=U*L&w|U*$&m,at^=U,at=at<<13|at>>>19,at=at*5+3864292196);switch(D=0,C){case 3:D^=y[O*4+2]<<16;case 2:D^=y[O*4+1]<<8;case 1:D^=y[O*4],D=D*Q&w|D*V&m,D=D<<15|D>>>17,D=D*L&w|D*$&m,O&1?Y^=D:at^=D}this.h1=Y,this.h2=at}hexdigest(){let k=this.h1,y=this.h2;return k^=y>>>1,k=k*3981806797&w|k*36045&m,y=y*4283543511&w|((y<<16|k>>>16)*2950163797&w)>>>16,k^=y>>>1,k=k*444984403&w|k*60499&m,y=y*3301882366&w|((y<<16|k>>>16)*3120437893&w)>>>16,k^=y>>>1,(k>>>0).toString(16).padStart(8,"0")+(y>>>0).toString(16).padStart(8,"0")}}},292:(r,p,c)=>{var o,mn,v,_r;c.d(p,{AbortException:()=>ie,AnnotationBorderStyleType:()=>at,AnnotationEditorParamsType:()=>C,AnnotationEditorPrefix:()=>f,AnnotationEditorType:()=>O,AnnotationMode:()=>y,AnnotationPrefix:()=>g,AnnotationType:()=>Y,BaseException:()=>Et,CMapCompressionType:()=>L,FONT_IDENTITY_MATRIX:()=>m,FeatureTest:()=>Ce,FormatError:()=>Kt,IDENTITY_MATRIX:()=>w,ImageKind:()=>U,InvalidPDFException:()=>Rt,LINE_FACTOR:()=>W,MAX_IMAGE_SIZE_TO_CACHE:()=>x,MissingPDFException:()=>Pt,OPS:()=>V,PasswordException:()=>Z,PasswordResponses:()=>$,PermissionFlag:()=>_,RenderingIntentFlag:()=>k,TextRenderingMode:()=>D,UnexpectedResponseException:()=>qt,UnknownErrorException:()=>gt,Util:()=>Ee,VerbosityLevel:()=>Q,assert:()=>Ot,bytesToString:()=>xe,createValidAbsoluteUrl:()=>Mt,getUuid:()=>d,getVerbosityLevel:()=>tt,info:()=>bt,isNodeJS:()=>e,normalizeUnicode:()=>n,objectFromMap:()=>be,setVerbosityLevel:()=>q,shadow:()=>Lt,string32:()=>le,stringToBytes:()=>de,unreachable:()=>Ct,warn:()=>Ft});const e=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),w=[1,0,0,1,0,0],m=[.001,0,0,.001,0,0],x=1e7,W=1.35,k={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},y={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},f="pdfjs_internal_editor_",O={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},C={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},_={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},D={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},U={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Y={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},at={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Q={ERRORS:0,WARNINGS:1,INFOS:5},L={NONE:0,BINARY:1},V={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},$={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let N=Q.WARNINGS;function q(u){Number.isInteger(u)&&(N=u)}function tt(){return N}function bt(u){N>=Q.INFOS&&console.log(`Info: ${u}`)}function Ft(u){N>=Q.WARNINGS&&console.log(`Warning: ${u}`)}function Ct(u){throw new Error(u)}function Ot(u,a){u||Ct(a)}function _t(u){switch(u==null?void 0:u.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Mt(u,a=null,h=null){var R;if(!u)return null;try{if(h&&typeof u=="string"&&(h.addDefaultProtocol&&u.startsWith("www.")&&((R=u.match(/\./g))==null?void 0:R.length)>=2&&(u=`http://${u}`),h.tryConvertEncoding))try{u=ne(u)}catch{}const j=a?new URL(u,a):new URL(u);if(_t(j))return j}catch{}return null}function Lt(u,a,h,R=!1){return Object.defineProperty(u,a,{value:h,enumerable:!R,configurable:!0,writable:!1}),h}const Et=function(){function u(a,h){this.constructor===u&&Ct("Cannot initialize BaseException."),this.message=a,this.name=h}return u.prototype=new Error,u.constructor=u,u}();class Z extends Et{constructor(a,h){super(a,"PasswordException"),this.code=h}}class gt extends Et{constructor(a,h){super(a,"UnknownErrorException"),this.details=h}}class Rt extends Et{constructor(a){super(a,"InvalidPDFException")}}class Pt extends Et{constructor(a){super(a,"MissingPDFException")}}class qt extends Et{constructor(a,h){super(a,"UnexpectedResponseException"),this.status=h}}class Kt extends Et{constructor(a){super(a,"FormatError")}}class ie extends Et{constructor(a){super(a,"AbortException")}}function xe(u){(typeof u!="object"||(u==null?void 0:u.length)===void 0)&&Ct("Invalid argument for bytesToString");const a=u.length,h=8192;if(a<h)return String.fromCharCode.apply(null,u);const R=[];for(let j=0;j<a;j+=h){const G=Math.min(j+h,a),rt=u.subarray(j,G);R.push(String.fromCharCode.apply(null,rt))}return R.join("")}function de(u){typeof u!="string"&&Ct("Invalid argument for stringToBytes");const a=u.length,h=new Uint8Array(a);for(let R=0;R<a;++R)h[R]=u.charCodeAt(R)&255;return h}function le(u){return String.fromCharCode(u>>24&255,u>>16&255,u>>8&255,u&255)}function be(u){const a=Object.create(null);for(const[h,R]of u)a[h]=R;return a}function Vt(){const u=new Uint8Array(4);return u[0]=1,new Uint32Array(u.buffer,0,1)[0]===1}function ae(){try{return new Function(""),!0}catch{return!1}}class Ce{static get isLittleEndian(){return Lt(this,"isLittleEndian",Vt())}static get isEvalSupported(){return Lt(this,"isEvalSupported",ae())}static get isOffscreenCanvasSupported(){return Lt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?Lt(this,"platform",{isMac:navigator.platform.includes("Mac")}):Lt(this,"platform",{isMac:!1})}static get isCSSRoundSupported(){var a,h;return Lt(this,"isCSSRoundSupported",(h=(a=globalThis.CSS)==null?void 0:a.supports)==null?void 0:h.call(a,"width: round(1.5px, 1px)"))}}const ee=Array.from(Array(256).keys(),u=>u.toString(16).padStart(2,"0"));class Ee{static makeHexColor(a,h,R){return`#${ee[a]}${ee[h]}${ee[R]}`}static scaleMinMax(a,h){let R;a[0]?(a[0]<0&&(R=h[0],h[0]=h[2],h[2]=R),h[0]*=a[0],h[2]*=a[0],a[3]<0&&(R=h[1],h[1]=h[3],h[3]=R),h[1]*=a[3],h[3]*=a[3]):(R=h[0],h[0]=h[1],h[1]=R,R=h[2],h[2]=h[3],h[3]=R,a[1]<0&&(R=h[1],h[1]=h[3],h[3]=R),h[1]*=a[1],h[3]*=a[1],a[2]<0&&(R=h[0],h[0]=h[2],h[2]=R),h[0]*=a[2],h[2]*=a[2]),h[0]+=a[4],h[1]+=a[5],h[2]+=a[4],h[3]+=a[5]}static transform(a,h){return[a[0]*h[0]+a[2]*h[1],a[1]*h[0]+a[3]*h[1],a[0]*h[2]+a[2]*h[3],a[1]*h[2]+a[3]*h[3],a[0]*h[4]+a[2]*h[5]+a[4],a[1]*h[4]+a[3]*h[5]+a[5]]}static applyTransform(a,h){const R=a[0]*h[0]+a[1]*h[2]+h[4],j=a[0]*h[1]+a[1]*h[3]+h[5];return[R,j]}static applyInverseTransform(a,h){const R=h[0]*h[3]-h[1]*h[2],j=(a[0]*h[3]-a[1]*h[2]+h[2]*h[5]-h[4]*h[3])/R,G=(-a[0]*h[1]+a[1]*h[0]+h[4]*h[1]-h[5]*h[0])/R;return[j,G]}static getAxialAlignedBoundingBox(a,h){const R=this.applyTransform(a,h),j=this.applyTransform(a.slice(2,4),h),G=this.applyTransform([a[0],a[3]],h),rt=this.applyTransform([a[2],a[1]],h);return[Math.min(R[0],j[0],G[0],rt[0]),Math.min(R[1],j[1],G[1],rt[1]),Math.max(R[0],j[0],G[0],rt[0]),Math.max(R[1],j[1],G[1],rt[1])]}static inverseTransform(a){const h=a[0]*a[3]-a[1]*a[2];return[a[3]/h,-a[1]/h,-a[2]/h,a[0]/h,(a[2]*a[5]-a[4]*a[3])/h,(a[4]*a[1]-a[5]*a[0])/h]}static singularValueDecompose2dScale(a){const h=[a[0],a[2],a[1],a[3]],R=a[0]*h[0]+a[1]*h[2],j=a[0]*h[1]+a[1]*h[3],G=a[2]*h[0]+a[3]*h[2],rt=a[2]*h[1]+a[3]*h[3],ot=(R+rt)/2,yt=Math.sqrt((R+rt)**2-4*(R*rt-G*j))/2,At=ot+yt||1,ut=ot-yt||1;return[Math.sqrt(At),Math.sqrt(ut)]}static normalizeRect(a){const h=a.slice(0);return a[0]>a[2]&&(h[0]=a[2],h[2]=a[0]),a[1]>a[3]&&(h[1]=a[3],h[3]=a[1]),h}static intersect(a,h){const R=Math.max(Math.min(a[0],a[2]),Math.min(h[0],h[2])),j=Math.min(Math.max(a[0],a[2]),Math.max(h[0],h[2]));if(R>j)return null;const G=Math.max(Math.min(a[1],a[3]),Math.min(h[1],h[3])),rt=Math.min(Math.max(a[1],a[3]),Math.max(h[1],h[3]));return G>rt?null:[R,G,j,rt]}static bezierBoundingBox(a,h,R,j,G,rt,ot,yt,At){return At?(At[0]=Math.min(At[0],a,ot),At[1]=Math.min(At[1],h,yt),At[2]=Math.max(At[2],a,ot),At[3]=Math.max(At[3],h,yt)):At=[Math.min(a,ot),Math.min(h,yt),Math.max(a,ot),Math.max(h,yt)],T(this,v,_r).call(this,a,R,G,ot,h,j,rt,yt,3*(-a+3*(R-G)+ot),6*(a-2*R+G),3*(R-a),At),T(this,v,_r).call(this,a,R,G,ot,h,j,rt,yt,3*(-h+3*(j-rt)+yt),6*(h-2*j+rt),3*(j-h),At),At}}o=new WeakSet,mn=function(a,h,R,j,G,rt,ot,yt,At,ut){if(At<=0||At>=1)return;const St=1-At,P=At*At,K=P*At,nt=St*(St*(St*a+3*At*h)+3*P*R)+K*j,B=St*(St*(St*G+3*At*rt)+3*P*ot)+K*yt;ut[0]=Math.min(ut[0],nt),ut[1]=Math.min(ut[1],B),ut[2]=Math.max(ut[2],nt),ut[3]=Math.max(ut[3],B)},v=new WeakSet,_r=function(a,h,R,j,G,rt,ot,yt,At,ut,St,P){if(Math.abs(At)<1e-12){Math.abs(ut)>=1e-12&&T(this,o,mn).call(this,a,h,R,j,G,rt,ot,yt,-St/ut,P);return}const K=ut**2-4*St*At;if(K<0)return;const nt=Math.sqrt(K),B=2*At;T(this,o,mn).call(this,a,h,R,j,G,rt,ot,yt,(-ut+nt)/B,P),T(this,o,mn).call(this,a,h,R,j,G,rt,ot,yt,(-ut-nt)/B,P)},l(Ee,o),l(Ee,v);function ne(u){return decodeURIComponent(escape(u))}let et=null,i=null;function n(u){return et||(et=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,i=new Map([["\uFB05","\u017Ft"]])),u.replaceAll(et,(a,h,R)=>h?h.normalize("NFKC"):i.get(R))}function d(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const u=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(u);else for(let a=0;a<32;a++)u[a]=Math.floor(Math.random()*255);return xe(u)}const g="pdfjs_internal_id_"}},Hr={};function Ms(r){var p=Hr[r];if(p!==void 0)return p.exports;var c=Hr[r]={exports:{}};return zo[r](c,c.exports,Ms),c.exports}(()=>{var r=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",p=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",c=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",e=m=>{m&&m.d<1&&(m.d=1,m.forEach(x=>x.r--),m.forEach(x=>x.r--?x.r++:x()))},w=m=>m.map(x=>{if(x!==null&&typeof x=="object"){if(x[r])return x;if(x.then){var W=[];W.d=0,x.then(f=>{k[p]=f,e(W)},f=>{k[c]=f,e(W)});var k={};return k[r]=f=>f(W),k}}var y={};return y[r]=f=>{},y[p]=x,y});Ms.a=(m,x,W)=>{var k;W&&((k=[]).d=-1);var y=new Set,f=m.exports,O,C,_,D=new Promise((U,Y)=>{_=Y,C=U});D[p]=f,D[r]=U=>(k&&U(k),y.forEach(U),D.catch(Y=>{})),m.exports=D,x(U=>{O=w(U);var Y,at=()=>O.map(L=>{if(L[c])throw L[c];return L[p]}),Q=new Promise(L=>{Y=()=>L(at),Y.r=0;var V=$=>$!==k&&!y.has($)&&(y.add($),$&&!$.d&&(Y.r++,$.push(Y)));O.map($=>$[r](V))});return Y.r?Q:at()},U=>(U?_(D[c]=U):C(f),e(k))),k&&k.d<0&&(k.d=0)}})(),Ms.d=(r,p)=>{for(var c in p)Ms.o(p,c)&&!Ms.o(r,c)&&Object.defineProperty(r,c,{enumerable:!0,get:p[c]})},Ms.o=(r,p)=>Object.prototype.hasOwnProperty.call(r,p);var ge=Ms(228);ge=globalThis.pdfjsLib=await(globalThis.pdfjsLibPromise=ge),ge.AbortException,ge.AnnotationEditorLayer,ge.AnnotationEditorParamsType,ge.AnnotationEditorType,ge.AnnotationEditorUIManager,ge.AnnotationLayer,ge.AnnotationMode,ge.CMapCompressionType,ge.ColorPicker,ge.DOMSVGFactory,ge.DrawLayer,ge.FeatureTest;var Wo=ge.GlobalWorkerOptions;ge.ImageKind,ge.InvalidPDFException,ge.MissingPDFException,ge.OPS,ge.Outliner,ge.PDFDataRangeTransport,ge.PDFDateString,ge.PDFWorker,ge.PasswordResponses,ge.PermissionFlag,ge.PixelsPerInch,ge.RenderingCancelledException,ge.UnexpectedResponseException,ge.Util,ge.VerbosityLevel,ge.XfaLayer,ge.build,ge.createValidAbsoluteUrl,ge.fetchData;var Xo=ge.getDocument;ge.getFilenameFromUrl,ge.getPdfFilenameFromUrl,ge.getXfaPageViewport,ge.isDataScheme,ge.isPdfFile,ge.noContextMenu,ge.normalizeUnicode,ge.renderTextLayer,ge.setLayerDimensions,ge.shadow,ge.updateTextLayer,ge.version;const Ko="https://cdn.jsdelivr.net/gh/DaimlarTech/blitz-ui-cdn/cdn/cmaps/",Yo="https://cdn.jsdelivr.net/gh/DaimlarTech/blitz-ui-cdn/cdn/pdf.worker.mjs";class Sn{constructor(p,c=2,e=(w,m)=>{}){if(!p||!p.dataset.url)throw new Error("PdfConvert: failed to instanciate");this.element=p,this.url=p.dataset.url,this.scale=c,this.data=[],this.callback=e}async init(){fetch(this.url,{headers:{"Content-Type":"application/pdf"}}).then(p=>p.blob()).then(p=>{var c=new Blob([p],{type:"application/pdf"});return Br(c)}).then(p=>this.convertFiles(p)).catch(p=>{this.loading=!1,this.error=p})}async blobInit(){var p=Ze(this.url,"application/pdf");Br(p).then(c=>this.convertFiles(c)).catch(c=>{this.loading=!1,this.error=c})}convertFiles(p){Wo.workerSrc=Yo,Xo({data:atob(p),cMapUrl:Ko,cMapPacked:!0}).promise.then(async c=>{for(let e=1;e<=c.numPages;e++)await this.pdf2png(e,c)},c=>{console.error(c)}).then(()=>{this.callback(this.data,this.element)})}async pdf2png(p,c){const e=this.scale,w=this.data;return new Promise(m=>{c.getPage(p).then(function(x){var W=x.getViewport({scale:e});let k=200/72;var y=document.createElement("canvas"),f=y.getContext("2d");y.height=W.height*k,y.width=W.width*k;var O={canvasContext:f,viewport:W,transform:[k,0,0,k,0,0]},C=x.render(O);C.promise.then(async()=>{w.push(y.toDataURL("image/png")),m()})})})}}function Jo(r,p){var c="application/"+p;if(p=="pdf")var e=Ze(r,c);else if(p=="zip")var e=Ze(r,"application/"+p);else if(p=="jpg"||p=="png"||p=="pptx")var e=Ze("data:image/"+p+";base64,"+r,c);else if(p=="doc")var e=Ze("data:application/msword;base64,"+r,c);else if(p=="xls")var e=Ze("data:application/vnd.ms-excel;base64,"+r,c);else if(p=="docx")var e=Ze("data:application/vnd.openxmlformats-officedocument.wordprocessingml.document;base64,"+r,c);else if(p=="xlsx")var e=Ze("data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"+r,c);else if(p=="ppt")var e=Ze("data:application/vnd.ms-powerpoint;base64,"+r,c);else if(p=="txt"||p=="TXT")var e=Ze("data:text/plain;base64,"+r,c);else if(p=="csv"||p=="CSV")var e=Ze("data:text/csv;base64,"+r,c);else if(p=="tsv"||p=="TSV")var e=Ze("data:text/tab-separated-values;base64,"+r,c);else if(p=="svg"||p=="SVG")var e=Ze("data:image/svg+xml;base64,"+r,c);else return;var w=(window.URL||window.webkitURL).createObjectURL(e);return w}function Ze(r,p){const c=atob(r),e=new Uint8Array(c.length);for(let w=0;w<c.length;w++)e[w]=c.charCodeAt(w);return new Blob([e.buffer],{type:p})}function Br(r){return new Promise(p=>{const c=new FileReader;c.readAsDataURL(r),c.onload=()=>{p(c.result.replace("data:application/pdf;base64,",""))}})}document.querySelectorAll('[data-role="file-display"]').forEach(r=>{const p=r.dataset.fileData,c="data:image/"+r.dataset.extension+";base64,"+p;r.src=c}),document.querySelectorAll('[data-role="additionalFiles"]').forEach(r=>{const p=r.dataset.fileData,c=r.dataset.extension,e=Jo(p,c);r.download="test",r.href=e});const Ur=r=>{const p=document.querySelector(r);p&&(p.disabled=!1)},Qo=r=>function p(){p.read||(p.read=Math.abs(this.scrollHeight-this.clientHeight-this.scrollTop)<3,p.read&&Ur(r))},$r=(r,p)=>{const c=document.createElement("div");c.classList.add("pdf-preview__container"),r.forEach((e,w)=>{const m=document.createElement("img");m.classList.add("pdf__img"),m.onload=()=>{if(c.appendChild(m),w===r.length-1){p.innerHTML=null,p.appendChild(c);let x=new MutationObserver(function(W){p.contains(m)&&(document.querySelectorAll('[data-role="scroll-check"]').forEach(k=>{c.addEventListener("load",()=>{const y=document.querySelector(k.dataset.target);Math.abs(y.scrollHeight-y.clientHeight-y.scrollTop)<3?Ur(`#${k.id}`):y.addEventListener("scroll",Qo(`#${k.id}`))})}),x.disconnect())});x.observe(p,{attributes:!1,childList:!0,characterData:!1,subtree:!0})}},m.src=e})};document.querySelectorAll('[data-role="pdf-preview-dl"]').forEach(r=>{const p=new Sn(r,2,$r);r.dataset.type==="blob"?p.blobInit():p.init()}),document.querySelectorAll('[data-role="pdf-preview-dl-blob"]').forEach(r=>{new Sn(r,2,$r).blobInit()}),document.querySelectorAll('[data-role="scroll-check-btn"]').forEach(r=>{document.querySelector(r.dataset.target).addEventListener("change",p=>{r.disabled=!p.target.checked}),r.addEventListener("click",()=>{document.querySelector(r.dataset.download).click();const p=document.querySelector(`[name="${r.dataset.result}"]`);p&&(p.value=new Date().toISOString(),p.dispatchEvent(new Event("change"))),document.querySelector(r.dataset.modal).classList.toggle("dialog_is_open")})}),document.querySelectorAll('[data-role="download-result-display"]').forEach(r=>{const p=document.querySelector(`[name="${r.dataset.target}"]`);p&&p.addEventListener("change",c=>{r.textContent=c.target.value.length===0?"\u672A\u627F\u8AFE":`\u627F\u8AFE\u6E08\u307F ${c.target.value.slice(0,10)}`})});const Zo=document.querySelectorAll('[data-role="download-document-dialog]'),th=(r,p)=>{const c=document.createElement("div");c.classList.add("pdf-preview__container"),r.forEach((e,w)=>{const m=document.createElement("img");m.classList.add("pdf__img"),m.onload=()=>{c.appendChild(m),w===r.length-1&&(p.innerHTML=null,p.appendChild(c),document.querySelectorAll('[data-role="scroll-check"]').forEach(x=>{document.querySelector(x.dataset.target).addEventListener("scroll",eh(`#${x.id}`))}))},m.src=e})},eh=r=>function p(){if(!p.read&&(p.read=Math.abs(this.scrollHeight-this.clientHeight-this.scrollTop)<1,p.read)){const c=document.querySelector(r);c&&(c.disabled=!1)}};Zo.forEach(r=>{r.querySelector('button[data="download-button"]'),r.querySelector('input[data="confirm-check"]'),r.querySelector('[data="document-container"]'),r.querySelector('[data="download-result"]'),document.querySelector(r.dataset.target);const p=r.querySelectorAll('[data-role="pdf-preview-dl"]');new Sn(p,2,th)})})();
