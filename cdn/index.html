<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>layout sample</title>
  <script type="module" crossorigin src="/main.js"></script>
  <link rel="stylesheet" crossorigin href="/style.css">
</head>

<body>
    <!--/* 不動産特定共同事業契約書 */-->
    <div class="download-document" th:if="${record[10] != null}" th:with="file=${record[10][0]}">
        <!-- label -->
        <div class="label label_required">
            <span class="label__text">
                不動産特定共同事業契約書への同意
            </span>
        </div>
        <!-- button -->
        <div class="download-document__inner">
            <button type="button" class="download-document__button" data-role="dialog-toggler"
              data-target="#contract-pdf-popup" th:text="${file.fileName}">
                契約成立前書面
            </button>
            <span class="download-document__value" data-role="download-result-display"
              data-target="contract_download_at">
                未承諾
            </span>
        </div>
        <!--/* PDF Popup */-->
        <div class="dialog dialog_pdf" id="contract-pdf-popup">
            <button type="button" class="dialog__close" data-role="dialog-dismiss"></button>
            <div class="dialog__container">
                <div class="dialog__body" id="contract-pdf">
                    <div data-role="pdf-preview-dl" th:data-url="${file.fileUrl}"
                      data-url="http://192.168.10.06:5173/contract.pdf"
                      class="pdf-preview pdf-preview_height_full">
                        <div class="img img_loading"></div>
                    </div>
                </div>

                <div class="dialog__footer">
                    <p class="dialog__footer-text">
                        ※最後まで確認しないとチェック及びダウンロードができません。
                    </p>

                    <div class="scroll-check">
                        <label for="contract-input" class="label label_check">
                            <input type="checkbox" class="input input_check"
                              id="contract-input"
                              data-role="scroll-check" data-target="#contract-pdf"
                              disabled
                              required>
                            <span class="dialog__confirm-text">上記内容を確認しました。</span>
                        </label>

                        <button type="button"
                          class="button button_width_full button_size_sm"
                          data-role="scroll-check-btn"
                          data-target="#contract-input"
                          data-download="#download-link-contract"
                          data-result="contract_download_at"
                          data-modal="#contract-pdf-popup"
                          disabled>
                            同意してダウンロード
                        </button>

                        <a th:href="${file.fileUrl}" id="download-link-contract"></a>
                    </div>
                </div>
            </div>
        </div>
        <input type="hidden" name="contract_download_at" data-role="download-result" required>
    </div>

    <!--/* 契約時追加出力書面 */-->
    <div class="download-document"
      th:if="${#maps.containsKey(record, 4) and #maps.containsKey(record[4], 180) and record[4][180]?.id  == 2 and record[15] != null}"
      th:with="file=${record[15][0]}">
        <!-- label -->
        <div class="label label_required">
            <span class="label__text" th:text="|${record[14] ?: '契約時追加出力書面'}への同意|">
                契約時追加出力書面への同意
            </span>
        </div>
        <!-- button -->
        <div class="download-document__inner">
            <button type="button" class="download-document__button"
              data-role="dialog-toggler"
              data-target="#agreement-pdf-popup" th:text="${file.fileName}">
                契約成立前書面
            </button>
            <span class="download-document__value" data-role="download-result-display"
              data-target="agreement_download_at">
                未承諾
            </span>
        </div>
        <!--/* PDF Popup */-->
        <div class="dialog dialog_pdf" id="agreement-pdf-popup">
            <button type="button" class="dialog__close" data-role="dialog-dismiss"></button>
            <div class="dialog__container">
                <div class="dialog__body" id="agreement-pdf">
                    <div data-role="pdf-preview-dl" th:data-url="${file.fileUrl}"
                      data-url="http://192.168.10.06:5173/contract.pdf"
                      class="pdf-preview pdf-preview_height_full">
                        <div class="img img_loading"></div>
                    </div>
                </div>
                <div class="dialog__footer">
                    <p class="dialog__footer-text">
                        ※最後まで確認しないとチェック及びダウンロードができません。
                    </p>
                    <div class="scroll-check">
                        <label for="agreement-input" class="label label_check">
                            <input type="checkbox" class="input input_check"
                              id="agreement-input"
                              data-role="scroll-check" data-target="#agreement-pdf"
                              disabled
                              required>
                            <span class="dialog__confirm-text">上記内容を確認しました。</span>
                        </label>
                        <button type="button"
                          class="button button_width_full button_size_sm"
                          data-role="scroll-check-btn"
                          data-target="#agreement-input"
                          data-download="#download-link-agreement"
                          data-result="agreement_download_at"
                          data-modal="#agreement-pdf-popup"
                          disabled>
                            同意してダウンロード
                        </button>
                        <a th:href="${file.fileUrl}" id="download-link-agreement"></a>
                    </div>
                </div>
            </div>
        </div>
        <input type="hidden" name="agreement_download_at" data-role="download-result" required>
    </div>

    <th:block th:if="${cp.result.value['additionalFiles'] != null}">
        <!--/* 契約時追加表示ファイル 修正中 */-->
        <th:block th:each="file,meta : ${cp.result.value['additionalFiles']}" th:with="ind=${meta.index}">
            <div th:if="${file.exists}" class="download-document">
                <div class="label label_optional">
                    <span class="label__text" th:text="${file.displayName}">
                        契約時追加表示ファイル
                    </span>
                </div>

                <div class="download-document__inner">
                    <a th:data-file-data="${file.fileData}" th:data-extension="${file.extension}"
                      th:text="${file.fileName}" class="download-document__button" data-role="additionalFiles"></a>
                </div>
            </div>
        </th:block>
    </th:block>
</body>

</html>